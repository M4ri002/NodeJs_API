import"v-calendar/style.css";(function(){const _=document.createElement("link").relList;if(_&&_.supports&&_.supports("modulepreload"))return;for(const T of document.querySelectorAll('link[rel="modulepreload"]'))m(T);new MutationObserver(T=>{for(const f of T)if(f.type==="childList")for(const x of f.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&m(x)}).observe(document,{childList:!0,subtree:!0});function E(T){const f={};return T.integrity&&(f.integrity=T.integrity),T.referrerPolicy&&(f.referrerPolicy=T.referrerPolicy),T.crossOrigin==="use-credentials"?f.credentials="include":T.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function m(T){if(T.ep)return;T.ep=!0;const f=E(T);fetch(T.href,f)}})();/**
* @vue/shared v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function G_(u,_){const E=new Set(u.split(","));return _?m=>E.has(m.toLowerCase()):m=>E.has(m)}const Si={},ud=[],gs=()=>{},SP=()=>!1,Cp=u=>u.charCodeAt(0)===111&&u.charCodeAt(1)===110&&(u.charCodeAt(2)>122||u.charCodeAt(2)<97),K0=u=>u.startsWith("onUpdate:"),Wi=Object.assign,J0=(u,_)=>{const E=u.indexOf(_);E>-1&&u.splice(E,1)},MP=Object.prototype.hasOwnProperty,ii=(u,_)=>MP.call(u,_),Bn=Array.isArray,hd=u=>Md(u)==="[object Map]",mh=u=>Md(u)==="[object Set]",Hw=u=>Md(u)==="[object Date]",AP=u=>Md(u)==="[object RegExp]",Mr=u=>typeof u=="function",Zi=u=>typeof u=="string",Wc=u=>typeof u=="symbol",Pi=u=>u!==null&&typeof u=="object",Q0=u=>(Pi(u)||Mr(u))&&Mr(u.then)&&Mr(u.catch),uE=Object.prototype.toString,Md=u=>uE.call(u),IP=u=>Md(u).slice(8,-1),hE=u=>Md(u)==="[object Object]",ev=u=>Zi(u)&&u!=="NaN"&&u[0]!=="-"&&""+parseInt(u,10)===u,dd=G_(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),H_=u=>{const _=Object.create(null);return E=>_[E]||(_[E]=u(E))},CP=/-(\w)/g,ls=H_(u=>u.replace(CP,(_,E)=>E?E.toUpperCase():"")),PP=/\B([A-Z])/g,Gs=H_(u=>u.replace(PP,"-$1").toLowerCase()),Pp=H_(u=>u.charAt(0).toUpperCase()+u.slice(1)),ap=H_(u=>u?`on${Pp(u)}`:""),La=(u,_)=>!Object.is(u,_),fd=(u,_)=>{for(let E=0;E<u.length;E++)u[E](_)},k_=(u,_,E)=>{Object.defineProperty(u,_,{configurable:!0,enumerable:!1,value:E})},_p=u=>{const _=parseFloat(u);return isNaN(_)?u:_},O_=u=>{const _=Zi(u)?Number(u):NaN;return isNaN(_)?u:_};let qw;const dE=()=>qw||(qw=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),DP="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error",kP=G_(DP);function Dp(u){if(Bn(u)){const _={};for(let E=0;E<u.length;E++){const m=u[E],T=Zi(m)?zP(m):Dp(m);if(T)for(const f in T)_[f]=T[f]}return _}else if(Zi(u)||Pi(u))return u}const OP=/;(?![^(]*\))/g,RP=/:([^]+)/,LP=/\/\*[^]*?\*\//g;function zP(u){const _={};return u.replace(LP,"").split(OP).forEach(E=>{if(E){const m=E.split(RP);m.length>1&&(_[m[0].trim()]=m[1].trim())}}),_}function ys(u){let _="";if(Zi(u))_=u;else if(Bn(u))for(let E=0;E<u.length;E++){const m=ys(u[E]);m&&(_+=m+" ")}else if(Pi(u))for(const E in u)u[E]&&(_+=E+" ");return _.trim()}function FP(u){if(!u)return null;let{class:_,style:E}=u;return _&&!Zi(_)&&(u.class=ys(_)),E&&(u.style=Dp(E)),u}const BP="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",NP=G_(BP);function fE(u){return!!u||u===""}function jP(u,_){if(u.length!==_.length)return!1;let E=!0;for(let m=0;E&&m<u.length;m++)E=Zc(u[m],_[m]);return E}function Zc(u,_){if(u===_)return!0;let E=Hw(u),m=Hw(_);if(E||m)return E&&m?u.getTime()===_.getTime():!1;if(E=Wc(u),m=Wc(_),E||m)return u===_;if(E=Bn(u),m=Bn(_),E||m)return E&&m?jP(u,_):!1;if(E=Pi(u),m=Pi(_),E||m){if(!E||!m)return!1;const T=Object.keys(u).length,f=Object.keys(_).length;if(T!==f)return!1;for(const x in u){const A=u.hasOwnProperty(x),i=_.hasOwnProperty(x);if(A&&!i||!A&&i||!Zc(u[x],_[x]))return!1}}return String(u)===String(_)}function q_(u,_){return u.findIndex(E=>Zc(E,_))}const Gc=u=>Zi(u)?u:u==null?"":Bn(u)||Pi(u)&&(u.toString===uE||!Mr(u.toString))?JSON.stringify(u,pE,2):String(u),pE=(u,_)=>_&&_.__v_isRef?pE(u,_.value):hd(_)?{[`Map(${_.size})`]:[..._.entries()].reduce((E,[m,T],f)=>(E[n0(m,f)+" =>"]=T,E),{})}:mh(_)?{[`Set(${_.size})`]:[..._.values()].map(E=>n0(E))}:Wc(_)?n0(_):Pi(_)&&!Bn(_)&&!hE(_)?String(_):_,n0=(u,_="")=>{var E;return Wc(u)?`Symbol(${(E=u.description)!=null?E:_})`:u};/**
* @vue/reactivity v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Us;class tv{constructor(_=!1){this.detached=_,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Us,!_&&Us&&(this.index=(Us.scopes||(Us.scopes=[])).push(this)-1)}get active(){return this._active}run(_){if(this._active){const E=Us;try{return Us=this,_()}finally{Us=E}}}on(){Us=this}off(){Us=this.parent}stop(_){if(this._active){let E,m;for(E=0,m=this.effects.length;E<m;E++)this.effects[E].stop();for(E=0,m=this.cleanups.length;E<m;E++)this.cleanups[E]();if(this.scopes)for(E=0,m=this.scopes.length;E<m;E++)this.scopes[E].stop(!0);if(!this.detached&&this.parent&&!_){const T=this.parent.scopes.pop();T&&T!==this&&(this.parent.scopes[this.index]=T,T.index=this.index)}this.parent=void 0,this._active=!1}}}function nv(u){return new tv(u)}function mE(u,_=Us){_&&_.active&&_.effects.push(u)}function rv(){return Us}function _E(u){Us&&Us.cleanups.push(u)}let rh;class vd{constructor(_,E,m,T){this.fn=_,this.trigger=E,this.scheduler=m,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,mE(this,T)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,_h();for(let _=0;_<this._depsLength;_++){const E=this.deps[_];if(E.computed&&(VP(E.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),gh()}return this._dirtyLevel>=4}set dirty(_){this._dirtyLevel=_?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let _=Hc,E=rh;try{return Hc=!0,rh=this,this._runnings++,Ww(this),this.fn()}finally{Zw(this),this._runnings--,rh=E,Hc=_}}stop(){var _;this.active&&(Ww(this),Zw(this),(_=this.onStop)==null||_.call(this),this.active=!1)}}function VP(u){return u.value}function Ww(u){u._trackId++,u._depsLength=0}function Zw(u){if(u.deps.length>u._depsLength){for(let _=u._depsLength;_<u.deps.length;_++)gE(u.deps[_],u);u.deps.length=u._depsLength}}function gE(u,_){const E=u.get(_);E!==void 0&&_._trackId!==E&&(u.delete(_),u.size===0&&u.cleanup())}function UP(u,_){u.effect instanceof vd&&(u=u.effect.fn);const E=new vd(u,gs,()=>{E.dirty&&E.run()});_&&(Wi(E,_),_.scope&&mE(E,_.scope)),(!_||!_.lazy)&&E.run();const m=E.run.bind(E);return m.effect=E,m}function $P(u){u.effect.stop()}let Hc=!0,v0=0;const yE=[];function _h(){yE.push(Hc),Hc=!1}function gh(){const u=yE.pop();Hc=u===void 0?!0:u}function iv(){v0++}function ov(){for(v0--;!v0&&x0.length;)x0.shift()()}function vE(u,_,E){if(_.get(u)!==u._trackId){_.set(u,u._trackId);const m=u.deps[u._depsLength];m!==_?(m&&gE(m,u),u.deps[u._depsLength++]=_):u._depsLength++}}const x0=[];function xE(u,_,E){iv();for(const m of u.keys()){let T;m._dirtyLevel<_&&(T??(T=u.get(m)===m._trackId))&&(m._shouldSchedule||(m._shouldSchedule=m._dirtyLevel===0),m._dirtyLevel=_),m._shouldSchedule&&(T??(T=u.get(m)===m._trackId))&&(m.trigger(),(!m._runnings||m.allowRecurse)&&m._dirtyLevel!==2&&(m._shouldSchedule=!1,m.scheduler&&x0.push(m.scheduler)))}ov()}const bE=(u,_)=>{const E=new Map;return E.cleanup=u,E.computed=_,E},R_=new WeakMap,ih=Symbol(""),b0=Symbol("");function xs(u,_,E){if(Hc&&rh){let m=R_.get(u);m||R_.set(u,m=new Map);let T=m.get(E);T||m.set(E,T=bE(()=>m.delete(E))),vE(rh,T)}}function Gl(u,_,E,m,T,f){const x=R_.get(u);if(!x)return;let A=[];if(_==="clear")A=[...x.values()];else if(E==="length"&&Bn(u)){const i=Number(m);x.forEach((P,O)=>{(O==="length"||!Wc(O)&&O>=i)&&A.push(P)})}else switch(E!==void 0&&A.push(x.get(E)),_){case"add":Bn(u)?ev(E)&&A.push(x.get("length")):(A.push(x.get(ih)),hd(u)&&A.push(x.get(b0)));break;case"delete":Bn(u)||(A.push(x.get(ih)),hd(u)&&A.push(x.get(b0)));break;case"set":hd(u)&&A.push(x.get(ih));break}iv();for(const i of A)i&&xE(i,4);ov()}function GP(u,_){var E;return(E=R_.get(u))==null?void 0:E.get(_)}const HP=G_("__proto__,__v_isRef,__isVue"),wE=new Set(Object.getOwnPropertyNames(Symbol).filter(u=>u!=="arguments"&&u!=="caller").map(u=>Symbol[u]).filter(Wc)),Yw=qP();function qP(){const u={};return["includes","indexOf","lastIndexOf"].forEach(_=>{u[_]=function(...E){const m=Xr(this);for(let f=0,x=this.length;f<x;f++)xs(m,"get",f+"");const T=m[_](...E);return T===-1||T===!1?m[_](...E.map(Xr)):T}}),["push","pop","shift","unshift","splice"].forEach(_=>{u[_]=function(...E){_h(),iv();const m=Xr(this)[_].apply(this,E);return ov(),gh(),m}}),u}function WP(u){const _=Xr(this);return xs(_,"has",u),_.hasOwnProperty(u)}class TE{constructor(_=!1,E=!1){this._isReadonly=_,this._isShallow=E}get(_,E,m){const T=this._isReadonly,f=this._isShallow;if(E==="__v_isReactive")return!T;if(E==="__v_isReadonly")return T;if(E==="__v_isShallow")return f;if(E==="__v_raw")return m===(T?f?CE:IE:f?AE:ME).get(_)||Object.getPrototypeOf(_)===Object.getPrototypeOf(m)?_:void 0;const x=Bn(_);if(!T){if(x&&ii(Yw,E))return Reflect.get(Yw,E,m);if(E==="hasOwnProperty")return WP}const A=Reflect.get(_,E,m);return(Wc(E)?wE.has(E):HP(E))||(T||xs(_,"get",E),f)?A:ro(A)?x&&ev(E)?A:A.value:Pi(A)?T?lv(A):za(A):A}}class EE extends TE{constructor(_=!1){super(!1,_)}set(_,E,m,T){let f=_[E];if(!this._isShallow){const i=ah(f);if(!gp(m)&&!ah(m)&&(f=Xr(f),m=Xr(m)),!Bn(_)&&ro(f)&&!ro(m))return i?!1:(f.value=m,!0)}const x=Bn(_)&&ev(E)?Number(E)<_.length:ii(_,E),A=Reflect.set(_,E,m,T);return _===Xr(T)&&(x?La(m,f)&&Gl(_,"set",E,m):Gl(_,"add",E,m)),A}deleteProperty(_,E){const m=ii(_,E);_[E];const T=Reflect.deleteProperty(_,E);return T&&m&&Gl(_,"delete",E,void 0),T}has(_,E){const m=Reflect.has(_,E);return(!Wc(E)||!wE.has(E))&&xs(_,"has",E),m}ownKeys(_){return xs(_,"iterate",Bn(_)?"length":ih),Reflect.ownKeys(_)}}class SE extends TE{constructor(_=!1){super(!0,_)}set(_,E){return!0}deleteProperty(_,E){return!0}}const ZP=new EE,YP=new SE,XP=new EE(!0),KP=new SE(!0),sv=u=>u,W_=u=>Reflect.getPrototypeOf(u);function f_(u,_,E=!1,m=!1){u=u.__v_raw;const T=Xr(u),f=Xr(_);E||(La(_,f)&&xs(T,"get",_),xs(T,"get",f));const{has:x}=W_(T),A=m?sv:E?uv:yp;if(x.call(T,_))return A(u.get(_));if(x.call(T,f))return A(u.get(f));u!==T&&u.get(_)}function p_(u,_=!1){const E=this.__v_raw,m=Xr(E),T=Xr(u);return _||(La(u,T)&&xs(m,"has",u),xs(m,"has",T)),u===T?E.has(u):E.has(u)||E.has(T)}function m_(u,_=!1){return u=u.__v_raw,!_&&xs(Xr(u),"iterate",ih),Reflect.get(u,"size",u)}function Xw(u){u=Xr(u);const _=Xr(this);return W_(_).has.call(_,u)||(_.add(u),Gl(_,"add",u,u)),this}function Kw(u,_){_=Xr(_);const E=Xr(this),{has:m,get:T}=W_(E);let f=m.call(E,u);f||(u=Xr(u),f=m.call(E,u));const x=T.call(E,u);return E.set(u,_),f?La(_,x)&&Gl(E,"set",u,_):Gl(E,"add",u,_),this}function Jw(u){const _=Xr(this),{has:E,get:m}=W_(_);let T=E.call(_,u);T||(u=Xr(u),T=E.call(_,u)),m&&m.call(_,u);const f=_.delete(u);return T&&Gl(_,"delete",u,void 0),f}function Qw(){const u=Xr(this),_=u.size!==0,E=u.clear();return _&&Gl(u,"clear",void 0,void 0),E}function __(u,_){return function(m,T){const f=this,x=f.__v_raw,A=Xr(x),i=_?sv:u?uv:yp;return!u&&xs(A,"iterate",ih),x.forEach((P,O)=>m.call(T,i(P),i(O),f))}}function g_(u,_,E){return function(...m){const T=this.__v_raw,f=Xr(T),x=hd(f),A=u==="entries"||u===Symbol.iterator&&x,i=u==="keys"&&x,P=T[u](...m),O=E?sv:_?uv:yp;return!_&&xs(f,"iterate",i?b0:ih),{next(){const{value:L,done:U}=P.next();return U?{value:L,done:U}:{value:A?[O(L[0]),O(L[1])]:O(L),done:U}},[Symbol.iterator](){return this}}}}function kc(u){return function(..._){return u==="delete"?!1:u==="clear"?void 0:this}}function JP(){const u={get(f){return f_(this,f)},get size(){return m_(this)},has:p_,add:Xw,set:Kw,delete:Jw,clear:Qw,forEach:__(!1,!1)},_={get(f){return f_(this,f,!1,!0)},get size(){return m_(this)},has:p_,add:Xw,set:Kw,delete:Jw,clear:Qw,forEach:__(!1,!0)},E={get(f){return f_(this,f,!0)},get size(){return m_(this,!0)},has(f){return p_.call(this,f,!0)},add:kc("add"),set:kc("set"),delete:kc("delete"),clear:kc("clear"),forEach:__(!0,!1)},m={get(f){return f_(this,f,!0,!0)},get size(){return m_(this,!0)},has(f){return p_.call(this,f,!0)},add:kc("add"),set:kc("set"),delete:kc("delete"),clear:kc("clear"),forEach:__(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(f=>{u[f]=g_(f,!1,!1),E[f]=g_(f,!0,!1),_[f]=g_(f,!1,!0),m[f]=g_(f,!0,!0)}),[u,E,_,m]}const[QP,eD,tD,nD]=JP();function Z_(u,_){const E=_?u?nD:tD:u?eD:QP;return(m,T,f)=>T==="__v_isReactive"?!u:T==="__v_isReadonly"?u:T==="__v_raw"?m:Reflect.get(ii(E,T)&&T in m?E:m,T,f)}const rD={get:Z_(!1,!1)},iD={get:Z_(!1,!0)},oD={get:Z_(!0,!1)},sD={get:Z_(!0,!0)},ME=new WeakMap,AE=new WeakMap,IE=new WeakMap,CE=new WeakMap;function aD(u){switch(u){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function lD(u){return u.__v_skip||!Object.isExtensible(u)?0:aD(IP(u))}function za(u){return ah(u)?u:Y_(u,!1,ZP,rD,ME)}function av(u){return Y_(u,!1,XP,iD,AE)}function lv(u){return Y_(u,!0,YP,oD,IE)}function cD(u){return Y_(u,!0,KP,sD,CE)}function Y_(u,_,E,m,T){if(!Pi(u)||u.__v_raw&&!(_&&u.__v_isReactive))return u;const f=T.get(u);if(f)return f;const x=lD(u);if(x===0)return u;const A=new Proxy(u,x===2?m:E);return T.set(u,A),A}function Hl(u){return ah(u)?Hl(u.__v_raw):!!(u&&u.__v_isReactive)}function ah(u){return!!(u&&u.__v_isReadonly)}function gp(u){return!!(u&&u.__v_isShallow)}function cv(u){return Hl(u)||ah(u)}function Xr(u){const _=u&&u.__v_raw;return _?Xr(_):u}function kp(u){return Object.isExtensible(u)&&k_(u,"__v_skip",!0),u}const yp=u=>Pi(u)?za(u):u,uv=u=>Pi(u)?lv(u):u;class PE{constructor(_,E,m,T){this.getter=_,this._setter=E,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new vd(()=>_(this._value),()=>pd(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!T,this.__v_isReadonly=m}get value(){const _=Xr(this);return(!_._cacheable||_.effect.dirty)&&La(_._value,_._value=_.effect.run())&&pd(_,4),hv(_),_.effect._dirtyLevel>=2&&pd(_,2),_._value}set value(_){this._setter(_)}get _dirty(){return this.effect.dirty}set _dirty(_){this.effect.dirty=_}}function uD(u,_,E=!1){let m,T;const f=Mr(u);return f?(m=u,T=gs):(m=u.get,T=u.set),new PE(m,T,f||!T,E)}function hv(u){var _;Hc&&rh&&(u=Xr(u),vE(rh,(_=u.dep)!=null?_:u.dep=bE(()=>u.dep=void 0,u instanceof PE?u:void 0)))}function pd(u,_=4,E){u=Xr(u);const m=u.dep;m&&xE(m,_)}function ro(u){return!!(u&&u.__v_isRef===!0)}function Yr(u){return kE(u,!1)}function DE(u){return kE(u,!0)}function kE(u,_){return ro(u)?u:new hD(u,_)}class hD{constructor(_,E){this.__v_isShallow=E,this.dep=void 0,this.__v_isRef=!0,this._rawValue=E?_:Xr(_),this._value=E?_:yp(_)}get value(){return hv(this),this._value}set value(_){const E=this.__v_isShallow||gp(_)||ah(_);_=E?_:Xr(_),La(_,this._rawValue)&&(this._rawValue=_,this._value=E?_:yp(_),pd(this,4))}}function dD(u){pd(u,4)}function $i(u){return ro(u)?u.value:u}function fD(u){return Mr(u)?u():$i(u)}const pD={get:(u,_,E)=>$i(Reflect.get(u,_,E)),set:(u,_,E,m)=>{const T=u[_];return ro(T)&&!ro(E)?(T.value=E,!0):Reflect.set(u,_,E,m)}};function dv(u){return Hl(u)?u:new Proxy(u,pD)}class mD{constructor(_){this.dep=void 0,this.__v_isRef=!0;const{get:E,set:m}=_(()=>hv(this),()=>pd(this));this._get=E,this._set=m}get value(){return this._get()}set value(_){this._set(_)}}function OE(u){return new mD(u)}function RE(u){const _=Bn(u)?new Array(u.length):{};for(const E in u)_[E]=LE(u,E);return _}class _D{constructor(_,E,m){this._object=_,this._key=E,this._defaultValue=m,this.__v_isRef=!0}get value(){const _=this._object[this._key];return _===void 0?this._defaultValue:_}set value(_){this._object[this._key]=_}get dep(){return GP(Xr(this._object),this._key)}}class gD{constructor(_){this._getter=_,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function yD(u,_,E){return ro(u)?u:Mr(u)?new gD(u):Pi(u)&&arguments.length>1?LE(u,_,E):Yr(u)}function LE(u,_,E){const m=u[_];return ro(m)?m:new _D(u,_,E)}const vD={GET:"get",HAS:"has",ITERATE:"iterate"},xD={SET:"set",ADD:"add",DELETE:"delete",CLEAR:"clear"};/**
* @vue/runtime-core v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function bD(u,_){}const wD={SETUP_FUNCTION:0,0:"SETUP_FUNCTION",RENDER_FUNCTION:1,1:"RENDER_FUNCTION",WATCH_GETTER:2,2:"WATCH_GETTER",WATCH_CALLBACK:3,3:"WATCH_CALLBACK",WATCH_CLEANUP:4,4:"WATCH_CLEANUP",NATIVE_EVENT_HANDLER:5,5:"NATIVE_EVENT_HANDLER",COMPONENT_EVENT_HANDLER:6,6:"COMPONENT_EVENT_HANDLER",VNODE_HOOK:7,7:"VNODE_HOOK",DIRECTIVE_HOOK:8,8:"DIRECTIVE_HOOK",TRANSITION_HOOK:9,9:"TRANSITION_HOOK",APP_ERROR_HANDLER:10,10:"APP_ERROR_HANDLER",APP_WARN_HANDLER:11,11:"APP_WARN_HANDLER",FUNCTION_REF:12,12:"FUNCTION_REF",ASYNC_COMPONENT_LOADER:13,13:"ASYNC_COMPONENT_LOADER",SCHEDULER:14,14:"SCHEDULER"},TD={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",0:"setup function",1:"render function",2:"watcher getter",3:"watcher callback",4:"watcher cleanup function",5:"native event handler",6:"component event handler",7:"vnode hook",8:"directive hook",9:"transition hook",10:"app errorHandler",11:"app warnHandler",12:"ref function",13:"async component loader",14:"scheduler flush. This is likely a Vue internals bug. Please open an issue at https://github.com/vuejs/core ."};function ql(u,_,E,m){try{return m?u(...m):u()}catch(T){yh(T,_,E)}}function Hs(u,_,E,m){if(Mr(u)){const f=ql(u,_,E,m);return f&&Q0(f)&&f.catch(x=>{yh(x,_,E)}),f}const T=[];for(let f=0;f<u.length;f++)T.push(Hs(u[f],_,E,m));return T}function yh(u,_,E,m=!0){const T=_?_.vnode:null;if(_){let f=_.parent;const x=_.proxy,A=`https://vuejs.org/error-reference/#runtime-${E}`;for(;f;){const P=f.ec;if(P){for(let O=0;O<P.length;O++)if(P[O](u,x,A)===!1)return}f=f.parent}const i=_.appContext.config.errorHandler;if(i){ql(i,null,10,[u,x,A]);return}}ED(u,E,T,m)}function ED(u,_,E,m=!0){console.error(u)}let vp=!1,w0=!1;const Ko=[];let hl=0;const md=[];let Nc=null,th=0;const zE=Promise.resolve();let fv=null;function Ad(u){const _=fv||zE;return u?_.then(this?u.bind(this):u):_}function SD(u){let _=hl+1,E=Ko.length;for(;_<E;){const m=_+E>>>1,T=Ko[m],f=xp(T);f<u||f===u&&T.pre?_=m+1:E=m}return _}function X_(u){(!Ko.length||!Ko.includes(u,vp&&u.allowRecurse?hl+1:hl))&&(u.id==null?Ko.push(u):Ko.splice(SD(u.id),0,u),FE())}function FE(){!vp&&!w0&&(w0=!0,fv=zE.then(BE))}function MD(u){const _=Ko.indexOf(u);_>hl&&Ko.splice(_,1)}function L_(u){Bn(u)?md.push(...u):(!Nc||!Nc.includes(u,u.allowRecurse?th+1:th))&&md.push(u),FE()}function eT(u,_,E=vp?hl+1:0){for(;E<Ko.length;E++){const m=Ko[E];if(m&&m.pre){if(u&&m.id!==u.uid)continue;Ko.splice(E,1),E--,m()}}}function z_(u){if(md.length){const _=[...new Set(md)].sort((E,m)=>xp(E)-xp(m));if(md.length=0,Nc){Nc.push(..._);return}for(Nc=_,th=0;th<Nc.length;th++)Nc[th]();Nc=null,th=0}}const xp=u=>u.id==null?1/0:u.id,AD=(u,_)=>{const E=xp(u)-xp(_);if(E===0){if(u.pre&&!_.pre)return-1;if(_.pre&&!u.pre)return 1}return E};function BE(u){w0=!1,vp=!0,Ko.sort(AD);try{for(hl=0;hl<Ko.length;hl++){const _=Ko[hl];_&&_.active!==!1&&ql(_,null,14)}}finally{hl=0,Ko.length=0,z_(),vp=!1,fv=null,(Ko.length||md.length)&&BE()}}let ld,y_=[];function NE(u,_){var E,m;ld=u,ld?(ld.enabled=!0,y_.forEach(({event:T,args:f})=>ld.emit(T,...f)),y_=[]):typeof window<"u"&&window.HTMLElement&&!((m=(E=window.navigator)==null?void 0:E.userAgent)!=null&&m.includes("jsdom"))?((_.__VUE_DEVTOOLS_HOOK_REPLAY__=_.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(f=>{NE(f,_)}),setTimeout(()=>{ld||(_.__VUE_DEVTOOLS_HOOK_REPLAY__=null,y_=[])},3e3)):y_=[]}function ID(u,_,...E){if(u.isUnmounted)return;const m=u.vnode.props||Si;let T=E;const f=_.startsWith("update:"),x=f&&_.slice(7);if(x&&x in m){const O=`${x==="modelValue"?"model":x}Modifiers`,{number:L,trim:U}=m[O]||Si;U&&(T=E.map(j=>Zi(j)?j.trim():j)),L&&(T=E.map(_p))}let A,i=m[A=ap(_)]||m[A=ap(ls(_))];!i&&f&&(i=m[A=ap(Gs(_))]),i&&Hs(i,u,6,T);const P=m[A+"Once"];if(P){if(!u.emitted)u.emitted={};else if(u.emitted[A])return;u.emitted[A]=!0,Hs(P,u,6,T)}}function jE(u,_,E=!1){const m=_.emitsCache,T=m.get(u);if(T!==void 0)return T;const f=u.emits;let x={},A=!1;if(!Mr(u)){const i=P=>{const O=jE(P,_,!0);O&&(A=!0,Wi(x,O))};!E&&_.mixins.length&&_.mixins.forEach(i),u.extends&&i(u.extends),u.mixins&&u.mixins.forEach(i)}return!f&&!A?(Pi(u)&&m.set(u,null),null):(Bn(f)?f.forEach(i=>x[i]=null):Wi(x,f),Pi(u)&&m.set(u,x),x)}function K_(u,_){return!u||!Cp(_)?!1:(_=_.slice(2).replace(/Once$/,""),ii(u,_[0].toLowerCase()+_.slice(1))||ii(u,Gs(_))||ii(u,_))}let vo=null,J_=null;function bp(u){const _=vo;return vo=u,J_=u&&u.type.__scopeId||null,_}function Zl(u){J_=u}function Yl(){J_=null}const CD=u=>wp;function wp(u,_=vo,E){if(!_||u._n)return u;const m=(...T)=>{m._d&&P0(-1);const f=bp(_);let x;try{x=u(...T)}finally{bp(f),m._d&&P0(1)}return x};return m._n=!0,m._c=!0,m._d=!0,m}function S_(u){const{type:_,vnode:E,proxy:m,withProxy:T,props:f,propsOptions:[x],slots:A,attrs:i,emit:P,render:O,renderCache:L,data:U,setupState:j,ctx:W,inheritAttrs:J}=u;let fe,_e;const we=bp(u);try{if(E.shapeFlag&4){const Pe=T||m,Fe=Pe;fe=$s(O.call(Fe,Pe,L,f,j,U,W)),_e=i}else{const Pe=_;fe=$s(Pe.length>1?Pe(f,{attrs:i,slots:A,emit:P}):Pe(f,null)),_e=_.props?i:DD(i)}}catch(Pe){hp.length=0,yh(Pe,u,1),fe=cr(Jo)}let ye=fe;if(_e&&J!==!1){const Pe=Object.keys(_e),{shapeFlag:Fe}=ye;Pe.length&&Fe&7&&(x&&Pe.some(K0)&&(_e=kD(_e,x)),ye=fl(ye,_e))}return E.dirs&&(ye=fl(ye),ye.dirs=ye.dirs?ye.dirs.concat(E.dirs):E.dirs),E.transition&&(ye.transition=E.transition),fe=ye,bp(we),fe}function PD(u,_=!0){let E;for(let m=0;m<u.length;m++){const T=u[m];if(Yc(T)){if(T.type!==Jo||T.children==="v-if"){if(E)return;E=T}}else return}return E}const DD=u=>{let _;for(const E in u)(E==="class"||E==="style"||Cp(E))&&((_||(_={}))[E]=u[E]);return _},kD=(u,_)=>{const E={};for(const m in u)(!K0(m)||!(m.slice(9)in _))&&(E[m]=u[m]);return E};function OD(u,_,E){const{props:m,children:T,component:f}=u,{props:x,children:A,patchFlag:i}=_,P=f.emitsOptions;if(_.dirs||_.transition)return!0;if(E&&i>=0){if(i&1024)return!0;if(i&16)return m?tT(m,x,P):!!x;if(i&8){const O=_.dynamicProps;for(let L=0;L<O.length;L++){const U=O[L];if(x[U]!==m[U]&&!K_(P,U))return!0}}}else return(T||A)&&(!A||!A.$stable)?!0:m===x?!1:m?x?tT(m,x,P):!0:!!x;return!1}function tT(u,_,E){const m=Object.keys(_);if(m.length!==Object.keys(u).length)return!0;for(let T=0;T<m.length;T++){const f=m[T];if(_[f]!==u[f]&&!K_(E,f))return!0}return!1}function pv({vnode:u,parent:_},E){for(;_;){const m=_.subTree;if(m.suspense&&m.suspense.activeBranch===u&&(m.el=u.el),m===u)(u=_.vnode).el=E,_=_.parent;else break}}const mv="components",RD="directives";function VE(u,_){return _v(mv,u,!0,_)||u}const UE=Symbol.for("v-ndc");function LD(u){return Zi(u)?_v(mv,u,!1)||u:u||UE}function zD(u){return _v(RD,u)}function _v(u,_,E=!0,m=!1){const T=vo||wo;if(T){const f=T.type;if(u===mv){const A=L0(f,!1);if(A&&(A===_||A===ls(_)||A===Pp(ls(_))))return f}const x=nT(T[u]||f[u],_)||nT(T.appContext[u],_);return!x&&m?f:x}}function nT(u,_){return u&&(u[_]||u[ls(_)]||u[Pp(ls(_))])}const $E=u=>u.__isSuspense;let T0=0;const FD={name:"Suspense",__isSuspense:!0,process(u,_,E,m,T,f,x,A,i,P){if(u==null)ND(_,E,m,T,f,x,A,i,P);else{if(f&&f.deps>0&&!u.suspense.isInFallback){_.suspense=u.suspense,_.suspense.vnode=_,_.el=u.el;return}jD(u,_,E,m,T,x,A,i,P)}},hydrate:VD,create:gv,normalize:UD},BD=FD;function Tp(u,_){const E=u.props&&u.props[_];Mr(E)&&E()}function ND(u,_,E,m,T,f,x,A,i){const{p:P,o:{createElement:O}}=i,L=O("div"),U=u.suspense=gv(u,T,m,_,L,E,f,x,A,i);P(null,U.pendingBranch=u.ssContent,L,null,m,U,f,x),U.deps>0?(Tp(u,"onPending"),Tp(u,"onFallback"),P(null,u.ssFallback,_,E,m,null,f,x),_d(U,u.ssFallback)):U.resolve(!1,!0)}function jD(u,_,E,m,T,f,x,A,{p:i,um:P,o:{createElement:O}}){const L=_.suspense=u.suspense;L.vnode=_,_.el=u.el;const U=_.ssContent,j=_.ssFallback,{activeBranch:W,pendingBranch:J,isInFallback:fe,isHydrating:_e}=L;if(J)L.pendingBranch=U,Ra(U,J)?(i(J,U,L.hiddenContainer,null,T,L,f,x,A),L.deps<=0?L.resolve():fe&&(_e||(i(W,j,E,m,T,null,f,x,A),_d(L,j)))):(L.pendingId=T0++,_e?(L.isHydrating=!1,L.activeBranch=J):P(J,T,L),L.deps=0,L.effects.length=0,L.hiddenContainer=O("div"),fe?(i(null,U,L.hiddenContainer,null,T,L,f,x,A),L.deps<=0?L.resolve():(i(W,j,E,m,T,null,f,x,A),_d(L,j))):W&&Ra(U,W)?(i(W,U,E,m,T,L,f,x,A),L.resolve(!0)):(i(null,U,L.hiddenContainer,null,T,L,f,x,A),L.deps<=0&&L.resolve()));else if(W&&Ra(U,W))i(W,U,E,m,T,L,f,x,A),_d(L,U);else if(Tp(_,"onPending"),L.pendingBranch=U,U.shapeFlag&512?L.pendingId=U.component.suspenseId:L.pendingId=T0++,i(null,U,L.hiddenContainer,null,T,L,f,x,A),L.deps<=0)L.resolve();else{const{timeout:we,pendingId:ye}=L;we>0?setTimeout(()=>{L.pendingId===ye&&L.fallback(j)},we):we===0&&L.fallback(j)}}function gv(u,_,E,m,T,f,x,A,i,P,O=!1){const{p:L,m:U,um:j,n:W,o:{parentNode:J,remove:fe}}=P;let _e;const we=$D(u);we&&_!=null&&_.pendingBranch&&(_e=_.pendingId,_.deps++);const ye=u.props?O_(u.props.timeout):void 0,Pe=f,Fe={vnode:u,parent:_,parentComponent:E,namespace:x,container:m,hiddenContainer:T,deps:0,pendingId:T0++,timeout:typeof ye=="number"?ye:-1,activeBranch:null,pendingBranch:null,isInFallback:!O,isHydrating:O,isUnmounted:!1,effects:[],resolve(Be=!1,He=!1){const{vnode:Ce,activeBranch:ve,pendingBranch:Te,pendingId:Ye,effects:Oe,parentComponent:lt,container:Ht}=Fe;let nt=!1;Fe.isHydrating?Fe.isHydrating=!1:Be||(nt=ve&&Te.transition&&Te.transition.mode==="out-in",nt&&(ve.transition.afterLeave=()=>{Ye===Fe.pendingId&&(U(Te,Ht,f===Pe?W(ve):f,0),L_(Oe))}),ve&&(J(ve.el)!==Fe.hiddenContainer&&(f=W(ve)),j(ve,lt,Fe,!0)),nt||U(Te,Ht,f,0)),_d(Fe,Te),Fe.pendingBranch=null,Fe.isInFallback=!1;let Tt=Fe.parent,Rt=!1;for(;Tt;){if(Tt.pendingBranch){Tt.effects.push(...Oe),Rt=!0;break}Tt=Tt.parent}!Rt&&!nt&&L_(Oe),Fe.effects=[],we&&_&&_.pendingBranch&&_e===_.pendingId&&(_.deps--,_.deps===0&&!He&&_.resolve()),Tp(Ce,"onResolve")},fallback(Be){if(!Fe.pendingBranch)return;const{vnode:He,activeBranch:Ce,parentComponent:ve,container:Te,namespace:Ye}=Fe;Tp(He,"onFallback");const Oe=W(Ce),lt=()=>{Fe.isInFallback&&(L(null,Be,Te,Oe,ve,null,Ye,A,i),_d(Fe,Be))},Ht=Be.transition&&Be.transition.mode==="out-in";Ht&&(Ce.transition.afterLeave=lt),Fe.isInFallback=!0,j(Ce,ve,null,!0),Ht||lt()},move(Be,He,Ce){Fe.activeBranch&&U(Fe.activeBranch,Be,He,Ce),Fe.container=Be},next(){return Fe.activeBranch&&W(Fe.activeBranch)},registerDep(Be,He){const Ce=!!Fe.pendingBranch;Ce&&Fe.deps++;const ve=Be.vnode.el;Be.asyncDep.catch(Te=>{yh(Te,Be,0)}).then(Te=>{if(Be.isUnmounted||Fe.isUnmounted||Fe.pendingId!==Be.suspenseId)return;Be.asyncResolved=!0;const{vnode:Ye}=Be;O0(Be,Te,!1),ve&&(Ye.el=ve);const Oe=!ve&&Be.subTree.el;He(Be,Ye,J(ve||Be.subTree.el),ve?null:W(Be.subTree),Fe,x,i),Oe&&fe(Oe),pv(Be,Ye.el),Ce&&--Fe.deps===0&&Fe.resolve()})},unmount(Be,He){Fe.isUnmounted=!0,Fe.activeBranch&&j(Fe.activeBranch,E,Be,He),Fe.pendingBranch&&j(Fe.pendingBranch,E,Be,He)}};return Fe}function VD(u,_,E,m,T,f,x,A,i){const P=_.suspense=gv(_,m,E,u.parentNode,document.createElement("div"),null,T,f,x,A,!0),O=i(u,P.pendingBranch=_.ssContent,E,P,f,x);return P.deps===0&&P.resolve(!1,!0),O}function UD(u){const{shapeFlag:_,children:E}=u,m=_&32;u.ssContent=rT(m?E.default:E),u.ssFallback=m?rT(E.fallback):cr(Jo)}function rT(u){let _;if(Mr(u)){const E=dh&&u._c;E&&(u._d=!1,gr()),u=u(),E&&(u._d=!0,_=vs,MS())}return Bn(u)&&(u=PD(u)),u=$s(u),_&&!u.dynamicChildren&&(u.dynamicChildren=_.filter(E=>E!==u)),u}function GE(u,_){_&&_.pendingBranch?Bn(u)?_.effects.push(...u):_.effects.push(u):L_(u)}function _d(u,_){u.activeBranch=_;const{vnode:E,parentComponent:m}=u;let T=_.el;for(;!T&&_.component;)_=_.component.subTree,T=_.el;E.el=T,m&&m.subTree===E&&(m.vnode.el=T,pv(m,T))}function $D(u){var _;return((_=u.props)==null?void 0:_.suspensible)!=null&&u.props.suspensible!==!1}const HE=Symbol.for("v-scx"),qE=()=>sa(HE);function GD(u,_){return Op(u,null,_)}function WE(u,_){return Op(u,null,{flush:"post"})}function ZE(u,_){return Op(u,null,{flush:"sync"})}const v_={};function qc(u,_,E){return Op(u,_,E)}function Op(u,_,{immediate:E,deep:m,flush:T,once:f,onTrack:x,onTrigger:A}=Si){if(_&&f){const Be=_;_=(...He)=>{Be(...He),Fe()}}const i=wo,P=Be=>m===!0?Be:nh(Be,m===!1?1:void 0);let O,L=!1,U=!1;if(ro(u)?(O=()=>u.value,L=gp(u)):Hl(u)?(O=()=>P(u),L=!0):Bn(u)?(U=!0,L=u.some(Be=>Hl(Be)||gp(Be)),O=()=>u.map(Be=>{if(ro(Be))return Be.value;if(Hl(Be))return P(Be);if(Mr(Be))return ql(Be,i,2)})):Mr(u)?_?O=()=>ql(u,i,2):O=()=>(j&&j(),Hs(u,i,3,[W])):O=gs,_&&m){const Be=O;O=()=>nh(Be())}let j,W=Be=>{j=ye.onStop=()=>{ql(Be,i,4),j=ye.onStop=void 0}},J;if(Lp)if(W=gs,_?E&&Hs(_,i,3,[O(),U?[]:void 0,W]):O(),T==="sync"){const Be=qE();J=Be.__watcherHandles||(Be.__watcherHandles=[])}else return gs;let fe=U?new Array(u.length).fill(v_):v_;const _e=()=>{if(!(!ye.active||!ye.dirty))if(_){const Be=ye.run();(m||L||(U?Be.some((He,Ce)=>La(He,fe[Ce])):La(Be,fe)))&&(j&&j(),Hs(_,i,3,[Be,fe===v_?void 0:U&&fe[0]===v_?[]:fe,W]),fe=Be)}else ye.run()};_e.allowRecurse=!!_;let we;T==="sync"?we=_e:T==="post"?we=()=>No(_e,i&&i.suspense):(_e.pre=!0,i&&(_e.id=i.uid),we=()=>X_(_e));const ye=new vd(O,gs,we),Pe=rv(),Fe=()=>{ye.stop(),Pe&&J0(Pe.effects,ye)};return _?E?_e():fe=ye.run():T==="post"?No(ye.run.bind(ye),i&&i.suspense):ye.run(),J&&J.push(Fe),Fe}function HD(u,_,E){const m=this.proxy,T=Zi(u)?u.includes(".")?YE(m,u):()=>m[u]:u.bind(m,m);let f;Mr(_)?f=_:(f=_.handler,E=_);const x=fh(this),A=Op(T,f.bind(m),E);return x(),A}function YE(u,_){const E=_.split(".");return()=>{let m=u;for(let T=0;T<E.length&&m;T++)m=m[E[T]];return m}}function nh(u,_,E=0,m){if(!Pi(u)||u.__v_skip)return u;if(_&&_>0){if(E>=_)return u;E++}if(m=m||new Set,m.has(u))return u;if(m.add(u),ro(u))nh(u.value,_,E,m);else if(Bn(u))for(let T=0;T<u.length;T++)nh(u[T],_,E,m);else if(mh(u)||hd(u))u.forEach(T=>{nh(T,_,E,m)});else if(hE(u))for(const T in u)nh(u[T],_,E,m);return u}function lh(u,_){if(vo===null)return u;const E=ag(vo)||vo.proxy,m=u.dirs||(u.dirs=[]);for(let T=0;T<_.length;T++){let[f,x,A,i=Si]=_[T];f&&(Mr(f)&&(f={mounted:f,updated:f}),f.deep&&nh(x),m.push({dir:f,instance:E,value:x,oldValue:void 0,arg:A,modifiers:i}))}return u}function ul(u,_,E,m){const T=u.dirs,f=_&&_.dirs;for(let x=0;x<T.length;x++){const A=T[x];f&&(A.oldValue=f[x].value);let i=A.dir[m];i&&(_h(),Hs(i,E,8,[u.el,A,u,_]),gh())}}const jc=Symbol("_leaveCb"),x_=Symbol("_enterCb");function yv(){const u={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Kl(()=>{u.isMounted=!0}),ng(()=>{u.isUnmounting=!0}),u}const oa=[Function,Array],vv={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:oa,onEnter:oa,onAfterEnter:oa,onEnterCancelled:oa,onBeforeLeave:oa,onLeave:oa,onAfterLeave:oa,onLeaveCancelled:oa,onBeforeAppear:oa,onAppear:oa,onAfterAppear:oa,onAppearCancelled:oa},qD={name:"BaseTransition",props:vv,setup(u,{slots:_}){const E=Jl(),m=yv();return()=>{const T=_.default&&Q_(_.default(),!0);if(!T||!T.length)return;let f=T[0];if(T.length>1){for(const U of T)if(U.type!==Jo){f=U;break}}const x=Xr(u),{mode:A}=x;if(m.isLeaving)return r0(f);const i=iT(f);if(!i)return r0(f);const P=xd(i,x,m,E);ch(i,P);const O=E.subTree,L=O&&iT(O);if(L&&L.type!==Jo&&!Ra(i,L)){const U=xd(L,x,m,E);if(ch(L,U),A==="out-in")return m.isLeaving=!0,U.afterLeave=()=>{m.isLeaving=!1,E.update.active!==!1&&(E.effect.dirty=!0,E.update())},r0(f);A==="in-out"&&i.type!==Jo&&(U.delayLeave=(j,W,J)=>{const fe=KE(m,L);fe[String(L.key)]=L,j[jc]=()=>{W(),j[jc]=void 0,delete P.delayedLeave},P.delayedLeave=J})}return f}}},XE=qD;function KE(u,_){const{leavingVNodes:E}=u;let m=E.get(_.type);return m||(m=Object.create(null),E.set(_.type,m)),m}function xd(u,_,E,m){const{appear:T,mode:f,persisted:x=!1,onBeforeEnter:A,onEnter:i,onAfterEnter:P,onEnterCancelled:O,onBeforeLeave:L,onLeave:U,onAfterLeave:j,onLeaveCancelled:W,onBeforeAppear:J,onAppear:fe,onAfterAppear:_e,onAppearCancelled:we}=_,ye=String(u.key),Pe=KE(E,u),Fe=(Ce,ve)=>{Ce&&Hs(Ce,m,9,ve)},Be=(Ce,ve)=>{const Te=ve[1];Fe(Ce,ve),Bn(Ce)?Ce.every(Ye=>Ye.length<=1)&&Te():Ce.length<=1&&Te()},He={mode:f,persisted:x,beforeEnter(Ce){let ve=A;if(!E.isMounted)if(T)ve=J||A;else return;Ce[jc]&&Ce[jc](!0);const Te=Pe[ye];Te&&Ra(u,Te)&&Te.el[jc]&&Te.el[jc](),Fe(ve,[Ce])},enter(Ce){let ve=i,Te=P,Ye=O;if(!E.isMounted)if(T)ve=fe||i,Te=_e||P,Ye=we||O;else return;let Oe=!1;const lt=Ce[x_]=Ht=>{Oe||(Oe=!0,Ht?Fe(Ye,[Ce]):Fe(Te,[Ce]),He.delayedLeave&&He.delayedLeave(),Ce[x_]=void 0)};ve?Be(ve,[Ce,lt]):lt()},leave(Ce,ve){const Te=String(u.key);if(Ce[x_]&&Ce[x_](!0),E.isUnmounting)return ve();Fe(L,[Ce]);let Ye=!1;const Oe=Ce[jc]=lt=>{Ye||(Ye=!0,ve(),lt?Fe(W,[Ce]):Fe(j,[Ce]),Ce[jc]=void 0,Pe[Te]===u&&delete Pe[Te])};Pe[Te]=u,U?Be(U,[Ce,Oe]):Oe()},clone(Ce){return xd(Ce,_,E,m)}};return He}function r0(u){if(Rp(u))return u=fl(u),u.children=null,u}function iT(u){return Rp(u)?u.children?u.children[0]:void 0:u}function ch(u,_){u.shapeFlag&6&&u.component?ch(u.component.subTree,_):u.shapeFlag&128?(u.ssContent.transition=_.clone(u.ssContent),u.ssFallback.transition=_.clone(u.ssFallback)):u.transition=_}function Q_(u,_=!1,E){let m=[],T=0;for(let f=0;f<u.length;f++){let x=u[f];const A=E==null?x.key:String(E)+String(x.key!=null?x.key:f);x.type===zi?(x.patchFlag&128&&T++,m=m.concat(Q_(x.children,_,A))):(_||x.type!==Jo)&&m.push(A!=null?fl(x,{key:A}):x)}if(T>1)for(let f=0;f<m.length;f++)m[f].patchFlag=-2;return m}/*! #__NO_SIDE_EFFECTS__ */function Id(u,_){return Mr(u)?Wi({name:u.name},_,{setup:u}):u}const oh=u=>!!u.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function WD(u){Mr(u)&&(u={loader:u});const{loader:_,loadingComponent:E,errorComponent:m,delay:T=200,timeout:f,suspensible:x=!0,onError:A}=u;let i=null,P,O=0;const L=()=>(O++,i=null,U()),U=()=>{let j;return i||(j=i=_().catch(W=>{if(W=W instanceof Error?W:new Error(String(W)),A)return new Promise((J,fe)=>{A(W,()=>J(L()),()=>fe(W),O+1)});throw W}).then(W=>j!==i&&i?i:(W&&(W.__esModule||W[Symbol.toStringTag]==="Module")&&(W=W.default),P=W,W)))};return Id({name:"AsyncComponentWrapper",__asyncLoader:U,get __asyncResolved(){return P},setup(){const j=wo;if(P)return()=>i0(P,j);const W=we=>{i=null,yh(we,j,13,!m)};if(x&&j.suspense||Lp)return U().then(we=>()=>i0(we,j)).catch(we=>(W(we),()=>m?cr(m,{error:we}):null));const J=Yr(!1),fe=Yr(),_e=Yr(!!T);return T&&setTimeout(()=>{_e.value=!1},T),f!=null&&setTimeout(()=>{if(!J.value&&!fe.value){const we=new Error(`Async component timed out after ${f}ms.`);W(we),fe.value=we}},f),U().then(()=>{J.value=!0,j.parent&&Rp(j.parent.vnode)&&(j.parent.effect.dirty=!0,X_(j.parent.update))}).catch(we=>{W(we),fe.value=we}),()=>{if(J.value&&P)return i0(P,j);if(fe.value&&m)return cr(m,{error:fe.value});if(E&&!_e.value)return cr(E)}}})}function i0(u,_){const{ref:E,props:m,children:T,ce:f}=_.vnode,x=cr(u,m,T);return x.ref=E,x.ce=f,delete _.vnode.ce,x}const Rp=u=>u.type.__isKeepAlive,ZD={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(u,{slots:_}){const E=Jl(),m=E.ctx;if(!m.renderer)return()=>{const we=_.default&&_.default();return we&&we.length===1?we[0]:we};const T=new Map,f=new Set;let x=null;const A=E.suspense,{renderer:{p:i,m:P,um:O,o:{createElement:L}}}=m,U=L("div");m.activate=(we,ye,Pe,Fe,Be)=>{const He=we.component;P(we,ye,Pe,0,A),i(He.vnode,we,ye,Pe,He,A,Fe,we.slotScopeIds,Be),No(()=>{He.isDeactivated=!1,He.a&&fd(He.a);const Ce=we.props&&we.props.onVnodeMounted;Ce&&_s(Ce,He.parent,we)},A)},m.deactivate=we=>{const ye=we.component;P(we,U,null,1,A),No(()=>{ye.da&&fd(ye.da);const Pe=we.props&&we.props.onVnodeUnmounted;Pe&&_s(Pe,ye.parent,we),ye.isDeactivated=!0},A)};function j(we){o0(we),O(we,E,A,!0)}function W(we){T.forEach((ye,Pe)=>{const Fe=L0(ye.type);Fe&&(!we||!we(Fe))&&J(Pe)})}function J(we){const ye=T.get(we);!x||!Ra(ye,x)?j(ye):x&&o0(x),T.delete(we),f.delete(we)}qc(()=>[u.include,u.exclude],([we,ye])=>{we&&W(Pe=>op(we,Pe)),ye&&W(Pe=>!op(ye,Pe))},{flush:"post",deep:!0});let fe=null;const _e=()=>{fe!=null&&T.set(fe,s0(E.subTree))};return Kl(_e),tg(_e),ng(()=>{T.forEach(we=>{const{subTree:ye,suspense:Pe}=E,Fe=s0(ye);if(we.type===Fe.type&&we.key===Fe.key){o0(Fe);const Be=Fe.component.da;Be&&No(Be,Pe);return}j(we)})}),()=>{if(fe=null,!_.default)return null;const we=_.default(),ye=we[0];if(we.length>1)return x=null,we;if(!Yc(ye)||!(ye.shapeFlag&4)&&!(ye.shapeFlag&128))return x=null,ye;let Pe=s0(ye);const Fe=Pe.type,Be=L0(oh(Pe)?Pe.type.__asyncResolved||{}:Fe),{include:He,exclude:Ce,max:ve}=u;if(He&&(!Be||!op(He,Be))||Ce&&Be&&op(Ce,Be))return x=Pe,ye;const Te=Pe.key==null?Fe:Pe.key,Ye=T.get(Te);return Pe.el&&(Pe=fl(Pe),ye.shapeFlag&128&&(ye.ssContent=Pe)),fe=Te,Ye?(Pe.el=Ye.el,Pe.component=Ye.component,Pe.transition&&ch(Pe,Pe.transition),Pe.shapeFlag|=512,f.delete(Te),f.add(Te)):(f.add(Te),ve&&f.size>parseInt(ve,10)&&J(f.values().next().value)),Pe.shapeFlag|=256,x=Pe,$E(ye.type)?ye:Pe}}},YD=ZD;function op(u,_){return Bn(u)?u.some(E=>op(E,_)):Zi(u)?u.split(",").includes(_):AP(u)?u.test(_):!1}function JE(u,_){eS(u,"a",_)}function QE(u,_){eS(u,"da",_)}function eS(u,_,E=wo){const m=u.__wdc||(u.__wdc=()=>{let T=E;for(;T;){if(T.isDeactivated)return;T=T.parent}return u()});if(eg(_,m,E),E){let T=E.parent;for(;T&&T.parent;)Rp(T.parent.vnode)&&XD(m,_,E,T),T=T.parent}}function XD(u,_,E,m){const T=eg(_,u,m,!0);rg(()=>{J0(m[_],T)},E)}function o0(u){u.shapeFlag&=-257,u.shapeFlag&=-513}function s0(u){return u.shapeFlag&128?u.ssContent:u}function eg(u,_,E=wo,m=!1){if(E){const T=E[u]||(E[u]=[]),f=_.__weh||(_.__weh=(...x)=>{if(E.isUnmounted)return;_h();const A=fh(E),i=Hs(_,E,u,x);return A(),gh(),i});return m?T.unshift(f):T.push(f),f}}const Xl=u=>(_,E=wo)=>(!Lp||u==="sp")&&eg(u,(...m)=>_(...m),E),tS=Xl("bm"),Kl=Xl("m"),nS=Xl("bu"),tg=Xl("u"),ng=Xl("bum"),rg=Xl("um"),rS=Xl("sp"),iS=Xl("rtg"),oS=Xl("rtc");function sS(u,_=wo){eg("ec",u,_)}function uh(u,_,E,m){let T;const f=E&&E[m];if(Bn(u)||Zi(u)){T=new Array(u.length);for(let x=0,A=u.length;x<A;x++)T[x]=_(u[x],x,void 0,f&&f[x])}else if(typeof u=="number"){T=new Array(u);for(let x=0;x<u;x++)T[x]=_(x+1,x,void 0,f&&f[x])}else if(Pi(u))if(u[Symbol.iterator])T=Array.from(u,(x,A)=>_(x,A,void 0,f&&f[A]));else{const x=Object.keys(u);T=new Array(x.length);for(let A=0,i=x.length;A<i;A++){const P=x[A];T[A]=_(u[P],P,A,f&&f[A])}}else T=[];return E&&(E[m]=T),T}function KD(u,_){for(let E=0;E<_.length;E++){const m=_[E];if(Bn(m))for(let T=0;T<m.length;T++)u[m[T].name]=m[T].fn;else m&&(u[m.name]=m.key?(...T)=>{const f=m.fn(...T);return f&&(f.key=m.key),f}:m.fn)}return u}function aS(u,_,E={},m,T){if(vo.isCE||vo.parent&&oh(vo.parent)&&vo.parent.isCE)return _!=="default"&&(E.name=_),cr("slot",E,m&&m());let f=u[_];f&&f._c&&(f._d=!1),gr();const x=f&&lS(f(E)),A=Tv(zi,{key:E.key||x&&x.key||`_${_}`},x||(m?m():[]),x&&u._===1?64:-2);return!T&&A.scopeId&&(A.slotScopeIds=[A.scopeId+"-s"]),f&&f._c&&(f._d=!0),A}function lS(u){return u.some(_=>Yc(_)?!(_.type===Jo||_.type===zi&&!lS(_.children)):!0)?u:null}function cS(u,_){const E={};for(const m in u)E[_&&/[A-Z]/.test(m)?`on:${m}`:ap(m)]=u[m];return E}const E0=u=>u?kS(u)?ag(u)||u.proxy:E0(u.parent):null,lp=Wi(Object.create(null),{$:u=>u,$el:u=>u.vnode.el,$data:u=>u.data,$props:u=>u.props,$attrs:u=>u.attrs,$slots:u=>u.slots,$refs:u=>u.refs,$parent:u=>E0(u.parent),$root:u=>E0(u.root),$emit:u=>u.emit,$options:u=>xv(u),$forceUpdate:u=>u.f||(u.f=()=>{u.effect.dirty=!0,X_(u.update)}),$nextTick:u=>u.n||(u.n=Ad.bind(u.proxy)),$watch:u=>HD.bind(u)}),a0=(u,_)=>u!==Si&&!u.__isScriptSetup&&ii(u,_),S0={get({_:u},_){const{ctx:E,setupState:m,data:T,props:f,accessCache:x,type:A,appContext:i}=u;let P;if(_[0]!=="$"){const j=x[_];if(j!==void 0)switch(j){case 1:return m[_];case 2:return T[_];case 4:return E[_];case 3:return f[_]}else{if(a0(m,_))return x[_]=1,m[_];if(T!==Si&&ii(T,_))return x[_]=2,T[_];if((P=u.propsOptions[0])&&ii(P,_))return x[_]=3,f[_];if(E!==Si&&ii(E,_))return x[_]=4,E[_];M0&&(x[_]=0)}}const O=lp[_];let L,U;if(O)return _==="$attrs"&&xs(u,"get",_),O(u);if((L=A.__cssModules)&&(L=L[_]))return L;if(E!==Si&&ii(E,_))return x[_]=4,E[_];if(U=i.config.globalProperties,ii(U,_))return U[_]},set({_:u},_,E){const{data:m,setupState:T,ctx:f}=u;return a0(T,_)?(T[_]=E,!0):m!==Si&&ii(m,_)?(m[_]=E,!0):ii(u.props,_)||_[0]==="$"&&_.slice(1)in u?!1:(f[_]=E,!0)},has({_:{data:u,setupState:_,accessCache:E,ctx:m,appContext:T,propsOptions:f}},x){let A;return!!E[x]||u!==Si&&ii(u,x)||a0(_,x)||(A=f[0])&&ii(A,x)||ii(m,x)||ii(lp,x)||ii(T.config.globalProperties,x)},defineProperty(u,_,E){return E.get!=null?u._.accessCache[_]=0:ii(E,"value")&&this.set(u,_,E.value,null),Reflect.defineProperty(u,_,E)}},JD=Wi({},S0,{get(u,_){if(_!==Symbol.unscopables)return S0.get(u,_,u)},has(u,_){return _[0]!=="_"&&!kP(_)}});function QD(){return null}function e3(){return null}function t3(u){}function n3(u){}function r3(){return null}function i3(){}function o3(u,_){return null}function uS(){return hS().slots}function s3(){return hS().attrs}function hS(){const u=Jl();return u.setupContext||(u.setupContext=LS(u))}function Ep(u){return Bn(u)?u.reduce((_,E)=>(_[E]=null,_),{}):u}function a3(u,_){const E=Ep(u);for(const m in _){if(m.startsWith("__skip"))continue;let T=E[m];T?Bn(T)||Mr(T)?T=E[m]={type:T,default:_[m]}:T.default=_[m]:T===null&&(T=E[m]={default:_[m]}),T&&_[`__skip_${m}`]&&(T.skipFactory=!0)}return E}function l3(u,_){return!u||!_?u||_:Bn(u)&&Bn(_)?u.concat(_):Wi({},Ep(u),Ep(_))}function c3(u,_){const E={};for(const m in u)_.includes(m)||Object.defineProperty(E,m,{enumerable:!0,get:()=>u[m]});return E}function u3(u){const _=Jl();let E=u();return k0(),Q0(E)&&(E=E.catch(m=>{throw fh(_),m})),[E,()=>fh(_)]}let M0=!0;function h3(u){const _=xv(u),E=u.proxy,m=u.ctx;M0=!1,_.beforeCreate&&oT(_.beforeCreate,u,"bc");const{data:T,computed:f,methods:x,watch:A,provide:i,inject:P,created:O,beforeMount:L,mounted:U,beforeUpdate:j,updated:W,activated:J,deactivated:fe,beforeDestroy:_e,beforeUnmount:we,destroyed:ye,unmounted:Pe,render:Fe,renderTracked:Be,renderTriggered:He,errorCaptured:Ce,serverPrefetch:ve,expose:Te,inheritAttrs:Ye,components:Oe,directives:lt,filters:Ht}=_;if(P&&d3(P,m,null),x)for(const Rt in x){const vt=x[Rt];Mr(vt)&&(m[Rt]=vt.bind(E))}if(T){const Rt=T.call(E,E);Pi(Rt)&&(u.data=za(Rt))}if(M0=!0,f)for(const Rt in f){const vt=f[Rt],wr=Mr(vt)?vt.bind(E,E):Mr(vt.get)?vt.get.bind(E,E):gs,Kr=!Mr(vt)&&Mr(vt.set)?vt.set.bind(E):gs,Gr=Mi({get:wr,set:Kr});Object.defineProperty(m,Rt,{enumerable:!0,configurable:!0,get:()=>Gr.value,set:Or=>Gr.value=Or})}if(A)for(const Rt in A)dS(A[Rt],m,E,Rt);if(i){const Rt=Mr(i)?i.call(E):i;Reflect.ownKeys(Rt).forEach(vt=>{cp(vt,Rt[vt])})}O&&oT(O,u,"c");function Tt(Rt,vt){Bn(vt)?vt.forEach(wr=>Rt(wr.bind(E))):vt&&Rt(vt.bind(E))}if(Tt(tS,L),Tt(Kl,U),Tt(nS,j),Tt(tg,W),Tt(JE,J),Tt(QE,fe),Tt(sS,Ce),Tt(oS,Be),Tt(iS,He),Tt(ng,we),Tt(rg,Pe),Tt(rS,ve),Bn(Te))if(Te.length){const Rt=u.exposed||(u.exposed={});Te.forEach(vt=>{Object.defineProperty(Rt,vt,{get:()=>E[vt],set:wr=>E[vt]=wr})})}else u.exposed||(u.exposed={});Fe&&u.render===gs&&(u.render=Fe),Ye!=null&&(u.inheritAttrs=Ye),Oe&&(u.components=Oe),lt&&(u.directives=lt)}function d3(u,_,E=gs){Bn(u)&&(u=A0(u));for(const m in u){const T=u[m];let f;Pi(T)?"default"in T?f=sa(T.from||m,T.default,!0):f=sa(T.from||m):f=sa(T),ro(f)?Object.defineProperty(_,m,{enumerable:!0,configurable:!0,get:()=>f.value,set:x=>f.value=x}):_[m]=f}}function oT(u,_,E){Hs(Bn(u)?u.map(m=>m.bind(_.proxy)):u.bind(_.proxy),_,E)}function dS(u,_,E,m){const T=m.includes(".")?YE(E,m):()=>E[m];if(Zi(u)){const f=_[u];Mr(f)&&qc(T,f)}else if(Mr(u))qc(T,u.bind(E));else if(Pi(u))if(Bn(u))u.forEach(f=>dS(f,_,E,m));else{const f=Mr(u.handler)?u.handler.bind(E):_[u.handler];Mr(f)&&qc(T,f,u)}}function xv(u){const _=u.type,{mixins:E,extends:m}=_,{mixins:T,optionsCache:f,config:{optionMergeStrategies:x}}=u.appContext,A=f.get(_);let i;return A?i=A:!T.length&&!E&&!m?i=_:(i={},T.length&&T.forEach(P=>F_(i,P,x,!0)),F_(i,_,x)),Pi(_)&&f.set(_,i),i}function F_(u,_,E,m=!1){const{mixins:T,extends:f}=_;f&&F_(u,f,E,!0),T&&T.forEach(x=>F_(u,x,E,!0));for(const x in _)if(!(m&&x==="expose")){const A=f3[x]||E&&E[x];u[x]=A?A(u[x],_[x]):_[x]}return u}const f3={data:sT,props:aT,emits:aT,methods:sp,computed:sp,beforeCreate:ss,created:ss,beforeMount:ss,mounted:ss,beforeUpdate:ss,updated:ss,beforeDestroy:ss,beforeUnmount:ss,destroyed:ss,unmounted:ss,activated:ss,deactivated:ss,errorCaptured:ss,serverPrefetch:ss,components:sp,directives:sp,watch:m3,provide:sT,inject:p3};function sT(u,_){return _?u?function(){return Wi(Mr(u)?u.call(this,this):u,Mr(_)?_.call(this,this):_)}:_:u}function p3(u,_){return sp(A0(u),A0(_))}function A0(u){if(Bn(u)){const _={};for(let E=0;E<u.length;E++)_[u[E]]=u[E];return _}return u}function ss(u,_){return u?[...new Set([].concat(u,_))]:_}function sp(u,_){return u?Wi(Object.create(null),u,_):_}function aT(u,_){return u?Bn(u)&&Bn(_)?[...new Set([...u,..._])]:Wi(Object.create(null),Ep(u),Ep(_??{})):_}function m3(u,_){if(!u)return _;if(!_)return u;const E=Wi(Object.create(null),u);for(const m in _)E[m]=ss(u[m],_[m]);return E}function fS(){return{app:null,config:{isNativeTag:SP,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let _3=0;function g3(u,_){return function(m,T=null){Mr(m)||(m=Wi({},m)),T!=null&&!Pi(T)&&(T=null);const f=fS(),x=new WeakSet;let A=!1;const i=f.app={_uid:_3++,_component:m,_props:T,_container:null,_context:f,_instance:null,version:FS,get config(){return f.config},set config(P){},use(P,...O){return x.has(P)||(P&&Mr(P.install)?(x.add(P),P.install(i,...O)):Mr(P)&&(x.add(P),P(i,...O))),i},mixin(P){return f.mixins.includes(P)||f.mixins.push(P),i},component(P,O){return O?(f.components[P]=O,i):f.components[P]},directive(P,O){return O?(f.directives[P]=O,i):f.directives[P]},mount(P,O,L){if(!A){const U=cr(m,T);return U.appContext=f,L===!0?L="svg":L===!1&&(L=void 0),O&&_?_(U,P):u(U,P,L),A=!0,i._container=P,P.__vue_app__=i,ag(U.component)||U.component.proxy}},unmount(){A&&(u(null,i._container),delete i._container.__vue_app__)},provide(P,O){return f.provides[P]=O,i},runWithContext(P){const O=gd;gd=i;try{return P()}finally{gd=O}}};return i}}let gd=null;function cp(u,_){if(wo){let E=wo.provides;const m=wo.parent&&wo.parent.provides;m===E&&(E=wo.provides=Object.create(m)),E[u]=_}}function sa(u,_,E=!1){const m=wo||vo;if(m||gd){const T=m?m.parent==null?m.vnode.appContext&&m.vnode.appContext.provides:m.parent.provides:gd._context.provides;if(T&&u in T)return T[u];if(arguments.length>1)return E&&Mr(_)?_.call(m&&m.proxy):_}}function pS(){return!!(wo||vo||gd)}function y3(u,_,E,m=!1){const T={},f={};k_(f,ig,1),u.propsDefaults=Object.create(null),mS(u,_,T,f);for(const x in u.propsOptions[0])x in T||(T[x]=void 0);E?u.props=m?T:av(T):u.type.props?u.props=T:u.props=f,u.attrs=f}function v3(u,_,E,m){const{props:T,attrs:f,vnode:{patchFlag:x}}=u,A=Xr(T),[i]=u.propsOptions;let P=!1;if((m||x>0)&&!(x&16)){if(x&8){const O=u.vnode.dynamicProps;for(let L=0;L<O.length;L++){let U=O[L];if(K_(u.emitsOptions,U))continue;const j=_[U];if(i)if(ii(f,U))j!==f[U]&&(f[U]=j,P=!0);else{const W=ls(U);T[W]=I0(i,A,W,j,u,!1)}else j!==f[U]&&(f[U]=j,P=!0)}}}else{mS(u,_,T,f)&&(P=!0);let O;for(const L in A)(!_||!ii(_,L)&&((O=Gs(L))===L||!ii(_,O)))&&(i?E&&(E[L]!==void 0||E[O]!==void 0)&&(T[L]=I0(i,A,L,void 0,u,!0)):delete T[L]);if(f!==A)for(const L in f)(!_||!ii(_,L))&&(delete f[L],P=!0)}P&&Gl(u,"set","$attrs")}function mS(u,_,E,m){const[T,f]=u.propsOptions;let x=!1,A;if(_)for(let i in _){if(dd(i))continue;const P=_[i];let O;T&&ii(T,O=ls(i))?!f||!f.includes(O)?E[O]=P:(A||(A={}))[O]=P:K_(u.emitsOptions,i)||(!(i in m)||P!==m[i])&&(m[i]=P,x=!0)}if(f){const i=Xr(E),P=A||Si;for(let O=0;O<f.length;O++){const L=f[O];E[L]=I0(T,i,L,P[L],u,!ii(P,L))}}return x}function I0(u,_,E,m,T,f){const x=u[E];if(x!=null){const A=ii(x,"default");if(A&&m===void 0){const i=x.default;if(x.type!==Function&&!x.skipFactory&&Mr(i)){const{propsDefaults:P}=T;if(E in P)m=P[E];else{const O=fh(T);m=P[E]=i.call(null,_),O()}}else m=i}x[0]&&(f&&!A?m=!1:x[1]&&(m===""||m===Gs(E))&&(m=!0))}return m}function _S(u,_,E=!1){const m=_.propsCache,T=m.get(u);if(T)return T;const f=u.props,x={},A=[];let i=!1;if(!Mr(u)){const O=L=>{i=!0;const[U,j]=_S(L,_,!0);Wi(x,U),j&&A.push(...j)};!E&&_.mixins.length&&_.mixins.forEach(O),u.extends&&O(u.extends),u.mixins&&u.mixins.forEach(O)}if(!f&&!i)return Pi(u)&&m.set(u,ud),ud;if(Bn(f))for(let O=0;O<f.length;O++){const L=ls(f[O]);lT(L)&&(x[L]=Si)}else if(f)for(const O in f){const L=ls(O);if(lT(L)){const U=f[O],j=x[L]=Bn(U)||Mr(U)?{type:U}:Wi({},U);if(j){const W=hT(Boolean,j.type),J=hT(String,j.type);j[0]=W>-1,j[1]=J<0||W<J,(W>-1||ii(j,"default"))&&A.push(L)}}}const P=[x,A];return Pi(u)&&m.set(u,P),P}function lT(u){return u[0]!=="$"&&!dd(u)}function cT(u){return u===null?"null":typeof u=="function"?u.name||"":typeof u=="object"&&u.constructor&&u.constructor.name||""}function uT(u,_){return cT(u)===cT(_)}function hT(u,_){return Bn(_)?_.findIndex(E=>uT(E,u)):Mr(_)&&uT(_,u)?0:-1}const gS=u=>u[0]==="_"||u==="$stable",bv=u=>Bn(u)?u.map($s):[$s(u)],x3=(u,_,E)=>{if(_._n)return _;const m=wp((...T)=>bv(_(...T)),E);return m._c=!1,m},yS=(u,_,E)=>{const m=u._ctx;for(const T in u){if(gS(T))continue;const f=u[T];if(Mr(f))_[T]=x3(T,f,m);else if(f!=null){const x=bv(f);_[T]=()=>x}}},vS=(u,_)=>{const E=bv(_);u.slots.default=()=>E},b3=(u,_)=>{if(u.vnode.shapeFlag&32){const E=_._;E?(u.slots=Xr(_),k_(_,"_",E)):yS(_,u.slots={})}else u.slots={},_&&vS(u,_);k_(u.slots,ig,1)},w3=(u,_,E)=>{const{vnode:m,slots:T}=u;let f=!0,x=Si;if(m.shapeFlag&32){const A=_._;A?E&&A===1?f=!1:(Wi(T,_),!E&&A===1&&delete T._):(f=!_.$stable,yS(_,T)),x=_}else _&&(vS(u,_),x={default:1});if(f)for(const A in T)!gS(A)&&x[A]==null&&delete T[A]};function B_(u,_,E,m,T=!1){if(Bn(u)){u.forEach((U,j)=>B_(U,_&&(Bn(_)?_[j]:_),E,m,T));return}if(oh(m)&&!T)return;const f=m.shapeFlag&4?ag(m.component)||m.component.proxy:m.el,x=T?null:f,{i:A,r:i}=u,P=_&&_.r,O=A.refs===Si?A.refs={}:A.refs,L=A.setupState;if(P!=null&&P!==i&&(Zi(P)?(O[P]=null,ii(L,P)&&(L[P]=null)):ro(P)&&(P.value=null)),Mr(i))ql(i,A,12,[x,O]);else{const U=Zi(i),j=ro(i);if(U||j){const W=()=>{if(u.f){const J=U?ii(L,i)?L[i]:O[i]:i.value;T?Bn(J)&&J0(J,f):Bn(J)?J.includes(f)||J.push(f):U?(O[i]=[f],ii(L,i)&&(L[i]=O[i])):(i.value=[f],u.k&&(O[u.k]=i.value))}else U?(O[i]=x,ii(L,i)&&(L[i]=x)):j&&(i.value=x,u.k&&(O[u.k]=x))};x?(W.id=-1,No(W,E)):W()}}}let Oc=!1;const T3=u=>u.namespaceURI.includes("svg")&&u.tagName!=="foreignObject",E3=u=>u.namespaceURI.includes("MathML"),b_=u=>{if(T3(u))return"svg";if(E3(u))return"mathml"},w_=u=>u.nodeType===8;function S3(u){const{mt:_,p:E,o:{patchProp:m,createText:T,nextSibling:f,parentNode:x,remove:A,insert:i,createComment:P}}=u,O=(ye,Pe)=>{if(!Pe.hasChildNodes()){E(null,ye,Pe),z_(),Pe._vnode=ye;return}Oc=!1,L(Pe.firstChild,ye,null,null,null),z_(),Pe._vnode=ye,Oc&&console.error("Hydration completed but contains mismatches.")},L=(ye,Pe,Fe,Be,He,Ce=!1)=>{const ve=w_(ye)&&ye.data==="[",Te=()=>J(ye,Pe,Fe,Be,He,ve),{type:Ye,ref:Oe,shapeFlag:lt,patchFlag:Ht}=Pe;let nt=ye.nodeType;Pe.el=ye,Ht===-2&&(Ce=!1,Pe.dynamicChildren=null);let Tt=null;switch(Ye){case hh:nt!==3?Pe.children===""?(i(Pe.el=T(""),x(ye),ye),Tt=ye):Tt=Te():(ye.data!==Pe.children&&(Oc=!0,ye.data=Pe.children),Tt=f(ye));break;case Jo:we(ye)?(Tt=f(ye),_e(Pe.el=ye.content.firstChild,ye,Fe)):nt!==8||ve?Tt=Te():Tt=f(ye);break;case sh:if(ve&&(ye=f(ye),nt=ye.nodeType),nt===1||nt===3){Tt=ye;const Rt=!Pe.children.length;for(let vt=0;vt<Pe.staticCount;vt++)Rt&&(Pe.children+=Tt.nodeType===1?Tt.outerHTML:Tt.data),vt===Pe.staticCount-1&&(Pe.anchor=Tt),Tt=f(Tt);return ve?f(Tt):Tt}else Te();break;case zi:ve?Tt=W(ye,Pe,Fe,Be,He,Ce):Tt=Te();break;default:if(lt&1)(nt!==1||Pe.type.toLowerCase()!==ye.tagName.toLowerCase())&&!we(ye)?Tt=Te():Tt=U(ye,Pe,Fe,Be,He,Ce);else if(lt&6){Pe.slotScopeIds=He;const Rt=x(ye);if(ve?Tt=fe(ye):w_(ye)&&ye.data==="teleport start"?Tt=fe(ye,ye.data,"teleport end"):Tt=f(ye),_(Pe,Rt,null,Fe,Be,b_(Rt),Ce),oh(Pe)){let vt;ve?(vt=cr(zi),vt.anchor=Tt?Tt.previousSibling:Rt.lastChild):vt=ye.nodeType===3?og(""):cr("div"),vt.el=ye,Pe.component.subTree=vt}}else lt&64?nt!==8?Tt=Te():Tt=Pe.type.hydrate(ye,Pe,Fe,Be,He,Ce,u,j):lt&128&&(Tt=Pe.type.hydrate(ye,Pe,Fe,Be,b_(x(ye)),He,Ce,u,L))}return Oe!=null&&B_(Oe,null,Be,Pe),Tt},U=(ye,Pe,Fe,Be,He,Ce)=>{Ce=Ce||!!Pe.dynamicChildren;const{type:ve,props:Te,patchFlag:Ye,shapeFlag:Oe,dirs:lt,transition:Ht}=Pe,nt=ve==="input"||ve==="option";if(nt||Ye!==-1){lt&&ul(Pe,null,Fe,"created");let Tt=!1;if(we(ye)){Tt=TS(Be,Ht)&&Fe&&Fe.vnode.props&&Fe.vnode.props.appear;const vt=ye.content.firstChild;Tt&&Ht.beforeEnter(vt),_e(vt,ye,Fe),Pe.el=ye=vt}if(Oe&16&&!(Te&&(Te.innerHTML||Te.textContent))){let vt=j(ye.firstChild,Pe,ye,Fe,Be,He,Ce);for(;vt;){Oc=!0;const wr=vt;vt=vt.nextSibling,A(wr)}}else Oe&8&&ye.textContent!==Pe.children&&(Oc=!0,ye.textContent=Pe.children);if(Te)if(nt||!Ce||Ye&48)for(const vt in Te)(nt&&(vt.endsWith("value")||vt==="indeterminate")||Cp(vt)&&!dd(vt)||vt[0]===".")&&m(ye,vt,null,Te[vt],void 0,void 0,Fe);else Te.onClick&&m(ye,"onClick",null,Te.onClick,void 0,void 0,Fe);let Rt;(Rt=Te&&Te.onVnodeBeforeMount)&&_s(Rt,Fe,Pe),lt&&ul(Pe,null,Fe,"beforeMount"),((Rt=Te&&Te.onVnodeMounted)||lt||Tt)&&GE(()=>{Rt&&_s(Rt,Fe,Pe),Tt&&Ht.enter(ye),lt&&ul(Pe,null,Fe,"mounted")},Be)}return ye.nextSibling},j=(ye,Pe,Fe,Be,He,Ce,ve)=>{ve=ve||!!Pe.dynamicChildren;const Te=Pe.children,Ye=Te.length;for(let Oe=0;Oe<Ye;Oe++){const lt=ve?Te[Oe]:Te[Oe]=$s(Te[Oe]);if(ye)ye=L(ye,lt,Be,He,Ce,ve);else{if(lt.type===hh&&!lt.children)continue;Oc=!0,E(null,lt,Fe,null,Be,He,b_(Fe),Ce)}}return ye},W=(ye,Pe,Fe,Be,He,Ce)=>{const{slotScopeIds:ve}=Pe;ve&&(He=He?He.concat(ve):ve);const Te=x(ye),Ye=j(f(ye),Pe,Te,Fe,Be,He,Ce);return Ye&&w_(Ye)&&Ye.data==="]"?f(Pe.anchor=Ye):(Oc=!0,i(Pe.anchor=P("]"),Te,Ye),Ye)},J=(ye,Pe,Fe,Be,He,Ce)=>{if(Oc=!0,Pe.el=null,Ce){const Ye=fe(ye);for(;;){const Oe=f(ye);if(Oe&&Oe!==Ye)A(Oe);else break}}const ve=f(ye),Te=x(ye);return A(ye),E(null,Pe,Te,ve,Fe,Be,b_(Te),He),ve},fe=(ye,Pe="[",Fe="]")=>{let Be=0;for(;ye;)if(ye=f(ye),ye&&w_(ye)&&(ye.data===Pe&&Be++,ye.data===Fe)){if(Be===0)return f(ye);Be--}return ye},_e=(ye,Pe,Fe)=>{const Be=Pe.parentNode;Be&&Be.replaceChild(ye,Pe);let He=Fe;for(;He;)He.vnode.el===Pe&&(He.vnode.el=He.subTree.el=ye),He=He.parent},we=ye=>ye.nodeType===1&&ye.tagName.toLowerCase()==="template";return[O,L]}const No=GE;function xS(u){return wS(u)}function bS(u){return wS(u,S3)}function wS(u,_){const E=dE();E.__VUE__=!0;const{insert:m,remove:T,patchProp:f,createElement:x,createText:A,createComment:i,setText:P,setElementText:O,parentNode:L,nextSibling:U,setScopeId:j=gs,insertStaticContent:W}=u,J=(De,Re,ft,Lt=null,Ot=null,Kt=null,dn=void 0,Vt=null,Gt=!!Re.dynamicChildren)=>{if(De===Re)return;De&&!Ra(De,Re)&&(Lt=It(De),Or(De,Ot,Kt,!0),De=null),Re.patchFlag===-2&&(Gt=!1,Re.dynamicChildren=null);const{type:Yt,ref:qt,shapeFlag:Mn}=Re;switch(Yt){case hh:fe(De,Re,ft,Lt);break;case Jo:_e(De,Re,ft,Lt);break;case sh:De==null&&we(Re,ft,Lt,dn);break;case zi:Oe(De,Re,ft,Lt,Ot,Kt,dn,Vt,Gt);break;default:Mn&1?Fe(De,Re,ft,Lt,Ot,Kt,dn,Vt,Gt):Mn&6?lt(De,Re,ft,Lt,Ot,Kt,dn,Vt,Gt):(Mn&64||Mn&128)&&Yt.process(De,Re,ft,Lt,Ot,Kt,dn,Vt,Gt,an)}qt!=null&&Ot&&B_(qt,De&&De.ref,Kt,Re||De,!Re)},fe=(De,Re,ft,Lt)=>{if(De==null)m(Re.el=A(Re.children),ft,Lt);else{const Ot=Re.el=De.el;Re.children!==De.children&&P(Ot,Re.children)}},_e=(De,Re,ft,Lt)=>{De==null?m(Re.el=i(Re.children||""),ft,Lt):Re.el=De.el},we=(De,Re,ft,Lt)=>{[De.el,De.anchor]=W(De.children,Re,ft,Lt,De.el,De.anchor)},ye=({el:De,anchor:Re},ft,Lt)=>{let Ot;for(;De&&De!==Re;)Ot=U(De),m(De,ft,Lt),De=Ot;m(Re,ft,Lt)},Pe=({el:De,anchor:Re})=>{let ft;for(;De&&De!==Re;)ft=U(De),T(De),De=ft;T(Re)},Fe=(De,Re,ft,Lt,Ot,Kt,dn,Vt,Gt)=>{Re.type==="svg"?dn="svg":Re.type==="math"&&(dn="mathml"),De==null?Be(Re,ft,Lt,Ot,Kt,dn,Vt,Gt):ve(De,Re,Ot,Kt,dn,Vt,Gt)},Be=(De,Re,ft,Lt,Ot,Kt,dn,Vt)=>{let Gt,Yt;const{props:qt,shapeFlag:Mn,transition:En,dirs:Qe}=De;if(Gt=De.el=x(De.type,Kt,qt&&qt.is,qt),Mn&8?O(Gt,De.children):Mn&16&&Ce(De.children,Gt,null,Lt,Ot,l0(De,Kt),dn,Vt),Qe&&ul(De,null,Lt,"created"),He(Gt,De,De.scopeId,dn,Lt),qt){for(const ue in qt)ue!=="value"&&!dd(ue)&&f(Gt,ue,null,qt[ue],Kt,De.children,Lt,Ot,zr);"value"in qt&&f(Gt,"value",null,qt.value,Kt),(Yt=qt.onVnodeBeforeMount)&&_s(Yt,Lt,De)}Qe&&ul(De,null,Lt,"beforeMount");const re=TS(Ot,En);re&&En.beforeEnter(Gt),m(Gt,Re,ft),((Yt=qt&&qt.onVnodeMounted)||re||Qe)&&No(()=>{Yt&&_s(Yt,Lt,De),re&&En.enter(Gt),Qe&&ul(De,null,Lt,"mounted")},Ot)},He=(De,Re,ft,Lt,Ot)=>{if(ft&&j(De,ft),Lt)for(let Kt=0;Kt<Lt.length;Kt++)j(De,Lt[Kt]);if(Ot){let Kt=Ot.subTree;if(Re===Kt){const dn=Ot.vnode;He(De,dn,dn.scopeId,dn.slotScopeIds,Ot.parent)}}},Ce=(De,Re,ft,Lt,Ot,Kt,dn,Vt,Gt=0)=>{for(let Yt=Gt;Yt<De.length;Yt++){const qt=De[Yt]=Vt?Vc(De[Yt]):$s(De[Yt]);J(null,qt,Re,ft,Lt,Ot,Kt,dn,Vt)}},ve=(De,Re,ft,Lt,Ot,Kt,dn)=>{const Vt=Re.el=De.el;let{patchFlag:Gt,dynamicChildren:Yt,dirs:qt}=Re;Gt|=De.patchFlag&16;const Mn=De.props||Si,En=Re.props||Si;let Qe;if(ft&&Qu(ft,!1),(Qe=En.onVnodeBeforeUpdate)&&_s(Qe,ft,Re,De),qt&&ul(Re,De,ft,"beforeUpdate"),ft&&Qu(ft,!0),Yt?Te(De.dynamicChildren,Yt,Vt,ft,Lt,l0(Re,Ot),Kt):dn||vt(De,Re,Vt,null,ft,Lt,l0(Re,Ot),Kt,!1),Gt>0){if(Gt&16)Ye(Vt,Re,Mn,En,ft,Lt,Ot);else if(Gt&2&&Mn.class!==En.class&&f(Vt,"class",null,En.class,Ot),Gt&4&&f(Vt,"style",Mn.style,En.style,Ot),Gt&8){const re=Re.dynamicProps;for(let ue=0;ue<re.length;ue++){const Ee=re[ue],it=Mn[Ee],pt=En[Ee];(pt!==it||Ee==="value")&&f(Vt,Ee,it,pt,Ot,De.children,ft,Lt,zr)}}Gt&1&&De.children!==Re.children&&O(Vt,Re.children)}else!dn&&Yt==null&&Ye(Vt,Re,Mn,En,ft,Lt,Ot);((Qe=En.onVnodeUpdated)||qt)&&No(()=>{Qe&&_s(Qe,ft,Re,De),qt&&ul(Re,De,ft,"updated")},Lt)},Te=(De,Re,ft,Lt,Ot,Kt,dn)=>{for(let Vt=0;Vt<Re.length;Vt++){const Gt=De[Vt],Yt=Re[Vt],qt=Gt.el&&(Gt.type===zi||!Ra(Gt,Yt)||Gt.shapeFlag&70)?L(Gt.el):ft;J(Gt,Yt,qt,null,Lt,Ot,Kt,dn,!0)}},Ye=(De,Re,ft,Lt,Ot,Kt,dn)=>{if(ft!==Lt){if(ft!==Si)for(const Vt in ft)!dd(Vt)&&!(Vt in Lt)&&f(De,Vt,ft[Vt],null,dn,Re.children,Ot,Kt,zr);for(const Vt in Lt){if(dd(Vt))continue;const Gt=Lt[Vt],Yt=ft[Vt];Gt!==Yt&&Vt!=="value"&&f(De,Vt,Yt,Gt,dn,Re.children,Ot,Kt,zr)}"value"in Lt&&f(De,"value",ft.value,Lt.value,dn)}},Oe=(De,Re,ft,Lt,Ot,Kt,dn,Vt,Gt)=>{const Yt=Re.el=De?De.el:A(""),qt=Re.anchor=De?De.anchor:A("");let{patchFlag:Mn,dynamicChildren:En,slotScopeIds:Qe}=Re;Qe&&(Vt=Vt?Vt.concat(Qe):Qe),De==null?(m(Yt,ft,Lt),m(qt,ft,Lt),Ce(Re.children||[],ft,qt,Ot,Kt,dn,Vt,Gt)):Mn>0&&Mn&64&&En&&De.dynamicChildren?(Te(De.dynamicChildren,En,ft,Ot,Kt,dn,Vt),(Re.key!=null||Ot&&Re===Ot.subTree)&&wv(De,Re,!0)):vt(De,Re,ft,qt,Ot,Kt,dn,Vt,Gt)},lt=(De,Re,ft,Lt,Ot,Kt,dn,Vt,Gt)=>{Re.slotScopeIds=Vt,De==null?Re.shapeFlag&512?Ot.ctx.activate(Re,ft,Lt,dn,Gt):Ht(Re,ft,Lt,Ot,Kt,dn,Gt):nt(De,Re,Gt)},Ht=(De,Re,ft,Lt,Ot,Kt,dn)=>{const Vt=De.component=DS(De,Lt,Ot);if(Rp(De)&&(Vt.ctx.renderer=an),OS(Vt),Vt.asyncDep){if(Ot&&Ot.registerDep(Vt,Tt),!De.el){const Gt=Vt.subTree=cr(Jo);_e(null,Gt,Re,ft)}}else Tt(Vt,De,Re,ft,Ot,Kt,dn)},nt=(De,Re,ft)=>{const Lt=Re.component=De.component;if(OD(De,Re,ft))if(Lt.asyncDep&&!Lt.asyncResolved){Rt(Lt,Re,ft);return}else Lt.next=Re,MD(Lt.update),Lt.effect.dirty=!0,Lt.update();else Re.el=De.el,Lt.vnode=Re},Tt=(De,Re,ft,Lt,Ot,Kt,dn)=>{const Vt=()=>{if(De.isMounted){let{next:qt,bu:Mn,u:En,parent:Qe,vnode:re}=De;{const Mt=ES(De);if(Mt){qt&&(qt.el=re.el,Rt(De,qt,dn)),Mt.asyncDep.then(()=>{De.isUnmounted||Vt()});return}}let ue=qt,Ee;Qu(De,!1),qt?(qt.el=re.el,Rt(De,qt,dn)):qt=re,Mn&&fd(Mn),(Ee=qt.props&&qt.props.onVnodeBeforeUpdate)&&_s(Ee,Qe,qt,re),Qu(De,!0);const it=S_(De),pt=De.subTree;De.subTree=it,J(pt,it,L(pt.el),It(pt),De,Ot,Kt),qt.el=it.el,ue===null&&pv(De,it.el),En&&No(En,Ot),(Ee=qt.props&&qt.props.onVnodeUpdated)&&No(()=>_s(Ee,Qe,qt,re),Ot)}else{let qt;const{el:Mn,props:En}=Re,{bm:Qe,m:re,parent:ue}=De,Ee=oh(Re);if(Qu(De,!1),Qe&&fd(Qe),!Ee&&(qt=En&&En.onVnodeBeforeMount)&&_s(qt,ue,Re),Qu(De,!0),Mn&&Gn){const it=()=>{De.subTree=S_(De),Gn(Mn,De.subTree,De,Ot,null)};Ee?Re.type.__asyncLoader().then(()=>!De.isUnmounted&&it()):it()}else{const it=De.subTree=S_(De);J(null,it,ft,Lt,De,Ot,Kt),Re.el=it.el}if(re&&No(re,Ot),!Ee&&(qt=En&&En.onVnodeMounted)){const it=Re;No(()=>_s(qt,ue,it),Ot)}(Re.shapeFlag&256||ue&&oh(ue.vnode)&&ue.vnode.shapeFlag&256)&&De.a&&No(De.a,Ot),De.isMounted=!0,Re=ft=Lt=null}},Gt=De.effect=new vd(Vt,gs,()=>X_(Yt),De.scope),Yt=De.update=()=>{Gt.dirty&&Gt.run()};Yt.id=De.uid,Qu(De,!0),Yt()},Rt=(De,Re,ft)=>{Re.component=De;const Lt=De.vnode.props;De.vnode=Re,De.next=null,v3(De,Re.props,Lt,ft),w3(De,Re.children,ft),_h(),eT(De),gh()},vt=(De,Re,ft,Lt,Ot,Kt,dn,Vt,Gt=!1)=>{const Yt=De&&De.children,qt=De?De.shapeFlag:0,Mn=Re.children,{patchFlag:En,shapeFlag:Qe}=Re;if(En>0){if(En&128){Kr(Yt,Mn,ft,Lt,Ot,Kt,dn,Vt,Gt);return}else if(En&256){wr(Yt,Mn,ft,Lt,Ot,Kt,dn,Vt,Gt);return}}Qe&8?(qt&16&&zr(Yt,Ot,Kt),Mn!==Yt&&O(ft,Mn)):qt&16?Qe&16?Kr(Yt,Mn,ft,Lt,Ot,Kt,dn,Vt,Gt):zr(Yt,Ot,Kt,!0):(qt&8&&O(ft,""),Qe&16&&Ce(Mn,ft,Lt,Ot,Kt,dn,Vt,Gt))},wr=(De,Re,ft,Lt,Ot,Kt,dn,Vt,Gt)=>{De=De||ud,Re=Re||ud;const Yt=De.length,qt=Re.length,Mn=Math.min(Yt,qt);let En;for(En=0;En<Mn;En++){const Qe=Re[En]=Gt?Vc(Re[En]):$s(Re[En]);J(De[En],Qe,ft,null,Ot,Kt,dn,Vt,Gt)}Yt>qt?zr(De,Ot,Kt,!0,!1,Mn):Ce(Re,ft,Lt,Ot,Kt,dn,Vt,Gt,Mn)},Kr=(De,Re,ft,Lt,Ot,Kt,dn,Vt,Gt)=>{let Yt=0;const qt=Re.length;let Mn=De.length-1,En=qt-1;for(;Yt<=Mn&&Yt<=En;){const Qe=De[Yt],re=Re[Yt]=Gt?Vc(Re[Yt]):$s(Re[Yt]);if(Ra(Qe,re))J(Qe,re,ft,null,Ot,Kt,dn,Vt,Gt);else break;Yt++}for(;Yt<=Mn&&Yt<=En;){const Qe=De[Mn],re=Re[En]=Gt?Vc(Re[En]):$s(Re[En]);if(Ra(Qe,re))J(Qe,re,ft,null,Ot,Kt,dn,Vt,Gt);else break;Mn--,En--}if(Yt>Mn){if(Yt<=En){const Qe=En+1,re=Qe<qt?Re[Qe].el:Lt;for(;Yt<=En;)J(null,Re[Yt]=Gt?Vc(Re[Yt]):$s(Re[Yt]),ft,re,Ot,Kt,dn,Vt,Gt),Yt++}}else if(Yt>En)for(;Yt<=Mn;)Or(De[Yt],Ot,Kt,!0),Yt++;else{const Qe=Yt,re=Yt,ue=new Map;for(Yt=re;Yt<=En;Yt++){const Ut=Re[Yt]=Gt?Vc(Re[Yt]):$s(Re[Yt]);Ut.key!=null&&ue.set(Ut.key,Yt)}let Ee,it=0;const pt=En-re+1;let Mt=!1,nn=0;const Ke=new Array(pt);for(Yt=0;Yt<pt;Yt++)Ke[Yt]=0;for(Yt=Qe;Yt<=Mn;Yt++){const Ut=De[Yt];if(it>=pt){Or(Ut,Ot,Kt,!0);continue}let tn;if(Ut.key!=null)tn=ue.get(Ut.key);else for(Ee=re;Ee<=En;Ee++)if(Ke[Ee-re]===0&&Ra(Ut,Re[Ee])){tn=Ee;break}tn===void 0?Or(Ut,Ot,Kt,!0):(Ke[tn-re]=Yt+1,tn>=nn?nn=tn:Mt=!0,J(Ut,Re[tn],ft,null,Ot,Kt,dn,Vt,Gt),it++)}const jt=Mt?M3(Ke):ud;for(Ee=jt.length-1,Yt=pt-1;Yt>=0;Yt--){const Ut=re+Yt,tn=Re[Ut],Sn=Ut+1<qt?Re[Ut+1].el:Lt;Ke[Yt]===0?J(null,tn,ft,Sn,Ot,Kt,dn,Vt,Gt):Mt&&(Ee<0||Yt!==jt[Ee]?Gr(tn,ft,Sn,2):Ee--)}}},Gr=(De,Re,ft,Lt,Ot=null)=>{const{el:Kt,type:dn,transition:Vt,children:Gt,shapeFlag:Yt}=De;if(Yt&6){Gr(De.component.subTree,Re,ft,Lt);return}if(Yt&128){De.suspense.move(Re,ft,Lt);return}if(Yt&64){dn.move(De,Re,ft,an);return}if(dn===zi){m(Kt,Re,ft);for(let Mn=0;Mn<Gt.length;Mn++)Gr(Gt[Mn],Re,ft,Lt);m(De.anchor,Re,ft);return}if(dn===sh){ye(De,Re,ft);return}if(Lt!==2&&Yt&1&&Vt)if(Lt===0)Vt.beforeEnter(Kt),m(Kt,Re,ft),No(()=>Vt.enter(Kt),Ot);else{const{leave:Mn,delayLeave:En,afterLeave:Qe}=Vt,re=()=>m(Kt,Re,ft),ue=()=>{Mn(Kt,()=>{re(),Qe&&Qe()})};En?En(Kt,re,ue):ue()}else m(Kt,Re,ft)},Or=(De,Re,ft,Lt=!1,Ot=!1)=>{const{type:Kt,props:dn,ref:Vt,children:Gt,dynamicChildren:Yt,shapeFlag:qt,patchFlag:Mn,dirs:En}=De;if(Vt!=null&&B_(Vt,null,ft,De,!0),qt&256){Re.ctx.deactivate(De);return}const Qe=qt&1&&En,re=!oh(De);let ue;if(re&&(ue=dn&&dn.onVnodeBeforeUnmount)&&_s(ue,Re,De),qt&6)oi(De.component,ft,Lt);else{if(qt&128){De.suspense.unmount(ft,Lt);return}Qe&&ul(De,null,Re,"beforeUnmount"),qt&64?De.type.remove(De,Re,ft,Ot,an,Lt):Yt&&(Kt!==zi||Mn>0&&Mn&64)?zr(Yt,Re,ft,!1,!0):(Kt===zi&&Mn&384||!Ot&&qt&16)&&zr(Gt,Re,ft),Lt&&yi(De)}(re&&(ue=dn&&dn.onVnodeUnmounted)||Qe)&&No(()=>{ue&&_s(ue,Re,De),Qe&&ul(De,null,Re,"unmounted")},ft)},yi=De=>{const{type:Re,el:ft,anchor:Lt,transition:Ot}=De;if(Re===zi){Hr(ft,Lt);return}if(Re===sh){Pe(De);return}const Kt=()=>{T(ft),Ot&&!Ot.persisted&&Ot.afterLeave&&Ot.afterLeave()};if(De.shapeFlag&1&&Ot&&!Ot.persisted){const{leave:dn,delayLeave:Vt}=Ot,Gt=()=>dn(ft,Kt);Vt?Vt(De.el,Kt,Gt):Gt()}else Kt()},Hr=(De,Re)=>{let ft;for(;De!==Re;)ft=U(De),T(De),De=ft;T(Re)},oi=(De,Re,ft)=>{const{bum:Lt,scope:Ot,update:Kt,subTree:dn,um:Vt}=De;Lt&&fd(Lt),Ot.stop(),Kt&&(Kt.active=!1,Or(dn,De,Re,ft)),Vt&&No(Vt,Re),No(()=>{De.isUnmounted=!0},Re),Re&&Re.pendingBranch&&!Re.isUnmounted&&De.asyncDep&&!De.asyncResolved&&De.suspenseId===Re.pendingId&&(Re.deps--,Re.deps===0&&Re.resolve())},zr=(De,Re,ft,Lt=!1,Ot=!1,Kt=0)=>{for(let dn=Kt;dn<De.length;dn++)Or(De[dn],Re,ft,Lt,Ot)},It=De=>De.shapeFlag&6?It(De.component.subTree):De.shapeFlag&128?De.suspense.next():U(De.anchor||De.el);let mn=!1;const on=(De,Re,ft)=>{De==null?Re._vnode&&Or(Re._vnode,null,null,!0):J(Re._vnode||null,De,Re,null,null,null,ft),mn||(mn=!0,eT(),z_(),mn=!1),Re._vnode=De},an={p:J,um:Or,m:Gr,r:yi,mt:Ht,mc:Ce,pc:vt,pbc:Te,n:It,o:u};let $n,Gn;return _&&([$n,Gn]=_(an)),{render:on,hydrate:$n,createApp:g3(on,$n)}}function l0({type:u,props:_},E){return E==="svg"&&u==="foreignObject"||E==="mathml"&&u==="annotation-xml"&&_&&_.encoding&&_.encoding.includes("html")?void 0:E}function Qu({effect:u,update:_},E){u.allowRecurse=_.allowRecurse=E}function TS(u,_){return(!u||u&&!u.pendingBranch)&&_&&!_.persisted}function wv(u,_,E=!1){const m=u.children,T=_.children;if(Bn(m)&&Bn(T))for(let f=0;f<m.length;f++){const x=m[f];let A=T[f];A.shapeFlag&1&&!A.dynamicChildren&&((A.patchFlag<=0||A.patchFlag===32)&&(A=T[f]=Vc(T[f]),A.el=x.el),E||wv(x,A)),A.type===hh&&(A.el=x.el)}}function M3(u){const _=u.slice(),E=[0];let m,T,f,x,A;const i=u.length;for(m=0;m<i;m++){const P=u[m];if(P!==0){if(T=E[E.length-1],u[T]<P){_[m]=T,E.push(m);continue}for(f=0,x=E.length-1;f<x;)A=f+x>>1,u[E[A]]<P?f=A+1:x=A;P<u[E[f]]&&(f>0&&(_[m]=E[f-1]),E[f]=m)}}for(f=E.length,x=E[f-1];f-- >0;)E[f]=x,x=_[x];return E}function ES(u){const _=u.subTree.component;if(_)return _.asyncDep&&!_.asyncResolved?_:ES(_)}const A3=u=>u.__isTeleport,up=u=>u&&(u.disabled||u.disabled===""),dT=u=>typeof SVGElement<"u"&&u instanceof SVGElement,fT=u=>typeof MathMLElement=="function"&&u instanceof MathMLElement,C0=(u,_)=>{const E=u&&u.to;return Zi(E)?_?_(E):null:E},I3={name:"Teleport",__isTeleport:!0,process(u,_,E,m,T,f,x,A,i,P){const{mc:O,pc:L,pbc:U,o:{insert:j,querySelector:W,createText:J,createComment:fe}}=P,_e=up(_.props);let{shapeFlag:we,children:ye,dynamicChildren:Pe}=_;if(u==null){const Fe=_.el=J(""),Be=_.anchor=J("");j(Fe,E,m),j(Be,E,m);const He=_.target=C0(_.props,W),Ce=_.targetAnchor=J("");He&&(j(Ce,He),x==="svg"||dT(He)?x="svg":(x==="mathml"||fT(He))&&(x="mathml"));const ve=(Te,Ye)=>{we&16&&O(ye,Te,Ye,T,f,x,A,i)};_e?ve(E,Be):He&&ve(He,Ce)}else{_.el=u.el;const Fe=_.anchor=u.anchor,Be=_.target=u.target,He=_.targetAnchor=u.targetAnchor,Ce=up(u.props),ve=Ce?E:Be,Te=Ce?Fe:He;if(x==="svg"||dT(Be)?x="svg":(x==="mathml"||fT(Be))&&(x="mathml"),Pe?(U(u.dynamicChildren,Pe,ve,T,f,x,A),wv(u,_,!0)):i||L(u,_,ve,Te,T,f,x,A,!1),_e)Ce?_.props&&u.props&&_.props.to!==u.props.to&&(_.props.to=u.props.to):T_(_,E,Fe,P,1);else if((_.props&&_.props.to)!==(u.props&&u.props.to)){const Ye=_.target=C0(_.props,W);Ye&&T_(_,Ye,null,P,0)}else Ce&&T_(_,Be,He,P,1)}SS(_)},remove(u,_,E,m,{um:T,o:{remove:f}},x){const{shapeFlag:A,children:i,anchor:P,targetAnchor:O,target:L,props:U}=u;if(L&&f(O),x&&f(P),A&16){const j=x||!up(U);for(let W=0;W<i.length;W++){const J=i[W];T(J,_,E,j,!!J.dynamicChildren)}}},move:T_,hydrate:C3};function T_(u,_,E,{o:{insert:m},m:T},f=2){f===0&&m(u.targetAnchor,_,E);const{el:x,anchor:A,shapeFlag:i,children:P,props:O}=u,L=f===2;if(L&&m(x,_,E),(!L||up(O))&&i&16)for(let U=0;U<P.length;U++)T(P[U],_,E,2);L&&m(A,_,E)}function C3(u,_,E,m,T,f,{o:{nextSibling:x,parentNode:A,querySelector:i}},P){const O=_.target=C0(_.props,i);if(O){const L=O._lpa||O.firstChild;if(_.shapeFlag&16)if(up(_.props))_.anchor=P(x(u),_,A(u),E,m,T,f),_.targetAnchor=L;else{_.anchor=x(u);let U=L;for(;U;)if(U=x(U),U&&U.nodeType===8&&U.data==="teleport anchor"){_.targetAnchor=U,O._lpa=_.targetAnchor&&x(_.targetAnchor);break}P(L,_,O,E,m,T,f)}SS(_)}return _.anchor&&x(_.anchor)}const P3=I3;function SS(u){const _=u.ctx;if(_&&_.ut){let E=u.children[0].el;for(;E&&E!==u.targetAnchor;)E.nodeType===1&&E.setAttribute("data-v-owner",_.uid),E=E.nextSibling;_.ut()}}const zi=Symbol.for("v-fgt"),hh=Symbol.for("v-txt"),Jo=Symbol.for("v-cmt"),sh=Symbol.for("v-stc"),hp=[];let vs=null;function gr(u=!1){hp.push(vs=u?null:[])}function MS(){hp.pop(),vs=hp[hp.length-1]||null}let dh=1;function P0(u){dh+=u}function AS(u){return u.dynamicChildren=dh>0?vs||ud:null,MS(),dh>0&&vs&&vs.push(u),u}function Pr(u,_,E,m,T,f){return AS(Ct(u,_,E,m,T,f,!0))}function Tv(u,_,E,m,T){return AS(cr(u,_,E,m,T,!0))}function Yc(u){return u?u.__v_isVNode===!0:!1}function Ra(u,_){return u.type===_.type&&u.key===_.key}function D3(u){}const ig="__vInternal",IS=({key:u})=>u??null,M_=({ref:u,ref_key:_,ref_for:E})=>(typeof u=="number"&&(u=""+u),u!=null?Zi(u)||ro(u)||Mr(u)?{i:vo,r:u,k:_,f:!!E}:u:null);function Ct(u,_=null,E=null,m=0,T=null,f=u===zi?0:1,x=!1,A=!1){const i={__v_isVNode:!0,__v_skip:!0,type:u,props:_,key:_&&IS(_),ref:_&&M_(_),scopeId:J_,slotScopeIds:null,children:E,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:f,patchFlag:m,dynamicProps:T,dynamicChildren:null,appContext:null,ctx:vo};return A?(Ev(i,E),f&128&&u.normalize(i)):E&&(i.shapeFlag|=Zi(E)?8:16),dh>0&&!x&&vs&&(i.patchFlag>0||f&6)&&i.patchFlag!==32&&vs.push(i),i}const cr=k3;function k3(u,_=null,E=null,m=0,T=null,f=!1){if((!u||u===UE)&&(u=Jo),Yc(u)){const A=fl(u,_,!0);return E&&Ev(A,E),dh>0&&!f&&vs&&(A.shapeFlag&6?vs[vs.indexOf(u)]=A:vs.push(A)),A.patchFlag|=-2,A}if(N3(u)&&(u=u.__vccOpts),_){_=CS(_);let{class:A,style:i}=_;A&&!Zi(A)&&(_.class=ys(A)),Pi(i)&&(cv(i)&&!Bn(i)&&(i=Wi({},i)),_.style=Dp(i))}const x=Zi(u)?1:$E(u)?128:A3(u)?64:Pi(u)?4:Mr(u)?2:0;return Ct(u,_,E,m,T,x,f,!0)}function CS(u){return u?cv(u)||ig in u?Wi({},u):u:null}function fl(u,_,E=!1){const{props:m,ref:T,patchFlag:f,children:x}=u,A=_?Sv(m||{},_):m;return{__v_isVNode:!0,__v_skip:!0,type:u.type,props:A,key:A&&IS(A),ref:_&&_.ref?E&&T?Bn(T)?T.concat(M_(_)):[T,M_(_)]:M_(_):T,scopeId:u.scopeId,slotScopeIds:u.slotScopeIds,children:x,target:u.target,targetAnchor:u.targetAnchor,staticCount:u.staticCount,shapeFlag:u.shapeFlag,patchFlag:_&&u.type!==zi?f===-1?16:f|16:f,dynamicProps:u.dynamicProps,dynamicChildren:u.dynamicChildren,appContext:u.appContext,dirs:u.dirs,transition:u.transition,component:u.component,suspense:u.suspense,ssContent:u.ssContent&&fl(u.ssContent),ssFallback:u.ssFallback&&fl(u.ssFallback),el:u.el,anchor:u.anchor,ctx:u.ctx,ce:u.ce}}function og(u=" ",_=0){return cr(hh,null,u,_)}function PS(u,_){const E=cr(sh,null,u);return E.staticCount=_,E}function sg(u="",_=!1){return _?(gr(),Tv(Jo,null,u)):cr(Jo,null,u)}function $s(u){return u==null||typeof u=="boolean"?cr(Jo):Bn(u)?cr(zi,null,u.slice()):typeof u=="object"?Vc(u):cr(hh,null,String(u))}function Vc(u){return u.el===null&&u.patchFlag!==-1||u.memo?u:fl(u)}function Ev(u,_){let E=0;const{shapeFlag:m}=u;if(_==null)_=null;else if(Bn(_))E=16;else if(typeof _=="object")if(m&65){const T=_.default;T&&(T._c&&(T._d=!1),Ev(u,T()),T._c&&(T._d=!0));return}else{E=32;const T=_._;!T&&!(ig in _)?_._ctx=vo:T===3&&vo&&(vo.slots._===1?_._=1:(_._=2,u.patchFlag|=1024))}else Mr(_)?(_={default:_,_ctx:vo},E=32):(_=String(_),m&64?(E=16,_=[og(_)]):E=8);u.children=_,u.shapeFlag|=E}function Sv(...u){const _={};for(let E=0;E<u.length;E++){const m=u[E];for(const T in m)if(T==="class")_.class!==m.class&&(_.class=ys([_.class,m.class]));else if(T==="style")_.style=Dp([_.style,m.style]);else if(Cp(T)){const f=_[T],x=m[T];x&&f!==x&&!(Bn(f)&&f.includes(x))&&(_[T]=f?[].concat(f,x):x)}else T!==""&&(_[T]=m[T])}return _}function _s(u,_,E,m=null){Hs(u,_,7,[E,m])}const O3=fS();let R3=0;function DS(u,_,E){const m=u.type,T=(_?_.appContext:u.appContext)||O3,f={uid:R3++,vnode:u,type:m,parent:_,appContext:T,root:null,next:null,subTree:null,effect:null,update:null,scope:new tv(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:_?_.provides:Object.create(T.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:_S(m,T),emitsOptions:jE(m,T),emit:null,emitted:null,propsDefaults:Si,inheritAttrs:m.inheritAttrs,ctx:Si,data:Si,props:Si,attrs:Si,slots:Si,refs:Si,setupState:Si,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:E,suspenseId:E?E.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return f.ctx={_:f},f.root=_?_.root:f,f.emit=ID.bind(null,f),u.ce&&u.ce(f),f}let wo=null;const Jl=()=>wo||vo;let N_,D0;{const u=dE(),_=(E,m)=>{let T;return(T=u[E])||(T=u[E]=[]),T.push(m),f=>{T.length>1?T.forEach(x=>x(f)):T[0](f)}};N_=_("__VUE_INSTANCE_SETTERS__",E=>wo=E),D0=_("__VUE_SSR_SETTERS__",E=>Lp=E)}const fh=u=>{const _=wo;return N_(u),u.scope.on(),()=>{u.scope.off(),N_(_)}},k0=()=>{wo&&wo.scope.off(),N_(null)};function kS(u){return u.vnode.shapeFlag&4}let Lp=!1;function OS(u,_=!1){_&&D0(_);const{props:E,children:m}=u.vnode,T=kS(u);y3(u,E,T,_),b3(u,m);const f=T?L3(u,_):void 0;return _&&D0(!1),f}function L3(u,_){const E=u.type;u.accessCache=Object.create(null),u.proxy=kp(new Proxy(u.ctx,S0));const{setup:m}=E;if(m){const T=u.setupContext=m.length>1?LS(u):null,f=fh(u);_h();const x=ql(m,u,0,[u.props,T]);if(gh(),f(),Q0(x)){if(x.then(k0,k0),_)return x.then(A=>{O0(u,A,_)}).catch(A=>{yh(A,u,0)});u.asyncDep=x}else O0(u,x,_)}else RS(u,_)}function O0(u,_,E){Mr(_)?u.type.__ssrInlineRender?u.ssrRender=_:u.render=_:Pi(_)&&(u.setupState=dv(_)),RS(u,E)}let j_,R0;function z3(u){j_=u,R0=_=>{_.render._rc&&(_.withProxy=new Proxy(_.ctx,JD))}}const F3=()=>!j_;function RS(u,_,E){const m=u.type;if(!u.render){if(!_&&j_&&!m.render){const T=m.template||xv(u).template;if(T){const{isCustomElement:f,compilerOptions:x}=u.appContext.config,{delimiters:A,compilerOptions:i}=m,P=Wi(Wi({isCustomElement:f,delimiters:A},x),i);m.render=j_(T,P)}}u.render=m.render||gs,R0&&R0(u)}{const T=fh(u);_h();try{h3(u)}finally{gh(),T()}}}function B3(u){return u.attrsProxy||(u.attrsProxy=new Proxy(u.attrs,{get(_,E){return xs(u,"get","$attrs"),_[E]}}))}function LS(u){const _=E=>{u.exposed=E||{}};return{get attrs(){return B3(u)},slots:u.slots,emit:u.emit,expose:_}}function ag(u){if(u.exposed)return u.exposeProxy||(u.exposeProxy=new Proxy(dv(kp(u.exposed)),{get(_,E){if(E in _)return _[E];if(E in lp)return lp[E](u)},has(_,E){return E in _||E in lp}}))}function L0(u,_=!0){return Mr(u)?u.displayName||u.name:u.name||_&&u.__name}function N3(u){return Mr(u)&&"__vccOpts"in u}const Mi=(u,_)=>uD(u,_,Lp);function j3(u,_,E=Si){const m=Jl(),T=ls(_),f=Gs(_),x=OE((i,P)=>{let O;return ZE(()=>{const L=u[_];La(O,L)&&(O=L,P())}),{get(){return i(),E.get?E.get(O):O},set(L){const U=m.vnode.props;!(U&&(_ in U||T in U||f in U)&&(`onUpdate:${_}`in U||`onUpdate:${T}`in U||`onUpdate:${f}`in U))&&La(L,O)&&(O=L,P()),m.emit(`update:${_}`,E.set?E.set(L):L)}}}),A=_==="modelValue"?"modelModifiers":`${_}Modifiers`;return x[Symbol.iterator]=()=>{let i=0;return{next(){return i<2?{value:i++?u[A]||{}:x,done:!1}:{done:!0}}}},x}function lg(u,_,E){const m=arguments.length;return m===2?Pi(_)&&!Bn(_)?Yc(_)?cr(u,null,[_]):cr(u,_):cr(u,null,_):(m>3?E=Array.prototype.slice.call(arguments,2):m===3&&Yc(E)&&(E=[E]),cr(u,_,E))}function V3(){}function U3(u,_,E,m){const T=E[m];if(T&&zS(T,u))return T;const f=_();return f.memo=u.slice(),E[m]=f}function zS(u,_){const E=u.memo;if(E.length!=_.length)return!1;for(let m=0;m<E.length;m++)if(La(E[m],_[m]))return!1;return dh>0&&vs&&vs.push(u),!0}const FS="3.4.21",$3=gs,G3=TD,H3=ld,q3=NE,W3={createComponentInstance:DS,setupComponent:OS,renderComponentRoot:S_,setCurrentRenderingInstance:bp,isVNode:Yc,normalizeVNode:$s},Z3=W3,Y3=null,X3=null,K3=null;/**
* @vue/runtime-dom v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const J3="http://www.w3.org/2000/svg",Q3="http://www.w3.org/1998/Math/MathML",Uc=typeof document<"u"?document:null,pT=Uc&&Uc.createElement("template"),ek={insert:(u,_,E)=>{_.insertBefore(u,E||null)},remove:u=>{const _=u.parentNode;_&&_.removeChild(u)},createElement:(u,_,E,m)=>{const T=_==="svg"?Uc.createElementNS(J3,u):_==="mathml"?Uc.createElementNS(Q3,u):Uc.createElement(u,E?{is:E}:void 0);return u==="select"&&m&&m.multiple!=null&&T.setAttribute("multiple",m.multiple),T},createText:u=>Uc.createTextNode(u),createComment:u=>Uc.createComment(u),setText:(u,_)=>{u.nodeValue=_},setElementText:(u,_)=>{u.textContent=_},parentNode:u=>u.parentNode,nextSibling:u=>u.nextSibling,querySelector:u=>Uc.querySelector(u),setScopeId(u,_){u.setAttribute(_,"")},insertStaticContent(u,_,E,m,T,f){const x=E?E.previousSibling:_.lastChild;if(T&&(T===f||T.nextSibling))for(;_.insertBefore(T.cloneNode(!0),E),!(T===f||!(T=T.nextSibling)););else{pT.innerHTML=m==="svg"?`<svg>${u}</svg>`:m==="mathml"?`<math>${u}</math>`:u;const A=pT.content;if(m==="svg"||m==="mathml"){const i=A.firstChild;for(;i.firstChild;)A.appendChild(i.firstChild);A.removeChild(i)}_.insertBefore(A,E)}return[x?x.nextSibling:_.firstChild,E?E.previousSibling:_.lastChild]}},Rc="transition",tp="animation",bd=Symbol("_vtc"),Mv=(u,{slots:_})=>lg(XE,NS(u),_);Mv.displayName="Transition";const BS={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},tk=Mv.props=Wi({},vv,BS),eh=(u,_=[])=>{Bn(u)?u.forEach(E=>E(..._)):u&&u(..._)},mT=u=>u?Bn(u)?u.some(_=>_.length>1):u.length>1:!1;function NS(u){const _={};for(const Oe in u)Oe in BS||(_[Oe]=u[Oe]);if(u.css===!1)return _;const{name:E="v",type:m,duration:T,enterFromClass:f=`${E}-enter-from`,enterActiveClass:x=`${E}-enter-active`,enterToClass:A=`${E}-enter-to`,appearFromClass:i=f,appearActiveClass:P=x,appearToClass:O=A,leaveFromClass:L=`${E}-leave-from`,leaveActiveClass:U=`${E}-leave-active`,leaveToClass:j=`${E}-leave-to`}=u,W=nk(T),J=W&&W[0],fe=W&&W[1],{onBeforeEnter:_e,onEnter:we,onEnterCancelled:ye,onLeave:Pe,onLeaveCancelled:Fe,onBeforeAppear:Be=_e,onAppear:He=we,onAppearCancelled:Ce=ye}=_,ve=(Oe,lt,Ht)=>{Fc(Oe,lt?O:A),Fc(Oe,lt?P:x),Ht&&Ht()},Te=(Oe,lt)=>{Oe._isLeaving=!1,Fc(Oe,L),Fc(Oe,j),Fc(Oe,U),lt&&lt()},Ye=Oe=>(lt,Ht)=>{const nt=Oe?He:we,Tt=()=>ve(lt,Oe,Ht);eh(nt,[lt,Tt]),_T(()=>{Fc(lt,Oe?i:f),Ul(lt,Oe?O:A),mT(nt)||gT(lt,m,J,Tt)})};return Wi(_,{onBeforeEnter(Oe){eh(_e,[Oe]),Ul(Oe,f),Ul(Oe,x)},onBeforeAppear(Oe){eh(Be,[Oe]),Ul(Oe,i),Ul(Oe,P)},onEnter:Ye(!1),onAppear:Ye(!0),onLeave(Oe,lt){Oe._isLeaving=!0;const Ht=()=>Te(Oe,lt);Ul(Oe,L),VS(),Ul(Oe,U),_T(()=>{Oe._isLeaving&&(Fc(Oe,L),Ul(Oe,j),mT(Pe)||gT(Oe,m,fe,Ht))}),eh(Pe,[Oe,Ht])},onEnterCancelled(Oe){ve(Oe,!1),eh(ye,[Oe])},onAppearCancelled(Oe){ve(Oe,!0),eh(Ce,[Oe])},onLeaveCancelled(Oe){Te(Oe),eh(Fe,[Oe])}})}function nk(u){if(u==null)return null;if(Pi(u))return[c0(u.enter),c0(u.leave)];{const _=c0(u);return[_,_]}}function c0(u){return O_(u)}function Ul(u,_){_.split(/\s+/).forEach(E=>E&&u.classList.add(E)),(u[bd]||(u[bd]=new Set)).add(_)}function Fc(u,_){_.split(/\s+/).forEach(m=>m&&u.classList.remove(m));const E=u[bd];E&&(E.delete(_),E.size||(u[bd]=void 0))}function _T(u){requestAnimationFrame(()=>{requestAnimationFrame(u)})}let rk=0;function gT(u,_,E,m){const T=u._endId=++rk,f=()=>{T===u._endId&&m()};if(E)return setTimeout(f,E);const{type:x,timeout:A,propCount:i}=jS(u,_);if(!x)return m();const P=x+"end";let O=0;const L=()=>{u.removeEventListener(P,U),f()},U=j=>{j.target===u&&++O>=i&&L()};setTimeout(()=>{O<i&&L()},A+1),u.addEventListener(P,U)}function jS(u,_){const E=window.getComputedStyle(u),m=W=>(E[W]||"").split(", "),T=m(`${Rc}Delay`),f=m(`${Rc}Duration`),x=yT(T,f),A=m(`${tp}Delay`),i=m(`${tp}Duration`),P=yT(A,i);let O=null,L=0,U=0;_===Rc?x>0&&(O=Rc,L=x,U=f.length):_===tp?P>0&&(O=tp,L=P,U=i.length):(L=Math.max(x,P),O=L>0?x>P?Rc:tp:null,U=O?O===Rc?f.length:i.length:0);const j=O===Rc&&/\b(transform|all)(,|$)/.test(m(`${Rc}Property`).toString());return{type:O,timeout:L,propCount:U,hasTransform:j}}function yT(u,_){for(;u.length<_.length;)u=u.concat(u);return Math.max(..._.map((E,m)=>vT(E)+vT(u[m])))}function vT(u){return u==="auto"?0:Number(u.slice(0,-1).replace(",","."))*1e3}function VS(){return document.body.offsetHeight}function ik(u,_,E){const m=u[bd];m&&(_=(_?[_,...m]:[...m]).join(" ")),_==null?u.removeAttribute("class"):E?u.setAttribute("class",_):u.className=_}const V_=Symbol("_vod"),US=Symbol("_vsh"),$S={beforeMount(u,{value:_},{transition:E}){u[V_]=u.style.display==="none"?"":u.style.display,E&&_?E.beforeEnter(u):np(u,_)},mounted(u,{value:_},{transition:E}){E&&_&&E.enter(u)},updated(u,{value:_,oldValue:E},{transition:m}){!_!=!E&&(m?_?(m.beforeEnter(u),np(u,!0),m.enter(u)):m.leave(u,()=>{np(u,!1)}):np(u,_))},beforeUnmount(u,{value:_}){np(u,_)}};function np(u,_){u.style.display=_?u[V_]:"none",u[US]=!_}function ok(){$S.getSSRProps=({value:u})=>{if(!u)return{style:{display:"none"}}}}const GS=Symbol("");function sk(u){const _=Jl();if(!_)return;const E=_.ut=(T=u(_.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${_.uid}"]`)).forEach(f=>F0(f,T))},m=()=>{const T=u(_.proxy);z0(_.subTree,T),E(T)};WE(m),Kl(()=>{const T=new MutationObserver(m);T.observe(_.subTree.el.parentNode,{childList:!0}),rg(()=>T.disconnect())})}function z0(u,_){if(u.shapeFlag&128){const E=u.suspense;u=E.activeBranch,E.pendingBranch&&!E.isHydrating&&E.effects.push(()=>{z0(E.activeBranch,_)})}for(;u.component;)u=u.component.subTree;if(u.shapeFlag&1&&u.el)F0(u.el,_);else if(u.type===zi)u.children.forEach(E=>z0(E,_));else if(u.type===sh){let{el:E,anchor:m}=u;for(;E&&(F0(E,_),E!==m);)E=E.nextSibling}}function F0(u,_){if(u.nodeType===1){const E=u.style;let m="";for(const T in _)E.setProperty(`--${T}`,_[T]),m+=`--${T}: ${_[T]};`;E[GS]=m}}const ak=/(^|;)\s*display\s*:/;function lk(u,_,E){const m=u.style,T=Zi(E);let f=!1;if(E&&!T){if(_)if(Zi(_))for(const x of _.split(";")){const A=x.slice(0,x.indexOf(":")).trim();E[A]==null&&A_(m,A,"")}else for(const x in _)E[x]==null&&A_(m,x,"");for(const x in E)x==="display"&&(f=!0),A_(m,x,E[x])}else if(T){if(_!==E){const x=m[GS];x&&(E+=";"+x),m.cssText=E,f=ak.test(E)}}else _&&u.removeAttribute("style");V_ in u&&(u[V_]=f?m.display:"",u[US]&&(m.display="none"))}const xT=/\s*!important$/;function A_(u,_,E){if(Bn(E))E.forEach(m=>A_(u,_,m));else if(E==null&&(E=""),_.startsWith("--"))u.setProperty(_,E);else{const m=ck(u,_);xT.test(E)?u.setProperty(Gs(m),E.replace(xT,""),"important"):u[m]=E}}const bT=["Webkit","Moz","ms"],u0={};function ck(u,_){const E=u0[_];if(E)return E;let m=ls(_);if(m!=="filter"&&m in u)return u0[_]=m;m=Pp(m);for(let T=0;T<bT.length;T++){const f=bT[T]+m;if(f in u)return u0[_]=f}return _}const wT="http://www.w3.org/1999/xlink";function uk(u,_,E,m,T){if(m&&_.startsWith("xlink:"))E==null?u.removeAttributeNS(wT,_.slice(6,_.length)):u.setAttributeNS(wT,_,E);else{const f=NP(_);E==null||f&&!fE(E)?u.removeAttribute(_):u.setAttribute(_,f?"":E)}}function hk(u,_,E,m,T,f,x){if(_==="innerHTML"||_==="textContent"){m&&x(m,T,f),u[_]=E??"";return}const A=u.tagName;if(_==="value"&&A!=="PROGRESS"&&!A.includes("-")){const P=A==="OPTION"?u.getAttribute("value")||"":u.value,O=E??"";(P!==O||!("_value"in u))&&(u.value=O),E==null&&u.removeAttribute(_),u._value=E;return}let i=!1;if(E===""||E==null){const P=typeof u[_];P==="boolean"?E=fE(E):E==null&&P==="string"?(E="",i=!0):P==="number"&&(E=0,i=!0)}try{u[_]=E}catch{}i&&u.removeAttribute(_)}function $l(u,_,E,m){u.addEventListener(_,E,m)}function dk(u,_,E,m){u.removeEventListener(_,E,m)}const TT=Symbol("_vei");function fk(u,_,E,m,T=null){const f=u[TT]||(u[TT]={}),x=f[_];if(m&&x)x.value=m;else{const[A,i]=pk(_);if(m){const P=f[_]=gk(m,T);$l(u,A,P,i)}else x&&(dk(u,A,x,i),f[_]=void 0)}}const ET=/(?:Once|Passive|Capture)$/;function pk(u){let _;if(ET.test(u)){_={};let m;for(;m=u.match(ET);)u=u.slice(0,u.length-m[0].length),_[m[0].toLowerCase()]=!0}return[u[2]===":"?u.slice(3):Gs(u.slice(2)),_]}let h0=0;const mk=Promise.resolve(),_k=()=>h0||(mk.then(()=>h0=0),h0=Date.now());function gk(u,_){const E=m=>{if(!m._vts)m._vts=Date.now();else if(m._vts<=E.attached)return;Hs(yk(m,E.value),_,5,[m])};return E.value=u,E.attached=_k(),E}function yk(u,_){if(Bn(_)){const E=u.stopImmediatePropagation;return u.stopImmediatePropagation=()=>{E.call(u),u._stopped=!0},_.map(m=>T=>!T._stopped&&m&&m(T))}else return _}const ST=u=>u.charCodeAt(0)===111&&u.charCodeAt(1)===110&&u.charCodeAt(2)>96&&u.charCodeAt(2)<123,vk=(u,_,E,m,T,f,x,A,i)=>{const P=T==="svg";_==="class"?ik(u,m,P):_==="style"?lk(u,E,m):Cp(_)?K0(_)||fk(u,_,E,m,x):(_[0]==="."?(_=_.slice(1),!0):_[0]==="^"?(_=_.slice(1),!1):xk(u,_,m,P))?hk(u,_,m,f,x,A,i):(_==="true-value"?u._trueValue=m:_==="false-value"&&(u._falseValue=m),uk(u,_,m,P))};function xk(u,_,E,m){if(m)return!!(_==="innerHTML"||_==="textContent"||_ in u&&ST(_)&&Mr(E));if(_==="spellcheck"||_==="draggable"||_==="translate"||_==="form"||_==="list"&&u.tagName==="INPUT"||_==="type"&&u.tagName==="TEXTAREA")return!1;if(_==="width"||_==="height"){const T=u.tagName;if(T==="IMG"||T==="VIDEO"||T==="CANVAS"||T==="SOURCE")return!1}return ST(_)&&Zi(E)?!1:_ in u}/*! #__NO_SIDE_EFFECTS__ */function HS(u,_){const E=Id(u);class m extends cg{constructor(f){super(E,f,_)}}return m.def=E,m}/*! #__NO_SIDE_EFFECTS__ */const bk=u=>HS(u,tM),wk=typeof HTMLElement<"u"?HTMLElement:class{};class cg extends wk{constructor(_,E={},m){super(),this._def=_,this._props=E,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this._ob=null,this.shadowRoot&&m?m(this._createVNode(),this.shadowRoot):(this.attachShadow({mode:"open"}),this._def.__asyncLoader||this._resolveProps(this._def))}connectedCallback(){this._connected=!0,this._instance||(this._resolved?this._update():this._resolveDef())}disconnectedCallback(){this._connected=!1,this._ob&&(this._ob.disconnect(),this._ob=null),Ad(()=>{this._connected||(B0(null,this.shadowRoot),this._instance=null)})}_resolveDef(){this._resolved=!0;for(let m=0;m<this.attributes.length;m++)this._setAttr(this.attributes[m].name);this._ob=new MutationObserver(m=>{for(const T of m)this._setAttr(T.attributeName)}),this._ob.observe(this,{attributes:!0});const _=(m,T=!1)=>{const{props:f,styles:x}=m;let A;if(f&&!Bn(f))for(const i in f){const P=f[i];(P===Number||P&&P.type===Number)&&(i in this._props&&(this._props[i]=O_(this._props[i])),(A||(A=Object.create(null)))[ls(i)]=!0)}this._numberProps=A,T&&this._resolveProps(m),this._applyStyles(x),this._update()},E=this._def.__asyncLoader;E?E().then(m=>_(m,!0)):_(this._def)}_resolveProps(_){const{props:E}=_,m=Bn(E)?E:Object.keys(E||{});for(const T of Object.keys(this))T[0]!=="_"&&m.includes(T)&&this._setProp(T,this[T],!0,!1);for(const T of m.map(ls))Object.defineProperty(this,T,{get(){return this._getProp(T)},set(f){this._setProp(T,f)}})}_setAttr(_){let E=this.getAttribute(_);const m=ls(_);this._numberProps&&this._numberProps[m]&&(E=O_(E)),this._setProp(m,E,!1)}_getProp(_){return this._props[_]}_setProp(_,E,m=!0,T=!0){E!==this._props[_]&&(this._props[_]=E,T&&this._instance&&this._update(),m&&(E===!0?this.setAttribute(Gs(_),""):typeof E=="string"||typeof E=="number"?this.setAttribute(Gs(_),E+""):E||this.removeAttribute(Gs(_))))}_update(){B0(this._createVNode(),this.shadowRoot)}_createVNode(){const _=cr(this._def,Wi({},this._props));return this._instance||(_.ce=E=>{this._instance=E,E.isCE=!0;const m=(f,x)=>{this.dispatchEvent(new CustomEvent(f,{detail:x}))};E.emit=(f,...x)=>{m(f,x),Gs(f)!==f&&m(Gs(f),x)};let T=this;for(;T=T&&(T.parentNode||T.host);)if(T instanceof cg){E.parent=T._instance,E.provides=T._instance.provides;break}}),_}_applyStyles(_){_&&_.forEach(E=>{const m=document.createElement("style");m.textContent=E,this.shadowRoot.appendChild(m)})}}function Tk(u="$style"){{const _=Jl();if(!_)return Si;const E=_.type.__cssModules;if(!E)return Si;const m=E[u];return m||Si}}const qS=new WeakMap,WS=new WeakMap,U_=Symbol("_moveCb"),MT=Symbol("_enterCb"),ZS={name:"TransitionGroup",props:Wi({},tk,{tag:String,moveClass:String}),setup(u,{slots:_}){const E=Jl(),m=yv();let T,f;return tg(()=>{if(!T.length)return;const x=u.moveClass||`${u.name||"v"}-move`;if(!Ck(T[0].el,E.vnode.el,x))return;T.forEach(Mk),T.forEach(Ak);const A=T.filter(Ik);VS(),A.forEach(i=>{const P=i.el,O=P.style;Ul(P,x),O.transform=O.webkitTransform=O.transitionDuration="";const L=P[U_]=U=>{U&&U.target!==P||(!U||/transform$/.test(U.propertyName))&&(P.removeEventListener("transitionend",L),P[U_]=null,Fc(P,x))};P.addEventListener("transitionend",L)})}),()=>{const x=Xr(u),A=NS(x);let i=x.tag||zi;T=f,f=_.default?Q_(_.default()):[];for(let P=0;P<f.length;P++){const O=f[P];O.key!=null&&ch(O,xd(O,A,m,E))}if(T)for(let P=0;P<T.length;P++){const O=T[P];ch(O,xd(O,A,m,E)),qS.set(O,O.el.getBoundingClientRect())}return cr(i,null,f)}}},Ek=u=>delete u.mode;ZS.props;const Sk=ZS;function Mk(u){const _=u.el;_[U_]&&_[U_](),_[MT]&&_[MT]()}function Ak(u){WS.set(u,u.el.getBoundingClientRect())}function Ik(u){const _=qS.get(u),E=WS.get(u),m=_.left-E.left,T=_.top-E.top;if(m||T){const f=u.el.style;return f.transform=f.webkitTransform=`translate(${m}px,${T}px)`,f.transitionDuration="0s",u}}function Ck(u,_,E){const m=u.cloneNode(),T=u[bd];T&&T.forEach(A=>{A.split(/\s+/).forEach(i=>i&&m.classList.remove(i))}),E.split(/\s+/).forEach(A=>A&&m.classList.add(A)),m.style.display="none";const f=_.nodeType===1?_:_.parentNode;f.appendChild(m);const{hasTransform:x}=jS(m);return f.removeChild(m),x}const Xc=u=>{const _=u.props["onUpdate:modelValue"]||!1;return Bn(_)?E=>fd(_,E):_};function Pk(u){u.target.composing=!0}function AT(u){const _=u.target;_.composing&&(_.composing=!1,_.dispatchEvent(new Event("input")))}const aa=Symbol("_assign"),ph={created(u,{modifiers:{lazy:_,trim:E,number:m}},T){u[aa]=Xc(T);const f=m||T.props&&T.props.type==="number";$l(u,_?"change":"input",x=>{if(x.target.composing)return;let A=u.value;E&&(A=A.trim()),f&&(A=_p(A)),u[aa](A)}),E&&$l(u,"change",()=>{u.value=u.value.trim()}),_||($l(u,"compositionstart",Pk),$l(u,"compositionend",AT),$l(u,"change",AT))},mounted(u,{value:_}){u.value=_??""},beforeUpdate(u,{value:_,modifiers:{lazy:E,trim:m,number:T}},f){if(u[aa]=Xc(f),u.composing)return;const x=T||u.type==="number"?_p(u.value):u.value,A=_??"";x!==A&&(document.activeElement===u&&u.type!=="range"&&(E||m&&u.value.trim()===A)||(u.value=A))}},Sp={deep:!0,created(u,_,E){u[aa]=Xc(E),$l(u,"change",()=>{const m=u._modelValue,T=wd(u),f=u.checked,x=u[aa];if(Bn(m)){const A=q_(m,T),i=A!==-1;if(f&&!i)x(m.concat(T));else if(!f&&i){const P=[...m];P.splice(A,1),x(P)}}else if(mh(m)){const A=new Set(m);f?A.add(T):A.delete(T),x(A)}else x(YS(u,f))})},mounted:IT,beforeUpdate(u,_,E){u[aa]=Xc(E),IT(u,_,E)}};function IT(u,{value:_,oldValue:E},m){u._modelValue=_,Bn(_)?u.checked=q_(_,m.props.value)>-1:mh(_)?u.checked=_.has(m.props.value):_!==E&&(u.checked=Zc(_,YS(u,!0)))}const Av={created(u,{value:_},E){u.checked=Zc(_,E.props.value),u[aa]=Xc(E),$l(u,"change",()=>{u[aa](wd(u))})},beforeUpdate(u,{value:_,oldValue:E},m){u[aa]=Xc(m),_!==E&&(u.checked=Zc(_,m.props.value))}},Iv={deep:!0,created(u,{value:_,modifiers:{number:E}},m){const T=mh(_);$l(u,"change",()=>{const f=Array.prototype.filter.call(u.options,x=>x.selected).map(x=>E?_p(wd(x)):wd(x));u[aa](u.multiple?T?new Set(f):f:f[0]),u._assigning=!0,Ad(()=>{u._assigning=!1})}),u[aa]=Xc(m)},mounted(u,{value:_,modifiers:{number:E}}){CT(u,_,E)},beforeUpdate(u,_,E){u[aa]=Xc(E)},updated(u,{value:_,modifiers:{number:E}}){u._assigning||CT(u,_,E)}};function CT(u,_,E){const m=u.multiple,T=Bn(_);if(!(m&&!T&&!mh(_))){for(let f=0,x=u.options.length;f<x;f++){const A=u.options[f],i=wd(A);if(m)if(T){const P=typeof i;P==="string"||P==="number"?A.selected=_.includes(E?_p(i):i):A.selected=q_(_,i)>-1}else A.selected=_.has(i);else if(Zc(wd(A),_)){u.selectedIndex!==f&&(u.selectedIndex=f);return}}!m&&u.selectedIndex!==-1&&(u.selectedIndex=-1)}}function wd(u){return"_value"in u?u._value:u.value}function YS(u,_){const E=_?"_trueValue":"_falseValue";return E in u?u[E]:_}const XS={created(u,_,E){E_(u,_,E,null,"created")},mounted(u,_,E){E_(u,_,E,null,"mounted")},beforeUpdate(u,_,E,m){E_(u,_,E,m,"beforeUpdate")},updated(u,_,E,m){E_(u,_,E,m,"updated")}};function KS(u,_){switch(u){case"SELECT":return Iv;case"TEXTAREA":return ph;default:switch(_){case"checkbox":return Sp;case"radio":return Av;default:return ph}}}function E_(u,_,E,m,T){const x=KS(u.tagName,E.props&&E.props.type)[T];x&&x(u,_,E,m)}function Dk(){ph.getSSRProps=({value:u})=>({value:u}),Av.getSSRProps=({value:u},_)=>{if(_.props&&Zc(_.props.value,u))return{checked:!0}},Sp.getSSRProps=({value:u},_)=>{if(Bn(u)){if(_.props&&q_(u,_.props.value)>-1)return{checked:!0}}else if(mh(u)){if(_.props&&u.has(_.props.value))return{checked:!0}}else if(u)return{checked:!0}},XS.getSSRProps=(u,_)=>{if(typeof _.type!="string")return;const E=KS(_.type.toUpperCase(),_.props&&_.props.type);if(E.getSSRProps)return E.getSSRProps(u,_)}}const kk=["ctrl","shift","alt","meta"],Ok={stop:u=>u.stopPropagation(),prevent:u=>u.preventDefault(),self:u=>u.target!==u.currentTarget,ctrl:u=>!u.ctrlKey,shift:u=>!u.shiftKey,alt:u=>!u.altKey,meta:u=>!u.metaKey,left:u=>"button"in u&&u.button!==0,middle:u=>"button"in u&&u.button!==1,right:u=>"button"in u&&u.button!==2,exact:(u,_)=>kk.some(E=>u[`${E}Key`]&&!_.includes(E))},I_=(u,_)=>{const E=u._withMods||(u._withMods={}),m=_.join(".");return E[m]||(E[m]=(T,...f)=>{for(let x=0;x<_.length;x++){const A=Ok[_[x]];if(A&&A(T,_))return}return u(T,...f)})},Rk={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Lk=(u,_)=>{const E=u._withKeys||(u._withKeys={}),m=_.join(".");return E[m]||(E[m]=T=>{if(!("key"in T))return;const f=Gs(T.key);if(_.some(x=>x===f||Rk[x]===f))return u(T)})},JS=Wi({patchProp:vk},ek);let dp,PT=!1;function QS(){return dp||(dp=xS(JS))}function eM(){return dp=PT?dp:bS(JS),PT=!0,dp}const B0=(...u)=>{QS().render(...u)},tM=(...u)=>{eM().hydrate(...u)},nM=(...u)=>{const _=QS().createApp(...u),{mount:E}=_;return _.mount=m=>{const T=iM(m);if(!T)return;const f=_._component;!Mr(f)&&!f.render&&!f.template&&(f.template=T.innerHTML),T.innerHTML="";const x=E(T,!1,rM(T));return T instanceof Element&&(T.removeAttribute("v-cloak"),T.setAttribute("data-v-app","")),x},_},zk=(...u)=>{const _=eM().createApp(...u),{mount:E}=_;return _.mount=m=>{const T=iM(m);if(T)return E(T,!0,rM(T))},_};function rM(u){if(u instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&u instanceof MathMLElement)return"mathml"}function iM(u){return Zi(u)?document.querySelector(u):u}let DT=!1;const Fk=()=>{DT||(DT=!0,Dk(),ok())};/**
* vue v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const Bk=()=>{},Nk=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:XE,BaseTransitionPropsValidators:vv,Comment:Jo,DeprecationTypes:K3,EffectScope:tv,ErrorCodes:wD,ErrorTypeStrings:G3,Fragment:zi,KeepAlive:YD,ReactiveEffect:vd,Static:sh,Suspense:BD,Teleport:P3,Text:hh,TrackOpTypes:vD,Transition:Mv,TransitionGroup:Sk,TriggerOpTypes:xD,VueElement:cg,assertNumber:bD,callWithAsyncErrorHandling:Hs,callWithErrorHandling:ql,camelize:ls,capitalize:Pp,cloneVNode:fl,compatUtils:X3,compile:Bk,computed:Mi,createApp:nM,createBlock:Tv,createCommentVNode:sg,createElementBlock:Pr,createElementVNode:Ct,createHydrationRenderer:bS,createPropsRestProxy:c3,createRenderer:xS,createSSRApp:zk,createSlots:KD,createStaticVNode:PS,createTextVNode:og,createVNode:cr,customRef:OE,defineAsyncComponent:WD,defineComponent:Id,defineCustomElement:HS,defineEmits:e3,defineExpose:t3,defineModel:i3,defineOptions:n3,defineProps:QD,defineSSRCustomElement:bk,defineSlots:r3,devtools:H3,effect:UP,effectScope:nv,getCurrentInstance:Jl,getCurrentScope:rv,getTransitionRawChildren:Q_,guardReactiveProps:CS,h:lg,handleError:yh,hasInjectionContext:pS,hydrate:tM,initCustomFormatter:V3,initDirectivesForSSR:Fk,inject:sa,isMemoSame:zS,isProxy:cv,isReactive:Hl,isReadonly:ah,isRef:ro,isRuntimeOnly:F3,isShallow:gp,isVNode:Yc,markRaw:kp,mergeDefaults:a3,mergeModels:l3,mergeProps:Sv,nextTick:Ad,normalizeClass:ys,normalizeProps:FP,normalizeStyle:Dp,onActivated:JE,onBeforeMount:tS,onBeforeUnmount:ng,onBeforeUpdate:nS,onDeactivated:QE,onErrorCaptured:sS,onMounted:Kl,onRenderTracked:oS,onRenderTriggered:iS,onScopeDispose:_E,onServerPrefetch:rS,onUnmounted:rg,onUpdated:tg,openBlock:gr,popScopeId:Yl,provide:cp,proxyRefs:dv,pushScopeId:Zl,queuePostFlushCb:L_,reactive:za,readonly:lv,ref:Yr,registerRuntimeCompiler:z3,render:B0,renderList:uh,renderSlot:aS,resolveComponent:VE,resolveDirective:zD,resolveDynamicComponent:LD,resolveFilter:Y3,resolveTransitionHooks:xd,setBlockTracking:P0,setDevtoolsHook:q3,setTransitionHooks:ch,shallowReactive:av,shallowReadonly:cD,shallowRef:DE,ssrContextKey:HE,ssrUtils:Z3,stop:$P,toDisplayString:Gc,toHandlerKey:ap,toHandlers:cS,toRaw:Xr,toRef:yD,toRefs:RE,toValue:fD,transformVNodeArgs:D3,triggerRef:dD,unref:$i,useAttrs:s3,useCssModule:Tk,useCssVars:sk,useModel:j3,useSSRContext:qE,useSlots:uS,useTransitionState:yv,vModelCheckbox:Sp,vModelDynamic:XS,vModelRadio:Av,vModelSelect:Iv,vModelText:ph,vShow:$S,version:FS,warn:$3,watch:qc,watchEffect:GD,watchPostEffect:WE,watchSyncEffect:ZE,withAsyncContext:u3,withCtx:wp,withDefaults:o3,withDirectives:lh,withKeys:Lk,withMemo:U3,withModifiers:I_,withScopeId:CD},Symbol.toStringTag,{value:"Module"}));var jk=!1;/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let oM;const ug=u=>oM=u,sM=Symbol();function N0(u){return u&&typeof u=="object"&&Object.prototype.toString.call(u)==="[object Object]"&&typeof u.toJSON!="function"}var fp;(function(u){u.direct="direct",u.patchObject="patch object",u.patchFunction="patch function"})(fp||(fp={}));function Vk(){const u=nv(!0),_=u.run(()=>Yr({}));let E=[],m=[];const T=kp({install(f){ug(T),T._a=f,f.provide(sM,T),f.config.globalProperties.$pinia=T,m.forEach(x=>E.push(x)),m=[]},use(f){return!this._a&&!jk?m.push(f):E.push(f),this},_p:E,_a:null,_e:u,_s:new Map,state:_});return T}const aM=()=>{};function kT(u,_,E,m=aM){u.push(_);const T=()=>{const f=u.indexOf(_);f>-1&&(u.splice(f,1),m())};return!E&&rv()&&_E(T),T}function ad(u,..._){u.slice().forEach(E=>{E(..._)})}const Uk=u=>u();function j0(u,_){u instanceof Map&&_ instanceof Map&&_.forEach((E,m)=>u.set(m,E)),u instanceof Set&&_ instanceof Set&&_.forEach(u.add,u);for(const E in _){if(!_.hasOwnProperty(E))continue;const m=_[E],T=u[E];N0(T)&&N0(m)&&u.hasOwnProperty(E)&&!ro(m)&&!Hl(m)?u[E]=j0(T,m):u[E]=m}return u}const $k=Symbol();function Gk(u){return!N0(u)||!u.hasOwnProperty($k)}const{assign:Bc}=Object;function Hk(u){return!!(ro(u)&&u.effect)}function qk(u,_,E,m){const{state:T,actions:f,getters:x}=_,A=E.state.value[u];let i;function P(){A||(E.state.value[u]=T?T():{});const O=RE(E.state.value[u]);return Bc(O,f,Object.keys(x||{}).reduce((L,U)=>(L[U]=kp(Mi(()=>{ug(E);const j=E._s.get(u);return x[U].call(j,j)})),L),{}))}return i=lM(u,P,_,E,m,!0),i}function lM(u,_,E={},m,T,f){let x;const A=Bc({actions:{}},E),i={deep:!0};let P,O,L=[],U=[],j;const W=m.state.value[u];!f&&!W&&(m.state.value[u]={}),Yr({});let J;function fe(Ce){let ve;P=O=!1,typeof Ce=="function"?(Ce(m.state.value[u]),ve={type:fp.patchFunction,storeId:u,events:j}):(j0(m.state.value[u],Ce),ve={type:fp.patchObject,payload:Ce,storeId:u,events:j});const Te=J=Symbol();Ad().then(()=>{J===Te&&(P=!0)}),O=!0,ad(L,ve,m.state.value[u])}const _e=f?function(){const{state:ve}=E,Te=ve?ve():{};this.$patch(Ye=>{Bc(Ye,Te)})}:aM;function we(){x.stop(),L=[],U=[],m._s.delete(u)}function ye(Ce,ve){return function(){ug(m);const Te=Array.from(arguments),Ye=[],Oe=[];function lt(Tt){Ye.push(Tt)}function Ht(Tt){Oe.push(Tt)}ad(U,{args:Te,name:Ce,store:Fe,after:lt,onError:Ht});let nt;try{nt=ve.apply(this&&this.$id===u?this:Fe,Te)}catch(Tt){throw ad(Oe,Tt),Tt}return nt instanceof Promise?nt.then(Tt=>(ad(Ye,Tt),Tt)).catch(Tt=>(ad(Oe,Tt),Promise.reject(Tt))):(ad(Ye,nt),nt)}}const Pe={_p:m,$id:u,$onAction:kT.bind(null,U),$patch:fe,$reset:_e,$subscribe(Ce,ve={}){const Te=kT(L,Ce,ve.detached,()=>Ye()),Ye=x.run(()=>qc(()=>m.state.value[u],Oe=>{(ve.flush==="sync"?O:P)&&Ce({storeId:u,type:fp.direct,events:j},Oe)},Bc({},i,ve)));return Te},$dispose:we},Fe=za(Pe);m._s.set(u,Fe);const He=(m._a&&m._a.runWithContext||Uk)(()=>m._e.run(()=>(x=nv()).run(_)));for(const Ce in He){const ve=He[Ce];if(ro(ve)&&!Hk(ve)||Hl(ve))f||(W&&Gk(ve)&&(ro(ve)?ve.value=W[Ce]:j0(ve,W[Ce])),m.state.value[u][Ce]=ve);else if(typeof ve=="function"){const Te=ye(Ce,ve);He[Ce]=Te,A.actions[Ce]=ve}}return Bc(Fe,He),Bc(Xr(Fe),He),Object.defineProperty(Fe,"$state",{get:()=>m.state.value[u],set:Ce=>{fe(ve=>{Bc(ve,Ce)})}}),m._p.forEach(Ce=>{Bc(Fe,x.run(()=>Ce({store:Fe,app:m._a,pinia:m,options:A})))}),W&&f&&E.hydrate&&E.hydrate(Fe.$state,W),P=!0,O=!0,Fe}function Cv(u,_,E){let m,T;const f=typeof _=="function";typeof u=="string"?(m=u,T=f?E:_):(T=u,m=u.id);function x(A,i){const P=pS();return A=A||(P?sa(sM,null):null),A&&ug(A),A=oM,A._s.has(m)||(f?lM(m,_,T,A):qk(m,T,A)),A._s.get(m)}return x.$id=m,x}/*!
  * vue-router v4.3.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const cd=typeof document<"u";function Wk(u){return u.__esModule||u[Symbol.toStringTag]==="Module"}const Ei=Object.assign;function d0(u,_){const E={};for(const m in _){const T=_[m];E[m]=Fa(T)?T.map(u):u(T)}return E}const pp=()=>{},Fa=Array.isArray,cM=/#/g,Zk=/&/g,Yk=/\//g,Xk=/=/g,Kk=/\?/g,uM=/\+/g,Jk=/%5B/g,Qk=/%5D/g,hM=/%5E/g,eO=/%60/g,dM=/%7B/g,tO=/%7C/g,fM=/%7D/g,nO=/%20/g;function Pv(u){return encodeURI(""+u).replace(tO,"|").replace(Jk,"[").replace(Qk,"]")}function rO(u){return Pv(u).replace(dM,"{").replace(fM,"}").replace(hM,"^")}function V0(u){return Pv(u).replace(uM,"%2B").replace(nO,"+").replace(cM,"%23").replace(Zk,"%26").replace(eO,"`").replace(dM,"{").replace(fM,"}").replace(hM,"^")}function iO(u){return V0(u).replace(Xk,"%3D")}function oO(u){return Pv(u).replace(cM,"%23").replace(Kk,"%3F")}function sO(u){return u==null?"":oO(u).replace(Yk,"%2F")}function Mp(u){try{return decodeURIComponent(""+u)}catch{}return""+u}const aO=/\/$/,lO=u=>u.replace(aO,"");function f0(u,_,E="/"){let m,T={},f="",x="";const A=_.indexOf("#");let i=_.indexOf("?");return A<i&&A>=0&&(i=-1),i>-1&&(m=_.slice(0,i),f=_.slice(i+1,A>-1?A:_.length),T=u(f)),A>-1&&(m=m||_.slice(0,A),x=_.slice(A,_.length)),m=dO(m??_,E),{fullPath:m+(f&&"?")+f+x,path:m,query:T,hash:Mp(x)}}function cO(u,_){const E=_.query?u(_.query):"";return _.path+(E&&"?")+E+(_.hash||"")}function OT(u,_){return!_||!u.toLowerCase().startsWith(_.toLowerCase())?u:u.slice(_.length)||"/"}function uO(u,_,E){const m=_.matched.length-1,T=E.matched.length-1;return m>-1&&m===T&&Td(_.matched[m],E.matched[T])&&pM(_.params,E.params)&&u(_.query)===u(E.query)&&_.hash===E.hash}function Td(u,_){return(u.aliasOf||u)===(_.aliasOf||_)}function pM(u,_){if(Object.keys(u).length!==Object.keys(_).length)return!1;for(const E in u)if(!hO(u[E],_[E]))return!1;return!0}function hO(u,_){return Fa(u)?RT(u,_):Fa(_)?RT(_,u):u===_}function RT(u,_){return Fa(_)?u.length===_.length&&u.every((E,m)=>E===_[m]):u.length===1&&u[0]===_}function dO(u,_){if(u.startsWith("/"))return u;if(!u)return _;const E=_.split("/"),m=u.split("/"),T=m[m.length-1];(T===".."||T===".")&&m.push("");let f=E.length-1,x,A;for(x=0;x<m.length;x++)if(A=m[x],A!==".")if(A==="..")f>1&&f--;else break;return E.slice(0,f).join("/")+"/"+m.slice(x).join("/")}var Ap;(function(u){u.pop="pop",u.push="push"})(Ap||(Ap={}));var mp;(function(u){u.back="back",u.forward="forward",u.unknown=""})(mp||(mp={}));function fO(u){if(!u)if(cd){const _=document.querySelector("base");u=_&&_.getAttribute("href")||"/",u=u.replace(/^\w+:\/\/[^\/]+/,"")}else u="/";return u[0]!=="/"&&u[0]!=="#"&&(u="/"+u),lO(u)}const pO=/^[^#]+#/;function mO(u,_){return u.replace(pO,"#")+_}function _O(u,_){const E=document.documentElement.getBoundingClientRect(),m=u.getBoundingClientRect();return{behavior:_.behavior,left:m.left-E.left-(_.left||0),top:m.top-E.top-(_.top||0)}}const hg=()=>({left:window.scrollX,top:window.scrollY});function gO(u){let _;if("el"in u){const E=u.el,m=typeof E=="string"&&E.startsWith("#"),T=typeof E=="string"?m?document.getElementById(E.slice(1)):document.querySelector(E):E;if(!T)return;_=_O(T,u)}else _=u;"scrollBehavior"in document.documentElement.style?window.scrollTo(_):window.scrollTo(_.left!=null?_.left:window.scrollX,_.top!=null?_.top:window.scrollY)}function LT(u,_){return(history.state?history.state.position-_:-1)+u}const U0=new Map;function yO(u,_){U0.set(u,_)}function vO(u){const _=U0.get(u);return U0.delete(u),_}let xO=()=>location.protocol+"//"+location.host;function mM(u,_){const{pathname:E,search:m,hash:T}=_,f=u.indexOf("#");if(f>-1){let A=T.includes(u.slice(f))?u.slice(f).length:1,i=T.slice(A);return i[0]!=="/"&&(i="/"+i),OT(i,"")}return OT(E,u)+m+T}function bO(u,_,E,m){let T=[],f=[],x=null;const A=({state:U})=>{const j=mM(u,location),W=E.value,J=_.value;let fe=0;if(U){if(E.value=j,_.value=U,x&&x===W){x=null;return}fe=J?U.position-J.position:0}else m(j);T.forEach(_e=>{_e(E.value,W,{delta:fe,type:Ap.pop,direction:fe?fe>0?mp.forward:mp.back:mp.unknown})})};function i(){x=E.value}function P(U){T.push(U);const j=()=>{const W=T.indexOf(U);W>-1&&T.splice(W,1)};return f.push(j),j}function O(){const{history:U}=window;U.state&&U.replaceState(Ei({},U.state,{scroll:hg()}),"")}function L(){for(const U of f)U();f=[],window.removeEventListener("popstate",A),window.removeEventListener("beforeunload",O)}return window.addEventListener("popstate",A),window.addEventListener("beforeunload",O,{passive:!0}),{pauseListeners:i,listen:P,destroy:L}}function zT(u,_,E,m=!1,T=!1){return{back:u,current:_,forward:E,replaced:m,position:window.history.length,scroll:T?hg():null}}function wO(u){const{history:_,location:E}=window,m={value:mM(u,E)},T={value:_.state};T.value||f(m.value,{back:null,current:m.value,forward:null,position:_.length-1,replaced:!0,scroll:null},!0);function f(i,P,O){const L=u.indexOf("#"),U=L>-1?(E.host&&document.querySelector("base")?u:u.slice(L))+i:xO()+u+i;try{_[O?"replaceState":"pushState"](P,"",U),T.value=P}catch(j){console.error(j),E[O?"replace":"assign"](U)}}function x(i,P){const O=Ei({},_.state,zT(T.value.back,i,T.value.forward,!0),P,{position:T.value.position});f(i,O,!0),m.value=i}function A(i,P){const O=Ei({},T.value,_.state,{forward:i,scroll:hg()});f(O.current,O,!0);const L=Ei({},zT(m.value,i,null),{position:O.position+1},P);f(i,L,!1),m.value=i}return{location:m,state:T,push:A,replace:x}}function TO(u){u=fO(u);const _=wO(u),E=bO(u,_.state,_.location,_.replace);function m(f,x=!0){x||E.pauseListeners(),history.go(f)}const T=Ei({location:"",base:u,go:m,createHref:mO.bind(null,u)},_,E);return Object.defineProperty(T,"location",{enumerable:!0,get:()=>_.location.value}),Object.defineProperty(T,"state",{enumerable:!0,get:()=>_.state.value}),T}function EO(u){return typeof u=="string"||u&&typeof u=="object"}function _M(u){return typeof u=="string"||typeof u=="symbol"}const Lc={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},gM=Symbol("");var FT;(function(u){u[u.aborted=4]="aborted",u[u.cancelled=8]="cancelled",u[u.duplicated=16]="duplicated"})(FT||(FT={}));function Ed(u,_){return Ei(new Error,{type:u,[gM]:!0},_)}function Vl(u,_){return u instanceof Error&&gM in u&&(_==null||!!(u.type&_))}const BT="[^/]+?",SO={sensitive:!1,strict:!1,start:!0,end:!0},MO=/[.+*?^${}()[\]/\\]/g;function AO(u,_){const E=Ei({},SO,_),m=[];let T=E.start?"^":"";const f=[];for(const P of u){const O=P.length?[]:[90];E.strict&&!P.length&&(T+="/");for(let L=0;L<P.length;L++){const U=P[L];let j=40+(E.sensitive?.25:0);if(U.type===0)L||(T+="/"),T+=U.value.replace(MO,"\\$&"),j+=40;else if(U.type===1){const{value:W,repeatable:J,optional:fe,regexp:_e}=U;f.push({name:W,repeatable:J,optional:fe});const we=_e||BT;if(we!==BT){j+=10;try{new RegExp(`(${we})`)}catch(Pe){throw new Error(`Invalid custom RegExp for param "${W}" (${we}): `+Pe.message)}}let ye=J?`((?:${we})(?:/(?:${we}))*)`:`(${we})`;L||(ye=fe&&P.length<2?`(?:/${ye})`:"/"+ye),fe&&(ye+="?"),T+=ye,j+=20,fe&&(j+=-8),J&&(j+=-20),we===".*"&&(j+=-50)}O.push(j)}m.push(O)}if(E.strict&&E.end){const P=m.length-1;m[P][m[P].length-1]+=.7000000000000001}E.strict||(T+="/?"),E.end?T+="$":E.strict&&(T+="(?:/|$)");const x=new RegExp(T,E.sensitive?"":"i");function A(P){const O=P.match(x),L={};if(!O)return null;for(let U=1;U<O.length;U++){const j=O[U]||"",W=f[U-1];L[W.name]=j&&W.repeatable?j.split("/"):j}return L}function i(P){let O="",L=!1;for(const U of u){(!L||!O.endsWith("/"))&&(O+="/"),L=!1;for(const j of U)if(j.type===0)O+=j.value;else if(j.type===1){const{value:W,repeatable:J,optional:fe}=j,_e=W in P?P[W]:"";if(Fa(_e)&&!J)throw new Error(`Provided param "${W}" is an array but it is not repeatable (* or + modifiers)`);const we=Fa(_e)?_e.join("/"):_e;if(!we)if(fe)U.length<2&&(O.endsWith("/")?O=O.slice(0,-1):L=!0);else throw new Error(`Missing required param "${W}"`);O+=we}}return O||"/"}return{re:x,score:m,keys:f,parse:A,stringify:i}}function IO(u,_){let E=0;for(;E<u.length&&E<_.length;){const m=_[E]-u[E];if(m)return m;E++}return u.length<_.length?u.length===1&&u[0]===80?-1:1:u.length>_.length?_.length===1&&_[0]===80?1:-1:0}function CO(u,_){let E=0;const m=u.score,T=_.score;for(;E<m.length&&E<T.length;){const f=IO(m[E],T[E]);if(f)return f;E++}if(Math.abs(T.length-m.length)===1){if(NT(m))return 1;if(NT(T))return-1}return T.length-m.length}function NT(u){const _=u[u.length-1];return u.length>0&&_[_.length-1]<0}const PO={type:0,value:""},DO=/[a-zA-Z0-9_]/;function kO(u){if(!u)return[[]];if(u==="/")return[[PO]];if(!u.startsWith("/"))throw new Error(`Invalid path "${u}"`);function _(j){throw new Error(`ERR (${E})/"${P}": ${j}`)}let E=0,m=E;const T=[];let f;function x(){f&&T.push(f),f=[]}let A=0,i,P="",O="";function L(){P&&(E===0?f.push({type:0,value:P}):E===1||E===2||E===3?(f.length>1&&(i==="*"||i==="+")&&_(`A repeatable param (${P}) must be alone in its segment. eg: '/:ids+.`),f.push({type:1,value:P,regexp:O,repeatable:i==="*"||i==="+",optional:i==="*"||i==="?"})):_("Invalid state to consume buffer"),P="")}function U(){P+=i}for(;A<u.length;){if(i=u[A++],i==="\\"&&E!==2){m=E,E=4;continue}switch(E){case 0:i==="/"?(P&&L(),x()):i===":"?(L(),E=1):U();break;case 4:U(),E=m;break;case 1:i==="("?E=2:DO.test(i)?U():(L(),E=0,i!=="*"&&i!=="?"&&i!=="+"&&A--);break;case 2:i===")"?O[O.length-1]=="\\"?O=O.slice(0,-1)+i:E=3:O+=i;break;case 3:L(),E=0,i!=="*"&&i!=="?"&&i!=="+"&&A--,O="";break;default:_("Unknown state");break}}return E===2&&_(`Unfinished custom RegExp for param "${P}"`),L(),x(),T}function OO(u,_,E){const m=AO(kO(u.path),E),T=Ei(m,{record:u,parent:_,children:[],alias:[]});return _&&!T.record.aliasOf==!_.record.aliasOf&&_.children.push(T),T}function RO(u,_){const E=[],m=new Map;_=UT({strict:!1,end:!0,sensitive:!1},_);function T(O){return m.get(O)}function f(O,L,U){const j=!U,W=LO(O);W.aliasOf=U&&U.record;const J=UT(_,O),fe=[W];if("alias"in O){const ye=typeof O.alias=="string"?[O.alias]:O.alias;for(const Pe of ye)fe.push(Ei({},W,{components:U?U.record.components:W.components,path:Pe,aliasOf:U?U.record:W}))}let _e,we;for(const ye of fe){const{path:Pe}=ye;if(L&&Pe[0]!=="/"){const Fe=L.record.path,Be=Fe[Fe.length-1]==="/"?"":"/";ye.path=L.record.path+(Pe&&Be+Pe)}if(_e=OO(ye,L,J),U?U.alias.push(_e):(we=we||_e,we!==_e&&we.alias.push(_e),j&&O.name&&!VT(_e)&&x(O.name)),W.children){const Fe=W.children;for(let Be=0;Be<Fe.length;Be++)f(Fe[Be],_e,U&&U.children[Be])}U=U||_e,(_e.record.components&&Object.keys(_e.record.components).length||_e.record.name||_e.record.redirect)&&i(_e)}return we?()=>{x(we)}:pp}function x(O){if(_M(O)){const L=m.get(O);L&&(m.delete(O),E.splice(E.indexOf(L),1),L.children.forEach(x),L.alias.forEach(x))}else{const L=E.indexOf(O);L>-1&&(E.splice(L,1),O.record.name&&m.delete(O.record.name),O.children.forEach(x),O.alias.forEach(x))}}function A(){return E}function i(O){let L=0;for(;L<E.length&&CO(O,E[L])>=0&&(O.record.path!==E[L].record.path||!yM(O,E[L]));)L++;E.splice(L,0,O),O.record.name&&!VT(O)&&m.set(O.record.name,O)}function P(O,L){let U,j={},W,J;if("name"in O&&O.name){if(U=m.get(O.name),!U)throw Ed(1,{location:O});J=U.record.name,j=Ei(jT(L.params,U.keys.filter(we=>!we.optional).concat(U.parent?U.parent.keys.filter(we=>we.optional):[]).map(we=>we.name)),O.params&&jT(O.params,U.keys.map(we=>we.name))),W=U.stringify(j)}else if(O.path!=null)W=O.path,U=E.find(we=>we.re.test(W)),U&&(j=U.parse(W),J=U.record.name);else{if(U=L.name?m.get(L.name):E.find(we=>we.re.test(L.path)),!U)throw Ed(1,{location:O,currentLocation:L});J=U.record.name,j=Ei({},L.params,O.params),W=U.stringify(j)}const fe=[];let _e=U;for(;_e;)fe.unshift(_e.record),_e=_e.parent;return{name:J,path:W,params:j,matched:fe,meta:FO(fe)}}return u.forEach(O=>f(O)),{addRoute:f,resolve:P,removeRoute:x,getRoutes:A,getRecordMatcher:T}}function jT(u,_){const E={};for(const m of _)m in u&&(E[m]=u[m]);return E}function LO(u){return{path:u.path,redirect:u.redirect,name:u.name,meta:u.meta||{},aliasOf:void 0,beforeEnter:u.beforeEnter,props:zO(u),children:u.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in u?u.components||null:u.component&&{default:u.component}}}function zO(u){const _={},E=u.props||!1;if("component"in u)_.default=E;else for(const m in u.components)_[m]=typeof E=="object"?E[m]:E;return _}function VT(u){for(;u;){if(u.record.aliasOf)return!0;u=u.parent}return!1}function FO(u){return u.reduce((_,E)=>Ei(_,E.meta),{})}function UT(u,_){const E={};for(const m in u)E[m]=m in _?_[m]:u[m];return E}function yM(u,_){return _.children.some(E=>E===u||yM(u,E))}function BO(u){const _={};if(u===""||u==="?")return _;const m=(u[0]==="?"?u.slice(1):u).split("&");for(let T=0;T<m.length;++T){const f=m[T].replace(uM," "),x=f.indexOf("="),A=Mp(x<0?f:f.slice(0,x)),i=x<0?null:Mp(f.slice(x+1));if(A in _){let P=_[A];Fa(P)||(P=_[A]=[P]),P.push(i)}else _[A]=i}return _}function $T(u){let _="";for(let E in u){const m=u[E];if(E=iO(E),m==null){m!==void 0&&(_+=(_.length?"&":"")+E);continue}(Fa(m)?m.map(f=>f&&V0(f)):[m&&V0(m)]).forEach(f=>{f!==void 0&&(_+=(_.length?"&":"")+E,f!=null&&(_+="="+f))})}return _}function NO(u){const _={};for(const E in u){const m=u[E];m!==void 0&&(_[E]=Fa(m)?m.map(T=>T==null?null:""+T):m==null?m:""+m)}return _}const jO=Symbol(""),GT=Symbol(""),dg=Symbol(""),vM=Symbol(""),$0=Symbol("");function rp(){let u=[];function _(m){return u.push(m),()=>{const T=u.indexOf(m);T>-1&&u.splice(T,1)}}function E(){u=[]}return{add:_,list:()=>u.slice(),reset:E}}function $c(u,_,E,m,T,f=x=>x()){const x=m&&(m.enterCallbacks[T]=m.enterCallbacks[T]||[]);return()=>new Promise((A,i)=>{const P=U=>{U===!1?i(Ed(4,{from:E,to:_})):U instanceof Error?i(U):EO(U)?i(Ed(2,{from:_,to:U})):(x&&m.enterCallbacks[T]===x&&typeof U=="function"&&x.push(U),A())},O=f(()=>u.call(m&&m.instances[T],_,E,P));let L=Promise.resolve(O);u.length<3&&(L=L.then(P)),L.catch(U=>i(U))})}function p0(u,_,E,m,T=f=>f()){const f=[];for(const x of u)for(const A in x.components){let i=x.components[A];if(!(_!=="beforeRouteEnter"&&!x.instances[A]))if(VO(i)){const O=(i.__vccOpts||i)[_];O&&f.push($c(O,E,m,x,A,T))}else{let P=i();f.push(()=>P.then(O=>{if(!O)return Promise.reject(new Error(`Couldn't resolve component "${A}" at "${x.path}"`));const L=Wk(O)?O.default:O;x.components[A]=L;const j=(L.__vccOpts||L)[_];return j&&$c(j,E,m,x,A,T)()}))}}return f}function VO(u){return typeof u=="object"||"displayName"in u||"props"in u||"__vccOpts"in u}function HT(u){const _=sa(dg),E=sa(vM),m=Mi(()=>_.resolve($i(u.to))),T=Mi(()=>{const{matched:i}=m.value,{length:P}=i,O=i[P-1],L=E.matched;if(!O||!L.length)return-1;const U=L.findIndex(Td.bind(null,O));if(U>-1)return U;const j=qT(i[P-2]);return P>1&&qT(O)===j&&L[L.length-1].path!==j?L.findIndex(Td.bind(null,i[P-2])):U}),f=Mi(()=>T.value>-1&&HO(E.params,m.value.params)),x=Mi(()=>T.value>-1&&T.value===E.matched.length-1&&pM(E.params,m.value.params));function A(i={}){return GO(i)?_[$i(u.replace)?"replace":"push"]($i(u.to)).catch(pp):Promise.resolve()}return{route:m,href:Mi(()=>m.value.href),isActive:f,isExactActive:x,navigate:A}}const UO=Id({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:HT,setup(u,{slots:_}){const E=za(HT(u)),{options:m}=sa(dg),T=Mi(()=>({[WT(u.activeClass,m.linkActiveClass,"router-link-active")]:E.isActive,[WT(u.exactActiveClass,m.linkExactActiveClass,"router-link-exact-active")]:E.isExactActive}));return()=>{const f=_.default&&_.default(E);return u.custom?f:lg("a",{"aria-current":E.isExactActive?u.ariaCurrentValue:null,href:E.href,onClick:E.navigate,class:T.value},f)}}}),$O=UO;function GO(u){if(!(u.metaKey||u.altKey||u.ctrlKey||u.shiftKey)&&!u.defaultPrevented&&!(u.button!==void 0&&u.button!==0)){if(u.currentTarget&&u.currentTarget.getAttribute){const _=u.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(_))return}return u.preventDefault&&u.preventDefault(),!0}}function HO(u,_){for(const E in _){const m=_[E],T=u[E];if(typeof m=="string"){if(m!==T)return!1}else if(!Fa(T)||T.length!==m.length||m.some((f,x)=>f!==T[x]))return!1}return!0}function qT(u){return u?u.aliasOf?u.aliasOf.path:u.path:""}const WT=(u,_,E)=>u??_??E,qO=Id({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(u,{attrs:_,slots:E}){const m=sa($0),T=Mi(()=>u.route||m.value),f=sa(GT,0),x=Mi(()=>{let P=$i(f);const{matched:O}=T.value;let L;for(;(L=O[P])&&!L.components;)P++;return P}),A=Mi(()=>T.value.matched[x.value]);cp(GT,Mi(()=>x.value+1)),cp(jO,A),cp($0,T);const i=Yr();return qc(()=>[i.value,A.value,u.name],([P,O,L],[U,j,W])=>{O&&(O.instances[L]=P,j&&j!==O&&P&&P===U&&(O.leaveGuards.size||(O.leaveGuards=j.leaveGuards),O.updateGuards.size||(O.updateGuards=j.updateGuards))),P&&O&&(!j||!Td(O,j)||!U)&&(O.enterCallbacks[L]||[]).forEach(J=>J(P))},{flush:"post"}),()=>{const P=T.value,O=u.name,L=A.value,U=L&&L.components[O];if(!U)return ZT(E.default,{Component:U,route:P});const j=L.props[O],W=j?j===!0?P.params:typeof j=="function"?j(P):j:null,fe=lg(U,Ei({},W,_,{onVnodeUnmounted:_e=>{_e.component.isUnmounted&&(L.instances[O]=null)},ref:i}));return ZT(E.default,{Component:fe,route:P})||fe}}});function ZT(u,_){if(!u)return null;const E=u(_);return E.length===1?E[0]:E}const G0=qO;function WO(u){const _=RO(u.routes,u),E=u.parseQuery||BO,m=u.stringifyQuery||$T,T=u.history,f=rp(),x=rp(),A=rp(),i=DE(Lc);let P=Lc;cd&&u.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const O=d0.bind(null,It=>""+It),L=d0.bind(null,sO),U=d0.bind(null,Mp);function j(It,mn){let on,an;return _M(It)?(on=_.getRecordMatcher(It),an=mn):an=It,_.addRoute(an,on)}function W(It){const mn=_.getRecordMatcher(It);mn&&_.removeRoute(mn)}function J(){return _.getRoutes().map(It=>It.record)}function fe(It){return!!_.getRecordMatcher(It)}function _e(It,mn){if(mn=Ei({},mn||i.value),typeof It=="string"){const Re=f0(E,It,mn.path),ft=_.resolve({path:Re.path},mn),Lt=T.createHref(Re.fullPath);return Ei(Re,ft,{params:U(ft.params),hash:Mp(Re.hash),redirectedFrom:void 0,href:Lt})}let on;if(It.path!=null)on=Ei({},It,{path:f0(E,It.path,mn.path).path});else{const Re=Ei({},It.params);for(const ft in Re)Re[ft]==null&&delete Re[ft];on=Ei({},It,{params:L(Re)}),mn.params=L(mn.params)}const an=_.resolve(on,mn),$n=It.hash||"";an.params=O(U(an.params));const Gn=cO(m,Ei({},It,{hash:rO($n),path:an.path})),De=T.createHref(Gn);return Ei({fullPath:Gn,hash:$n,query:m===$T?NO(It.query):It.query||{}},an,{redirectedFrom:void 0,href:De})}function we(It){return typeof It=="string"?f0(E,It,i.value.path):Ei({},It)}function ye(It,mn){if(P!==It)return Ed(8,{from:mn,to:It})}function Pe(It){return He(It)}function Fe(It){return Pe(Ei(we(It),{replace:!0}))}function Be(It){const mn=It.matched[It.matched.length-1];if(mn&&mn.redirect){const{redirect:on}=mn;let an=typeof on=="function"?on(It):on;return typeof an=="string"&&(an=an.includes("?")||an.includes("#")?an=we(an):{path:an},an.params={}),Ei({query:It.query,hash:It.hash,params:an.path!=null?{}:It.params},an)}}function He(It,mn){const on=P=_e(It),an=i.value,$n=It.state,Gn=It.force,De=It.replace===!0,Re=Be(on);if(Re)return He(Ei(we(Re),{state:typeof Re=="object"?Ei({},$n,Re.state):$n,force:Gn,replace:De}),mn||on);const ft=on;ft.redirectedFrom=mn;let Lt;return!Gn&&uO(m,an,on)&&(Lt=Ed(16,{to:ft,from:an}),Gr(an,an,!0,!1)),(Lt?Promise.resolve(Lt):Te(ft,an)).catch(Ot=>Vl(Ot)?Vl(Ot,2)?Ot:Kr(Ot):vt(Ot,ft,an)).then(Ot=>{if(Ot){if(Vl(Ot,2))return He(Ei({replace:De},we(Ot.to),{state:typeof Ot.to=="object"?Ei({},$n,Ot.to.state):$n,force:Gn}),mn||ft)}else Ot=Oe(ft,an,!0,De,$n);return Ye(ft,an,Ot),Ot})}function Ce(It,mn){const on=ye(It,mn);return on?Promise.reject(on):Promise.resolve()}function ve(It){const mn=Hr.values().next().value;return mn&&typeof mn.runWithContext=="function"?mn.runWithContext(It):It()}function Te(It,mn){let on;const[an,$n,Gn]=ZO(It,mn);on=p0(an.reverse(),"beforeRouteLeave",It,mn);for(const Re of an)Re.leaveGuards.forEach(ft=>{on.push($c(ft,It,mn))});const De=Ce.bind(null,It,mn);return on.push(De),zr(on).then(()=>{on=[];for(const Re of f.list())on.push($c(Re,It,mn));return on.push(De),zr(on)}).then(()=>{on=p0($n,"beforeRouteUpdate",It,mn);for(const Re of $n)Re.updateGuards.forEach(ft=>{on.push($c(ft,It,mn))});return on.push(De),zr(on)}).then(()=>{on=[];for(const Re of Gn)if(Re.beforeEnter)if(Fa(Re.beforeEnter))for(const ft of Re.beforeEnter)on.push($c(ft,It,mn));else on.push($c(Re.beforeEnter,It,mn));return on.push(De),zr(on)}).then(()=>(It.matched.forEach(Re=>Re.enterCallbacks={}),on=p0(Gn,"beforeRouteEnter",It,mn,ve),on.push(De),zr(on))).then(()=>{on=[];for(const Re of x.list())on.push($c(Re,It,mn));return on.push(De),zr(on)}).catch(Re=>Vl(Re,8)?Re:Promise.reject(Re))}function Ye(It,mn,on){A.list().forEach(an=>ve(()=>an(It,mn,on)))}function Oe(It,mn,on,an,$n){const Gn=ye(It,mn);if(Gn)return Gn;const De=mn===Lc,Re=cd?history.state:{};on&&(an||De?T.replace(It.fullPath,Ei({scroll:De&&Re&&Re.scroll},$n)):T.push(It.fullPath,$n)),i.value=It,Gr(It,mn,on,De),Kr()}let lt;function Ht(){lt||(lt=T.listen((It,mn,on)=>{if(!oi.listening)return;const an=_e(It),$n=Be(an);if($n){He(Ei($n,{replace:!0}),an).catch(pp);return}P=an;const Gn=i.value;cd&&yO(LT(Gn.fullPath,on.delta),hg()),Te(an,Gn).catch(De=>Vl(De,12)?De:Vl(De,2)?(He(De.to,an).then(Re=>{Vl(Re,20)&&!on.delta&&on.type===Ap.pop&&T.go(-1,!1)}).catch(pp),Promise.reject()):(on.delta&&T.go(-on.delta,!1),vt(De,an,Gn))).then(De=>{De=De||Oe(an,Gn,!1),De&&(on.delta&&!Vl(De,8)?T.go(-on.delta,!1):on.type===Ap.pop&&Vl(De,20)&&T.go(-1,!1)),Ye(an,Gn,De)}).catch(pp)}))}let nt=rp(),Tt=rp(),Rt;function vt(It,mn,on){Kr(It);const an=Tt.list();return an.length?an.forEach($n=>$n(It,mn,on)):console.error(It),Promise.reject(It)}function wr(){return Rt&&i.value!==Lc?Promise.resolve():new Promise((It,mn)=>{nt.add([It,mn])})}function Kr(It){return Rt||(Rt=!It,Ht(),nt.list().forEach(([mn,on])=>It?on(It):mn()),nt.reset()),It}function Gr(It,mn,on,an){const{scrollBehavior:$n}=u;if(!cd||!$n)return Promise.resolve();const Gn=!on&&vO(LT(It.fullPath,0))||(an||!on)&&history.state&&history.state.scroll||null;return Ad().then(()=>$n(It,mn,Gn)).then(De=>De&&gO(De)).catch(De=>vt(De,It,mn))}const Or=It=>T.go(It);let yi;const Hr=new Set,oi={currentRoute:i,listening:!0,addRoute:j,removeRoute:W,hasRoute:fe,getRoutes:J,resolve:_e,options:u,push:Pe,replace:Fe,go:Or,back:()=>Or(-1),forward:()=>Or(1),beforeEach:f.add,beforeResolve:x.add,afterEach:A.add,onError:Tt.add,isReady:wr,install(It){const mn=this;It.component("RouterLink",$O),It.component("RouterView",G0),It.config.globalProperties.$router=mn,Object.defineProperty(It.config.globalProperties,"$route",{enumerable:!0,get:()=>$i(i)}),cd&&!yi&&i.value===Lc&&(yi=!0,Pe(T.location).catch($n=>{}));const on={};for(const $n in Lc)Object.defineProperty(on,$n,{get:()=>i.value[$n],enumerable:!0});It.provide(dg,mn),It.provide(vM,av(on)),It.provide($0,i);const an=It.unmount;Hr.add(It),It.unmount=function(){Hr.delete(It),Hr.size<1&&(P=Lc,lt&&lt(),lt=null,i.value=Lc,yi=!1,Rt=!1),an()}}};function zr(It){return It.reduce((mn,on)=>mn.then(()=>ve(on)),Promise.resolve())}return oi}function ZO(u,_){const E=[],m=[],T=[],f=Math.max(_.matched.length,u.matched.length);for(let x=0;x<f;x++){const A=_.matched[x];A&&(u.matched.find(P=>Td(P,A))?m.push(A):E.push(A));const i=u.matched[x];i&&(_.matched.find(P=>Td(P,i))||T.push(i))}return[E,m,T]}function Dv(){return sa(dg)}const YO={__name:"App",setup(u){return localStorage.language="es",(_,E)=>(gr(),Pr(zi,null,[cr($i(G0)),cr($i(G0))],64))}},XO=["es","en"],KO=[["Seccin 1","Section 1"],["Seccin 2","Section 2"],["Seccin 3","Section 3"],["es-fot-1","en-fot-1"],["es-fot-2","en-fot-2"],["es-fot-3","en-fot-3"]],YT={languages:XO,dictionary:KO},ua=Cv("i18n",()=>{const u=za(YT.languages),_=za(YT.dictionary),E=Yr(f());function m(x){const A=_.findIndex(P=>P[0]===x),i=u.findIndex(P=>P===E.value);return A===-1||i===-1?x:_[A][i]}function T(x){u.includes(x)&&(E.value=x),localStorage.setItem("language",E.value)}function f(){return localStorage.getItem("language")||u[0]}return{_:m,languages:u,language:E,set:T,get:f}}),ca=Cv("data",()=>{const u=za({header:{es:{txt1:"Producto",txt2:"Contacto",txt3:"Blog",txt4:"Sobre nosotros",txt5:"Inscribirse",txt6:"Registrarse"},en:{txt1:"Product",txt2:"Contact",txt3:"Blog",txt4:"About",txt5:"Login",txt6:"Sign in"},links:{link1:"/product",link2:"/contact",link3:"/blog",link4:"/about",link5:"/login",link6:"/login"}},layer1:{es:{txt1:"Transformando la Experiencia de Viaje",txt2:"Encuentra el camino hacia tu viaje",txt3:"Organiza tu viaje ideal con nosotros"},en:{txt1:"Transforming the Travel Experience",txt2:"Find the way to your journey",txt3:"Organize your ideal trip with us"}},search:{es:{txt1:"Donde quieres ir de viaje?",txt2:"Generar viaje"},en:{txt1:"Where are you going to?",txt2:"Generate trip"}},aboutSection1:{es:{span1:"Descubre tu",span2:"prxima aventura",txt1:"Selecciona y personaliza tu viaje",txt2:"Comienza tu viaje"},en:{span1:"Discover your",span2:"next adventure",txt1:"Select and customize your trip",txt2:"Start your journey"}},aboutSection3:{es:{type0:{txt1:"Simplicidad en Accion",txt2:"Introduce un prompt, genera un plan de viaje",btn1:"Ver cmo"},type1:{txt1:"Emprende la aventura",txt2:"El mundo te espera, descbrelo",btn1:"nete Ahora",btn2:"Saber ms"}},en:{type0:{txt1:"Simplicity in Action",txt2:"Enter a prompt, generate a travel plan",btn1:"See how"},type1:{txt1:"Start the adventure",txt2:"The world awaits you, discover it",btn1:"Join Now",btn2:"Learn more"}}},aboutSection4:{es:{title1:"Propmt Inteligente",title2:"Aventuras a medida",title3:"Exploracin mundial",title4:"Itinerarios instantneos",txt1:"Tecnologa que convierte palabras en itinerarios",txt2:"Personalice sus viajes con la creatividad de la IA",txt3:"Descubra destinos gracias a la inteligencia artificial",txt4:"Generar rpidamente planes para cualquier ayuda"},en:{title1:"Propmt Inteligence",title2:"Custom Adventures",title3:"Global Exploration",title4:"Instant Itinieraries",txt1:"Technology that turns words into itineraries",txt2:"Personalize your travel with AI creativity",txt3:"Discover destinations throught AI insights",txt4:"Quickly generate plans for any help"}},footerTeo:{es:{txt1:"Todos los derechos reservados 2024"},en:{txt1:"All rights reserved 2024"}}});function _(E,m){return u[E][m]}return{get:_}}),JO="/assets/logo-CKH6eN2w.png",Ao=(u,_)=>{const E=u.__vccOpts||u;for(const[m,T]of _)E[m]=T;return E},QO=["value"],eR={__name:"traduction",setup(u){const _=ua(),E=localStorage.language?localStorage.language:"es",m=Yr(E);function T(f){_.set(f.target.value)}return(f,x)=>(gr(),Pr("div",null,[lh(Ct("select",{onChange:T,"onUpdate:modelValue":x[0]||(x[0]=A=>m.value=A)},[(gr(!0),Pr(zi,null,uh($i(_).languages,(A,i)=>(gr(),Pr("option",{key:i,value:A},Gc(A),9,QO))),128))],544),[[Iv,m.value]])]))}},xM=Ao(eR,[["__scopeId","data-v-af2f236d"]]),tR=u=>(Zl("data-v-597799ef"),u=u(),Yl(),u),nR=tR(()=>Ct("img",{src:"",alt:""},null,-1)),rR={id:"menu-content"},iR={id:"nav"},oR={id:"col1"},sR=["href","innerHTML"],aR={__name:"mobileMenu",setup(u){const _=ua(),E=Mi(()=>ca().get("header",_.language)),m=Mi(()=>ca().get("header","links")),T=Yr(Object.keys(E.value).length),f=Yr(!1),x=Yr(window.innerWidth);window.addEventListener("resize",()=>{window.innerWidth<=1200?x.value=!0:(x.value,f.value=!1)});function A(){f.value=!f.value}return(i,P)=>(gr(),Pr("div",null,[Ct("div",{id:"desp",onClick:A},[nR,og("= ")]),cr(xM,{id:"Mtraduction"}),x.value<=1200?(gr(),Pr("div",{key:0,id:"menu",class:ys({desplegar:f.value})},[Ct("div",rR,[Ct("nav",iR,[Ct("ul",oR,[(gr(!0),Pr(zi,null,uh(T.value,(O,L)=>(gr(),Pr("li",{key:L},[Ct("a",{href:m.value["link"+O],innerHTML:E.value["txt"+O]},null,8,sR)]))),128))])])])],2)):sg("",!0)]))}},lR=Ao(aR,[["__scopeId","data-v-597799ef"]]),cR={class:"logo"},uR={href:"/"},hR=["src"],dR={id:"col1"},fR=["href","innerHTML"],pR={id:"col2"},mR=["href","innerHTML"],XT=4,_R={__name:"HeaderComponent",setup(u){const _=ua(),E=ca(),m=Mi(()=>E.get("header",_.language)),T=Mi(()=>E.get("header","links")),f=Mi(()=>Object.keys(m.value).length);return(x,A)=>(gr(),Pr(zi,null,[cr(lR),Ct("header",null,[Ct("div",cR,[Ct("a",uR,[Ct("img",{src:$i(JO),alt:"logo"},null,8,hR)])]),Ct("ul",dR,[(gr(!0),Pr(zi,null,uh(Math.min(f.value,XT),(i,P)=>(gr(),Pr("li",{key:P},[Ct("a",{href:T.value["link"+i],innerHTML:m.value["txt"+i]},null,8,fR)]))),128))]),Ct("ul",pR,[cr(xM,{id:"traduction"}),(gr(!0),Pr(zi,null,uh(Math.max(0,f.value-XT),(i,P)=>(gr(),Pr("li",{key:P},[Ct("a",{href:T.value["link"+(f.value-P)],innerHTML:m.value["txt"+(f.value-P)]},null,8,mR)]))),128))])])],64))}},fg=Ao(_R,[["__scopeId","data-v-1b7d3dad"]]);var bM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gR(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}function yR(u){if(u.__esModule)return u;var _=u.default;if(typeof _=="function"){var E=function m(){return this instanceof m?Reflect.construct(_,arguments,this.constructor):_.apply(this,arguments)};E.prototype=_.prototype}else E={};return Object.defineProperty(E,"__esModule",{value:!0}),Object.keys(u).forEach(function(m){var T=Object.getOwnPropertyDescriptor(u,m);Object.defineProperty(E,m,T.get?T:{enumerable:!0,get:function(){return u[m]}})}),E}var wM={exports:{}};(function(u,_){var E={};(function(m,T){u.exports=T()})(bM,function(){var m,T,f;function x(i,P){if(!m)m=P;else if(!T)T=P;else{var O="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+m+")(sharedChunk); ("+T+")(sharedChunk); self.onerror = null;",L={};m(L),f=P(L),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(f.workerUrl=window.URL.createObjectURL(new Blob([O],{type:"text/javascript"})))}}x(["exports"],function(i){var P="3.3.0";let O;const L={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(O==null){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{O=E.API_URL_REGEX!=null?new RegExp(E.API_URL_REGEX):t}catch{O=t}}return O},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!L.API_URL)return null;try{const t=new URL(L.API_URL);return t.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":t.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"};function U(t){return L.API_URL_REGEX.test(t)}function j(t){return t.indexOf("mapbox:")===0}function W(t){return L.API_CDN_URL_REGEX.test(t)}function J(t){return L.API_SPRITE_REGEX.test(t)}function fe(t){return L.API_STYLE_REGEX.test(t)&&!J(t)}const _e={create:"create",load:"load",fullLoad:"fullLoad"};function we(t){const e=t.name.split("?")[0];return W(e)&&e.includes("mapbox-gl.js")?"javascript":W(e)&&e.includes("mapbox-gl.css")?"css":function(n){return L.API_FONTS_REGEX.test(n)}(e)?"fontRange":J(e)?"sprite":fe(e)?"style":function(n){return L.API_TILEJSON_REGEX.test(n)}(e)?"tilejson":"other"}function ye(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Pe=Fe;function Fe(t,e,n,o){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(o-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=n,this.p2y=o}Fe.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(e===void 0&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var n=t,o=0;o<8;o++){var a=this.sampleCurveX(n)-t;if(Math.abs(a)<e)return n;var l=this.sampleCurveDerivativeX(n);if(Math.abs(l)<1e-6)break;n-=a/l}var d=0,g=1;for(n=t,o=0;o<20&&(a=this.sampleCurveX(n),!(Math.abs(a-t)<e));o++)t>a?d=n:g=n,n=.5*(g-d)+d;return n},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var Be=ye(Pe),He=Ce;function Ce(t,e){this.x=t,this.y=e}Ce.prototype={clone:function(){return new Ce(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),o=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=o,this},_rotateAround:function(t,e){var n=Math.cos(t),o=Math.sin(t),a=e.y+o*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-o*(this.y-e.y),this.y=a,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ce.convert=function(t){return t instanceof Ce?t:Array.isArray(t)?new Ce(t[0],t[1]):t};var ve=ye(He);const Te=Math.PI/180,Ye=180/Math.PI;function Oe(t){return t*Te}function lt(t){return t*Ye}const Ht=[[0,0],[1,0],[1,1],[0,1]];function nt(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function Tt(t,e,n,o){const a=new Be(t,e,n,o);return function(l){return a.solve(l)}}const Rt=Tt(.25,.1,.25,1);function vt(t,e,n){return Math.min(n,Math.max(e,t))}function wr(t,e,n){return(n=vt((n-t)/(e-t),0,1))*n*(3-2*n)}function Kr(t,e,n){const o=n-e,a=((t-e)%o+o)%o+e;return a===e?n:a}function Gr(t,e,n){if(!t.length)return n(null,[]);let o=t.length;const a=new Array(t.length);let l=null;t.forEach((d,g)=>{e(d,(v,b)=>{v&&(l=v),a[g]=b,--o==0&&n(l,a)})})}function Or(t,...e){for(const n of e)for(const o in n)t[o]=n[o];return t}let yi=1;function Hr(){return yi++}function oi(){return function t(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function zr(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function It(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function mn(t,e){t.forEach(n=>{e[n]&&(e[n]=e[n].bind(e))})}function on(t,e){return t.indexOf(e,t.length-e.length)!==-1}function an(t,e,n){const o={};for(const a in t)o[a]=e.call(n||this,t[a],a,t);return o}function $n(t,e,n){const o={};for(const a in t)e.call(n||this,t[a],a,t)&&(o[a]=t[a]);return o}function Gn(t){return Array.isArray(t)?t.map(Gn):typeof t=="object"&&t?an(t,Gn):t}const De={};function Re(t){De[t]||(typeof console<"u"&&console.warn(t),De[t]=!0)}function ft(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function Lt(t){let e=0;for(let n,o,a=0,l=t.length,d=l-1;a<l;d=a++)n=t[a],o=t[d],e+=(o.x-n.x)*(n.y+o.y);return e}function Ot([t,e,n]){const o=Oe(e+90),a=Oe(n);return{x:t*Math.cos(o)*Math.sin(a),y:t*Math.sin(o)*Math.sin(a),z:t*Math.cos(a),azimuthal:e,polar:n}}function Kt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function dn(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,o,a,l)=>{const d=a||l;return e[o]=!d||d.toLowerCase(),""}),e["max-age"]){const n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}let Vt,Gt,Yt,qt,Mn,En,Qe=null;function re(t){try{const e=self[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function ue(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}function Ee(t,e,n,o){for(;e<n;){const a=e+n>>1;t[a]<o?e=a+1:n=a}return e}function it(t,e,n,o){for(;e<n;){const a=e+n>>1;t[a]<=o?e=a+1:n=a}return e}function pt(){return Vt==null&&(Vt=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Vt}const Mt={now:()=>qt!==void 0?qt:performance.now(),setNow(t){qt=t},restoreNow(){qt=void 0},frame(t){const e=requestAnimationFrame(t);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(t,e=0){const{width:n,height:o}=t;Mn||(Mn=document.createElement("canvas"));const a=Mn.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return(n>Mn.width||o>Mn.height)&&(Mn.width=n,Mn.height=o),a.clearRect(-e,-e,n+2*e,o+2*e),a.drawImage(t,0,0,n,o),a.getImageData(-e,-e,n+2*e,o+2*e)},resolveURL:t=>(Gt||(Gt=document.createElement("a")),Gt.href=t,Gt.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Yt==null&&(Yt=window.matchMedia("(prefers-reduced-motion: reduce)")),Yt.matches)},hasCanvasFingerprintNoise(){if(En!==void 0)return En;if(!pt())return En=!1,!1;const t=new OffscreenCanvas(85,1),e=t.getContext("2d",{willReadFrequently:!0});let n=0;for(let a=0;a<t.width;++a)e.fillStyle=`rgba(${n++},${n++},${n++}, 255)`,e.fillRect(a,0,1,1);const o=e.getImageData(0,0,t.width,t.height);n=0;for(let a=0;a<o.data.length;++a)if(a%4!=3&&n++!==o.data[a])return En=!0,!0;return En=!1,!1}},nn="mapbox-tiles";let Ke=500,jt=50,Ut,tn;function Sn(){try{return caches}catch{}}function Ln(){const t=Sn();t&&!Ut&&(Ut=t.open(nn))}function Dr(t){const e=t.indexOf("?");if(e<0)return t;const n=["language","worldview"],o=new URLSearchParams,a=new URLSearchParams(t.slice(e));for(const l of n){const d=a.get(l);d&&o.set(l,d)}return`${t.slice(0,e)}?${o.toString()}`}function Nr(t,e){const n=t.indexOf("?");if(n<0)return`${t}?${new URLSearchParams(e).toString()}`;const o=new URLSearchParams(t.slice(n));for(const a in e)o.set(a,e[a]);return`${t.slice(0,n)}?${o.toString()}`}let hr=1/0;const Tr={supported:!1,testSupport:function(t){!Di&&$r&&(dr?Ji(t):Rr=t)}};let Rr,$r,Di=!1,dr=!1;const io=typeof self<"u"?self:{};function Ji(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,$r),t.isContextLost())return;Tr.supported=!0}catch{}t.deleteTexture(e),Di=!0}io.document&&($r=io.document.createElement("img"),$r.onload=function(){Rr&&Ji(Rr),Rr=null,dr=!0},$r.onerror=function(){Di=!0,Rr=null},$r.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const oo={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(oo);class rr extends Error{constructor(e,n,o){n===401&&U(o)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=n,this.url=o}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const vi=Kt()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,mt=function(t,e){if(!(/^file:/.test(n=t.url)||/^file:/.test(vi())&&!/^\w+:/.test(n))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(o,a){const l=new AbortController,d=new Request(o.url,{method:o.method||"GET",body:o.body,credentials:o.credentials,headers:o.headers,referrer:vi(),referrerPolicy:o.referrerPolicy,signal:l.signal});let g=!1,v=!1;const b=(S=d.url).indexOf("sku=")>0&&U(S);var S;o.type==="json"&&d.headers.set("Accept","application/json");const I=(F,N,V)=>{if(v)return;if(F&&F.message!=="SecurityError"&&Re(F.toString()),N&&V)return D(N);const q=Date.now();fetch(d).then(Y=>{if(Y.ok){const oe=b?Y.clone():null;return D(Y,oe,q)}return a(new rr(Y.statusText,Y.status,o.url))}).catch(Y=>{Y.name!=="AbortError"&&a(new Error(`${Y.message} ${o.url}`))})},D=(F,N,V)=>{(o.type==="arrayBuffer"?F.arrayBuffer():o.type==="json"?F.json():F.text()).then(q=>{v||(N&&V&&function(Y,oe,le){if(Ln(),!Ut)return;const ae=dn(oe.headers.get("Cache-Control")||"");if(ae["no-store"])return;const be={status:oe.status,statusText:oe.statusText,headers:new Headers};oe.headers.forEach((Ne,Ge)=>be.headers.set(Ge,Ne)),ae["max-age"]&&be.headers.set("Expires",new Date(le+1e3*ae["max-age"]).toUTCString());const ge=be.headers.get("Expires");if(!ge||new Date(ge).getTime()-le<42e4)return;let Ie=Dr(Y.url);if(oe.status===206){const Ne=Y.headers.get("Range");if(!Ne)return;be.status=200,Ie=Nr(Ie,{range:Ne})}(function(Ne,Ge){if(tn===void 0)try{new Response(new ReadableStream),tn=!0}catch{tn=!1}tn?Ge(Ne.body):Ne.blob().then(Ge)})(oe,Ne=>{const Ge=new Response(Ne,be);Ln(),Ut&&Ut.then(tt=>tt.put(Ie,Ge)).catch(tt=>Re(tt.message))})}(d,N,V),g=!0,a(null,q,F.headers.get("Cache-Control"),F.headers.get("Expires")))}).catch(q=>{v||a(new Error(q.message))})};return b?function(F,N){if(Ln(),!Ut)return N(null);Ut.then(V=>{let q=Dr(F.url);const Y=F.headers.get("Range");Y&&(q=Nr(q,{range:Y})),V.match(q).then(oe=>{const le=function(ae){if(!ae)return!1;const be=new Date(ae.headers.get("Expires")||0),ge=dn(ae.headers.get("Cache-Control")||"");return be>Date.now()&&!ge["no-cache"]}(oe);V.delete(q),le&&V.put(q,oe.clone()),N(null,oe,le)}).catch(N)}).catch(N)}(d,I):I(null,null),{cancel:()=>{v=!0,g||l.abort()}}}(t,e);if(Kt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var n;return function(o,a){const l=new XMLHttpRequest;l.open(o.method||"GET",o.url,!0),o.type==="arrayBuffer"&&(l.responseType="arraybuffer");for(const d in o.headers)l.setRequestHeader(d,o.headers[d]);return o.type==="json"&&(l.responseType="text",l.setRequestHeader("Accept","application/json")),l.withCredentials=o.credentials==="include",l.onerror=()=>{a(new Error(l.statusText))},l.onload=()=>{if((l.status>=200&&l.status<300||l.status===0)&&l.response!==null){let d=l.response;if(o.type==="json")try{d=JSON.parse(l.response)}catch(g){return a(g)}a(null,d,l.getResponseHeader("Cache-Control"),l.getResponseHeader("Expires"))}else a(new rr(l.statusText,l.status,o.url))},l.send(o.body),{cancel:()=>l.abort()}}(t,e)},ce=function(t,e){return mt(Or(t,{type:"arrayBuffer"}),e)};function ee(t){const e=document.createElement("a");return e.href=t,e.protocol===location.protocol&&e.host===location.host}const me="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let xe,Ve;xe=[],Ve=0;const Ue=function(t,e){if(Tr.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),Ve>=L.MAX_PARALLEL_IMAGE_REQUESTS){const l={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return xe.push(l),l}Ve++;let n=!1;const o=()=>{if(!n)for(n=!0,Ve--;xe.length&&Ve<L.MAX_PARALLEL_IMAGE_REQUESTS;){const l=xe.shift(),{requestParameters:d,callback:g,cancelled:v}=l;v||(l.cancel=Ue(d,g).cancel)}},a=ce(t,(l,d,g,v)=>{o(),l?e(l):d&&(self.createImageBitmap?function(b,S){const I=new Blob([new Uint8Array(b)],{type:"image/png"});createImageBitmap(I).then(D=>{S(null,D)}).catch(D=>{S(new Error(`Could not load image because of ${D.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(d,(b,S)=>e(b,S,g,v)):function(b,S){const I=new Image;I.onload=()=>{S(null,I),URL.revokeObjectURL(I.src),I.onload=null,requestAnimationFrame(()=>{I.src=me})},I.onerror=()=>S(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const D=new Blob([new Uint8Array(b)],{type:"image/png"});I.src=b.byteLength?URL.createObjectURL(D):me}(d,(b,S)=>e(b,S,g,v)))});return{cancel:()=>{a.cancel(),o()}}},Xe="01",yt="NO_ACCESS_TOKEN",rt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Zt(t){const e=t.match(rt);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function fn(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}const zt="mapbox.eventData";function Rn(t){if(!t)return null;const e=t.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(atob(e[1]).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class zn{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const n=Rn(L.ACCESS_TOKEN);let o="";return o=n&&n.u?btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,(a,l)=>String.fromCharCode(+("0x"+l)))):L.ACCESS_TOKEN||"",e?`${zt}.${e}:${o}`:`${zt}:${o}`}fetchEventData(){const e=re("localStorage"),n=this.getStorageKey(),o=this.getStorageKey("uuid");if(e)try{const a=localStorage.getItem(n);a&&(this.eventData=JSON.parse(a));const l=localStorage.getItem(o);l&&(this.anonId=l)}catch{Re("Unable to read from LocalStorage")}}saveEventData(){const e=re("localStorage"),n=this.getStorageKey(),o=this.getStorageKey("uuid"),a=this.anonId;if(e&&a)try{localStorage.setItem(o,a),Object.keys(this.eventData).length>=1&&localStorage.setItem(n,JSON.stringify(this.eventData))}catch{Re("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,n,o,a){if(!L.EVENTS_URL)return;const l=Zt(L.EVENTS_URL);l.params.push(`access_token=${a||L.ACCESS_TOKEN||""}`);const d={event:this.type,created:new Date(e).toISOString()},g=n?Or(d,n):d,v={url:fn(l),headers:{"Content-Type":"text/plain"},body:JSON.stringify([g])};this.pendingRequest=function(b,S){return mt(Or(b,{method:"POST"}),S)}(v,b=>{this.pendingRequest=null,o(b),this.saveEventData(),this.processRequests(a)})}queueRequest(e,n){this.queue.push(e),this.processRequests(n)}}const Hn=new class extends zn{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){L.EVENTS_URL&&L.ACCESS_TOKEN&&Array.isArray(t)&&t.some(n=>j(n)||U(n))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=Rn(L.ACCESS_TOKEN),n=e?e.u:L.ACCESS_TOKEN;let o=n!==this.eventData.tokenU;It(this.anonId)||(this.anonId=oi(),o=!0);const a=this.queue.shift();if(this.eventData.lastSuccess){const l=new Date(this.eventData.lastSuccess),d=new Date(a),g=(a-this.eventData.lastSuccess)/864e5;o=o||g>=1||g<-1||l.getDate()!==d.getDate()}else o=!0;o?this.postEvent(a,{sdkIdentifier:"mapbox-gl-js",sdkVersion:P,skuId:Xe,"enabled.telemetry":!1,userId:this.anonId},l=>{l||(this.eventData.lastSuccess=a,this.eventData.tokenU=n)},t):this.processRequests()}},ni=Hn.postTurnstileEvent.bind(Hn),ar=new class extends zn{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,n,o){this.skuToken=e,this.errorCb=o,L.EVENTS_URL&&(n||L.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(yt)))}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),It(this.anonId)||(this.anonId=oi()),this.postEvent(n,{sdkIdentifier:"mapbox-gl-js",sdkVersion:P,skuId:Xe,skuToken:this.skuToken,userId:this.anonId},o=>{o?this.errorCb(o):e&&(this.success[e]=!0)},t))}remove(){this.errorCb=null}},Qn=ar.postMapLoadEvent.bind(ar),ki=new class extends zn{constructor(){super("gljs.performance")}postPerformanceEvent(t,e){L.EVENTS_URL&&(t||L.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},t)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:e,performanceData:n}=this.queue.shift(),o=function(a){const l=performance.getEntriesByType("resource"),d=performance.getEntriesByType("mark"),g=function(F){const N={};if(F){for(const V in F)if(V!=="other")for(const q of F[V]){const Y=`${V}ResolveRangeMin`,oe=`${V}ResolveRangeMax`,le=`${V}RequestCount`,ae=`${V}RequestCachedCount`;N[Y]=Math.min(N[Y]||1/0,q.startTime),N[oe]=Math.max(N[oe]||-1/0,q.responseEnd);const be=ge=>{N[ge]===void 0&&(N[ge]=0),++N[ge]};q.transferSize!==void 0&&q.transferSize===0&&be(ae),be(le)}}return N}(function(F,N){const V={};if(F)for(const q of F){const Y=N(q);V[Y]===void 0&&(V[Y]=[]),V[Y].push(q)}return V}(l,we)),v=window.devicePixelRatio,b=navigator.connection||navigator.mozConnection||navigator.webkitConnection,S=b?b.effectiveType:void 0,I={counters:[],metadata:[],attributes:[]},D=(F,N,V)=>{V!=null&&F.push({name:N,value:V.toString()})};for(const F in g)D(I.counters,F,g[F]);if(a.interactionRange[0]!==1/0&&a.interactionRange[1]!==-1/0&&(D(I.counters,"interactionRangeMin",a.interactionRange[0]),D(I.counters,"interactionRangeMax",a.interactionRange[1])),d)for(const F of Object.keys(_e)){const N=_e[F],V=d.find(q=>q.name===N);V&&D(I.counters,N,V.startTime)}return D(I.counters,"visibilityHidden",a.visibilityHidden),D(I.attributes,"style",function(F){if(F)for(const N of F){const V=N.name.split("?")[0];if(fe(V)){const q=V.split("/").slice(-2);if(q.length===2)return`mapbox://styles/${q[0]}/${q[1]}`}}}(l)),D(I.attributes,"terrainEnabled",a.terrainEnabled?"true":"false"),D(I.attributes,"fogEnabled",a.fogEnabled?"true":"false"),D(I.attributes,"projection",a.projection),D(I.attributes,"zoom",a.zoom),D(I.metadata,"devicePixelRatio",v),D(I.metadata,"connectionEffectiveType",S),D(I.metadata,"navigatorUserAgent",navigator.userAgent),D(I.metadata,"screenWidth",window.screen.width),D(I.metadata,"screenHeight",window.screen.height),D(I.metadata,"windowWidth",window.innerWidth),D(I.metadata,"windowHeight",window.innerHeight),D(I.metadata,"mapWidth",a.width/v),D(I.metadata,"mapHeight",a.height/v),D(I.metadata,"webglRenderer",a.renderer),D(I.metadata,"webglVendor",a.vendor),D(I.metadata,"sdkVersion",P),D(I.metadata,"sdkIdentifier","mapbox-gl-js"),I}(n);for(const a of o.metadata);for(const a of o.counters);for(const a of o.attributes);this.postEvent(e,o,()=>{},t)}},Gi=ki.postPerformanceEvent.bind(ki),di=new class extends zn{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,n,o){if(!L.API_URL||!L.SESSION_PATH)return;const a=Zt(L.API_URL+L.SESSION_PATH);a.params.push(`sku=${e||""}`),a.params.push(`access_token=${o||L.ACCESS_TOKEN||""}`);const l={url:fn(a),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(d,g){return mt(Or(d,{method:"GET"}),g)}(l,d=>{this.pendingRequest=null,n(d),this.saveEventData(),this.processRequests(o)})}getSessionAPI(t,e,n,o){this.skuToken=e,this.errorCb=o,L.SESSION_PATH&&L.API_URL&&(n||L.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(yt)))}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||this.getSession(n,this.skuToken,o=>{o?this.errorCb(o):e&&(this.success[e]=!0)},t)}remove(){this.errorCb=null}},Qo=di.getSessionAPI.bind(di),Hi=new Set;function To(t,e,n){n[t]&&n[t].indexOf(e)!==-1||(n[t]=n[t]||[],n[t].push(e))}function ha(t,e,n){if(n&&n[t]){const o=n[t].indexOf(e);o!==-1&&n[t].splice(o,1)}}class bs{constructor(e,n={}){Or(this,n),this.type=e}}class ml extends bs{constructor(e,n={}){super("error",Or({error:e},n))}}class qs{on(e,n){return this._listeners=this._listeners||{},To(e,n,this._listeners),this}off(e,n){return ha(e,n,this._listeners),ha(e,n,this._oneTimeListeners),this}once(e,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},To(e,n,this._oneTimeListeners),this):new Promise(o=>this.once(e,o))}fire(e,n){typeof e=="string"&&(e=new bs(e,n||{}));const o=e.type;if(this.listens(o)){e.target=this;const a=this._listeners&&this._listeners[o]?this._listeners[o].slice():[];for(const g of a)g.call(this,e);const l=this._oneTimeListeners&&this._oneTimeListeners[o]?this._oneTimeListeners[o].slice():[];for(const g of l)ha(o,g,this._oneTimeListeners),g.call(this,e);const d=this._eventedParent;d&&(Or(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),d.fire(e))}else e instanceof ml&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,n){return this._eventedParent=e,this._eventedParentData=n,this}}i.y=void 0;var Ql={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Io(t){return(t=Math.round(t))<0?0:t>255?255:t}function Co(t){return Io(t[t.length-1]==="%"?parseFloat(t)/100*255:parseInt(t))}function Po(t){return(e=t[t.length-1]==="%"?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function ws(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{i.y={}.parseCSSColor=function(t){var e,n=t.replace(/ /g,"").toLowerCase();if(n in Ql)return Ql[n].slice();if(n[0]==="#")return n.length===4?(e=parseInt(n.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:n.length===7&&(e=parseInt(n.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var o=n.indexOf("("),a=n.indexOf(")");if(o!==-1&&a+1===n.length){var l=n.substr(0,o),d=n.substr(o+1,a-(o+1)).split(","),g=1;switch(l){case"rgba":if(d.length!==4)return null;g=Po(d.pop());case"rgb":return d.length!==3?null:[Co(d[0]),Co(d[1]),Co(d[2]),g];case"hsla":if(d.length!==4)return null;g=Po(d.pop());case"hsl":if(d.length!==3)return null;var v=(parseFloat(d[0])%360+360)%360/360,b=Po(d[1]),S=Po(d[2]),I=S<=.5?S*(b+1):S+b-S*b,D=2*S-I;return[Io(255*ws(D,I,v+1/3)),Io(255*ws(D,I,v)),Io(255*ws(D,I,v-1/3)),g];default:return null}}return null}}catch{}class Yi{constructor(e,n,o,a=1){this.r=e,this.g=n,this.b=o,this.a=a}static parse(e){if(!e)return;if(e instanceof Yi)return e;if(typeof e!="string")return;const n=i.y(e);return n?new Yi(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3]):void 0}toString(){const[e,n,o,a]=this.toArray();return`rgba(${Math.round(e)},${Math.round(n)},${Math.round(o)},${a})`}toArray(){const{r:e,g:n,b:o,a}=this;return a===0?[0,0,0,0]:[255*e/a,255*n/a,255*o/a,a]}toArray01(){const{r:e,g:n,b:o,a}=this;return a===0?[0,0,0,0]:[e/a,n/a,o/a,a]}toArray01Scaled(e){const{r:n,g:o,b:a,a:l}=this;return l===0?[0,0,0]:[n/l*e,o/l*e,a/l*e]}toArray01PremultipliedAlpha(){const{r:e,g:n,b:o,a}=this;return[e,n,o,a]}toArray01Linear(){const{r:e,g:n,b:o,a}=this;return a===0?[0,0,0,0]:[Math.pow(e/a,2.2),Math.pow(n/a,2.2),Math.pow(o/a,2.2),a]}}Yi.black=new Yi(0,0,0,1),Yi.white=new Yi(1,1,1,1),Yi.transparent=new Yi(0,0,0,0),Yi.red=new Yi(1,0,0,1),Yi.blue=new Yi(0,0,1,1);var li=Yi;function Zn(t,e,n){return t*(1-n)+e*n}function _l(t,e,n){return t.map((o,a)=>Zn(o,e[a],n))}var Ba=Object.freeze({__proto__:null,array:_l,color:function(t,e,n){return new li(Zn(t.r,e.r,n),Zn(t.g,e.g,n),Zn(t.b,e.b,n),Zn(t.a,e.a,n))},number:Zn});function yn(t,...e){for(const n of e)for(const o in n)t[o]=n[o];return t}class yr extends Error{constructor(e,n){super(n),this.message=n,this.key=e}}var Do=yr;class Na{constructor(e,n=[]){this.parent=e,this.bindings={};for(const[o,a]of n)this.bindings[o]=a}concat(e){return new Na(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var xo=Na;const Ts={kind:"null"},en={kind:"number"},vr={kind:"string"},xr={kind:"boolean"},ko={kind:"color"},ja={kind:"object"},mr={kind:"value"},ec={kind:"collator"},Va={kind:"formatted"},Ua={kind:"resolvedImage"};function Oi(t,e){return{kind:"array",itemType:t,N:e}}function Ai(t){if(t.kind==="array"){const e=Ai(t.itemType);return typeof t.N=="number"?`array<${e}, ${t.N}>`:t.itemType.kind==="value"?"array":`array<${e}>`}return t.kind}const xn=[Ts,en,vr,xr,ko,Va,ja,Oi(mr),Ua];function da(t,e){if(e.kind==="error")return null;if(t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!da(t.itemType,e.itemType))&&(typeof t.N!="number"||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if(t.kind==="value"){for(const n of xn)if(!da(n,e))return null}}return`Expected ${Ai(t)} but found ${Ai(e)} instead.`}function Dn(t,e){return e.some(n=>n.kind===t.kind)}function es(t,e){return e.some(n=>n==="null"?t===null:n==="array"?Array.isArray(t):n==="object"?t&&!Array.isArray(t)&&typeof t=="object":n===typeof t)}class Yn{constructor(e,n,o){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=o,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,n){return this.collator.compare(e,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ws{constructor(e,n,o,a,l){this.text=e.normalize?e.normalize():e,this.image=n,this.scale=o,this.fontStack=a,this.textColor=l}}class Qi{constructor(e){this.sections=e}static fromString(e){return new Qi([new Ws(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.namePrimary.length!==0)}static factory(e){return e instanceof Qi?e:Qi.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const n of this.sections){if(n.image){e.push(["image",n.image.namePrimary]);continue}e.push(n.text);const o={};n.fontStack&&(o["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(o["font-scale"]=n.scale),n.textColor&&(o["text-color"]=["rgba"].concat(n.textColor.toArray())),e.push(o)}return e}}class bn{constructor(e){this.namePrimary=e.namePrimary,e.nameSecondary&&(this.nameSecondary=e.nameSecondary),this.available=e.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(e,n){return e?new bn({namePrimary:e,nameSecondary:n,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function vh(t,e,n,o){return typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof n=="number"&&n>=0&&n<=255?o===void 0||typeof o=="number"&&o>=0&&o<=1?null:`Invalid rgba value [${[t,e,n,o].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof o=="number"?[t,e,n,o]:[t,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function fa(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof li||t instanceof Yn||t instanceof Qi||t instanceof bn)return!0;if(Array.isArray(t)){for(const e of t)if(!fa(e))return!1;return!0}if(typeof t=="object"){for(const e in t)if(!fa(t[e]))return!1;return!0}return!1}function Fi(t){if(t===null)return Ts;if(typeof t=="string")return vr;if(typeof t=="boolean")return xr;if(typeof t=="number")return en;if(t instanceof li)return ko;if(t instanceof Yn)return ec;if(t instanceof Qi)return Va;if(t instanceof bn)return Ua;if(Array.isArray(t)){const e=t.length;let n;for(const o of t){const a=Fi(o);if(n){if(n===a)continue;n=mr;break}n=a}return Oi(n||mr,e)}return ja}function jo(t){const e=typeof t;return t===null?"":e==="string"||e==="number"||e==="boolean"?String(t):t instanceof li||t instanceof Qi||t instanceof bn?t.toString():JSON.stringify(t)}class Zs{constructor(e,n){this.type=e,this.value=n}static parse(e,n){if(e.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!fa(e[1]))return n.error("invalid value");const o=e[1];let a=Fi(o);const l=n.expectedType;return a.kind!=="array"||a.N!==0||!l||l.kind!=="array"||typeof l.N=="number"&&l.N!==0||(a=l),new Zs(a,o)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof li?["rgba"].concat(this.value.toArray()):this.value instanceof Qi?this.value.serialize():this.value}}var Es=Zs,xi=class{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}};const Kc={string:vr,number:en,boolean:xr,object:ja};class Jc{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let o,a=1;const l=e[0];if(l==="array"){let g,v;if(e.length>2){const b=e[1];if(typeof b!="string"||!(b in Kc)||b==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);g=Kc[b],a++}else g=mr;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);v=e[2],a++}o=Oi(g,v)}else o=Kc[l];const d=[];for(;a<e.length;a++){const g=n.parse(e[a],a,mr);if(!g)return null;d.push(g)}return new Jc(o,d)}evaluate(e){for(let n=0;n<this.args.length;n++){const o=this.args[n].evaluate(e);if(!da(this.type,Fi(o)))return o;if(n===this.args.length-1)throw new xi(`Expected value to be of type ${Ai(this.type)}, but found ${Ai(Fi(o))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,n=[e.kind];if(e.kind==="array"){const o=e.itemType;if(o.kind==="string"||o.kind==="number"||o.kind==="boolean"){n.push(o.kind);const a=e.N;(typeof a=="number"||this.args.length>1)&&n.push(a)}}return n.concat(this.args.map(o=>o.serialize()))}}var Ss=Jc;class $a{constructor(e){this.type=Va,this.sections=e}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const o=e[1];if(!Array.isArray(o)&&typeof o=="object")return n.error("First argument must be an image or text section.");const a=[];let l=!1;for(let d=1;d<=e.length-1;++d){const g=e[d];if(l&&typeof g=="object"&&!Array.isArray(g)){l=!1;let v=null;if(g["font-scale"]&&(v=n.parse(g["font-scale"],1,en),!v))return null;let b=null;if(g["text-font"]&&(b=n.parse(g["text-font"],1,Oi(vr)),!b))return null;let S=null;if(g["text-color"]&&(S=n.parse(g["text-color"],1,ko),!S))return null;const I=a[a.length-1];I.scale=v,I.font=b,I.textColor=S}else{const v=n.parse(e[d],1,mr);if(!v)return null;const b=v.type.kind;if(b!=="string"&&b!=="value"&&b!=="null"&&b!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");l=!0,a.push({content:v,scale:null,font:null,textColor:null})}}return new $a(a)}evaluate(e){return new Qi(this.sections.map(n=>{const o=n.content.evaluate(e);return Fi(o)===Ua?new Ws("",o,null,null,null):new Ws(jo(o),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)}))}eachChild(e){for(const n of this.sections)e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const n of this.sections){e.push(n.content.serialize());const o={};n.scale&&(o["font-scale"]=n.scale.serialize()),n.font&&(o["text-font"]=n.font.serialize()),n.textColor&&(o["text-color"]=n.textColor.serialize()),e.push(o)}return e}}class pa{constructor(e,n){this.type=Ua,this.inputPrimary=e,this.inputSecondary=n}static parse(e,n){if(e.length<2)return n.error("Expected two or more arguments.");const o=n.parse(e[1],1,vr);if(!o)return n.error("No image name provided.");if(e.length===2)return new pa(o);const a=n.parse(e[2],1,vr);return a?new pa(o,a):n.error("Secondary image variant is not a string.")}evaluate(e){const n=bn.fromString(this.inputPrimary.evaluate(e),this.inputSecondary?this.inputSecondary.evaluate(e):void 0);return n&&e.availableImages&&(n.available=e.availableImages.indexOf(n.namePrimary)>-1,n.nameSecondary&&n.available&&e.availableImages&&(n.available=e.availableImages.indexOf(n.nameSecondary)>-1)),n}eachChild(e){e(this.inputPrimary),this.inputSecondary&&e(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function ma(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}const Oo={"to-boolean":xr,"to-color":ko,"to-number":en,"to-string":vr};class tc{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const o=e[0],a=[];let l=Ts;if(o==="to-array"){if(!Array.isArray(e[1]))return null;const d=e[1].length;if(n.expectedType){if(n.expectedType.kind!=="array")return n.error(`Expected ${n.expectedType.kind} but found array.`);l=Oi(n.expectedType.itemType,d)}else{if(!(d>0&&fa(e[1][0])))return null;l=Oi(Fi(e[1][0]),d)}for(let g=0;g<d;g++){const v=e[1][g];let b;if(ma(v)==="array")b=n.parse(v,void 0,l.itemType);else{const S=ma(v);if(S!==l.itemType.kind)return n.error(`Expected ${l.itemType.kind} but found ${S}.`);b=n.registry.literal.parse(["literal",v===void 0?null:v],n)}if(!b)return null;a.push(b)}}else{if((o==="to-boolean"||o==="to-string")&&e.length!==2)return n.error("Expected one argument.");l=Oo[o];for(let d=1;d<e.length;d++){const g=n.parse(e[d],d,mr);if(!g)return null;a.push(g)}}return new tc(l,a)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let n,o;for(const a of this.args){if(n=a.evaluate(e),o=null,n instanceof li)return n;if(typeof n=="string"){const l=e.parseColor(n);if(l)return l}else if(Array.isArray(n)&&(o=n.length<3||n.length>4?`Invalid rbga value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:vh(n[0],n[1],n[2],n[3]),!o))return new li(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new xi(o||`Could not parse color from value '${typeof n=="string"?n:String(JSON.stringify(n))}'`)}if(this.type.kind==="number"){let n=null;for(const o of this.args){if(n=o.evaluate(e),n===null)return 0;const a=Number(n);if(!isNaN(a))return a}throw new xi(`Could not convert ${JSON.stringify(n)} to number.`)}return this.type.kind==="formatted"?Qi.fromString(jo(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?bn.fromString(jo(this.args[0].evaluate(e))):this.type.kind==="array"?this.args.map(n=>n.evaluate(e)):jo(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new $a([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new pa(this.args[0]).serialize();const e=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(n=>{e.push(n.serialize())}),e}}var Ms=tc;const gl=["Unknown","Point","LineString","Polygon"];var Qc=class{constructor(t,e){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=t,this.options=e}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?gl[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(t){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:n,y:o}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(n*e-t[0])+this.featureDistanceData.bearing[1]*(o*e-t[1])}return 0}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=li.parse(t)),e}getConfig(t){return this.options?this.options.get(t):null}};class As{constructor(e,n,o,a,l){this.name=e,this.type=n,this._evaluate=o,this.args=a,this._overloadIndex=l}evaluate(e){if(!this._evaluate){const n=As.definitions[this.name];this._evaluate=Array.isArray(n)?n[2]:n.overloads[this._overloadIndex][1]}return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,n){const o=e[0],a=As.definitions[o];if(!a)return n.error(`Unknown expression "${o}". If you wanted a literal array, use ["literal", [...]].`,0);const l=Array.isArray(a)?a[0]:a.type,d=Array.isArray(a)?[[a[1],a[2]]]:a.overloads,g=[];let v=null,b=-1;for(const[S,I]of d){if(Array.isArray(S)&&S.length!==e.length-1)continue;g.push(S),b++,v=new Ri(n.registry,n.path,null,n.scope,void 0,n._scope,n.options);const D=[];let F=!1;for(let N=1;N<e.length;N++){const V=e[N],q=Array.isArray(S)?S[N-1]:S.type,Y=v.parse(V,1+D.length,q);if(!Y){F=!0;break}D.push(Y)}if(!F)if(Array.isArray(S)&&S.length!==D.length)v.error(`Expected ${S.length} arguments, but found ${D.length} instead.`);else{for(let N=0;N<D.length;N++){const V=Array.isArray(S)?S[N]:S.type,q=D[N];v.concat(N+1).checkSubtype(V,q.type)}if(v.errors.length===0)return new As(o,l,I,D,b)}}if(g.length===1)n.errors.push(...v.errors);else{const S=(g.length?g:d.map(([D])=>D)).map(nc).join(" | "),I=[];for(let D=1;D<e.length;D++){const F=n.parse(e[D],1+I.length);if(!F)return null;I.push(Ai(F.type))}n.error(`Expected arguments of type ${S}, but found (${I.join(", ")}) instead.`)}return null}static register(e,n){As.definitions=n;for(const o in n)e[o]=As}}function nc(t){return Array.isArray(t)?`(${t.map(Ai).join(", ")})`:`(${Ai(t.type)}...)`}var lr=As;class yl{constructor(e,n,o){this.type=ec,this.locale=o,this.caseSensitive=e,this.diacriticSensitive=n}static parse(e,n){if(e.length!==2)return n.error("Expected one argument.");const o=e[1];if(typeof o!="object"||Array.isArray(o))return n.error("Collator options argument must be an object.");const a=n.parse(o["case-sensitive"]!==void 0&&o["case-sensitive"],1,xr);if(!a)return null;const l=n.parse(o["diacritic-sensitive"]!==void 0&&o["diacritic-sensitive"],1,xr);if(!l)return null;let d=null;return o.locale&&(d=n.parse(o.locale,1,vr),!d)?null:new yl(a,l,d)}evaluate(e){return new Yn(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}var Ga={exports:{}};Ga.exports=function(){function t(o,a,l,d,g){for(;d>l;){if(d-l>600){var v=d-l+1,b=a-l+1,S=Math.log(v),I=.5*Math.exp(2*S/3),D=.5*Math.sqrt(S*I*(v-I)/v)*(b-v/2<0?-1:1);t(o,a,Math.max(l,Math.floor(a-b*I/v+D)),Math.min(d,Math.floor(a+(v-b)*I/v+D)),g)}var F=o[a],N=l,V=d;for(e(o,l,a),g(o[d],F)>0&&e(o,l,d);N<V;){for(e(o,N,V),N++,V--;g(o[N],F)<0;)N++;for(;g(o[V],F)>0;)V--}g(o[l],F)===0?e(o,l,V):e(o,++V,d),V<=a&&(l=V+1),a<=V&&(d=V-1)}}function e(o,a,l){var d=o[a];o[a]=o[l],o[l]=d}function n(o,a){return o<a?-1:o>a?1:0}return function(o,a,l,d,g){t(o,a,l||0,d||o.length-1,g||n)}}();var Dd=ye(Ga.exports);function kd(t){let e=0;for(let n,o,a=0,l=t.length,d=l-1;a<l;d=a++)n=t[a],o=t[d],e+=(o.x-n.x)*(n.y+o.y);return e}function Ys(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function Xs(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function rc(t,e,n){const o=t[0]-e[0],a=t[1]-e[1],l=t[0]-n[0],d=t[1]-n[1];return o*d-l*a==0&&o*l<=0&&a*d<=0}function Ha(t,e,n=!1){let o=!1;for(let g=0,v=e.length;g<v;g++){const b=e[g];for(let S=0,I=b.length,D=I-1;S<I;D=S++){const F=b[D],N=b[S];if(rc(t,F,N))return n;(l=F)[1]>(a=t)[1]!=(d=N)[1]>a[1]&&a[0]<(d[0]-l[0])*(a[1]-l[1])/(d[1]-l[1])+l[0]&&(o=!o)}}var a,l,d;return o}function eu(t,e,n,o){const a=o[0]-n[0],l=o[1]-n[1],d=(t[0]-n[0])*l-a*(t[1]-n[1]),g=(e[0]-n[0])*l-a*(e[1]-n[1]);return d>0&&g<0||d<0&&g>0}function Is(t,e,n,o){return(a=[o[0]-n[0],o[1]-n[1]])[0]*(l=[e[0]-t[0],e[1]-t[1]])[1]-a[1]*l[0]!=0&&!(!eu(t,e,n,o)||!eu(n,o,t,e));var a,l}const Ks=8192;function vl(t,e){const n=(180+t[0])/360,o=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,a=Math.pow(2,e.z);return[Math.round(n*a*Ks),Math.round(o*a*Ks)]}function tu(t,e){for(let n=0;n<e.length;n++)if(Ha(t,e[n]))return!0;return!1}function nu(t,e,n){for(const o of n)for(let a=0,l=o.length,d=l-1;a<l;d=a++)if(Is(t,e,o[d],o[a]))return!0;return!1}function Vo(t,e){for(let n=0;n<t.length;++n)if(!Ha(t[n],e))return!1;for(let n=0;n<t.length-1;++n)if(nu(t[n],t[n+1],e))return!1;return!0}function xh(t,e){for(let n=0;n<e.length;n++)if(Vo(t,e[n]))return!0;return!1}function ru(t,e,n){const o=[];for(let a=0;a<t.length;a++){const l=[];for(let d=0;d<t[a].length;d++){const g=vl(t[a][d],n);Ys(e,g),l.push(g)}o.push(l)}return o}function iu(t,e,n){const o=[];for(let a=0;a<t.length;a++){const l=ru(t[a],e,n);o.push(l)}return o}function ou(t,e,n,o){if(t[0]<n[0]||t[0]>n[2]){const a=.5*o;let l=t[0]-n[0]>a?-o:n[0]-t[0]>a?o:0;l===0&&(l=t[0]-n[2]>a?-o:n[2]-t[0]>a?o:0),t[0]+=l}Ys(e,t)}function su(t,e,n,o){const a=Math.pow(2,o.z)*Ks,l=[o.x*Ks,o.y*Ks],d=[];if(!t)return d;for(const g of t)for(const v of g){const b=[v.x+l[0],v.y+l[1]];ou(b,e,n,a),d.push(b)}return d}function au(t,e,n,o){const a=Math.pow(2,o.z)*Ks,l=[o.x*Ks,o.y*Ks],d=[];if(!t)return d;for(const v of t){const b=[];for(const S of v){const I=[S.x+l[0],S.y+l[1]];Ys(e,I),b.push(I)}d.push(b)}if(e[2]-e[0]<=a/2){(g=e)[0]=g[1]=1/0,g[2]=g[3]=-1/0;for(const v of d)for(const b of v)ou(b,e,n,a)}var g;return d}class qa{constructor(e,n){this.type=xr,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(fa(e[1])){const o=e[1];if(o.type==="FeatureCollection")for(let a=0;a<o.features.length;++a){const l=o.features[a].geometry.type;if(l==="Polygon"||l==="MultiPolygon")return new qa(o,o.features[a].geometry)}else if(o.type==="Feature"){const a=o.geometry.type;if(a==="Polygon"||a==="MultiPolygon")return new qa(o,o.geometry)}else if(o.type==="Polygon"||o.type==="MultiPolygon")return new qa(o,o)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(n,o){const a=[1/0,1/0,-1/0,-1/0],l=[1/0,1/0,-1/0,-1/0],d=n.canonicalID();if(!d)return!1;if(o.type==="Polygon"){const g=ru(o.coordinates,l,d),v=su(n.geometry(),a,l,d);if(!Xs(a,l))return!1;for(const b of v)if(!Ha(b,g))return!1}if(o.type==="MultiPolygon"){const g=iu(o.coordinates,l,d),v=su(n.geometry(),a,l,d);if(!Xs(a,l))return!1;for(const b of v)if(!tu(b,g))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(n,o){const a=[1/0,1/0,-1/0,-1/0],l=[1/0,1/0,-1/0,-1/0],d=n.canonicalID();if(!d)return!1;if(o.type==="Polygon"){const g=ru(o.coordinates,l,d),v=au(n.geometry(),a,l,d);if(!Xs(a,l))return!1;for(const b of v)if(!Vo(b,g))return!1}if(o.type==="MultiPolygon"){const g=iu(o.coordinates,l,d),v=au(n.geometry(),a,l,d);if(!Xs(a,l))return!1;for(const b of v)if(!xh(b,g))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var ic=qa,xl={exports:{}};xl.exports=function(){var t={kilometers:1,miles:.621371192237334,nauticalmiles:.5399568034557235,meters:1e3,metres:1e3,yards:1093.6132983377079,feet:3280.839895013123,inches:39370.078740157485},e=1/298.257223563,n=e*(2-e),o=Math.PI/180,a=function(b,S){if(b===void 0)throw new Error("No latitude given.");if(S&&!t[S])throw new Error("Unknown unit "+S+". Use one of: "+Object.keys(t).join(", "));var I=6378.137*o*(S?t[S]:1),D=Math.cos(b*o),F=1/(1-n*(1-D*D)),N=Math.sqrt(F);this.kx=I*N*D,this.ky=I*N*F*(1-n)},l={units:{configurable:!0}};function d(b,S){return b[0]===S[0]&&b[1]===S[1]}function g(b,S,I){var D=v(S[0]-b[0]);return[b[0]+D*I,b[1]+(S[1]-b[1])*I]}function v(b){for(;b<-180;)b+=360;for(;b>180;)b-=360;return b}return a.fromTile=function(b,S,I){var D=Math.PI*(1-2*(b+.5)/Math.pow(2,S)),F=Math.atan(.5*(Math.exp(D)-Math.exp(-D)))/o;return new a(F,I)},l.units.get=function(){return t},a.prototype.distance=function(b,S){var I=v(b[0]-S[0])*this.kx,D=(b[1]-S[1])*this.ky;return Math.sqrt(I*I+D*D)},a.prototype.bearing=function(b,S){var I=v(S[0]-b[0])*this.kx;return Math.atan2(I,(S[1]-b[1])*this.ky)/o},a.prototype.destination=function(b,S,I){var D=I*o;return this.offset(b,Math.sin(D)*S,Math.cos(D)*S)},a.prototype.offset=function(b,S,I){return[b[0]+S/this.kx,b[1]+I/this.ky]},a.prototype.lineDistance=function(b){for(var S=0,I=0;I<b.length-1;I++)S+=this.distance(b[I],b[I+1]);return S},a.prototype.area=function(b){for(var S=0,I=0;I<b.length;I++)for(var D=b[I],F=0,N=D.length,V=N-1;F<N;V=F++)S+=v(D[F][0]-D[V][0])*(D[F][1]+D[V][1])*(I?-1:1);return Math.abs(S)/2*this.kx*this.ky},a.prototype.along=function(b,S){var I=0;if(S<=0)return b[0];for(var D=0;D<b.length-1;D++){var F=b[D],N=b[D+1],V=this.distance(F,N);if((I+=V)>S)return g(F,N,(S-(I-V))/V)}return b[b.length-1]},a.prototype.pointToSegmentDistance=function(b,S,I){var D=S[0],F=S[1],N=v(I[0]-D)*this.kx,V=(I[1]-F)*this.ky,q=0;return N===0&&V===0||((q=(v(b[0]-D)*this.kx*N+(b[1]-F)*this.ky*V)/(N*N+V*V))>1?(D=I[0],F=I[1]):q>0&&(D+=N/this.kx*q,F+=V/this.ky*q)),N=v(b[0]-D)*this.kx,V=(b[1]-F)*this.ky,Math.sqrt(N*N+V*V)},a.prototype.pointOnLine=function(b,S){for(var I,D,F,N,V=1/0,q=0;q<b.length-1;q++){var Y=b[q][0],oe=b[q][1],le=v(b[q+1][0]-Y)*this.kx,ae=(b[q+1][1]-oe)*this.ky,be=0;le===0&&ae===0||((be=(v(S[0]-Y)*this.kx*le+(S[1]-oe)*this.ky*ae)/(le*le+ae*ae))>1?(Y=b[q+1][0],oe=b[q+1][1]):be>0&&(Y+=le/this.kx*be,oe+=ae/this.ky*be));var ge=(le=v(S[0]-Y)*this.kx)*le+(ae=(S[1]-oe)*this.ky)*ae;ge<V&&(V=ge,I=Y,D=oe,F=q,N=be)}return{point:[I,D],index:F,t:Math.max(0,Math.min(1,N))}},a.prototype.lineSlice=function(b,S,I){var D=this.pointOnLine(I,b),F=this.pointOnLine(I,S);if(D.index>F.index||D.index===F.index&&D.t>F.t){var N=D;D=F,F=N}var V=[D.point],q=D.index+1,Y=F.index;!d(I[q],V[0])&&q<=Y&&V.push(I[q]);for(var oe=q+1;oe<=Y;oe++)V.push(I[oe]);return d(I[Y],F.point)||V.push(F.point),V},a.prototype.lineSliceAlong=function(b,S,I){for(var D=0,F=[],N=0;N<I.length-1;N++){var V=I[N],q=I[N+1],Y=this.distance(V,q);if((D+=Y)>b&&F.length===0&&F.push(g(V,q,(b-(D-Y))/Y)),D>=S)return F.push(g(V,q,(S-(D-Y))/Y)),F;D>b&&F.push(q)}return F},a.prototype.bufferPoint=function(b,S){var I=S/this.ky,D=S/this.kx;return[b[0]-D,b[1]-I,b[0]+D,b[1]+I]},a.prototype.bufferBBox=function(b,S){var I=S/this.ky,D=S/this.kx;return[b[0]-D,b[1]-I,b[2]+D,b[3]+I]},a.prototype.insideBBox=function(b,S){return v(b[0]-S[0])>=0&&v(b[0]-S[2])<=0&&b[1]>=S[1]&&b[1]<=S[3]},Object.defineProperties(a,l),a}();var Js=ye(xl.exports),lu={exports:{}};lu.exports=function(){var t=function(n,o){if(n===void 0&&(n=[]),o===void 0&&(o=e),this.data=n,this.length=this.data.length,this.compare=o,this.length>0)for(var a=(this.length>>1)-1;a>=0;a--)this._down(a)};function e(n,o){return n<o?-1:n>o?1:0}return t.prototype.push=function(n){this.data.push(n),this.length++,this._up(this.length-1)},t.prototype.pop=function(){if(this.length!==0){var n=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),n}},t.prototype.peek=function(){return this.data[0]},t.prototype._up=function(n){for(var o=this.data,a=this.compare,l=o[n];n>0;){var d=n-1>>1,g=o[d];if(a(l,g)>=0)break;o[n]=g,n=d}o[n]=l},t.prototype._down=function(n){for(var o=this.data,a=this.compare,l=this.length>>1,d=o[n];n<l;){var g=1+(n<<1),v=o[g],b=g+1;if(b<this.length&&a(o[b],v)<0&&(g=b,v=o[b]),a(v,d)>=0)break;o[n]=v,n=g}o[n]=d},t}();var Uo=ye(lu.exports),Jt=8192;function oc(t,e){return e.dist-t.dist}const cu=100,bl=50;function uu(t){const e=[1/0,1/0,-1/0,-1/0];if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Qs(t){return t[1]-t[0]+1}function ts(t,e){const n=t[1]>=t[0]&&t[1]<e;return n||console.warn("Distance Expression: Index is out of range"),n}function hu(t,e){if(t[0]>t[1])return[null,null];const n=Qs(t);if(e){if(n===2)return[t,null];const o=Math.floor(n/2);return[[t[0],t[0]+o],[t[0]+o,t[1]]]}{if(n===1)return[t,null];const o=Math.floor(n/2)-1;return[[t[0],t[0]+o],[t[0]+o+1,t[1]]]}}function _a(t,e){const n=[1/0,1/0,-1/0,-1/0];if(!ts(e,t.length))return n;for(let o=e[0];o<=e[1];++o)Ys(n,t[o]);return n}function sc(t){const e=[1/0,1/0,-1/0,-1/0];for(let n=0;n<t.length;++n)for(let o=0;o<t[n].length;++o)Ys(e,t[n][o]);return e}function ga(t,e,n){if(uu(t)||uu(e))return NaN;let o=0,a=0;return t[2]<e[0]&&(o=e[0]-t[2]),t[0]>e[2]&&(o=t[0]-e[2]),t[1]>e[3]&&(a=t[1]-e[3]),t[3]<e[1]&&(a=e[1]-t[3]),n.distance([0,0],[o,a])}function du(t){return 360*t-180}function Od(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Wa(t,e){const n=Math.pow(2,e.z),o=(t.y/Jt+e.y)/n;return[du((t.x/Jt+e.x)/n),Od(o)]}function Rd(t,e){const n=[];for(let o=0;o<t.length;++o)n.push(Wa(t[o],e));return n}function fu(t,e,n){const o=n.pointOnLine(e,t).point;return n.distance(t,o)}function bh(t,e,n,o,a){const l=n.slice(o[0],o[1]+1);let d=1/0;for(let g=e[0];g<=e[1];++g)if((d=Math.min(d,fu(t[g],l,a)))===0)return 0;return d}function Za(t,e,n,o,a){const l=Math.min(a.pointToSegmentDistance(t,n,o),a.pointToSegmentDistance(e,n,o)),d=Math.min(a.pointToSegmentDistance(n,t,e),a.pointToSegmentDistance(o,t,e));return Math.min(l,d)}function Ro(t,e,n,o,a){if(!ts(e,t.length)||!ts(o,n.length))return NaN;let l=1/0;for(let d=e[0];d<e[1];++d)for(let g=o[0];g<o[1];++g){if(Is(t[d],t[d+1],n[g],n[g+1]))return 0;l=Math.min(l,Za(t[d],t[d+1],n[g],n[g+1],a))}return l}function Ld(t,e,n,o,a){if(!ts(e,t.length)||!ts(o,n.length))return NaN;let l=1/0;for(let d=e[0];d<=e[1];++d)for(let g=o[0];g<=o[1];++g)if((l=Math.min(l,a.distance(t[d],n[g])))===0)return l;return l}function zd(t,e,n){if(Ha(t,e,!0))return 0;let o=1/0;for(const a of e){const l=a.length;if(l<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(a[0]!==a[l-1]&&(o=Math.min(o,n.pointToSegmentDistance(t,a[l-1],a[0])))===0||(o=Math.min(o,fu(t,a,n)))===0)return o}return o}function wh(t,e,n,o){if(!ts(e,t.length))return NaN;for(let l=e[0];l<=e[1];++l)if(Ha(t[l],n,!0))return 0;let a=1/0;for(let l=e[0];l<e[1];++l)for(const d of n)for(let g=0,v=d.length,b=v-1;g<v;b=g++){if(Is(t[l],t[l+1],d[b],d[g]))return 0;a=Math.min(a,Za(t[l],t[l+1],d[b],d[g],o))}return a}function wl(t,e){for(const n of t)for(let o=0;o<=n.length-1;++o)if(Ha(n[o],e,!0))return!0;return!1}function Fd(t,e,n,o=1/0){const a=sc(t),l=sc(e);if(o!==1/0&&ga(a,l,n)>=o)return o;if(Xs(a,l)){if(wl(t,e))return 0}else if(wl(e,t))return 0;let d=o;for(const g of t)for(let v=0,b=g.length,S=b-1;v<b;S=v++)for(const I of e)for(let D=0,F=I.length,N=F-1;D<F;N=D++){if(Is(g[S],g[v],I[N],I[D]))return 0;d=Math.min(d,Za(g[S],g[v],I[N],I[D],n))}return d}function ac(t,e,n,o,a,l,d){if(l===null||d===null)return;const g=ga(_a(o,l),_a(a,d),n);g<e&&t.push({dist:g,range1:l,range2:d})}function R(t,e,n,o,a=1/0){let l=Math.min(o.distance(t[0],n[0][0]),a);if(l===0)return l;const d=new Uo([{dist:0,range1:[0,t.length-1],range2:[0,0]}],oc),g=e?bl:cu,v=sc(n);for(;d.length;){const b=d.pop();if(b.dist>=l)continue;const S=b.range1;if(Qs(S)<=g){if(!ts(S,t.length))return NaN;if(e){const I=wh(t,S,n,o);if((l=Math.min(l,I))===0)return l}else for(let I=S[0];I<=S[1];++I){const D=zd(t[I],n,o);if((l=Math.min(l,D))===0)return l}}else{const I=hu(S,e);if(I[0]!==null){const D=ga(_a(t,I[0]),v,o);D<l&&d.push({dist:D,range1:I[0],range2:[0,0]})}if(I[1]!==null){const D=ga(_a(t,I[1]),v,o);D<l&&d.push({dist:D,range1:I[1],range2:[0,0]})}}}return l}function G(t,e,n,o,a,l=1/0){let d=Math.min(l,a.distance(t[0],n[0]));if(d===0)return d;const g=new Uo([{dist:0,range1:[0,t.length-1],range2:[0,n.length-1]}],oc),v=e?bl:cu,b=o?bl:cu;for(;g.length;){const S=g.pop();if(S.dist>=d)continue;const I=S.range1,D=S.range2;if(Qs(I)<=v&&Qs(D)<=b){if(!ts(I,t.length)||!ts(D,n.length))return NaN;if(e&&o?d=Math.min(d,Ro(t,I,n,D,a)):e||o?e&&!o?d=Math.min(d,bh(n,D,t,I,a)):!e&&o&&(d=Math.min(d,bh(t,I,n,D,a))):d=Math.min(d,Ld(t,I,n,D,a)),d===0)return d}else{const F=hu(I,e),N=hu(D,o);ac(g,d,a,t,n,F[0],N[0]),ac(g,d,a,t,n,F[0],N[1]),ac(g,d,a,t,n,F[1],N[0]),ac(g,d,a,t,n,F[1],N[1])}}return d}function te(t,e,n,o,a=1/0){let l=a;const d=_a(t,[0,t.length-1]);for(const g of n)if(!(l!==1/0&&ga(d,_a(g,[0,g.length-1]),o)>=l)&&(l=Math.min(l,G(t,e,g,!0,o,l)),l===0))return l;return l}function Me(t,e,n,o,a=1/0){let l=a;const d=_a(t,[0,t.length-1]);for(const g of n){if(l!==1/0&&ga(d,sc(g),o)>=l)continue;const v=R(t,e,g,o,l);if(isNaN(v))return v;if((l=Math.min(l,v))===0)return l}return l}function ze(t){return t==="Point"||t==="MultiPoint"||t==="LineString"||t==="MultiLineString"||t==="Polygon"||t==="MultiPolygon"}class We{constructor(e,n){this.type=en,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'distance' expression requires either one argument, but found ' ${e.length-1} instead.`);if(fa(e[1])){const o=e[1];if(o.type==="FeatureCollection"){for(let a=0;a<o.features.length;++a)if(ze(o.features[a].geometry.type))return new We(o,o.features[a].geometry)}else if(o.type==="Feature"){if(ze(o.geometry.type))return new We(o,o.geometry)}else if(ze(o.type))return new We(o,o)}return n.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(e){const n=e.geometry(),o=e.canonicalID();if(n!=null&&o!=null){if(e.geometryType()==="Point")return function(a,l,d){const g=[];for(const b of a)for(const S of b)g.push(Wa(S,l));const v=new Js(g[0][1],"meters");return d.type==="Point"||d.type==="MultiPoint"||d.type==="LineString"?G(g,!1,d.type==="Point"?[d.coordinates]:d.coordinates,d.type==="LineString",v):d.type==="MultiLineString"?te(g,!1,d.coordinates,v):d.type==="Polygon"||d.type==="MultiPolygon"?Me(g,!1,d.type==="Polygon"?[d.coordinates]:d.coordinates,v):null}(n,o,this.geometries);if(e.geometryType()==="LineString")return function(a,l,d){const g=[];for(const b of a){const S=[];for(const I of b)S.push(Wa(I,l));g.push(S)}const v=new Js(g[0][0][1],"meters");if(d.type==="Point"||d.type==="MultiPoint"||d.type==="LineString")return te(d.type==="Point"?[d.coordinates]:d.coordinates,d.type==="LineString",g,v);if(d.type==="MultiLineString"){let b=1/0;for(let S=0;S<d.coordinates.length;S++){const I=te(d.coordinates[S],!0,g,v,b);if(isNaN(I))return I;if((b=Math.min(b,I))===0)return b}return b}if(d.type==="Polygon"||d.type==="MultiPolygon"){let b=1/0;for(let S=0;S<g.length;S++){const I=Me(g[S],!0,d.type==="Polygon"?[d.coordinates]:d.coordinates,v,b);if(isNaN(I))return I;if((b=Math.min(b,I))===0)return b}return b}return null}(n,o,this.geometries);if(e.geometryType()==="Polygon")return function(a,l,d){const g=[];for(const b of function(S,I){const D=S.length;if(D<=1)return[S];const F=[];let N,V;for(let q=0;q<D;q++){const Y=kd(S[q]);Y!==0&&(S[q].area=Math.abs(Y),V===void 0&&(V=Y<0),V===Y<0?(N&&F.push(N),N=[S[q]]):N.push(S[q]))}return N&&F.push(N),F}(a)){const S=[];for(let I=0;I<b.length;++I)S.push(Rd(b[I],l));g.push(S)}const v=new Js(g[0][0][0][1],"meters");if(d.type==="Point"||d.type==="MultiPoint"||d.type==="LineString")return Me(d.type==="Point"?[d.coordinates]:d.coordinates,d.type==="LineString",g,v);if(d.type==="MultiLineString"){let b=1/0;for(let S=0;S<d.coordinates.length;S++){const I=Me(d.coordinates[S],!0,g,v,b);if(isNaN(I))return I;if((b=Math.min(b,I))===0)return b}return b}return d.type==="Polygon"||d.type==="MultiPolygon"?function(b,S,I){let D=1/0;for(const F of b)for(const N of S){const V=Fd(F,N,I,D);if(isNaN(V))return V;if((D=Math.min(D,V))===0)return D}return D}(d.type==="Polygon"?[d.coordinates]:d.coordinates,g,v):null}(n,o,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}var ut=We;function ht(t,e){switch(t){case"string":return jo(e);case"number":return+e;case"boolean":return!!e;case"color":return li.parse(e);case"formatted":return Qi.fromString(jo(e));case"resolvedImage":return bn.fromString(jo(e))}return e}function gt(t,e,n,o){return o!==void 0&&(t=o*Math.round(t/o)),e!==void 0&&t<e&&(t=e),n!==void 0&&t>n&&(t=n),t}class xt{constructor(e,n,o){this.type=e,this.key=n,this.scope=o}static parse(e,n){let o=n.expectedType;if(o==null&&(o=mr),e.length<2||e.length>3)return n.error("Invalid number of arguments for 'config' expression.");const a=n.parse(e[1],1);if(!(a instanceof Es))return n.error("Key name of 'config' expression must be a string literal.");if(e.length>=3){const l=n.parse(e[2],2);return l instanceof Es?new xt(o,jo(a.value),jo(l.value)):n.error("Scope of 'config' expression must be a string literal.")}return new xt(o,jo(a.value))}evaluate(e){const n=[this.key,this.scope,e.scope].filter(Boolean).join(""),o=e.getConfig(n);if(!o)return null;const{type:a,value:l,values:d,minValue:g,maxValue:v,stepValue:b}=o,S=o.default.evaluate(e);let I=S;if(l){const D=e.scope;e.scope=(D||"").split("").slice(1).join(""),I=l.evaluate(e),e.scope=D}return a&&(I=ht(a,I)),I===void 0||g===void 0&&v===void 0&&b===void 0||(typeof I=="number"?I=gt(I,g,v,b):Array.isArray(I)&&(I=I.map(D=>typeof D=="number"?gt(D,g,v,b):D))),l!==void 0&&I!==void 0&&d&&!d.includes(I)&&(I=S,a&&(I=ht(a,I))),(a&&a!==this.type||I!==void 0&&Fi(I)!==this.type)&&(I=ht(this.type.kind,I)),I}eachChild(){}outputDefined(){return!1}serialize(){const e=["config",this.key];return this.scope&&e.concat(this.key),e}}var Qt=xt;function Cn(t){if(t instanceof lr&&(t.name==="get"&&t.args.length===1||t.name==="feature-state"||t.name==="has"&&t.args.length===1||t.name==="properties"||t.name==="geometry-type"||t.name==="id"||/^filter-/.test(t.name))||t instanceof ic||t instanceof ut)return!1;let e=!0;return t.eachChild(n=>{e&&!Cn(n)&&(e=!1)}),e}function Pn(t){if(t instanceof lr&&t.name==="feature-state")return!1;let e=!0;return t.eachChild(n=>{e&&!Pn(n)&&(e=!1)}),e}function er(t){if(t instanceof Qt)return!1;let e=!0;return t.eachChild(n=>{e&&!er(n)&&(e=!1)}),e}function Er(t,e){if(t instanceof lr&&e.indexOf(t.name)>=0)return!1;let n=!0;return t.eachChild(o=>{n&&!Er(o,e)&&(n=!1)}),n}class tr{constructor(e,n){this.type=n.type,this.name=e,this.boundExpression=n}static parse(e,n){if(e.length!==2||typeof e[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const o=e[1];return n.scope.has(o)?new tr(o,n.scope.get(o)):n.error(`Unknown variable "${o}". Make sure "${o}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Fr=tr;class ci{constructor(e,n=[],o,a=new xo,l=[],d,g){this.registry=e,this.path=n,this.key=n.map(v=>`[${v}]`).join(""),this.scope=a,this.errors=l,this.expectedType=o,this._scope=d,this.options=g}parse(e,n,o,a,l={}){return n||o?this.concat(n,o,a)._parse(e,l):this._parse(e,l)}_parse(e,n){function o(a,l,d){return d==="assert"?new Ss(l,[a]):d==="coerce"?new Ms(l,[a]):a}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const a=typeof e[0]=="string"?this.registry[e[0]]:void 0;if(a){let l=a.parse(e,this);if(!l)return null;if(this.expectedType){const d=this.expectedType,g=l.type;if(d.kind!=="string"&&d.kind!=="number"&&d.kind!=="boolean"&&d.kind!=="object"&&d.kind!=="array"||g.kind!=="value")if(d.kind!=="color"&&d.kind!=="formatted"&&d.kind!=="resolvedImage"||g.kind!=="value"&&g.kind!=="string"){if(this.checkSubtype(d,g))return null}else l=o(l,d,n.typeAnnotation||"coerce");else l=o(l,d,n.typeAnnotation||"assert")}if(!(l instanceof Es)&&l.type.kind!=="resolvedImage"&&Bi(l)){const d=new Qc(this._scope,this.options);try{l=new Es(l.type,l.evaluate(d))}catch(g){return this.error(g.message),null}}return l}return Ms.parse(["to-array",e],this)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,n,o){const a=typeof e=="number"?this.path.concat(e):this.path,l=o?this.scope.concat(o):this.scope;return new ci(this.registry,a,n||null,l,this.errors,this._scope,this.options)}error(e,...n){const o=`${this.key}${n.map(a=>`[${a}]`).join("")}`;this.errors.push(new Do(o,e))}checkSubtype(e,n){const o=da(e,n);return o&&this.error(o),o}}var Ri=ci;function Bi(t){if(t instanceof Fr)return Bi(t.boundExpression);if(t instanceof lr&&t.name==="error"||t instanceof yl||t instanceof ic||t instanceof ut||t instanceof Qt)return!1;const e=t instanceof Ms||t instanceof Ss;let n=!0;return t.eachChild(o=>{n=e?n&&Bi(o):n&&o instanceof Es}),!!n&&Cn(t)&&Er(t,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Vr(t,e){const n=t.length-1;let o,a,l=0,d=n,g=0;for(;l<=d;)if(g=Math.floor((l+d)/2),o=t[g],a=t[g+1],o<=e){if(g===n||e<a)return g;l=g+1}else{if(!(o>e))throw new xi("Input is not a number.");d=g-1}return 0}class Jr{constructor(e,n,o){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(const[a,l]of o)this.labels.push(a),this.outputs.push(l)}static parse(e,n){if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");const o=n.parse(e[1],1,en);if(!o)return null;const a=[];let l=null;n.expectedType&&n.expectedType.kind!=="value"&&(l=n.expectedType);for(let d=1;d<e.length;d+=2){const g=d===1?-1/0:e[d],v=e[d+1],b=d,S=d+1;if(typeof g!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',b);if(a.length&&a[a.length-1][0]>=g)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',b);const I=n.parse(v,S,l);if(!I)return null;l=l||I.type,a.push([g,I])}return new Jr(l,o,a)}evaluate(e){const n=this.labels,o=this.outputs;if(n.length===1)return o[0].evaluate(e);const a=this.input.evaluate(e);if(a<=n[0])return o[0].evaluate(e);const l=n.length;return a>=n[l-1]?o[l-1].evaluate(e):o[Vr(n,a)].evaluate(e)}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let n=0;n<this.labels.length;n++)n>0&&e.push(this.labels[n]),e.push(this.outputs[n].serialize());return e}}var ri=Jr;const Ni=.95047,bi=1.08883,so=4/29,ji=6/29,Vi=3*ji*ji,$o=ji*ji*ji,Go=Math.PI/180,ao=180/Math.PI;function cs(t){return t>$o?Math.pow(t,1/3):t/Vi+so}function _o(t){return t>ji?t*t*t:Vi*(t-so)}function Eo(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function ya(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Cs(t){const e=ya(t.r),n=ya(t.g),o=ya(t.b),a=cs((.4124564*e+.3575761*n+.1804375*o)/Ni),l=cs((.2126729*e+.7151522*n+.072175*o)/1);return{l:116*l-16,a:500*(a-l),b:200*(l-cs((.0193339*e+.119192*n+.9503041*o)/bi)),alpha:t.a}}function Ya(t){let e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,o=isNaN(t.b)?e:e-t.b/200;return e=1*_o(e),n=Ni*_o(n),o=bi*_o(o),new li(Eo(3.2404542*n-1.5371385*e-.4985314*o),Eo(-.969266*n+1.8760108*e+.041556*o),Eo(.0556434*n-.2040259*e+1.0572252*o),t.alpha)}function lc(t,e,n){const o=e-t;return t+n*(o>180||o<-180?o-360*Math.round(o/360):o)}const us={forward:Cs,reverse:Ya,interpolate:function(t,e,n){return{l:Zn(t.l,e.l,n),a:Zn(t.a,e.a,n),b:Zn(t.b,e.b,n),alpha:Zn(t.alpha,e.alpha,n)}}},Ps={forward:function(t){const{l:e,a:n,b:o}=Cs(t),a=Math.atan2(o,n)*ao;return{h:a<0?a+360:a,c:Math.sqrt(n*n+o*o),l:e,alpha:t.a}},reverse:function(t){const e=t.h*Go,n=t.c;return Ya({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:lc(t.h,e.h,n),c:Zn(t.c,e.c,n),l:Zn(t.l,e.l,n),alpha:Zn(t.alpha,e.alpha,n)}}};var Ds=Object.freeze({__proto__:null,hcl:Ps,lab:us});class Lo{constructor(e,n,o,a,l){this.type=e,this.operator=n,this.interpolation=o,this.input=a,this.labels=[],this.outputs=[];for(const[d,g]of l)this.labels.push(d),this.outputs.push(g)}static interpolationFactor(e,n,o,a){let l=0;if(e.name==="exponential")l=ks(n,e.base,o,a);else if(e.name==="linear")l=ks(n,1,o,a);else if(e.name==="cubic-bezier"){const d=e.controlPoints;l=new Be(d[0],d[1],d[2],d[3]).solve(ks(n,1,o,a))}return l}static parse(e,n){let[o,a,l,...d]=e;if(!Array.isArray(a)||a.length===0)return n.error("Expected an interpolation type expression.",1);if(a[0]==="linear")a={name:"linear"};else if(a[0]==="exponential"){const b=a[1];if(typeof b!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);a={name:"exponential",base:b}}else{if(a[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(a[0])}`,1,0);{const b=a.slice(1);if(b.length!==4||b.some(S=>typeof S!="number"||S<0||S>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);a={name:"cubic-bezier",controlPoints:b}}}if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(l=n.parse(l,2,en),!l)return null;const g=[];let v=null;o==="interpolate-hcl"||o==="interpolate-lab"?v=ko:n.expectedType&&n.expectedType.kind!=="value"&&(v=n.expectedType);for(let b=0;b<d.length;b+=2){const S=d[b],I=d[b+1],D=b+3,F=b+4;if(typeof S!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(g.length&&g[g.length-1][0]>=S)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',D);const N=n.parse(I,F,v);if(!N)return null;v=v||N.type,g.push([S,N])}return v.kind==="number"||v.kind==="color"||v.kind==="array"&&v.itemType.kind==="number"&&typeof v.N=="number"?new Lo(v,o,a,l,g):n.error(`Type ${Ai(v)} is not interpolatable.`)}evaluate(e){const n=this.labels,o=this.outputs;if(n.length===1)return o[0].evaluate(e);const a=this.input.evaluate(e);if(a<=n[0])return o[0].evaluate(e);const l=n.length;if(a>=n[l-1])return o[l-1].evaluate(e);const d=Vr(n,a),g=Lo.interpolationFactor(this.interpolation,a,n[d],n[d+1]),v=o[d].evaluate(e),b=o[d+1].evaluate(e);return this.operator==="interpolate"?Ba[this.type.kind.toLowerCase()](v,b,g):this.operator==="interpolate-hcl"?Ps.reverse(Ps.interpolate(Ps.forward(v),Ps.forward(b),g)):us.reverse(us.interpolate(us.forward(v),us.forward(b),g))}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const n=[this.operator,e,this.input.serialize()];for(let o=0;o<this.labels.length;o++)n.push(this.labels[o],this.outputs[o].serialize());return n}}function ks(t,e,n,o){const a=o-n,l=t-n;return a===0?0:e===1?l/a:(Math.pow(e,l)-1)/(Math.pow(e,a)-1)}var lo=Lo;class ns{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expectected at least one argument.");let o=null;const a=n.expectedType;a&&a.kind!=="value"&&(o=a);const l=[];for(const g of e.slice(1)){const v=n.parse(g,1+l.length,o,void 0,{typeAnnotation:"omit"});if(!v)return null;o=o||v.type,l.push(v)}const d=a&&l.some(g=>da(a,g.type));return new ns(d?mr:o,l)}evaluate(e){let n,o=null,a=0;for(const l of this.args){if(a++,o=l.evaluate(e),o&&o instanceof bn&&!o.available&&(n||(n=o),o=null,a===this.args.length))return n;if(o!==null)break}return o}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(n=>{e.push(n.serialize())}),e}}var pu=ns;class cc{constructor(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const n of this.bindings)e(n[1]);e(this.result)}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const o=[];for(let l=1;l<e.length-1;l+=2){const d=e[l];if(typeof d!="string")return n.error(`Expected string, but found ${typeof d} instead.`,l);if(/[^a-zA-Z0-9_]/.test(d))return n.error("Variable names must contain only alphanumeric characters or '_'.",l);const g=n.parse(e[l+1],l+1);if(!g)return null;o.push([d,g])}const a=n.parse(e[e.length-1],e.length-1,n.expectedType,o);return a?new cc(o,a):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[n,o]of this.bindings)e.push(n,o.serialize());return e.push(this.result.serialize()),e}}var Tl=cc;class ea{constructor(e,n,o){this.type=e,this.index=n,this.input=o}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const o=n.parse(e[1],1,en),a=n.parse(e[2],2,Oi(n.expectedType||mr));return o&&a?new ea(a.type.itemType,o,a):null}evaluate(e){const n=this.index.evaluate(e),o=this.input.evaluate(e);if(n<0)throw new xi(`Array index out of bounds: ${n} < 0.`);if(n>=o.length)throw new xi(`Array index out of bounds: ${n} > ${o.length-1}.`);if(n!==Math.floor(n))throw new xi(`Array index must be an integer, but found ${n} instead.`);return o[n]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var fr=ea;class mu{constructor(e,n){this.type=xr,this.needle=e,this.haystack=n}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const o=n.parse(e[1],1,mr),a=n.parse(e[2],2,mr);return o&&a?Dn(o.type,[xr,vr,en,Ts,mr])?new mu(o,a):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ai(o.type)} instead`):null}evaluate(e){const n=this.needle.evaluate(e),o=this.haystack.evaluate(e);if(o==null)return!1;if(!es(n,["boolean","string","number","null"]))throw new xi(`Expected first argument to be of type boolean, string, number or null, but found ${Ai(Fi(n))} instead.`);if(!es(o,["string","array"]))throw new xi(`Expected second argument to be of type array or string, but found ${Ai(Fi(o))} instead.`);return o.indexOf(n)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Bd=mu;class El{constructor(e,n,o){this.type=en,this.needle=e,this.haystack=n,this.fromIndex=o}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const o=n.parse(e[1],1,mr),a=n.parse(e[2],2,mr);if(!o||!a)return null;if(!Dn(o.type,[xr,vr,en,Ts,mr]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ai(o.type)} instead`);if(e.length===4){const l=n.parse(e[3],3,en);return l?new El(o,a,l):null}return new El(o,a)}evaluate(e){const n=this.needle.evaluate(e),o=this.haystack.evaluate(e);if(!es(n,["boolean","string","number","null"]))throw new xi(`Expected first argument to be of type boolean, string, number or null, but found ${Ai(Fi(n))} instead.`);if(!es(o,["string","array"]))throw new xi(`Expected second argument to be of type array or string, but found ${Ai(Fi(o))} instead.`);if(this.fromIndex){const a=this.fromIndex.evaluate(e);return o.indexOf(n,a)}return o.indexOf(n)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var _u=El;class gu{constructor(e,n,o,a,l,d){this.inputType=e,this.type=n,this.input=o,this.cases=a,this.outputs=l,this.otherwise=d}static parse(e,n){if(e.length<5)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return n.error("Expected an even number of arguments.");let o,a;n.expectedType&&n.expectedType.kind!=="value"&&(a=n.expectedType);const l={},d=[];for(let b=2;b<e.length-1;b+=2){let S=e[b];const I=e[b+1];Array.isArray(S)||(S=[S]);const D=n.concat(b);if(S.length===0)return D.error("Expected at least one branch label.");for(const N of S){if(typeof N!="number"&&typeof N!="string")return D.error("Branch labels must be numbers or strings.");if(typeof N=="number"&&Math.abs(N)>Number.MAX_SAFE_INTEGER)return D.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof N=="number"&&Math.floor(N)!==N)return D.error("Numeric branch labels must be integer values.");if(o){if(D.checkSubtype(o,Fi(N)))return null}else o=Fi(N);if(l[String(N)]!==void 0)return D.error("Branch labels must be unique.");l[String(N)]=d.length}const F=n.parse(I,b,a);if(!F)return null;a=a||F.type,d.push(F)}const g=n.parse(e[1],1,mr);if(!g)return null;const v=n.parse(e[e.length-1],e.length-1,a);return v?g.type.kind!=="value"&&n.concat(1).checkSubtype(o,g.type)?null:new gu(o,a,g,l,d,v):null}evaluate(e){const n=this.input.evaluate(e);return(Fi(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],n=Object.keys(this.cases).sort(),o=[],a={};for(const d of n){const g=a[this.cases[d]];g===void 0?(a[this.cases[d]]=o.length,o.push([this.cases[d],[d]])):o[g][1].push(d)}const l=d=>this.inputType.kind==="number"?Number(d):d;for(const[d,g]of o)e.push(g.length===1?l(g[0]):g.map(l)),e.push(this.outputs[d].serialize());return e.push(this.otherwise.serialize()),e}}var Th=gu;class hs{constructor(e,n,o){this.type=e,this.branches=n,this.otherwise=o}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return n.error("Expected an odd number of arguments.");let o;n.expectedType&&n.expectedType.kind!=="value"&&(o=n.expectedType);const a=[];for(let d=1;d<e.length-1;d+=2){const g=n.parse(e[d],d,xr);if(!g)return null;const v=n.parse(e[d+1],d+1,o);if(!v)return null;a.push([g,v]),o=o||v.type}const l=n.parse(e[e.length-1],e.length-1,o);return l?new hs(o,a,l):null}evaluate(e){for(const[n,o]of this.branches)if(n.evaluate(e))return o.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[n,o]of this.branches)e(n),e(o);e(this.otherwise)}outputDefined(){return this.branches.every(([e,n])=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(n=>{e.push(n.serialize())}),e}}var Sl=hs;class Xa{constructor(e,n,o,a){this.type=e,this.input=n,this.beginIndex=o,this.endIndex=a}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const o=n.parse(e[1],1,mr),a=n.parse(e[2],2,en);if(!o||!a)return null;if(!Dn(o.type,[Oi(mr),vr,mr]))return n.error(`Expected first argument to be of type array or string, but found ${Ai(o.type)} instead`);if(e.length===4){const l=n.parse(e[3],3,en);return l?new Xa(o.type,o,a,l):null}return new Xa(o.type,o,a)}evaluate(e){const n=this.input.evaluate(e),o=this.beginIndex.evaluate(e);if(!es(n,["string","array"]))throw new xi(`Expected first argument to be of type array or string, but found ${Ai(Fi(n))} instead.`);if(this.endIndex){const a=this.endIndex.evaluate(e);return n.slice(o,a)}return n.slice(o)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var va=Xa;function Ml(t,e){return t==="=="||t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function uc(t,e,n,o){return o.compare(e,n)===0}function xa(t,e,n){const o=t!=="=="&&t!=="!=";return class TM{constructor(l,d,g){this.type=xr,this.lhs=l,this.rhs=d,this.collator=g,this.hasUntypedArgument=l.type.kind==="value"||d.type.kind==="value"}static parse(l,d){if(l.length!==3&&l.length!==4)return d.error("Expected two or three arguments.");const g=l[0];let v=d.parse(l[1],1,mr);if(!v)return null;if(!Ml(g,v.type))return d.concat(1).error(`"${g}" comparisons are not supported for type '${Ai(v.type)}'.`);let b=d.parse(l[2],2,mr);if(!b)return null;if(!Ml(g,b.type))return d.concat(2).error(`"${g}" comparisons are not supported for type '${Ai(b.type)}'.`);if(v.type.kind!==b.type.kind&&v.type.kind!=="value"&&b.type.kind!=="value")return d.error(`Cannot compare types '${Ai(v.type)}' and '${Ai(b.type)}'.`);o&&(v.type.kind==="value"&&b.type.kind!=="value"?v=new Ss(b.type,[v]):v.type.kind!=="value"&&b.type.kind==="value"&&(b=new Ss(v.type,[b])));let S=null;if(l.length===4){if(v.type.kind!=="string"&&b.type.kind!=="string"&&v.type.kind!=="value"&&b.type.kind!=="value")return d.error("Cannot use collator to compare non-string types.");if(S=d.parse(l[3],3,ec),!S)return null}return new TM(v,b,S)}evaluate(l){const d=this.lhs.evaluate(l),g=this.rhs.evaluate(l);if(o&&this.hasUntypedArgument){const v=Fi(d),b=Fi(g);if(v.kind!==b.kind||v.kind!=="string"&&v.kind!=="number")throw new xi(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${v.kind}, ${b.kind}) instead.`)}if(this.collator&&!o&&this.hasUntypedArgument){const v=Fi(d),b=Fi(g);if(v.kind!=="string"||b.kind!=="string")return e(l,d,g)}return this.collator?n(l,d,g,this.collator.evaluate(l)):e(l,d,g)}eachChild(l){l(this.lhs),l(this.rhs),this.collator&&l(this.collator)}outputDefined(){return!0}serialize(){const l=[t];return this.eachChild(d=>{l.push(d.serialize())}),l}}}const hc=xa("==",function(t,e,n){return e===n},uc),dc=xa("!=",function(t,e,n){return e!==n},function(t,e,n,o){return!uc(0,e,n,o)}),Tg=xa("<",function(t,e,n){return e<n},function(t,e,n,o){return o.compare(e,n)<0}),Eg=xa(">",function(t,e,n){return e>n},function(t,e,n,o){return o.compare(e,n)>0}),Np=xa("<=",function(t,e,n){return e<=n},function(t,e,n,o){return o.compare(e,n)<=0}),Sg=xa(">=",function(t,e,n){return e>=n},function(t,e,n,o){return o.compare(e,n)>=0});class Nd{constructor(e,n,o,a,l,d){this.type=vr,this.number=e,this.locale=n,this.currency=o,this.unit=a,this.minFractionDigits=l,this.maxFractionDigits=d}static parse(e,n){if(e.length!==3)return n.error("Expected two arguments.");const o=n.parse(e[1],1,en);if(!o)return null;const a=e[2];if(typeof a!="object"||Array.isArray(a))return n.error("NumberFormat options argument must be an object.");let l=null;if(a.locale&&(l=n.parse(a.locale,1,vr),!l))return null;let d=null;if(a.currency&&(d=n.parse(a.currency,1,vr),!d))return null;let g=null;if(a.unit&&(g=n.parse(a.unit,1,vr),!g))return null;let v=null;if(a["min-fraction-digits"]&&(v=n.parse(a["min-fraction-digits"],1,en),!v))return null;let b=null;return a["max-fraction-digits"]&&(b=n.parse(a["max-fraction-digits"],1,en),!b)?null:new Nd(o,l,d,g,v,b)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class jd{constructor(e){this.type=en,this.input=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const o=n.parse(e[1],1);return o?o.type.kind!=="array"&&o.type.kind!=="string"&&o.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${Ai(o.type)} instead.`):new jd(o):null}evaluate(e){const n=this.input.evaluate(e);if(typeof n=="string"||Array.isArray(n))return n.length;throw new xi(`Expected value to be of type string or array, but found ${Ai(Fi(n))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(n=>{e.push(n.serialize())}),e}}function jp(t){return function(){t=1831565813+(t|=0)|0;let e=Math.imul(t^t>>>15,1|t);return e=e+Math.imul(e^e>>>7,61|e)^e,((e^e>>>14)>>>0)/4294967296}}const Vd={"==":hc,"!=":dc,">":Eg,"<":Tg,">=":Sg,"<=":Np,array:Ss,at:fr,boolean:Ss,case:Sl,coalesce:pu,collator:yl,format:$a,image:pa,in:Bd,"index-of":_u,interpolate:lo,"interpolate-hcl":lo,"interpolate-lab":lo,length:jd,let:Tl,literal:Es,match:Th,number:Ss,"number-format":Nd,object:Ss,slice:va,step:ri,string:Ss,"to-boolean":Ms,"to-color":Ms,"to-number":Ms,"to-string":Ms,var:Fr,within:ic,distance:ut,config:Qt};function Ud(t,[e,n,o,a]){e=e.evaluate(t),n=n.evaluate(t),o=o.evaluate(t);const l=a?a.evaluate(t):1,d=vh(e,n,o,l);if(d)throw new xi(d);return new li(e/255*l,n/255*l,o/255*l,l)}function Vp(t,[e,n,o,a]){e=e.evaluate(t),n=n.evaluate(t),o=o.evaluate(t);const l=a?a.evaluate(t):1,d=function(b,S,I,D){return typeof b=="number"&&b>=0&&b<=360?typeof S=="number"&&S>=0&&S<=100&&typeof I=="number"&&I>=0&&I<=100?D===void 0||typeof D=="number"&&D>=0&&D<=1?null:`Invalid hsla value [${[b,S,I,D].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof D=="number"?[b,S,I,D]:[b,S,I]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof D=="number"?[b,S,I,D]:[b,S,I]).join(", ")}]: 'h' must be between 0 and 360.`}(e,n,o,l);if(d)throw new xi(d);const g=`hsla(${e}, ${n}%, ${o}%, ${l})`,v=li.parse(g);if(!v)throw new xi(`Failed to parse HSLA color: ${g}`);return v}function $d(t,e){return t in e}function Gd(t,e){const n=e[t];return n===void 0?null:n}function Al(t){return{type:t}}lr.register(Vd,{error:[{kind:"error"},[vr],(t,[e])=>{throw new xi(e.evaluate(t))}],typeof:[vr,[mr],(t,[e])=>Ai(Fi(e.evaluate(t)))],"to-rgba":[Oi(en,4),[ko],(t,[e])=>e.evaluate(t).toArray()],rgb:[ko,[en,en,en],Ud],rgba:[ko,[en,en,en,en],Ud],hsl:[ko,[en,en,en],Vp],hsla:[ko,[en,en,en,en],Vp],has:{type:xr,overloads:[[[vr],(t,[e])=>$d(e.evaluate(t),t.properties())],[[vr,ja],(t,[e,n])=>$d(e.evaluate(t),n.evaluate(t))]]},get:{type:mr,overloads:[[[vr],(t,[e])=>Gd(e.evaluate(t),t.properties())],[[vr,ja],(t,[e,n])=>Gd(e.evaluate(t),n.evaluate(t))]]},"feature-state":[mr,[vr],(t,[e])=>Gd(e.evaluate(t),t.featureState||{})],properties:[ja,[],t=>t.properties()],"geometry-type":[vr,[],t=>t.geometryType()],id:[mr,[],t=>t.id()],zoom:[en,[],t=>t.globals.zoom],pitch:[en,[],t=>t.globals.pitch||0],"distance-from-center":[en,[],t=>t.distanceFromCenter()],"measure-light":[en,[vr],(t,[e])=>t.measureLight(e.evaluate(t))],"heatmap-density":[en,[],t=>t.globals.heatmapDensity||0],"line-progress":[en,[],t=>t.globals.lineProgress||0],"raster-value":[en,[],t=>t.globals.rasterValue||0],"raster-particle-speed":[en,[],t=>t.globals.rasterParticleSpeed||0],"sky-radial-progress":[en,[],t=>t.globals.skyRadialProgress||0],accumulated:[mr,[],t=>t.globals.accumulated===void 0?null:t.globals.accumulated],"+":[en,Al(en),(t,e)=>{let n=0;for(const o of e)n+=o.evaluate(t);return n}],"*":[en,Al(en),(t,e)=>{let n=1;for(const o of e)n*=o.evaluate(t);return n}],"-":{type:en,overloads:[[[en,en],(t,[e,n])=>e.evaluate(t)-n.evaluate(t)],[[en],(t,[e])=>-e.evaluate(t)]]},"/":[en,[en,en],(t,[e,n])=>e.evaluate(t)/n.evaluate(t)],"%":[en,[en,en],(t,[e,n])=>e.evaluate(t)%n.evaluate(t)],ln2:[en,[],()=>Math.LN2],pi:[en,[],()=>Math.PI],e:[en,[],()=>Math.E],"^":[en,[en,en],(t,[e,n])=>Math.pow(e.evaluate(t),n.evaluate(t))],sqrt:[en,[en],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[en,[en],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[en,[en],(t,[e])=>Math.log(e.evaluate(t))],log2:[en,[en],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[en,[en],(t,[e])=>Math.sin(e.evaluate(t))],cos:[en,[en],(t,[e])=>Math.cos(e.evaluate(t))],tan:[en,[en],(t,[e])=>Math.tan(e.evaluate(t))],asin:[en,[en],(t,[e])=>Math.asin(e.evaluate(t))],acos:[en,[en],(t,[e])=>Math.acos(e.evaluate(t))],atan:[en,[en],(t,[e])=>Math.atan(e.evaluate(t))],min:[en,Al(en),(t,e)=>Math.min(...e.map(n=>n.evaluate(t)))],max:[en,Al(en),(t,e)=>Math.max(...e.map(n=>n.evaluate(t)))],abs:[en,[en],(t,[e])=>Math.abs(e.evaluate(t))],round:[en,[en],(t,[e])=>{const n=e.evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[en,[en],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[en,[en],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[xr,[vr,mr],(t,[e,n])=>t.properties()[e.value]===n.value],"filter-id-==":[xr,[mr],(t,[e])=>t.id()===e.value],"filter-type-==":[xr,[vr],(t,[e])=>t.geometryType()===e.value],"filter-<":[xr,[vr,mr],(t,[e,n])=>{const o=t.properties()[e.value],a=n.value;return typeof o==typeof a&&o<a}],"filter-id-<":[xr,[mr],(t,[e])=>{const n=t.id(),o=e.value;return typeof n==typeof o&&n<o}],"filter->":[xr,[vr,mr],(t,[e,n])=>{const o=t.properties()[e.value],a=n.value;return typeof o==typeof a&&o>a}],"filter-id->":[xr,[mr],(t,[e])=>{const n=t.id(),o=e.value;return typeof n==typeof o&&n>o}],"filter-<=":[xr,[vr,mr],(t,[e,n])=>{const o=t.properties()[e.value],a=n.value;return typeof o==typeof a&&o<=a}],"filter-id-<=":[xr,[mr],(t,[e])=>{const n=t.id(),o=e.value;return typeof n==typeof o&&n<=o}],"filter->=":[xr,[vr,mr],(t,[e,n])=>{const o=t.properties()[e.value],a=n.value;return typeof o==typeof a&&o>=a}],"filter-id->=":[xr,[mr],(t,[e])=>{const n=t.id(),o=e.value;return typeof n==typeof o&&n>=o}],"filter-has":[xr,[mr],(t,[e])=>e.value in t.properties()],"filter-has-id":[xr,[],t=>t.id()!==null&&t.id()!==void 0],"filter-type-in":[xr,[Oi(vr)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[xr,[Oi(mr)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[xr,[vr,Oi(mr)],(t,[e,n])=>n.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[xr,[vr,Oi(mr)],(t,[e,n])=>function(o,a,l,d){for(;l<=d;){const g=l+d>>1;if(a[g]===o)return!0;a[g]>o?d=g-1:l=g+1}return!1}(t.properties()[e.value],n.value,0,n.value.length-1)],all:{type:xr,overloads:[[[xr,xr],(t,[e,n])=>e.evaluate(t)&&n.evaluate(t)],[Al(xr),(t,e)=>{for(const n of e)if(!n.evaluate(t))return!1;return!0}]]},any:{type:xr,overloads:[[[xr,xr],(t,[e,n])=>e.evaluate(t)||n.evaluate(t)],[Al(xr),(t,e)=>{for(const n of e)if(n.evaluate(t))return!0;return!1}]]},"!":[xr,[xr],(t,[e])=>!e.evaluate(t)],"is-supported-script":[xr,[vr],(t,[e])=>{const n=t.globals&&t.globals.isSupportedScript;return!n||n(e.evaluate(t))}],upcase:[vr,[vr],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[vr,[vr],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[vr,Al(mr),(t,e)=>e.map(n=>jo(n.evaluate(t))).join("")],"resolved-locale":[vr,[ec],(t,[e])=>e.evaluate(t).resolvedLocale()],random:[en,[en,en,mr],(t,e)=>{const[n,o,a]=e.map(d=>d.evaluate(t));if(n>o||n===o)return n;let l;if(typeof a=="string")l=function(d){let g=0;if(d.length===0)return g;for(let v=0;v<d.length;v++)g=(g<<5)-g+d.charCodeAt(v),g|=0;return g}(a);else{if(typeof a!="number")throw new xi(`Invalid seed input: ${a}`);l=a}return n+jp(l)()*(o-n)}]});var fc=Vd;function Hd(t){return{result:"success",value:t}}function Il(t){return{result:"error",value:t}}function Up(t,e){return!!t&&!!t.parameters&&t.parameters.indexOf(e)>-1}function Eh(t){return t["property-type"]==="data-driven"}function qd(t){return Up(t.expression,"measure-light")}function $p(t){return Up(t.expression,"zoom")}function Wd(t){return!!t.expression&&t.expression.interpolated}function Sh(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function Gp(t){return t}function Zd(t,e){const n=e.type==="color",o=t.stops&&typeof t.stops[0][0]=="object",a=o||!(o||t.property!==void 0),l=t.type||(Wd(e)?"exponential":"interval");if(n&&((t=yn({},t)).stops&&(t.stops=t.stops.map(b=>[b[0],li.parse(b[1])])),t.default=li.parse(t.default?t.default:e.default)),t.colorSpace&&t.colorSpace!=="rgb"&&!Ds[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let d,g,v;if(l==="exponential")d=Hp;else if(l==="interval")d=Ag;else if(l==="categorical"){d=Mg,g=Object.create(null);for(const b of t.stops)g[b[0]]=b[1];v=typeof t.stops[0][0]}else{if(l!=="identity")throw new Error(`Unknown function type "${l}"`);d=qp}if(o){const b={},S=[];for(let F=0;F<t.stops.length;F++){const N=t.stops[F],V=N[0].zoom;b[V]===void 0&&(b[V]={zoom:V,type:t.type,property:t.property,default:t.default,stops:[]},S.push(V)),b[V].stops.push([N[0].value,N[1]])}const I=[];for(const F of S)I.push([b[F].zoom,Zd(b[F],e)]);const D={name:"linear"};return{kind:"composite",interpolationType:D,interpolationFactor:lo.interpolationFactor.bind(void 0,D),zoomStops:I.map(F=>F[0]),evaluate:({zoom:F},N)=>Hp({stops:I,base:t.base},e,F).evaluate(F,N)}}if(a){const b=l==="exponential"?{name:"exponential",base:t.base!==void 0?t.base:1}:null;return{kind:"camera",interpolationType:b,interpolationFactor:lo.interpolationFactor.bind(void 0,b),zoomStops:t.stops.map(S=>S[0]),evaluate:({zoom:S})=>d(t,e,S,g,v)}}return{kind:"source",evaluate(b,S){const I=S&&S.properties?S.properties[t.property]:void 0;return I===void 0?yu(t.default,e.default):d(t,e,I,g,v)}}}function yu(t,e,n){return t!==void 0?t:e!==void 0?e:n!==void 0?n:void 0}function Mg(t,e,n,o,a){return yu(typeof n===a?o[n]:void 0,t.default,e.default)}function Ag(t,e,n){if(ma(n)!=="number")return yu(t.default,e.default);const o=t.stops.length;if(o===1||n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[o-1][0])return t.stops[o-1][1];const a=Vr(t.stops.map(l=>l[0]),n);return t.stops[a][1]}function Hp(t,e,n){const o=t.base!==void 0?t.base:1;if(ma(n)!=="number")return yu(t.default,e.default);const a=t.stops.length;if(a===1||n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[a-1][0])return t.stops[a-1][1];const l=Vr(t.stops.map(S=>S[0]),n),d=function(S,I,D,F){const N=F-D,V=S-D;return N===0?0:I===1?V/N:(Math.pow(I,V)-1)/(Math.pow(I,N)-1)}(n,o,t.stops[l][0],t.stops[l+1][0]),g=t.stops[l][1],v=t.stops[l+1][1];let b=Ba[e.type]||Gp;if(t.colorSpace&&t.colorSpace!=="rgb"){const S=Ds[t.colorSpace];b=(I,D)=>S.reverse(S.interpolate(S.forward(I),S.forward(D),d))}return typeof g.evaluate=="function"?{evaluate(...S){const I=g.evaluate.apply(void 0,S),D=v.evaluate.apply(void 0,S);if(I!==void 0&&D!==void 0)return b(I,D,d)}}:b(g,v,d)}function qp(t,e,n){return e.type==="color"?n=li.parse(n):e.type==="formatted"?n=Qi.fromString(n.toString()):e.type==="resolvedImage"?n=bn.fromString(n.toString()):ma(n)===e.type||e.type==="enum"&&e.values[n]||(n=void 0),yu(n,t.default,e.default)}class Mh{constructor(e,n,o,a){this.expression=e,this._warningHistory={},this._evaluator=new Qc(o,a),this._defaultValue=n?function(l){return l.type==="color"&&(Sh(l.default)||Array.isArray(l.default))?new li(0,0,0,0):l.type==="color"?li.parse(l.default)||null:l.default===void 0?null:l.default}(n):null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(e,n,o,a,l,d,g,v){return this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=o,this._evaluator.canonical=a||null,this._evaluator.availableImages=l||null,this._evaluator.formattedSection=d,this._evaluator.featureTileCoord=g||null,this._evaluator.featureDistanceData=v||null,this.expression.evaluate(this._evaluator)}evaluate(e,n,o,a,l,d,g,v){this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=o||null,this._evaluator.canonical=a||null,this._evaluator.availableImages=l||null,this._evaluator.formattedSection=d||null,this._evaluator.featureTileCoord=g||null,this._evaluator.featureDistanceData=v||null;try{const b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new xi(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function vu(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in fc}function Ah(t,e,n,o){const a=new Ri(fc,[],e?function(d){const g={color:ko,string:vr,number:en,enum:vr,boolean:xr,formatted:Va,resolvedImage:Ua};return d.type==="array"?Oi(g[d.value]||mr,d.length):g[d.type]}(e):void 0,void 0,void 0,n,o),l=a.parse(t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?Hd(new Mh(l,e,n,o)):Il(a.errors)}class Yd{constructor(e,n,o){this.kind=e,this._styleExpression=n,this.isLightConstant=o,this.isStateDependent=e!=="constant"&&!Pn(n.expression),this.isConfigDependent=!er(n.expression)}evaluateWithoutErrorHandling(e,n,o,a,l,d){return this._styleExpression.evaluateWithoutErrorHandling(e,n,o,a,l,d)}evaluate(e,n,o,a,l,d){return this._styleExpression.evaluate(e,n,o,a,l,d)}}class xu{constructor(e,n,o,a,l){this.kind=e,this.zoomStops=o,this._styleExpression=n,this.isStateDependent=e!=="camera"&&!Pn(n.expression),this.isLightConstant=l,this.isConfigDependent=!er(n.expression),this.interpolationType=a}evaluateWithoutErrorHandling(e,n,o,a,l,d){return this._styleExpression.evaluateWithoutErrorHandling(e,n,o,a,l,d)}evaluate(e,n,o,a,l,d){return this._styleExpression.evaluate(e,n,o,a,l,d)}interpolationFactor(e,n,o){return this.interpolationType?lo.interpolationFactor(this.interpolationType,e,n,o):0}}function Ih(t,e,n,o){if((t=Ah(t,e,n,o)).result==="error")return t;const a=t.value.expression,l=Cn(a);if(!l&&!Eh(e))return Il([new Do("","data expressions not supported")]);const d=Er(a,["zoom","pitch","distance-from-center"]);if(!d&&!$p(e))return Il([new Do("","zoom expressions not supported")]);const g=Er(a,["measure-light"]);if(!g&&!qd(e))return Il([new Do("","measure-light expression not supported")]);const v=e.expression&&e.expression.relaxZoomRestriction,b=wu(a);return b||d||v?b instanceof Do?Il([b]):b instanceof lo&&!Wd(e)?Il([new Do("",'"interpolate" expressions cannot be used with this property')]):Hd(b?new xu(l?"camera":"composite",t.value,b.labels,b instanceof lo?b.interpolation:void 0,g):new Yd(l?"constant":"source",t.value,g)):Il([new Do("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class bu{constructor(e,n){this._parameters=e,this._specification=n,yn(this,Zd(this._parameters,this._specification))}static deserialize(e){return new bu(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function wu(t){let e=null;if(t instanceof Tl)e=wu(t.result);else if(t instanceof pu){for(const n of t.args)if(e=wu(n),e)break}else(t instanceof ri||t instanceof lo)&&t.input instanceof lr&&t.input.name==="zoom"&&(e=t);return e instanceof Do||t.eachChild(n=>{const o=wu(n);o instanceof Do?e=o:e&&o&&e!==o&&(e=new Do("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}var Ig=Rs,Os=3;function Rs(t,e,n){var o=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var a=new Int32Array(this.arrayBuffer);t=a[0],this.d=(e=a[1])+2*(n=a[2]);for(var l=0;l<this.d*this.d;l++){var d=a[Os+l],g=a[Os+l+1];o.push(d===g?null:a.subarray(d,g))}var v=a[Os+o.length+1];this.keys=a.subarray(a[Os+o.length],v),this.bboxes=a.subarray(v),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var b=0;b<this.d*this.d;b++)o.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var S=n/e*t;this.min=-S,this.max=t+S}Rs.prototype.insert=function(t,e,n,o,a){this._forEachCell(e,n,o,a,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(o),this.bboxes.push(a)},Rs.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Rs.prototype._insertCell=function(t,e,n,o,a,l){this.cells[a].push(l)},Rs.prototype.query=function(t,e,n,o,a){var l=this.min,d=this.max;if(t<=l&&e<=l&&d<=n&&d<=o&&!a)return Array.prototype.slice.call(this.keys);var g=[];return this._forEachCell(t,e,n,o,this._queryCell,g,{},a),g},Rs.prototype._queryCell=function(t,e,n,o,a,l,d,g){var v=this.cells[a];if(v!==null)for(var b=this.keys,S=this.bboxes,I=0;I<v.length;I++){var D=v[I];if(d[D]===void 0){var F=4*D;(g?g(S[F+0],S[F+1],S[F+2],S[F+3]):t<=S[F+2]&&e<=S[F+3]&&n>=S[F+0]&&o>=S[F+1])?(d[D]=!0,l.push(b[D])):d[D]=!1}}},Rs.prototype._forEachCell=function(t,e,n,o,a,l,d,g){for(var v=this._convertToCellCoord(t),b=this._convertToCellCoord(e),S=this._convertToCellCoord(n),I=this._convertToCellCoord(o),D=v;D<=S;D++)for(var F=b;F<=I;F++){var N=this.d*F+D;if((!g||g(this._convertFromCellCoord(D),this._convertFromCellCoord(F),this._convertFromCellCoord(D+1),this._convertFromCellCoord(F+1)))&&a.call(this,t,e,n,o,N,l,d,g))return}},Rs.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Rs.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Rs.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=Os+this.cells.length+1+1,n=0,o=0;o<this.cells.length;o++)n+=this.cells[o].length;var a=new Int32Array(e+n+this.keys.length+this.bboxes.length);a[0]=this.extent,a[1]=this.n,a[2]=this.padding;for(var l=e,d=0;d<t.length;d++){var g=t[d];a[Os+d]=l,a.set(g,l),l+=g.length}return a[Os+t.length]=l,a.set(this.keys,l),a[Os+t.length+1]=l+=this.keys.length,a.set(this.bboxes,l),l+=this.bboxes.length,a.buffer};var ba=ye(Ig);const Tu={};function sn(t,e,n={}){Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Tu[e]={klass:t,omit:n.omit||[]}}sn(Object,"Object"),ba.serialize=function(t,e){const n=t.toArrayBuffer();return e&&e.add(n),{buffer:n}},ba.deserialize=function(t){return new ba(t.buffer)},Object.defineProperty(ba,"name",{value:"Grid"}),sn(ba,"Grid"),sn(li,"Color"),sn(Error,"Error"),sn(Qi,"Formatted"),sn(Ws,"FormattedSection"),sn(rr,"AJAXError"),sn(bn,"ResolvedImage"),sn(bu,"StylePropertyFunction"),sn(Mh,"StyleExpression",{omit:["_evaluator"]}),sn(xu,"ZoomDependentExpression"),sn(Yd,"ZoomConstantExpression"),sn(lr,"CompoundExpression",{omit:["_evaluate"]});for(const t in fc)Tu[fc[t]._classRegistryKey]||sn(fc[t],`Expression${t}`);function Wp(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function Ch(t){return self.ImageBitmap&&t instanceof ImageBitmap}function Ka(t,e){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(Wp(t)||Ch(t))return e&&e.add(t),t;if(ArrayBuffer.isView(t)){const n=t;return e&&e.add(n.buffer),n}if(t instanceof ImageData)return e&&e.add(t.data.buffer),t;if(Array.isArray(t)){const n=[];for(const o of t)n.push(Ka(o,e));return n}if(t instanceof Map){const n={$name:"Map"};for(const[o,a]of t.entries())n[o]=Ka(a);return n}if(typeof t=="object"){const n=t.constructor,o=n._classRegistryKey;if(!o)throw new Error(`can't serialize object of unregistered class ${o}`);const a=n.serialize?n.serialize(t,e):{};if(!n.serialize){for(const l in t)t.hasOwnProperty(l)&&(Tu[o].omit.indexOf(l)>=0||(a[l]=Ka(t[l],e)));t instanceof Error&&(a.message=t.message)}if(a.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(a.$name=o),a}throw new Error("can't serialize object of type "+typeof t)}function Cl(t){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||Wp(t)||Ch(t)||ArrayBuffer.isView(t)||t instanceof ImageData)return t;if(Array.isArray(t))return t.map(Cl);if(typeof t=="object"){const e=t.$name||"Object";if(e==="Map"){const a=new Map;for(const l of Object.keys(t))l!=="$name"&&a.set(l,Cl(t[l]));return a}const{klass:n}=Tu[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(t);const o=Object.create(n.prototype);for(const a of Object.keys(t))a!=="$name"&&(o[a]=Cl(t[a]));return o}throw new Error("can't deserialize object of type "+typeof t)}const hn={"Latin-1 Supplement":t=>t>=128&&t<=255,Arabic:t=>t>=1536&&t<=1791,"Arabic Supplement":t=>t>=1872&&t<=1919,"Arabic Extended-A":t=>t>=2208&&t<=2303,"Hangul Jamo":t=>t>=4352&&t<=4607,"Unified Canadian Aboriginal Syllabics":t=>t>=5120&&t<=5759,Khmer:t=>t>=6016&&t<=6143,"Unified Canadian Aboriginal Syllabics Extended":t=>t>=6320&&t<=6399,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"CJK Radicals Supplement":t=>t>=11904&&t<=12031,"Kangxi Radicals":t=>t>=12032&&t<=12255,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Bopomofo:t=>t>=12544&&t<=12591,"Hangul Compatibility Jamo":t=>t>=12592&&t<=12687,Kanbun:t=>t>=12688&&t<=12703,"Bopomofo Extended":t=>t>=12704&&t<=12735,"CJK Strokes":t=>t>=12736&&t<=12783,"Katakana Phonetic Extensions":t=>t>=12784&&t<=12799,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"CJK Unified Ideographs Extension A":t=>t>=13312&&t<=19903,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Yi Syllables":t=>t>=40960&&t<=42127,"Yi Radicals":t=>t>=42128&&t<=42191,"Hangul Jamo Extended-A":t=>t>=43360&&t<=43391,"Hangul Syllables":t=>t>=44032&&t<=55215,"Hangul Jamo Extended-B":t=>t>=55216&&t<=55295,"Private Use Area":t=>t>=57344&&t<=63743,"CJK Compatibility Ideographs":t=>t>=63744&&t<=64255,"Arabic Presentation Forms-A":t=>t>=64336&&t<=65023,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Arabic Presentation Forms-B":t=>t>=65136&&t<=65279,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519,"CJK Unified Ideographs Extension B":t=>t>=131072&&t<=173791};function Ja(t){for(const e of t)if(Xd(e.charCodeAt(0)))return!0;return!1}function Cg(t){for(const e of t)if(!Pg(e.charCodeAt(0)))return!1;return!0}function Pg(t){return!(hn.Arabic(t)||hn["Arabic Supplement"](t)||hn["Arabic Extended-A"](t)||hn["Arabic Presentation Forms-A"](t)||hn["Arabic Presentation Forms-B"](t))}function Xd(t){return!(t!==746&&t!==747&&(t<4352||!(hn["Bopomofo Extended"](t)||hn.Bopomofo(t)||hn["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||hn["CJK Compatibility Ideographs"](t)||hn["CJK Compatibility"](t)||hn["CJK Radicals Supplement"](t)||hn["CJK Strokes"](t)||!(!hn["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||t===12336)||hn["CJK Unified Ideographs Extension A"](t)||hn["CJK Unified Ideographs"](t)||hn["Enclosed CJK Letters and Months"](t)||hn["Hangul Compatibility Jamo"](t)||hn["Hangul Jamo Extended-A"](t)||hn["Hangul Jamo Extended-B"](t)||hn["Hangul Jamo"](t)||hn["Hangul Syllables"](t)||hn.Hiragana(t)||hn["Ideographic Description Characters"](t)||hn.Kanbun(t)||hn["Kangxi Radicals"](t)||hn["Katakana Phonetic Extensions"](t)||hn.Katakana(t)&&t!==12540||!(!hn["Halfwidth and Fullwidth Forms"](t)||t===65288||t===65289||t===65293||t>=65306&&t<=65310||t===65339||t===65341||t===65343||t>=65371&&t<=65503||t===65507||t>=65512&&t<=65519)||!(!hn["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||hn["Unified Canadian Aboriginal Syllabics"](t)||hn["Unified Canadian Aboriginal Syllabics Extended"](t)||hn["Vertical Forms"](t)||hn["Yijing Hexagram Symbols"](t)||hn["Yi Syllables"](t)||hn["Yi Radicals"](t))))}function Zp(t){return!(Xd(t)||function(e){return!!(hn["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||hn["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||hn["Letterlike Symbols"](e)||hn["Number Forms"](e)||hn["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||hn["Control Pictures"](e)&&e!==9251||hn["Optical Character Recognition"](e)||hn["Enclosed Alphanumerics"](e)||hn["Geometric Shapes"](e)||hn["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||hn["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||hn["CJK Symbols and Punctuation"](e)||hn.Katakana(e)||hn["Private Use Area"](e)||hn["CJK Compatibility Forms"](e)||hn["Small Form Variants"](e)||hn["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(t))}function Yp(t){return t>=1424&&t<=2303||hn["Arabic Presentation Forms-A"](t)||hn["Arabic Presentation Forms-B"](t)}function Xp(t,e){return!(!e&&Yp(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||hn.Khmer(t))}function Kd(t){for(const e of t)if(Yp(e.charCodeAt(0)))return!0;return!1}const Jd="deferred",Qd="loading",ef="loaded";let tf=null,Ho="unavailable",Qa=null;const Kp=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(Ho="error"),tf&&tf(t)};function nf(){rf.fire(new bs("pluginStateChange",{pluginStatus:Ho,pluginURL:Qa}))}const rf=new qs,el=function(){return Ho},of=function(){if(Ho!==Jd||!Qa)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ho=Qd,nf(),Qa&&ce({url:Qa},t=>{t?Kp(t):(Ho=ef,nf())})},rs={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Ho===ef||rs.applyArabicShaping!=null,isLoading:()=>Ho===Qd,setState(t){Ho=t.pluginStatus,Qa=t.pluginURL},isParsed:()=>rs.applyArabicShaping!=null&&rs.processBidirectionalText!=null&&rs.processStyledBidirectionalText!=null,getPluginURL:()=>Qa};class fi{constructor(e,n){this.zoom=e,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.transition=n.transition,this.pitch=n.pitch,this.brightness=n.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(e){return function(n,o){for(const a of n)if(!Xp(a.charCodeAt(0),o))return!1;return!0}(e,rs.isLoaded())}}class Ph{constructor(e,n,o,a){this.property=e,this.value=n,this.expression=function(l,d,g,v){if(Sh(l))return new bu(l,d);if(vu(l)||Array.isArray(l)&&l.length>0){const b=Ih(l,d,g,v);if(b.result==="error")throw new Error(b.value.map(S=>`${S.key}: ${S.message}`).join(", "));return b.value}{let b=l;return typeof l=="string"&&d.type==="color"&&(b=li.parse(l)),{kind:"constant",isConfigDependent:!1,evaluate:()=>b}}}(n===void 0?e.specification.default:n,e.specification,o,a)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,n,o){return this.property.possiblyEvaluate(this,e,n,o)}}class sf{constructor(e,n,o){this.property=e,this.value=new Ph(e,void 0,n,o)}transitioned(e,n){return new af(this.property,this.value,n,Or({},e.transition,this.transition),e.now)}untransitioned(){return new af(this.property,this.value,null,{},0)}}class wa{constructor(e,n,o){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._scope=n,this._options=o,this.isConfigDependent=!1}getValue(e){return Gn(this._values[e].value.value)}setValue(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new sf(this._values[e].property,this._scope,this._options)),this._values[e].value=new Ph(this._values[e].property,n===null?void 0:Gn(n),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[e].value.expression.isConfigDependent}setTransitionOrValue(e,n){n&&(this._options=n);const o=this._properties.properties;if(e)for(const a in e){const l=e[a];if(on(a,"-transition")){const d=a.slice(0,-11);o[d]&&this.setTransition(d,l)}else o[a]&&this.setValue(a,l)}}getTransition(e){return Gn(this._values[e].transition)}setTransition(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new sf(this._values[e].property)),this._values[e].transition=Gn(n)||void 0}serialize(){const e={};for(const n of Object.keys(this._values)){const o=this.getValue(n);o!==void 0&&(e[n]=o);const a=this.getTransition(n);a!==void 0&&(e[`${n}-transition`]=a)}return e}transitioned(e,n){const o=new Pl(this._properties);for(const a of Object.keys(this._values))o._values[a]=this._values[a].transitioned(e,n._values[a]);return o}untransitioned(){const e=new Pl(this._properties);for(const n of Object.keys(this._values))e._values[n]=this._values[n].untransitioned();return e}}class af{constructor(e,n,o,a,l){const d=a.delay||0,g=a.duration||0;l=l||0,this.property=e,this.value=n,this.begin=l+d,this.end=this.begin+g,e.specification.transition&&(a.delay||a.duration)&&(this.prior=o)}possiblyEvaluate(e,n,o){const a=e.now||0,l=this.value.possiblyEvaluate(e,n,o),d=this.prior;if(d){if(a>this.end)return this.prior=null,l;if(this.value.isDataDriven())return this.prior=null,l;if(a<this.begin)return d.possiblyEvaluate(e,n,o);{const g=(a-this.begin)/(this.end-this.begin);return this.property.interpolate(d.possiblyEvaluate(e,n,o),l,nt(g))}}return l}}class Pl{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,n,o){const a=new Eu(this._properties);for(const l of Object.keys(this._values))a._values[l]=this._values[l].possiblyEvaluate(e,n,o);return a}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Dg{constructor(e,n,o){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._scope=n,this._options=o,this.isConfigDependent=!1}getValue(e){return Gn(this._values[e].value)}setValue(e,n){this._values[e]=new Ph(this._values[e].property,n===null?void 0:Gn(n),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[e].expression.isConfigDependent}serialize(){const e={};for(const n of Object.keys(this._values)){const o=this.getValue(n);o!==void 0&&(e[n]=o)}return e}possiblyEvaluate(e,n,o){const a=new Eu(this._properties);for(const l of Object.keys(this._values))a._values[l]=this._values[l].possiblyEvaluate(e,n,o);return a}}class pc{constructor(e,n,o){this.property=e,this.value=n,this.parameters=o}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,n,o,a){return this.property.evaluate(this.value,this.parameters,e,n,o,a)}}class Eu{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Nt{constructor(e){this.specification=e}possiblyEvaluate(e,n){return e.expression.evaluate(n)}interpolate(e,n,o){const a=Ba[this.specification.type];return a?a(e,n,o):e}}class wn{constructor(e,n){this.specification=e,this.overrides=n}possiblyEvaluate(e,n,o,a){return new pc(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(n,null,{},o,a)}:e.expression,n)}interpolate(e,n,o){if(e.value.kind!=="constant"||n.value.kind!=="constant")return e;if(e.value.value===void 0||n.value.value===void 0)return new pc(this,{kind:"constant",value:void 0},e.parameters);const a=Ba[this.specification.type];return a?new pc(this,{kind:"constant",value:a(e.value.value,n.value.value,o)},e.parameters):e}evaluate(e,n,o,a,l,d){return e.kind==="constant"?e.value:e.evaluate(n,o,a,l,d)}}class Dl{constructor(e){this.specification=e}possiblyEvaluate(e,n,o,a){return!!e.expression.evaluate(n,null,{},o,a)}interpolate(){return!1}}class pi{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const n=new fi(0,{});for(const o in e){const a=e[o];a.specification.overridable&&this.overridableProperties.push(o);const l=this.defaultPropertyValues[o]=new Ph(a,void 0),d=this.defaultTransitionablePropertyValues[o]=new sf(a);this.defaultTransitioningPropertyValues[o]=d.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=l.possiblyEvaluate(n)}}}function Su(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Mu(t){if(Array.isArray(t))return t.map(Mu);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const n in t)e[n]=Mu(t[n]);return e}return Su(t)}sn(wn,"DataDrivenProperty"),sn(Nt,"DataConstantProperty"),sn(Dl,"ColorRampProperty");var Je=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function lf(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!lf(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function is(t,e="fill"){if(t==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};lf(t)||(t=Au(t));const n=t;let o=!0;try{o=function(b){if(!mc(b))return b;let S=Mu(b);return cf(S),S=Jp(S),S}(n)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(n,null,2)}
        `)}const a=Je[`filter_${e}`],l=Ah(o,a);let d=null;if(l.result==="error")throw new Error(l.value.map(b=>`${b.key}: ${b.message}`).join(", "));d=(b,S,I)=>l.value.evaluate(b,S,{},I);let g=null,v=null;if(o!==n){const b=Ah(n,a);if(b.result==="error")throw new Error(b.value.map(S=>`${S.key}: ${S.message}`).join(", "));g=(S,I,D,F,N)=>b.value.evaluate(S,I,{},D,void 0,void 0,F,N),v=!Cn(b.value.expression)}return{filter:d,dynamicFilter:g||void 0,needGeometry:Qp(o),needFeature:!!v}}function Jp(t){if(!Array.isArray(t))return t;const e=function(n){if(kg.has(n[0])){for(let o=1;o<n.length;o++)if(mc(n[o]))return!0}return n}(t);return e===!0?e:e.map(n=>Jp(n))}function cf(t){let e=!1;const n=[];if(t[0]==="case"){for(let o=1;o<t.length-1;o+=2)e=e||mc(t[o]),n.push(t[o+1]);n.push(t[t.length-1])}else if(t[0]==="match"){e=e||mc(t[1]);for(let o=2;o<t.length-1;o+=2)n.push(t[o+1]);n.push(t[t.length-1])}else if(t[0]==="step"){e=e||mc(t[1]);for(let o=1;o<t.length-1;o+=2)n.push(t[o+1])}e&&(t.length=0,t.push("any",...n));for(let o=1;o<t.length;o++)cf(t[o])}function mc(t){if(!Array.isArray(t))return!1;if((e=t[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let n=1;n<t.length;n++)if(mc(t[n]))return!0;return!1}const kg=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Og(t,e){return t<e?-1:t>e?1:0}function Qp(t){if(!Array.isArray(t))return!1;if(t[0]==="within"||t[0]==="distance")return!0;for(let e=1;e<t.length;e++)if(Qp(t[e]))return!0;return!1}function Au(t){if(!t)return!0;const e=t[0];return t.length<=1?e!=="any":e==="=="?Iu(t[1],t[2],"=="):e==="!="?Cu(Iu(t[1],t[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Iu(t[1],t[2],e):e==="any"?(n=t.slice(1),["any"].concat(n.map(Au))):e==="all"?["all"].concat(t.slice(1).map(Au)):e==="none"?["all"].concat(t.slice(1).map(Au).map(Cu)):e==="in"?uf(t[1],t.slice(2)):e==="!in"?Cu(uf(t[1],t.slice(2))):e==="has"?em(t[1]):e!=="!has"||Cu(em(t[1]));var n}function Iu(t,e,n){switch(t){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,t,e]}}function uf(t,e){if(e.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(n=>typeof n!=typeof e[0])?["filter-in-large",t,["literal",e.sort(Og)]]:["filter-in-small",t,["literal",e]]}}function em(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Cu(t){return["!",t]}const Dh="";function hf(t,e){return e?`${t}${Dh}${e}`:t}const Pu="-transition";class qo extends qs{constructor(e,n,o,a){if(super(),this.id=e.id,this.fqid=hf(this.id,o),this.type=e.type,this.scope=o,this.options=a,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&e.type!=="slot"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),e.slot&&(this.slot=e.slot),n.layout&&(this._unevaluatedLayout=new Dg(n.layout,this.scope,a),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),n.paint)){this._transitionablePaint=new wa(n.paint,this.scope,a);for(const l in e.paint)this.setPaintProperty(l,e.paint[l]);for(const l in e.layout)this.setLayoutProperty(l,e.layout[l]);this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Eu(n.paint)}}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,n){if(this.type==="custom"&&e==="visibility")return void(this.visibility=n);const o=this._unevaluatedLayout;o._properties.properties[e]&&(o.setValue(e,n),this.isConfigDependent=this.isConfigDependent||o.isConfigDependent,e==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(e){return on(e,Pu)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,n){const o=this._transitionablePaint,a=o._properties.properties;if(on(e,Pu)){const I=e.slice(0,-11);return a[I]&&o.setTransition(I,n||void 0),!1}if(!a[e])return!1;const l=o._values[e],d=l.value.isDataDriven(),g=l.value;o.setValue(e,n),this.isConfigDependent=this.isConfigDependent||o.isConfigDependent,this._handleSpecialPaintPropertyUpdate(e);const v=o._values[e].value,b=v.isDataDriven(),S=on(e,"pattern")||e==="line-dasharray";return b||d||S||this._handleOverridablePaintPropertyUpdate(e,g,v)}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getDefaultProgramParams(e,n){return null}_handleOverridablePaintPropertyUpdate(e,n,o){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,n){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,n)}serialize(){return $n({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(e,n)=>!(e===void 0||n==="layout"&&!Object.keys(e).length||n==="paint"&&!Object.keys(e).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const e in this.paint._values){const n=this.paint.get(e);if(n instanceof pc&&Eh(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=is(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(e){this._stats&&(e.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}}const Rg={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class kh{constructor(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class si{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,n){return e._trim(),n&&(e.isTransferred=!0,n.add(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...e){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...e){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function jr(t,e=1){let n=0,o=0;return{members:t.map(a=>{const l=Rg[a.type].BYTES_PER_ELEMENT,d=n=Du(n,Math.max(e,l)),g=a.components||1;return o=Math.max(o,l),n+=l*g,{name:a.name,type:a.type,components:g,offset:d}}),size:Du(n,Math.max(o,e)),alignment:e}}function Du(t,e){return Math.ceil(t/e)*e}class Ls extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n){const o=this.length;return this.resize(o+1),this.emplace(o,e,n)}emplace(e,n,o){const a=2*e;return this.int16[a+0]=n,this.int16[a+1]=o,e}}Ls.prototype.bytesPerElement=4,sn(Ls,"StructArrayLayout2i4");class zo extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o){const a=this.length;return this.resize(a+1),this.emplace(a,e,n,o)}emplace(e,n,o,a){const l=3*e;return this.int16[l+0]=n,this.int16[l+1]=o,this.int16[l+2]=a,e}}zo.prototype.bytesPerElement=6,sn(zo,"StructArrayLayout3i6");class Ta extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,a){const l=this.length;return this.resize(l+1),this.emplace(l,e,n,o,a)}emplace(e,n,o,a,l){const d=4*e;return this.int16[d+0]=n,this.int16[d+1]=o,this.int16[d+2]=a,this.int16[d+3]=l,e}}Ta.prototype.bytesPerElement=8,sn(Ta,"StructArrayLayout4i8");class df extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,a,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,o,a,l)}emplace(e,n,o,a,l,d){const g=5*e;return this.int16[g+0]=n,this.int16[g+1]=o,this.int16[g+2]=a,this.int16[g+3]=l,this.int16[g+4]=d,e}}df.prototype.bytesPerElement=10,sn(df,"StructArrayLayout5i10");class ff extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,a,l,d,g){const v=this.length;return this.resize(v+1),this.emplace(v,e,n,o,a,l,d,g)}emplace(e,n,o,a,l,d,g,v){const b=6*e,S=12*e,I=3*e;return this.int16[b+0]=n,this.int16[b+1]=o,this.uint8[S+4]=a,this.uint8[S+5]=l,this.uint8[S+6]=d,this.uint8[S+7]=g,this.float32[I+2]=v,e}}ff.prototype.bytesPerElement=12,sn(ff,"StructArrayLayout2i4ub1f12");class tl extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,a){const l=this.length;return this.resize(l+1),this.emplace(l,e,n,o,a)}emplace(e,n,o,a,l){const d=4*e;return this.float32[d+0]=n,this.float32[d+1]=o,this.float32[d+2]=a,this.float32[d+3]=l,e}}tl.prototype.bytesPerElement=16,sn(tl,"StructArrayLayout4f16");class nl extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,a,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,o,a,l)}emplace(e,n,o,a,l,d){const g=6*e,v=3*e;return this.uint16[g+0]=n,this.uint16[g+1]=o,this.uint16[g+2]=a,this.uint16[g+3]=l,this.float32[v+2]=d,e}}nl.prototype.bytesPerElement=12,sn(nl,"StructArrayLayout4ui1f12");class _c extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o,a){const l=this.length;return this.resize(l+1),this.emplace(l,e,n,o,a)}emplace(e,n,o,a,l){const d=4*e;return this.uint16[d+0]=n,this.uint16[d+1]=o,this.uint16[d+2]=a,this.uint16[d+3]=l,e}}_c.prototype.bytesPerElement=8,sn(_c,"StructArrayLayout4ui8");class Oh extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,a,l,d){const g=this.length;return this.resize(g+1),this.emplace(g,e,n,o,a,l,d)}emplace(e,n,o,a,l,d,g){const v=6*e;return this.int16[v+0]=n,this.int16[v+1]=o,this.int16[v+2]=a,this.int16[v+3]=l,this.int16[v+4]=d,this.int16[v+5]=g,e}}Oh.prototype.bytesPerElement=12,sn(Oh,"StructArrayLayout6i12");class ku extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o,a,l,d,g,v,b,S,I,D){const F=this.length;return this.resize(F+1),this.emplace(F,e,n,o,a,l,d,g,v,b,S,I,D)}emplace(e,n,o,a,l,d,g,v,b,S,I,D,F){const N=12*e;return this.int16[N+0]=n,this.int16[N+1]=o,this.int16[N+2]=a,this.int16[N+3]=l,this.uint16[N+4]=d,this.uint16[N+5]=g,this.uint16[N+6]=v,this.uint16[N+7]=b,this.int16[N+8]=S,this.int16[N+9]=I,this.int16[N+10]=D,this.int16[N+11]=F,e}}ku.prototype.bytesPerElement=24,sn(ku,"StructArrayLayout4i4ui4i24");class pf extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,a,l,d){const g=this.length;return this.resize(g+1),this.emplace(g,e,n,o,a,l,d)}emplace(e,n,o,a,l,d,g){const v=10*e,b=5*e;return this.int16[v+0]=n,this.int16[v+1]=o,this.int16[v+2]=a,this.float32[b+2]=l,this.float32[b+3]=d,this.float32[b+4]=g,e}}pf.prototype.bytesPerElement=20,sn(pf,"StructArrayLayout3i3f20");class mf extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint32[1*e+0]=n,e}}mf.prototype.bytesPerElement=4,sn(mf,"StructArrayLayout1ul4");class ta extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n){const o=this.length;return this.resize(o+1),this.emplace(o,e,n)}emplace(e,n,o){const a=2*e;return this.uint16[a+0]=n,this.uint16[a+1]=o,e}}ta.prototype.bytesPerElement=4,sn(ta,"StructArrayLayout2ui4");class _f extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o,a,l,d,g,v,b,S,I,D,F){const N=this.length;return this.resize(N+1),this.emplace(N,e,n,o,a,l,d,g,v,b,S,I,D,F)}emplace(e,n,o,a,l,d,g,v,b,S,I,D,F,N){const V=20*e,q=10*e;return this.int16[V+0]=n,this.int16[V+1]=o,this.int16[V+2]=a,this.int16[V+3]=l,this.int16[V+4]=d,this.float32[q+3]=g,this.float32[q+4]=v,this.float32[q+5]=b,this.float32[q+6]=S,this.int16[V+14]=I,this.uint32[q+8]=D,this.uint16[V+18]=F,this.uint16[V+19]=N,e}}_f.prototype.bytesPerElement=40,sn(_f,"StructArrayLayout5i4f1i1ul2ui40");class Ou extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,a,l,d,g){const v=this.length;return this.resize(v+1),this.emplace(v,e,n,o,a,l,d,g)}emplace(e,n,o,a,l,d,g,v){const b=8*e;return this.int16[b+0]=n,this.int16[b+1]=o,this.int16[b+2]=a,this.int16[b+4]=l,this.int16[b+5]=d,this.int16[b+6]=g,this.int16[b+7]=v,e}}Ou.prototype.bytesPerElement=16,sn(Ou,"StructArrayLayout3i2i2i16");class Rh extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,a,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,o,a,l)}emplace(e,n,o,a,l,d){const g=4*e,v=8*e;return this.float32[g+0]=n,this.float32[g+1]=o,this.float32[g+2]=a,this.int16[v+6]=l,this.int16[v+7]=d,e}}Rh.prototype.bytesPerElement=16,sn(Rh,"StructArrayLayout2f1f2i16");class gf extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,a){const l=this.length;return this.resize(l+1),this.emplace(l,e,n,o,a)}emplace(e,n,o,a,l){const d=12*e,g=3*e;return this.uint8[d+0]=n,this.uint8[d+1]=o,this.float32[g+1]=a,this.float32[g+2]=l,e}}gf.prototype.bytesPerElement=12,sn(gf,"StructArrayLayout2ub2f12");class eo extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o){const a=this.length;return this.resize(a+1),this.emplace(a,e,n,o)}emplace(e,n,o,a){const l=3*e;return this.uint16[l+0]=n,this.uint16[l+1]=o,this.uint16[l+2]=a,e}}eo.prototype.bytesPerElement=6,sn(eo,"StructArrayLayout3ui6");class gc extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,o,a,l,d,g,v,b,S,I,D,F,N,V,q,Y,oe,le,ae,be){const ge=this.length;return this.resize(ge+1),this.emplace(ge,e,n,o,a,l,d,g,v,b,S,I,D,F,N,V,q,Y,oe,le,ae,be)}emplace(e,n,o,a,l,d,g,v,b,S,I,D,F,N,V,q,Y,oe,le,ae,be,ge){const Ie=30*e,Ne=15*e,Ge=60*e;return this.int16[Ie+0]=n,this.int16[Ie+1]=o,this.int16[Ie+2]=a,this.float32[Ne+2]=l,this.float32[Ne+3]=d,this.uint16[Ie+8]=g,this.uint16[Ie+9]=v,this.uint32[Ne+5]=b,this.uint32[Ne+6]=S,this.uint32[Ne+7]=I,this.uint16[Ie+16]=D,this.uint16[Ie+17]=F,this.uint16[Ie+18]=N,this.float32[Ne+10]=V,this.float32[Ne+11]=q,this.uint8[Ge+48]=Y,this.uint8[Ge+49]=oe,this.uint8[Ge+50]=le,this.uint32[Ne+13]=ae,this.int16[Ie+28]=be,this.uint8[Ge+58]=ge,e}}gc.prototype.bytesPerElement=60,sn(gc,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Lh extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,o,a,l,d,g,v,b,S,I,D,F,N,V,q,Y,oe,le,ae,be,ge,Ie,Ne,Ge,tt,qe,_t,Et,ct,wt,st){const bt=this.length;return this.resize(bt+1),this.emplace(bt,e,n,o,a,l,d,g,v,b,S,I,D,F,N,V,q,Y,oe,le,ae,be,ge,Ie,Ne,Ge,tt,qe,_t,Et,ct,wt,st)}emplace(e,n,o,a,l,d,g,v,b,S,I,D,F,N,V,q,Y,oe,le,ae,be,ge,Ie,Ne,Ge,tt,qe,_t,Et,ct,wt,st,bt){const $t=20*e,St=40*e,cn=80*e;return this.float32[$t+0]=n,this.float32[$t+1]=o,this.int16[St+4]=a,this.int16[St+5]=l,this.int16[St+6]=d,this.int16[St+7]=g,this.int16[St+8]=v,this.int16[St+9]=b,this.int16[St+10]=S,this.int16[St+11]=I,this.int16[St+12]=D,this.uint16[St+13]=F,this.uint16[St+14]=N,this.uint16[St+15]=V,this.uint16[St+16]=q,this.uint16[St+17]=Y,this.uint16[St+18]=oe,this.uint16[St+19]=le,this.uint16[St+20]=ae,this.uint16[St+21]=be,this.uint16[St+22]=ge,this.uint16[St+23]=Ie,this.uint16[St+24]=Ne,this.uint16[St+25]=Ge,this.uint16[St+26]=tt,this.uint16[St+27]=qe,this.uint32[$t+14]=_t,this.float32[$t+15]=Et,this.float32[$t+16]=ct,this.float32[$t+17]=wt,this.float32[$t+18]=st,this.uint8[cn+76]=bt,e}}Lh.prototype.bytesPerElement=80,sn(Lh,"StructArrayLayout2f9i15ui1ul4f1ub80");class Ru extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.float32[1*e+0]=n,e}}Ru.prototype.bytesPerElement=4,sn(Ru,"StructArrayLayout1f4");class rl extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,a,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,o,a,l)}emplace(e,n,o,a,l,d){const g=5*e;return this.float32[g+0]=n,this.float32[g+1]=o,this.float32[g+2]=a,this.float32[g+3]=l,this.float32[g+4]=d,e}}rl.prototype.bytesPerElement=20,sn(rl,"StructArrayLayout5f20");class yf extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,a,l,d,g){const v=this.length;return this.resize(v+1),this.emplace(v,e,n,o,a,l,d,g)}emplace(e,n,o,a,l,d,g,v){const b=7*e;return this.float32[b+0]=n,this.float32[b+1]=o,this.float32[b+2]=a,this.float32[b+3]=l,this.float32[b+4]=d,this.float32[b+5]=g,this.float32[b+6]=v,e}}yf.prototype.bytesPerElement=28,sn(yf,"StructArrayLayout7f28");class Lu extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o,a){const l=this.length;return this.resize(l+1),this.emplace(l,e,n,o,a)}emplace(e,n,o,a,l){const d=6*e;return this.uint32[3*e+0]=n,this.uint16[d+2]=o,this.uint16[d+3]=a,this.uint16[d+4]=l,e}}Lu.prototype.bytesPerElement=12,sn(Lu,"StructArrayLayout1ul3ui12");class vf extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint16[1*e+0]=n,e}}vf.prototype.bytesPerElement=2,sn(vf,"StructArrayLayout1ui2");class kl extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o){const a=this.length;return this.resize(a+1),this.emplace(a,e,n,o)}emplace(e,n,o,a){const l=3*e;return this.float32[l+0]=n,this.float32[l+1]=o,this.float32[l+2]=a,e}}kl.prototype.bytesPerElement=12,sn(kl,"StructArrayLayout3f12");class zu extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n){const o=this.length;return this.resize(o+1),this.emplace(o,e,n)}emplace(e,n,o){const a=2*e;return this.float32[a+0]=n,this.float32[a+1]=o,e}}zu.prototype.bytesPerElement=8,sn(zu,"StructArrayLayout2f8");class xf extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,a,l,d,g,v,b,S,I,D,F,N,V,q){const Y=this.length;return this.resize(Y+1),this.emplace(Y,e,n,o,a,l,d,g,v,b,S,I,D,F,N,V,q)}emplace(e,n,o,a,l,d,g,v,b,S,I,D,F,N,V,q,Y){const oe=16*e;return this.float32[oe+0]=n,this.float32[oe+1]=o,this.float32[oe+2]=a,this.float32[oe+3]=l,this.float32[oe+4]=d,this.float32[oe+5]=g,this.float32[oe+6]=v,this.float32[oe+7]=b,this.float32[oe+8]=S,this.float32[oe+9]=I,this.float32[oe+10]=D,this.float32[oe+11]=F,this.float32[oe+12]=N,this.float32[oe+13]=V,this.float32[oe+14]=q,this.float32[oe+15]=Y,e}}xf.prototype.bytesPerElement=64,sn(xf,"StructArrayLayout16f64");class Fu extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,a,l,d,g){const v=this.length;return this.resize(v+1),this.emplace(v,e,n,o,a,l,d,g)}emplace(e,n,o,a,l,d,g,v){const b=10*e,S=5*e;return this.uint16[b+0]=n,this.uint16[b+1]=o,this.uint16[b+2]=a,this.uint16[b+3]=l,this.float32[S+2]=d,this.float32[S+3]=g,this.float32[S+4]=v,e}}Fu.prototype.bytesPerElement=20,sn(Fu,"StructArrayLayout4ui3f20");class bf extends si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint8[1*e+0]=n,e}}bf.prototype.bytesPerElement=1,sn(bf,"StructArrayLayout1ub1");class tm extends kh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}tm.prototype.size=40;class nm extends _f{get(e){return new tm(this,e)}}sn(nm,"CollisionBoxArray");class rm extends kh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}rm.prototype.size=60;class im extends gc{get(e){return new rm(this,e)}}sn(im,"PlacedSymbolArray");class om extends kh{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(e){this._structArray.uint32[this._pos4+14]=e}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(e){this._structArray.float32[this._pos4+18]=e}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}om.prototype.size=80;class sm extends Lh{get(e){return new om(this,e)}}sn(sm,"SymbolInstanceArray");class am extends Ru{getoffsetX(e){return this.float32[1*e+0]}}sn(am,"GlyphOffsetArray");class Bu extends Ls{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}sn(Bu,"SymbolLineVertexArray");class lm extends kh{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}lm.prototype.size=12;class cm extends Lu{get(e){return new lm(this,e)}}sn(cm,"FeatureIndexArray");class Nu extends ta{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}sn(Nu,"FillExtrusionCentroidArray");const Lg=jr([{name:"a_pos",components:2,type:"Int16"}],4),um=jr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Ii{constructor(e=[]){this.segments=e}_prepareSegment(e,n,o,a){let l=this.segments[this.segments.length-1];return e>Ii.MAX_VERTEX_ARRAY_LENGTH&&Re(`Max vertices per segment is ${Ii.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!l||l.vertexLength+e>Ii.MAX_VERTEX_ARRAY_LENGTH||l.sortKey!==a)&&(l={vertexOffset:n,primitiveOffset:o,vertexLength:0,primitiveLength:0},a!==void 0&&(l.sortKey=a),this.segments.push(l)),l}prepareSegment(e,n,o,a){return this._prepareSegment(e,n.length,o.length,a)}get(){return this.segments}destroy(){for(const e of this.segments)for(const n in e.vaos)e.vaos[n].destroy()}static simpleSegment(e,n,o,a){return new Ii([{vertexOffset:e,primitiveOffset:n,vertexLength:o,primitiveLength:a,vaos:{},sortKey:0}])}}function wf(t,e){return 256*(t=vt(Math.floor(t),0,255))+vt(Math.floor(e),0,255)}Ii.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,sn(Ii,"SegmentVector");const hm=jr([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),dm=jr([{name:"a_dash",components:4,type:"Uint16"}]);var ju={exports:{}},zh={exports:{}};(function(t){t.exports=function(e,n){var o,a,l,d,g,v,b,S;for(a=e.length-(o=3&e.length),l=n,g=3432918353,v=461845907,S=0;S<a;)b=255&e.charCodeAt(S)|(255&e.charCodeAt(++S))<<8|(255&e.charCodeAt(++S))<<16|(255&e.charCodeAt(++S))<<24,++S,l=27492+(65535&(d=5*(65535&(l=(l^=b=(65535&(b=(b=(65535&b)*g+(((b>>>16)*g&65535)<<16)&4294967295)<<15|b>>>17))*v+(((b>>>16)*v&65535)<<16)&4294967295)<<13|l>>>19))+((5*(l>>>16)&65535)<<16)&4294967295))+((58964+(d>>>16)&65535)<<16);switch(b=0,o){case 3:b^=(255&e.charCodeAt(S+2))<<16;case 2:b^=(255&e.charCodeAt(S+1))<<8;case 1:l^=b=(65535&(b=(b=(65535&(b^=255&e.charCodeAt(S)))*g+(((b>>>16)*g&65535)<<16)&4294967295)<<15|b>>>17))*v+(((b>>>16)*v&65535)<<16)&4294967295}return l^=e.length,l=2246822507*(65535&(l^=l>>>16))+((2246822507*(l>>>16)&65535)<<16)&4294967295,l=3266489909*(65535&(l^=l>>>13))+((3266489909*(l>>>16)&65535)<<16)&4294967295,(l^=l>>>16)>>>0}})(zh);var Tf=zh.exports,fm={exports:{}};(function(t){t.exports=function(e,n){for(var o,a=e.length,l=n^a,d=0;a>=4;)o=1540483477*(65535&(o=255&e.charCodeAt(d)|(255&e.charCodeAt(++d))<<8|(255&e.charCodeAt(++d))<<16|(255&e.charCodeAt(++d))<<24))+((1540483477*(o>>>16)&65535)<<16),l=1540483477*(65535&l)+((1540483477*(l>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),a-=4,++d;switch(a){case 3:l^=(255&e.charCodeAt(d+2))<<16;case 2:l^=(255&e.charCodeAt(d+1))<<8;case 1:l=1540483477*(65535&(l^=255&e.charCodeAt(d)))+((1540483477*(l>>>16)&65535)<<16)}return l=1540483477*(65535&(l^=l>>>13))+((1540483477*(l>>>16)&65535)<<16),(l^=l>>>15)>>>0}})(fm);var pm=Tf,mm=fm.exports;ju.exports=pm,ju.exports.murmur3=pm,ju.exports.murmur2=mm;var Ef=ye(ju.exports);class Vu{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(e,n,o,a){this.ids.push(_m(e)),this.positions.push(n,o,a)}eachPosition(e,n){const o=_m(e);let a=0,l=this.ids.length-1;for(;a<l;){const d=a+l>>1;this.ids[d]>=o?l=d:a=d+1}for(;this.ids[a]===o;)n(this.positions[3*a],this.positions[3*a+1],this.positions[3*a+2]),a++}static serialize(e,n){const o=new Float64Array(e.ids),a=new Uint32Array(e.positions);return Sf(o,a,0,o.length-1),n&&(n.add(o.buffer),n.add(a.buffer)),{ids:o,positions:a}}static deserialize(e){const n=new Vu;let o;n.ids=e.ids,n.positions=e.positions;for(const a of n.ids)a!==o&&n.uniqueIds.push(a),o=a;return n.indexed=!0,n}}function _m(t){const e=+t;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:Ef(String(t))}function Sf(t,e,n,o){for(;n<o;){const a=t[n+o>>1];let l=n-1,d=o+1;for(;;){do l++;while(t[l]<a);do d--;while(t[d]>a);if(l>=d)break;Fh(t,l,d),Fh(e,3*l,3*d),Fh(e,3*l+1,3*d+1),Fh(e,3*l+2,3*d+2)}d-n<o-d?(Sf(t,e,n,d),n=d+1):(Sf(t,e,d+1,o),o=d)}}function Fh(t,e,n){const o=t[e];t[e]=t[n],t[n]=o}sn(Vu,"FeaturePositionMap");class Ea{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,n){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,n),this.initialized=!0),!!this.location}}class Bh extends Ea{constructor(e){super(e),this.current=0}set(e,n,o){this.fetchUniformLocation(e,n)&&this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}}class So extends Ea{constructor(e){super(e),this.current=0}set(e,n,o){this.fetchUniformLocation(e,n)&&this.current!==o&&(this.current=o,this.gl.uniform1f(this.location,o))}}class il extends Ea{constructor(e){super(e),this.current=[0,0]}set(e,n,o){this.fetchUniformLocation(e,n)&&(o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1])))}}class gm extends Ea{constructor(e){super(e),this.current=[0,0,0]}set(e,n,o){this.fetchUniformLocation(e,n)&&(o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2])))}}class c extends Ea{constructor(e){super(e),this.current=[0,0,0,0]}set(e,n,o){this.fetchUniformLocation(e,n)&&(o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]&&o[3]===this.current[3]||(this.current=o,this.gl.uniform4f(this.location,o[0],o[1],o[2],o[3])))}}class r extends Ea{constructor(e){super(e),this.current=li.transparent}set(e,n,o){this.fetchUniformLocation(e,n)&&(o.r===this.current.r&&o.g===this.current.g&&o.b===this.current.b&&o.a===this.current.a||(this.current=o,this.gl.uniform4f(this.location,o.r,o.g,o.b,o.a)))}}const s=new Float32Array(16);class h extends Ea{constructor(e){super(e),this.current=s}set(e,n,o){if(this.fetchUniformLocation(e,n)){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let a=1;a<16;a++)if(o[a]!==this.current[a]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}}}const p=new Float32Array(9),y=new Float32Array(4);class w extends Ea{constructor(e){super(e),this.current=y}set(e,n,o){if(this.fetchUniformLocation(e,n)){for(let a=0;a<4;a++)if(o[a]!==this.current[a]){this.current=o,this.gl.uniformMatrix2fv(this.location,!1,o);break}}}}function M(t){return[wf(255*t.r,255*t.g),wf(255*t.b,255*t.a)]}class C{constructor(e,n,o){this.value=e,this.uniformNames=n.map(a=>`u_${a}`),this.type=o}setUniform(e,n,o,a,l){n.set(e,l,a.constantOr(this.value))}getBinding(e,n){return this.type==="color"?new r(e):new So(e)}}class k{constructor(e,n){this.uniformNames=n.map(o=>`u_${o}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,n,o,a,l){const d=l==="u_pattern"||l==="u_dash"?this.pattern:l==="u_pixel_ratio"?this.pixelRatio:null;d&&n.set(e,l,d)}getBinding(e,n){return n==="u_pattern"||n==="u_dash"?new c(e):new So(e)}}class z{constructor(e,n,o,a){this.expression=e,this.type=o,this.maxValue=0,this.paintVertexAttributes=n.map(l=>({name:`a_${l}`,type:"Float32",components:o==="color"?2:1,offset:0})),this.paintVertexArray=new a}populatePaintArray(e,n,o,a,l,d,g){const v=this.paintVertexArray.length,b=this.expression.evaluate(new fi(0,{brightness:d}),n,{},l,a,g);this.paintVertexArray.resize(e),this._setPaintValue(v,e,b)}updatePaintArray(e,n,o,a,l,d,g){const v=this.expression.evaluate({zoom:0,brightness:g},o,a,void 0,l);this._setPaintValue(e,n,v)}_setPaintValue(e,n,o){if(this.type==="color"){const a=M(o);for(let l=e;l<n;l++)this.paintVertexArray.emplace(l,a[0],a[1])}else{for(let a=e;a<n;a++)this.paintVertexArray.emplace(a,o);this.maxValue=Math.max(this.maxValue,Math.abs(o))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class B{constructor(e,n,o,a,l,d){this.expression=e,this.uniformNames=n.map(g=>`u_${g}_t`),this.type=o,this.useIntegerZoom=a,this.zoom=l,this.maxValue=0,this.paintVertexAttributes=n.map(g=>({name:`a_${g}`,type:"Float32",components:o==="color"?4:2,offset:0})),this.paintVertexArray=new d}populatePaintArray(e,n,o,a,l,d,g){const v=this.expression.evaluate(new fi(this.zoom,{brightness:d}),n,{},l,a,g),b=this.expression.evaluate(new fi(this.zoom+1,{brightness:d}),n,{},l,a,g),S=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(S,e,v,b)}updatePaintArray(e,n,o,a,l,d,g){const v=this.expression.evaluate({zoom:this.zoom,brightness:g},o,a,void 0,l),b=this.expression.evaluate({zoom:this.zoom+1,brightness:g},o,a,void 0,l);this._setPaintValue(e,n,v,b)}_setPaintValue(e,n,o,a){if(this.type==="color"){const l=M(o),d=M(a);for(let g=e;g<n;g++)this.paintVertexArray.emplace(g,l[0],l[1],d[0],d[1])}else{for(let l=e;l<n;l++)this.paintVertexArray.emplace(l,o,a);this.maxValue=Math.max(this.maxValue,Math.abs(o),Math.abs(a))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,n,o,a,l){const d=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,g=vt(this.expression.interpolationFactor(d,this.zoom,this.zoom+1),0,1);n.set(e,l,g)}getBinding(e,n){return new So(e)}}class ${constructor(e,n,o,a,l){this.expression=e,this.layerId=l,this.paintVertexAttributes=(o==="array"?dm:hm).members;for(let d=0;d<n.length;++d);this.paintVertexArray=new a}populatePaintArray(e,n,o){const a=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(a,e,n.patterns&&n.patterns[this.layerId],o)}updatePaintArray(e,n,o,a,l,d,g){this._setPaintValues(e,n,o.patterns&&o.patterns[this.layerId],d)}_setPaintValues(e,n,o,a){if(!a||!o)return;const l=a[o];if(!l)return;const{tl:d,br:g,pixelRatio:v}=l;for(let b=e;b<n;b++)this.paintVertexArray.emplace(b,d[0],d[1],g[0],g[1],v)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class H{constructor(e,n,o=()=>!0){this.binders={},this._buffers=[];const a=[];for(const l in e.paint._values){const d=e.paint.get(l);if(!o(l)||!(d instanceof pc&&Eh(d.property.specification)))continue;const g=Q(l,e.type),v=d.value,b=d.property.specification.type,S=!!d.property.useIntegerZoom,I=l==="line-dasharray"||l.endsWith("pattern"),D=l==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(v.kind!=="constant"||D)if(v.kind==="source"||D||I){const F=he(l,b,"source");this.binders[l]=I?new $(v,g,b,F,e.id):new z(v,g,b,F),a.push(`/a_${l}`)}else{const F=he(l,b,"composite");this.binders[l]=new B(v,g,b,S,n,F),a.push(`/z_${l}`)}else this.binders[l]=I?new k(v.value,g):new C(v.value,g,b),a.push(`/u_${l}`)}this.cacheKey=a.sort().join("")}getMaxValue(e){const n=this.binders[e];return n instanceof z||n instanceof B?n.maxValue:0}populatePaintArrays(e,n,o,a,l,d,g){for(const v in this.binders){const b=this.binders[v];(b instanceof z||b instanceof B||b instanceof $)&&b.populatePaintArray(e,n,o,a,l,d,g)}}setConstantPatternPositions(e){for(const n in this.binders){const o=this.binders[n];o instanceof k&&o.setConstantPatternPositions(e)}}updatePaintArrays(e,n,o,a,l,d,g,v){let b=!1;const S=Object.keys(e),I=S.length!==0,D=I?S:n.uniqueIds;for(const F in this.binders){const N=this.binders[F];if((N instanceof z||N instanceof B||N instanceof $)&&(N.expression.isStateDependent===!0||N.expression.isLightConstant===!1)){const V=l.paint.get(F);N.expression=V.value;for(const q of D){const Y=e[q.toString()];n.eachPosition(q,(oe,le,ae)=>{const be=a.feature(oe);N.updatePaintArray(le,ae,be,Y,d,g,v)})}if(!I)for(const q of o.uniqueIds){const Y=e[q.toString()];o.eachPosition(q,(oe,le,ae)=>{const be=a.feature(oe);N.updatePaintArray(le,ae,be,Y,d,g,v)})}b=!0}}return b}defines(){const e=[];for(const n in this.binders){const o=this.binders[n];(o instanceof C||o instanceof k)&&e.push(...o.uniformNames.map(a=>`#define HAS_UNIFORM_${a}`))}return e}getBinderAttributes(){const e=[];for(const n in this.binders){const o=this.binders[n];if(o instanceof z||o instanceof B||o instanceof $)for(let a=0;a<o.paintVertexAttributes.length;a++)e.push(o.paintVertexAttributes[a].name)}return e}getBinderUniforms(){const e=[];for(const n in this.binders){const o=this.binders[n];if(o instanceof C||o instanceof k||o instanceof B)for(const a of o.uniformNames)e.push(a)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const n=[];for(const o in this.binders){const a=this.binders[o];if(a instanceof C||a instanceof k||a instanceof B)for(const l of a.uniformNames)n.push({name:l,property:o,binding:a.getBinding(e,l)})}return n}setUniforms(e,n,o,a,l){for(const{name:d,property:g,binding:v}of o)this.binders[g].setUniform(e,v,l,a.get(g),d)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const n=this.binders[e];(n instanceof z||n instanceof B||n instanceof $)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(e){for(const n in this.binders){const o=this.binders[n];(o instanceof z||o instanceof B||o instanceof $)&&o.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const n=this.binders[e];(n instanceof z||n instanceof B||n instanceof $)&&n.destroy()}}}class K{constructor(e,n,o=()=>!0){this.programConfigurations={};for(const a of e)this.programConfigurations[a.id]=new H(a,n,o);this.needsUpload=!1,this._featureMap=new Vu,this._featureMapWithoutIds=new Vu,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(e,n,o,a,l,d,g,v){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(e,n,a,l,d,g,v);n.id!==void 0?this._featureMap.add(n.id,o,this._bufferOffset,e):(this._featureMapWithoutIds.add(this._idlessCounter,o,this._bufferOffset,e),this._idlessCounter+=1),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,n,o,a,l,d){for(const g of o)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(e,this._featureMap,this._featureMapWithoutIds,n,g,a,l,d||0)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const X={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Q(t,e){return X[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}const Z={"line-pattern":{source:nl,composite:nl},"fill-pattern":{source:nl,composite:nl},"fill-extrusion-pattern":{source:nl,composite:nl},"line-dasharray":{source:_c,composite:_c}},ie={color:{source:zu,composite:tl},number:{source:Ru,composite:zu}};function he(t,e,n){const o=Z[t];return o&&o[n]||ie[e][n]}sn(C,"ConstantBinder"),sn(k,"PatternConstantBinder"),sn(z,"SourceExpressionBinder"),sn($,"PatternCompositeBinder"),sn(B,"CompositeExpressionBinder"),sn(H,"ProgramConfiguration",{omit:["_buffers"]}),sn(K,"ProgramConfigurationSet");const se=Jt/Math.PI/2,de=5,ne=6,pe=16383,Se=64,Ae=[Se,32,16],Le=-se,et=se;function je(t,e,n,o=se){return n=Oe(n),[t*Math.sin(n)*o,-e*o,t*Math.cos(n)*o]}function dt(t,e,n){return je(Math.cos(Oe(t)),Math.sin(Oe(t)),e,n)}const at=63710088e-1,At=2*Math.PI*at;class $e{constructor(e,n){if(isNaN(e)||isNaN(n))throw new Error(`Invalid LngLat object: (${e}, ${n})`);if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new $e(Kr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const n=Math.PI/180,o=this.lat*n,a=e.lat*n,l=Math.sin(o)*Math.sin(a)+Math.cos(o)*Math.cos(a)*Math.cos((e.lng-this.lng)*n);return at*Math.acos(Math.min(l,1))}toBounds(e=0){const n=360*e/40075017,o=n/Math.cos(Math.PI/180*this.lat);return new ot({lng:this.lng-o,lat:this.lat-n},{lng:this.lng+o,lat:this.lat+n})}toEcef(e){return dt(this.lat,this.lng,se+e*se/at)}static convert(e){if(e instanceof $e)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new $e(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new $e(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class ot{constructor(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof $e?new $e(e.lng,e.lat):$e.convert(e),this}setSouthWest(e){return this._sw=e instanceof $e?new $e(e.lng,e.lat):$e.convert(e),this}extend(e){const n=this._sw,o=this._ne;let a,l;if(e instanceof $e)a=e,l=e;else{if(!(e instanceof ot))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(ot.convert(e)):this.extend($e.convert(e)):typeof e=="object"&&e!==null&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend($e.convert(e)):this;if(a=e._sw,l=e._ne,!a||!l)return this}return n||o?(n.lng=Math.min(a.lng,n.lng),n.lat=Math.min(a.lat,n.lat),o.lng=Math.max(l.lng,o.lng),o.lat=Math.max(l.lat,o.lat)):(this._sw=new $e(a.lng,a.lat),this._ne=new $e(l.lng,l.lat)),this}getCenter(){return new $e((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new $e(this.getWest(),this.getNorth())}getSouthEast(){return new $e(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:n,lat:o}=$e.convert(e);let a=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(a=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=o&&o<=this._ne.lat&&a}static convert(e){return!e||e instanceof ot?e:new ot(e)}}var ke={};(function(t,e){(function(n){function o(l,d,g){var v=a(256*l,256*(d=Math.pow(2,g)-d-1),g),b=a(256*(l+1),256*(d+1),g);return v[0]+","+v[1]+","+b[0]+","+b[1]}function a(l,d,g){var v=2*Math.PI*6378137/256/Math.pow(2,g);return[l*v-2*Math.PI*6378137/2,d*v-2*Math.PI*6378137/2]}n.getURL=function(l,d,g,v,b,S){return S=S||{},l+"?"+["bbox="+o(g,v,b),"format="+(S.format||"image/png"),"service="+(S.service||"WMS"),"version="+(S.version||"1.1.1"),"request="+(S.request||"GetMap"),"srs="+(S.srs||"EPSG:3857"),"width="+(S.width||256),"height="+(S.height||256),"layers="+d].join("&")},n.getTileBBox=o,n.getMercCoords=a,Object.defineProperty(n,"__esModule",{value:!0})})(e)})(0,ke);var Ze=ke;class Pt{constructor(e,n,o){this.z=e,this.x=n,this.y=o,this.key=Xt(0,e,e,n,o)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,n){const o=Ze.getTileBBox(this.x,this.y,this.z),a=function(l,d,g){let v,b="";for(let S=l;S>0;S--)v=1<<S-1,b+=(d&v?1:0)+(g&v?2:0);return b}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",a).replace("{bbox-epsg-3857}",o)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Bt{constructor(e,n){this.wrap=e,this.canonical=n,this.key=Xt(e,n.z,n.z,n.x,n.y)}}class Ft{constructor(e,n,o,a,l){this.overscaledZ=e,this.wrap=n,this.canonical=new Pt(o,+a,+l),this.key=n===0&&e===o?this.canonical.key:Xt(n,e,o,a,l)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const n=this.canonical.z-e;return e>this.canonical.z?new Ft(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ft(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(e,n=!0){if(this.overscaledZ===e&&n)return this.key;if(e>this.canonical.z)return Xt(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y);{const o=this.canonical.z-e;return Xt(this.wrap*+n,e,e,this.canonical.x>>o,this.canonical.y>>o)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const n=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.z<this.canonical.z&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n}children(e){if(this.overscaledZ>=e)return[new Ft(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,o=2*this.canonical.x,a=2*this.canonical.y;return[new Ft(n,this.wrap,n,o,a),new Ft(n,this.wrap,n,o+1,a),new Ft(n,this.wrap,n,o,a+1),new Ft(n,this.wrap,n,o+1,a+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Ft(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Ft(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Bt(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Xt(t,e,n,o,a){const l=1<<Math.min(n,22);let d=l*(a%l)+o%l;return t&&n<22&&(d+=l*l*((t<0?-2*t-1:2*t)%(1<<2*(22-n)))),16*(32*d+n)+(e-n)}const un=[t=>{let e=t.canonical.x-1,n=t.wrap;return e<0&&(e=(1<<t.canonical.z)-1,n--),new Ft(t.overscaledZ,n,t.canonical.z,e,t.canonical.y)},t=>{let e=t.canonical.x+1,n=t.wrap;return e===1<<t.canonical.z&&(e=0,n++),new Ft(t.overscaledZ,n,t.canonical.z,e,t.canonical.y)},t=>new Ft(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,(t.canonical.y===0?1<<t.canonical.z:t.canonical.y)-1),t=>new Ft(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y===(1<<t.canonical.z)-1?0:t.canonical.y+1)];sn(Pt,"CanonicalTileID"),sn(Ft,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const vn=0,pn=25.5;function gn(t){return At*Math.cos(t*Math.PI/180)}function qn(t){return(180+t)/360}function kn(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Nn(t,e){return t/gn(e)}function Fn(t){return 360*t-180}function _r(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Zr(t,e){return t*gn(_r(e))}const ir=85.051129;function mi(t){return Math.cos(Oe(vt(t,-ir,ir)))}function or(t,e){const n=vt(e,vn,pn),o=Math.pow(2,n);return mi(t)*At/(512*o)}function Ar(t){return 1/Math.cos(t*Math.PI/180)}function sr(t,e=0){const n=Math.exp(Math.PI*(1-(t.y+e/Jt)/(1<<t.z)*2));return 80150034*n/(n*n+1)/Jt/(1<<t.z)}class Sr{constructor(e,n,o=0){this.x=+e,this.y=+n,this.z=+o}static fromLngLat(e,n=0){const o=$e.convert(e);return new Sr(qn(o.lng),kn(o.lat),Nn(n,o.lat))}toLngLat(){return new $e(Fn(this.x),_r(this.y))}toAltitude(){return Zr(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/At*Ar(_r(this.y))}}function Qr(t,e,n,o,a,l,d,g,v){const b=(e+o)/2,S=(n+a)/2,I=new ve(b,S);g(I),function(D,F,N,V,q,Y){const oe=N-q,le=V-Y;return Math.abs((V-F)*oe-(N-D)*le)/Math.hypot(oe,le)}(I.x,I.y,l.x,l.y,d.x,d.y)>=v?(Qr(t,e,n,b,S,l,I,g,v),Qr(t,b,S,o,a,I,d,g,v)):t.push(d)}function Lr(t,e,n){let o=t[0],a=o.x,l=o.y;e(o);const d=[o];for(let g=1;g<t.length;g++){const v=t[g],{x:b,y:S}=v;e(v),Qr(d,a,l,b,S,o,v,e,n),a=b,l=S,o=v}return d}function to(t,e,n,o){if(o(e,n)){const a=e.add(n)._mult(.5);to(t,e,a,o),to(t,a,n,o)}else t.push(n)}function go(t,e){let n=t[0];const o=[n];for(let a=1;a<t.length;a++){const l=t[a];to(o,n,l,e),n=l}return o}const Wo=Math.pow(2,14)-1,na=-Wo-1;function Zo(t,e){const n=Math.round(t.x*e),o=Math.round(t.y*e);return t.x=vt(n,na,Wo),t.y=vt(o,na,Wo),(n<t.x||n>t.x+1||o<t.y||o>t.y+1)&&Re("Geometry exceeds allowed extent, reduce your vector tile buffer size"),t}function no(t,e,n){const o=t.loadGeometry(),a=t.extent,l=Jt/a;if(e&&n&&n.projection.isReprojectedInTileSpace){const d=1<<e.z,{scale:g,x:v,y:b,projection:S}=n,I=D=>{const F=Fn((e.x+D.x/a)/d),N=_r((e.y+D.y/a)/d),V=S.project(F,N);D.x=(V.x*g-v)*a,D.y=(V.y*g-b)*a};for(let D=0;D<o.length;D++)if(t.type!==1)o[D]=Lr(o[D],I,1);else{const F=[];for(const N of o[D])N.x<0||N.x>=a||N.y<0||N.y>=a||(I(N),F.push(N));o[D]=F}}for(const d of o)for(const g of d)Zo(g,l);return o}function qi(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?no(t):[]}}function Mo(t,e,n,o,a){t.emplaceBack(2*e+(o+1)/2,2*n+(a+1)/2)}function Fo(t,e,n){t.emplaceBack(e.x,e.y,e.z,n[0]*16384,n[1]*16384,n[2]*16384)}class Yo{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.fqid),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Ls,this.indexArray=new eo,this.segments=new Ii,this.programConfigurations=new K(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,o,a){const l=this.layers[0],d=[];let g=null;l.type==="circle"&&(g=l.layout.get("circle-sort-key"));for(const{feature:b,id:S,index:I,sourceLayerIndex:D}of e){const F=this.layers[0]._featureFilter.needGeometry,N=qi(b,F);if(!this.layers[0]._featureFilter.filter(new fi(this.zoom),N,o))continue;const V=g?g.evaluate(N,{},o):void 0,q={id:S,properties:b.properties,type:b.type,sourceLayerIndex:D,index:I,geometry:F?N.geometry:no(b,o,a),patterns:{},sortKey:V};d.push(q)}g&&d.sort((b,S)=>b.sortKey-S.sortKey);let v=null;a.projection.name==="globe"&&(this.globeExtVertexArray=new Oh,v=a.projection);for(const b of d){const{geometry:S,index:I,sourceLayerIndex:D}=b,F=e[I].feature;this.addFeature(b,S,I,n.availableImages,o,v,n.brightness),n.featureIndex.insert(F,S,I,D,this.index)}}update(e,n,o,a,l){const d=Object.keys(e).length!==0;d&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,n,d?this.stateDependentLayers:this.layers,o,a,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Lg.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,um.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,n,o,a,l,d,g){for(const v of n)for(const b of v){const S=b.x,I=b.y;if(S<0||S>=Jt||I<0||I>=Jt)continue;if(d){const N=d.projectTilePoint(S,I,l),V=d.upVector(l,S,I),q=this.globeExtVertexArray;Fo(q,N,V),Fo(q,N,V),Fo(q,N,V),Fo(q,N,V)}const D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),F=D.vertexLength;Mo(this.layoutVertexArray,S,I,-1,-1),Mo(this.layoutVertexArray,S,I,1,-1),Mo(this.layoutVertexArray,S,I,1,1),Mo(this.layoutVertexArray,S,I,-1,1),this.indexArray.emplaceBack(F,F+1,F+2),this.indexArray.emplaceBack(F,F+2,F+3),D.vertexLength+=4,D.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,{},a,l,g)}}function ra(t,e){for(let n=0;n<t.length;n++)if(Sa(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(Sa(t,e[n]))return!0;return!!$u(t,e)}function ol(t,e,n){return!!Sa(t,e)||!!Gu(e,t,n)}function Ol(t,e){if(t.length===1)return Nh(e,t[0]);for(let n=0;n<e.length;n++){const o=e[n];for(let a=0;a<o.length;a++)if(Sa(t,o[a]))return!0}for(let n=0;n<t.length;n++)if(Nh(e,t[n]))return!0;for(let n=0;n<e.length;n++)if($u(t,e[n]))return!0;return!1}function Uu(t,e,n){if(t.length>1){if($u(t,e))return!0;for(let o=0;o<e.length;o++)if(Gu(e[o],t,n))return!0}for(let o=0;o<t.length;o++)if(Gu(t[o],e,n))return!0;return!1}function $u(t,e){if(t.length===0||e.length===0)return!1;for(let n=0;n<t.length-1;n++){const o=t[n],a=t[n+1];for(let l=0;l<e.length-1;l++)if(Mf(o,a,e[l],e[l+1]))return!0}return!1}function Mf(t,e,n,o){return ft(t,n,o)!==ft(e,n,o)&&ft(t,e,n)!==ft(t,e,o)}function Gu(t,e,n){const o=n*n;if(e.length===1)return t.distSqr(e[0])<o;for(let a=1;a<e.length;a++)if(yc(t,e[a-1],e[a])<o)return!0;return!1}function yc(t,e,n){const o=e.distSqr(n);if(o===0)return t.distSqr(e);const a=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/o;return t.distSqr(a<0?e:a>1?n:n.sub(e)._mult(a)._add(e))}function Nh(t,e){let n,o,a,l=!1;for(let d=0;d<t.length;d++){n=t[d];for(let g=0,v=n.length-1;g<n.length;v=g++)o=n[g],a=n[v],o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(l=!l)}return l}function Sa(t,e){let n=!1;for(let o=0,a=t.length-1;o<t.length;a=o++){const l=t[o],d=t[a];l.y>e.y!=d.y>e.y&&e.x<(d.x-l.x)*(e.y-l.y)/(d.y-l.y)+l.x&&(n=!n)}return n}function Nv(t,e,n,o,a){for(const d of t)if(e<=d.x&&n<=d.y&&o>=d.x&&a>=d.y)return!0;const l=[new ve(e,n),new ve(e,a),new ve(o,a),new ve(o,n)];if(t.length>2){for(const d of l)if(Sa(t,d))return!0}for(let d=0;d<t.length-1;d++)if(YM(t[d],t[d+1],l))return!0;return!1}function YM(t,e,n){const o=n[0],a=n[2];if(t.x<o.x&&e.x<o.x||t.x>a.x&&e.x>a.x||t.y<o.y&&e.y<o.y||t.y>a.y&&e.y>a.y)return!1;const l=ft(t,e,n[0]);return l!==ft(t,e,n[1])||l!==ft(t,e,n[2])||l!==ft(t,e,n[3])}function jh(t,e,n,o,a,l){let d=e.y-t.y,g=t.x-e.x;if(l=l||0){const v=d*d+g*g;if(v===0)return!0;const b=Math.sqrt(v);d/=b,g/=b}return!((n.x-t.x)*d+(n.y-t.y)*g-l<0||(o.x-t.x)*d+(o.y-t.y)*g-l<0||(a.x-t.x)*d+(a.y-t.y)*g-l<0)}function zg(t,e,n,o,a,l,d){return!(jh(t,e,o,a,l,d)||jh(e,n,o,a,l,d)||jh(n,t,o,a,l,d)||jh(o,a,t,e,n,d)||jh(a,l,t,e,n,d)||jh(l,o,t,e,n,d))}function Vh(t,e,n){const o=e.paint.get(t).value;return o.kind==="constant"?o.value:n.programConfigurations.get(e.id).getMaxValue(t)}function ym(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function jv(t,e,n,o,a){if(!e[0]&&!e[1])return t;const l=ve.convert(e)._mult(a);n==="viewport"&&l._rotate(-o);const d=[];for(let g=0;g<t.length;g++)d.push(t[g].sub(l));return d}function Vv(t,e,n,o){const a=ve.convert(t)._mult(o);return e==="viewport"&&a._rotate(-n),a}sn(Yo,"CircleBucket",{omit:["layers"]});const XM=new pi({"circle-sort-key":new wn(Je.layout_circle["circle-sort-key"]),visibility:new Nt(Je.layout_circle.visibility)});var KM={paint:new pi({"circle-radius":new wn(Je.paint_circle["circle-radius"]),"circle-color":new wn(Je.paint_circle["circle-color"]),"circle-blur":new wn(Je.paint_circle["circle-blur"]),"circle-opacity":new wn(Je.paint_circle["circle-opacity"]),"circle-translate":new Nt(Je.paint_circle["circle-translate"]),"circle-translate-anchor":new Nt(Je.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Nt(Je.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Nt(Je.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new wn(Je.paint_circle["circle-stroke-width"]),"circle-stroke-color":new wn(Je.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new wn(Je.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Nt(Je.paint_circle["circle-emissive-strength"])}),layout:XM},co={},uo={};Object.defineProperty(uo,"__esModule",{value:!0}),uo.setMatrixArrayType=function(t){uo.ARRAY_TYPE=$v=t},uo.toRadian=function(t){return t*QM},uo.equals=function(t,e){return Math.abs(t-e)<=Uv*Math.max(1,Math.abs(t),Math.abs(e))},uo.RANDOM=uo.ARRAY_TYPE=uo.EPSILON=void 0;var Uv=1e-6;uo.EPSILON=Uv;var $v=typeof Float32Array<"u"?Float32Array:Array;uo.ARRAY_TYPE=$v;var JM=Math.random;uo.RANDOM=JM;var QM=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var _i={};function Fg(t){return Fg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fg(t)}Object.defineProperty(_i,"__esModule",{value:!0}),_i.create=function(){var t=new vc.ARRAY_TYPE(4);return vc.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},_i.clone=function(t){var e=new vc.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},_i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},_i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},_i.fromValues=function(t,e,n,o){var a=new vc.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=n,a[3]=o,a},_i.set=function(t,e,n,o,a){return t[0]=e,t[1]=n,t[2]=o,t[3]=a,t},_i.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},_i.invert=function(t,e){var n=e[0],o=e[1],a=e[2],l=e[3],d=n*l-a*o;return d?(t[0]=l*(d=1/d),t[1]=-o*d,t[2]=-a*d,t[3]=n*d,t):null},_i.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},_i.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},_i.multiply=Hv,_i.rotate=function(t,e,n){var o=e[0],a=e[1],l=e[2],d=e[3],g=Math.sin(n),v=Math.cos(n);return t[0]=o*v+l*g,t[1]=a*v+d*g,t[2]=o*-g+l*v,t[3]=a*-g+d*v,t},_i.scale=function(t,e,n){var o=e[1],a=e[2],l=e[3],d=n[0],g=n[1];return t[0]=e[0]*d,t[1]=o*d,t[2]=a*g,t[3]=l*g,t},_i.fromRotation=function(t,e){var n=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=n,t[2]=-n,t[3]=o,t},_i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},_i.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},_i.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},_i.LDU=function(t,e,n,o){return t[2]=o[2]/o[0],n[0]=o[0],n[1]=o[1],n[3]=o[3]-t[2]*n[1],[t,e,n]},_i.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},_i.subtract=qv,_i.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},_i.equals=function(t,e){var n=t[0],o=t[1],a=t[2],l=t[3],d=e[0],g=e[1],v=e[2],b=e[3];return Math.abs(n-d)<=vc.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(o-g)<=vc.EPSILON*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(a-v)<=vc.EPSILON*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(l-b)<=vc.EPSILON*Math.max(1,Math.abs(l),Math.abs(b))},_i.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},_i.multiplyScalarAndAdd=function(t,e,n,o){return t[0]=e[0]+n[0]*o,t[1]=e[1]+n[1]*o,t[2]=e[2]+n[2]*o,t[3]=e[3]+n[3]*o,t},_i.sub=_i.mul=void 0;var vc=function(t,e){if(t&&t.__esModule)return t;if(t===null||Fg(t)!=="object"&&typeof t!="function")return{default:t};var n=Gv(void 0);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var d=a?Object.getOwnPropertyDescriptor(t,l):null;d&&(d.get||d.set)?Object.defineProperty(o,l,d):o[l]=t[l]}return o.default=t,n&&n.set(t,o),o}(uo);function Gv(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Gv=function(o){return o?n:e})(t)}function Hv(t,e,n){var o=e[0],a=e[1],l=e[2],d=e[3],g=n[0],v=n[1],b=n[2],S=n[3];return t[0]=o*g+l*v,t[1]=a*g+d*v,t[2]=o*b+l*S,t[3]=a*b+d*S,t}function qv(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}_i.mul=Hv,_i.sub=qv;var wi={};function Bg(t){return Bg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bg(t)}Object.defineProperty(wi,"__esModule",{value:!0}),wi.create=function(){var t=new sl.ARRAY_TYPE(6);return sl.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t},wi.clone=function(t){var e=new sl.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},wi.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},wi.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},wi.fromValues=function(t,e,n,o,a,l){var d=new sl.ARRAY_TYPE(6);return d[0]=t,d[1]=e,d[2]=n,d[3]=o,d[4]=a,d[5]=l,d},wi.set=function(t,e,n,o,a,l,d){return t[0]=e,t[1]=n,t[2]=o,t[3]=a,t[4]=l,t[5]=d,t},wi.invert=function(t,e){var n=e[0],o=e[1],a=e[2],l=e[3],d=e[4],g=e[5],v=n*l-o*a;return v?(t[0]=l*(v=1/v),t[1]=-o*v,t[2]=-a*v,t[3]=n*v,t[4]=(a*g-l*d)*v,t[5]=(o*d-n*g)*v,t):null},wi.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},wi.multiply=Zv,wi.rotate=function(t,e,n){var o=e[0],a=e[1],l=e[2],d=e[3],g=e[4],v=e[5],b=Math.sin(n),S=Math.cos(n);return t[0]=o*S+l*b,t[1]=a*S+d*b,t[2]=o*-b+l*S,t[3]=a*-b+d*S,t[4]=g,t[5]=v,t},wi.scale=function(t,e,n){var o=e[1],a=e[2],l=e[3],d=e[4],g=e[5],v=n[0],b=n[1];return t[0]=e[0]*v,t[1]=o*v,t[2]=a*b,t[3]=l*b,t[4]=d,t[5]=g,t},wi.translate=function(t,e,n){var o=e[0],a=e[1],l=e[2],d=e[3],g=e[4],v=e[5],b=n[0],S=n[1];return t[0]=o,t[1]=a,t[2]=l,t[3]=d,t[4]=o*b+l*S+g,t[5]=a*b+d*S+v,t},wi.fromRotation=function(t,e){var n=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=n,t[2]=-n,t[3]=o,t[4]=0,t[5]=0,t},wi.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},wi.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},wi.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},wi.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)},wi.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},wi.subtract=Yv,wi.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},wi.multiplyScalarAndAdd=function(t,e,n,o){return t[0]=e[0]+n[0]*o,t[1]=e[1]+n[1]*o,t[2]=e[2]+n[2]*o,t[3]=e[3]+n[3]*o,t[4]=e[4]+n[4]*o,t[5]=e[5]+n[5]*o,t},wi.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},wi.equals=function(t,e){var n=t[0],o=t[1],a=t[2],l=t[3],d=t[4],g=t[5],v=e[0],b=e[1],S=e[2],I=e[3],D=e[4],F=e[5];return Math.abs(n-v)<=sl.EPSILON*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(o-b)<=sl.EPSILON*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(a-S)<=sl.EPSILON*Math.max(1,Math.abs(a),Math.abs(S))&&Math.abs(l-I)<=sl.EPSILON*Math.max(1,Math.abs(l),Math.abs(I))&&Math.abs(d-D)<=sl.EPSILON*Math.max(1,Math.abs(d),Math.abs(D))&&Math.abs(g-F)<=sl.EPSILON*Math.max(1,Math.abs(g),Math.abs(F))},wi.sub=wi.mul=void 0;var sl=function(t,e){if(t&&t.__esModule)return t;if(t===null||Bg(t)!=="object"&&typeof t!="function")return{default:t};var n=Wv(void 0);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var d=a?Object.getOwnPropertyDescriptor(t,l):null;d&&(d.get||d.set)?Object.defineProperty(o,l,d):o[l]=t[l]}return o.default=t,n&&n.set(t,o),o}(uo);function Wv(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Wv=function(o){return o?n:e})(t)}function Zv(t,e,n){var o=e[0],a=e[1],l=e[2],d=e[3],g=e[4],v=e[5],b=n[0],S=n[1],I=n[2],D=n[3],F=n[4],N=n[5];return t[0]=o*b+l*S,t[1]=a*b+d*S,t[2]=o*I+l*D,t[3]=a*I+d*D,t[4]=o*F+l*N+g,t[5]=a*F+d*N+v,t}function Yv(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}wi.mul=Zv,wi.sub=Yv;var qr={};function Ng(t){return Ng=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ng(t)}Object.defineProperty(qr,"__esModule",{value:!0}),qr.create=function(){var t=new zs.ARRAY_TYPE(9);return zs.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},qr.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},qr.clone=function(t){var e=new zs.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},qr.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},qr.fromValues=function(t,e,n,o,a,l,d,g,v){var b=new zs.ARRAY_TYPE(9);return b[0]=t,b[1]=e,b[2]=n,b[3]=o,b[4]=a,b[5]=l,b[6]=d,b[7]=g,b[8]=v,b},qr.set=function(t,e,n,o,a,l,d,g,v,b){return t[0]=e,t[1]=n,t[2]=o,t[3]=a,t[4]=l,t[5]=d,t[6]=g,t[7]=v,t[8]=b,t},qr.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},qr.transpose=function(t,e){if(t===e){var n=e[1],o=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=o,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},qr.invert=function(t,e){var n=e[0],o=e[1],a=e[2],l=e[3],d=e[4],g=e[5],v=e[6],b=e[7],S=e[8],I=S*d-g*b,D=-S*l+g*v,F=b*l-d*v,N=n*I+o*D+a*F;return N?(t[0]=I*(N=1/N),t[1]=(-S*o+a*b)*N,t[2]=(g*o-a*d)*N,t[3]=D*N,t[4]=(S*n-a*v)*N,t[5]=(-g*n+a*l)*N,t[6]=F*N,t[7]=(-b*n+o*v)*N,t[8]=(d*n-o*l)*N,t):null},qr.adjoint=function(t,e){var n=e[0],o=e[1],a=e[2],l=e[3],d=e[4],g=e[5],v=e[6],b=e[7],S=e[8];return t[0]=d*S-g*b,t[1]=a*b-o*S,t[2]=o*g-a*d,t[3]=g*v-l*S,t[4]=n*S-a*v,t[5]=a*l-n*g,t[6]=l*b-d*v,t[7]=o*v-n*b,t[8]=n*d-o*l,t},qr.determinant=function(t){var e=t[3],n=t[4],o=t[5],a=t[6],l=t[7],d=t[8];return t[0]*(d*n-o*l)+t[1]*(-d*e+o*a)+t[2]*(l*e-n*a)},qr.multiply=Kv,qr.translate=function(t,e,n){var o=e[0],a=e[1],l=e[2],d=e[3],g=e[4],v=e[5],b=e[6],S=e[7],I=e[8],D=n[0],F=n[1];return t[0]=o,t[1]=a,t[2]=l,t[3]=d,t[4]=g,t[5]=v,t[6]=D*o+F*d+b,t[7]=D*a+F*g+S,t[8]=D*l+F*v+I,t},qr.rotate=function(t,e,n){var o=e[0],a=e[1],l=e[2],d=e[3],g=e[4],v=e[5],b=e[6],S=e[7],I=e[8],D=Math.sin(n),F=Math.cos(n);return t[0]=F*o+D*d,t[1]=F*a+D*g,t[2]=F*l+D*v,t[3]=F*d-D*o,t[4]=F*g-D*a,t[5]=F*v-D*l,t[6]=b,t[7]=S,t[8]=I,t},qr.scale=function(t,e,n){var o=n[0],a=n[1];return t[0]=o*e[0],t[1]=o*e[1],t[2]=o*e[2],t[3]=a*e[3],t[4]=a*e[4],t[5]=a*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},qr.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},qr.fromRotation=function(t,e){var n=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=n,t[2]=0,t[3]=-n,t[4]=o,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},qr.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},qr.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},qr.fromQuat=function(t,e){var n=e[0],o=e[1],a=e[2],l=e[3],d=n+n,g=o+o,v=a+a,b=n*d,S=o*d,I=o*g,D=a*d,F=a*g,N=a*v,V=l*d,q=l*g,Y=l*v;return t[0]=1-I-N,t[3]=S-Y,t[6]=D+q,t[1]=S+Y,t[4]=1-b-N,t[7]=F-V,t[2]=D-q,t[5]=F+V,t[8]=1-b-I,t},qr.normalFromMat4=function(t,e){var n=e[0],o=e[1],a=e[2],l=e[3],d=e[4],g=e[5],v=e[6],b=e[7],S=e[8],I=e[9],D=e[10],F=e[11],N=e[12],V=e[13],q=e[14],Y=e[15],oe=n*g-o*d,le=n*v-a*d,ae=n*b-l*d,be=o*v-a*g,ge=o*b-l*g,Ie=a*b-l*v,Ne=S*V-I*N,Ge=S*q-D*N,tt=S*Y-F*N,qe=I*q-D*V,_t=I*Y-F*V,Et=D*Y-F*q,ct=oe*Et-le*_t+ae*qe+be*tt-ge*Ge+Ie*Ne;return ct?(t[0]=(g*Et-v*_t+b*qe)*(ct=1/ct),t[1]=(v*tt-d*Et-b*Ge)*ct,t[2]=(d*_t-g*tt+b*Ne)*ct,t[3]=(a*_t-o*Et-l*qe)*ct,t[4]=(n*Et-a*tt+l*Ge)*ct,t[5]=(o*tt-n*_t-l*Ne)*ct,t[6]=(V*Ie-q*ge+Y*be)*ct,t[7]=(q*ae-N*Ie-Y*le)*ct,t[8]=(N*ge-V*ae+Y*oe)*ct,t):null},qr.projection=function(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},qr.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},qr.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},qr.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},qr.subtract=Jv,qr.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},qr.multiplyScalarAndAdd=function(t,e,n,o){return t[0]=e[0]+n[0]*o,t[1]=e[1]+n[1]*o,t[2]=e[2]+n[2]*o,t[3]=e[3]+n[3]*o,t[4]=e[4]+n[4]*o,t[5]=e[5]+n[5]*o,t[6]=e[6]+n[6]*o,t[7]=e[7]+n[7]*o,t[8]=e[8]+n[8]*o,t},qr.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},qr.equals=function(t,e){var n=t[0],o=t[1],a=t[2],l=t[3],d=t[4],g=t[5],v=t[6],b=t[7],S=t[8],I=e[0],D=e[1],F=e[2],N=e[3],V=e[4],q=e[5],Y=e[6],oe=e[7],le=e[8];return Math.abs(n-I)<=zs.EPSILON*Math.max(1,Math.abs(n),Math.abs(I))&&Math.abs(o-D)<=zs.EPSILON*Math.max(1,Math.abs(o),Math.abs(D))&&Math.abs(a-F)<=zs.EPSILON*Math.max(1,Math.abs(a),Math.abs(F))&&Math.abs(l-N)<=zs.EPSILON*Math.max(1,Math.abs(l),Math.abs(N))&&Math.abs(d-V)<=zs.EPSILON*Math.max(1,Math.abs(d),Math.abs(V))&&Math.abs(g-q)<=zs.EPSILON*Math.max(1,Math.abs(g),Math.abs(q))&&Math.abs(v-Y)<=zs.EPSILON*Math.max(1,Math.abs(v),Math.abs(Y))&&Math.abs(b-oe)<=zs.EPSILON*Math.max(1,Math.abs(b),Math.abs(oe))&&Math.abs(S-le)<=zs.EPSILON*Math.max(1,Math.abs(S),Math.abs(le))},qr.sub=qr.mul=void 0;var zs=function(t,e){if(t&&t.__esModule)return t;if(t===null||Ng(t)!=="object"&&typeof t!="function")return{default:t};var n=Xv(void 0);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var d=a?Object.getOwnPropertyDescriptor(t,l):null;d&&(d.get||d.set)?Object.defineProperty(o,l,d):o[l]=t[l]}return o.default=t,n&&n.set(t,o),o}(uo);function Xv(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Xv=function(o){return o?n:e})(t)}function Kv(t,e,n){var o=e[0],a=e[1],l=e[2],d=e[3],g=e[4],v=e[5],b=e[6],S=e[7],I=e[8],D=n[0],F=n[1],N=n[2],V=n[3],q=n[4],Y=n[5],oe=n[6],le=n[7],ae=n[8];return t[0]=D*o+F*d+N*b,t[1]=D*a+F*g+N*S,t[2]=D*l+F*v+N*I,t[3]=V*o+q*d+Y*b,t[4]=V*a+q*g+Y*S,t[5]=V*l+q*v+Y*I,t[6]=oe*o+le*d+ae*b,t[7]=oe*a+le*g+ae*S,t[8]=oe*l+le*v+ae*I,t}function Jv(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}qr.mul=Kv,qr.sub=Jv;var Xn={};function jg(t){return jg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jg(t)}Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.create=function(){var t=new Li.ARRAY_TYPE(16);return Li.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},Xn.clone=function(t){var e=new Li.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},Xn.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},Xn.fromValues=function(t,e,n,o,a,l,d,g,v,b,S,I,D,F,N,V){var q=new Li.ARRAY_TYPE(16);return q[0]=t,q[1]=e,q[2]=n,q[3]=o,q[4]=a,q[5]=l,q[6]=d,q[7]=g,q[8]=v,q[9]=b,q[10]=S,q[11]=I,q[12]=D,q[13]=F,q[14]=N,q[15]=V,q},Xn.set=function(t,e,n,o,a,l,d,g,v,b,S,I,D,F,N,V,q){return t[0]=e,t[1]=n,t[2]=o,t[3]=a,t[4]=l,t[5]=d,t[6]=g,t[7]=v,t[8]=b,t[9]=S,t[10]=I,t[11]=D,t[12]=F,t[13]=N,t[14]=V,t[15]=q,t},Xn.identity=ex,Xn.transpose=function(t,e){if(t===e){var n=e[1],o=e[2],a=e[3],l=e[6],d=e[7],g=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=o,t[9]=l,t[11]=e[14],t[12]=a,t[13]=d,t[14]=g}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},Xn.invert=function(t,e){var n=e[0],o=e[1],a=e[2],l=e[3],d=e[4],g=e[5],v=e[6],b=e[7],S=e[8],I=e[9],D=e[10],F=e[11],N=e[12],V=e[13],q=e[14],Y=e[15],oe=n*g-o*d,le=n*v-a*d,ae=n*b-l*d,be=o*v-a*g,ge=o*b-l*g,Ie=a*b-l*v,Ne=S*V-I*N,Ge=S*q-D*N,tt=S*Y-F*N,qe=I*q-D*V,_t=I*Y-F*V,Et=D*Y-F*q,ct=oe*Et-le*_t+ae*qe+be*tt-ge*Ge+Ie*Ne;return ct?(t[0]=(g*Et-v*_t+b*qe)*(ct=1/ct),t[1]=(a*_t-o*Et-l*qe)*ct,t[2]=(V*Ie-q*ge+Y*be)*ct,t[3]=(D*ge-I*Ie-F*be)*ct,t[4]=(v*tt-d*Et-b*Ge)*ct,t[5]=(n*Et-a*tt+l*Ge)*ct,t[6]=(q*ae-N*Ie-Y*le)*ct,t[7]=(S*Ie-D*ae+F*le)*ct,t[8]=(d*_t-g*tt+b*Ne)*ct,t[9]=(o*tt-n*_t-l*Ne)*ct,t[10]=(N*ge-V*ae+Y*oe)*ct,t[11]=(I*ae-S*ge-F*oe)*ct,t[12]=(g*Ge-d*qe-v*Ne)*ct,t[13]=(n*qe-o*Ge+a*Ne)*ct,t[14]=(V*le-N*be-q*oe)*ct,t[15]=(S*be-I*le+D*oe)*ct,t):null},Xn.adjoint=function(t,e){var n=e[0],o=e[1],a=e[2],l=e[3],d=e[4],g=e[5],v=e[6],b=e[7],S=e[8],I=e[9],D=e[10],F=e[11],N=e[12],V=e[13],q=e[14],Y=e[15];return t[0]=g*(D*Y-F*q)-I*(v*Y-b*q)+V*(v*F-b*D),t[1]=-(o*(D*Y-F*q)-I*(a*Y-l*q)+V*(a*F-l*D)),t[2]=o*(v*Y-b*q)-g*(a*Y-l*q)+V*(a*b-l*v),t[3]=-(o*(v*F-b*D)-g*(a*F-l*D)+I*(a*b-l*v)),t[4]=-(d*(D*Y-F*q)-S*(v*Y-b*q)+N*(v*F-b*D)),t[5]=n*(D*Y-F*q)-S*(a*Y-l*q)+N*(a*F-l*D),t[6]=-(n*(v*Y-b*q)-d*(a*Y-l*q)+N*(a*b-l*v)),t[7]=n*(v*F-b*D)-d*(a*F-l*D)+S*(a*b-l*v),t[8]=d*(I*Y-F*V)-S*(g*Y-b*V)+N*(g*F-b*I),t[9]=-(n*(I*Y-F*V)-S*(o*Y-l*V)+N*(o*F-l*I)),t[10]=n*(g*Y-b*V)-d*(o*Y-l*V)+N*(o*b-l*g),t[11]=-(n*(g*F-b*I)-d*(o*F-l*I)+S*(o*b-l*g)),t[12]=-(d*(I*q-D*V)-S*(g*q-v*V)+N*(g*D-v*I)),t[13]=n*(I*q-D*V)-S*(o*q-a*V)+N*(o*D-a*I),t[14]=-(n*(g*q-v*V)-d*(o*q-a*V)+N*(o*v-a*g)),t[15]=n*(g*D-v*I)-d*(o*D-a*I)+S*(o*v-a*g),t},Xn.determinant=function(t){var e=t[0],n=t[1],o=t[2],a=t[3],l=t[4],d=t[5],g=t[6],v=t[7],b=t[8],S=t[9],I=t[10],D=t[11],F=t[12],N=t[13],V=t[14],q=t[15];return(e*d-n*l)*(I*q-D*V)-(e*g-o*l)*(S*q-D*N)+(e*v-a*l)*(S*V-I*N)+(n*g-o*d)*(b*q-D*F)-(n*v-a*d)*(b*V-I*F)+(o*v-a*g)*(b*N-S*F)},Xn.multiply=tx,Xn.translate=function(t,e,n){var o,a,l,d,g,v,b,S,I,D,F,N,V=n[0],q=n[1],Y=n[2];return e===t?(t[12]=e[0]*V+e[4]*q+e[8]*Y+e[12],t[13]=e[1]*V+e[5]*q+e[9]*Y+e[13],t[14]=e[2]*V+e[6]*q+e[10]*Y+e[14],t[15]=e[3]*V+e[7]*q+e[11]*Y+e[15]):(a=e[1],l=e[2],d=e[3],g=e[4],v=e[5],b=e[6],S=e[7],I=e[8],D=e[9],F=e[10],N=e[11],t[0]=o=e[0],t[1]=a,t[2]=l,t[3]=d,t[4]=g,t[5]=v,t[6]=b,t[7]=S,t[8]=I,t[9]=D,t[10]=F,t[11]=N,t[12]=o*V+g*q+I*Y+e[12],t[13]=a*V+v*q+D*Y+e[13],t[14]=l*V+b*q+F*Y+e[14],t[15]=d*V+S*q+N*Y+e[15]),t},Xn.scale=function(t,e,n){var o=n[0],a=n[1],l=n[2];return t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t[3]=e[3]*o,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*l,t[9]=e[9]*l,t[10]=e[10]*l,t[11]=e[11]*l,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},Xn.rotate=function(t,e,n,o){var a,l,d,g,v,b,S,I,D,F,N,V,q,Y,oe,le,ae,be,ge,Ie,Ne,Ge,tt,qe,_t=o[0],Et=o[1],ct=o[2],wt=Math.hypot(_t,Et,ct);return wt<Li.EPSILON?null:(_t*=wt=1/wt,Et*=wt,ct*=wt,a=Math.sin(n),l=Math.cos(n),v=e[1],b=e[2],S=e[3],D=e[5],F=e[6],N=e[7],q=e[9],Y=e[10],oe=e[11],le=_t*_t*(d=1-l)+l,ge=_t*Et*d-ct*a,Ie=Et*Et*d+l,Ne=ct*Et*d+_t*a,Ge=_t*ct*d+Et*a,tt=Et*ct*d-_t*a,qe=ct*ct*d+l,t[0]=(g=e[0])*le+(I=e[4])*(ae=Et*_t*d+ct*a)+(V=e[8])*(be=ct*_t*d-Et*a),t[1]=v*le+D*ae+q*be,t[2]=b*le+F*ae+Y*be,t[3]=S*le+N*ae+oe*be,t[4]=g*ge+I*Ie+V*Ne,t[5]=v*ge+D*Ie+q*Ne,t[6]=b*ge+F*Ie+Y*Ne,t[7]=S*ge+N*Ie+oe*Ne,t[8]=g*Ge+I*tt+V*qe,t[9]=v*Ge+D*tt+q*qe,t[10]=b*Ge+F*tt+Y*qe,t[11]=S*Ge+N*tt+oe*qe,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},Xn.rotateX=function(t,e,n){var o=Math.sin(n),a=Math.cos(n),l=e[4],d=e[5],g=e[6],v=e[7],b=e[8],S=e[9],I=e[10],D=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=l*a+b*o,t[5]=d*a+S*o,t[6]=g*a+I*o,t[7]=v*a+D*o,t[8]=b*a-l*o,t[9]=S*a-d*o,t[10]=I*a-g*o,t[11]=D*a-v*o,t},Xn.rotateY=function(t,e,n){var o=Math.sin(n),a=Math.cos(n),l=e[0],d=e[1],g=e[2],v=e[3],b=e[8],S=e[9],I=e[10],D=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=l*a-b*o,t[1]=d*a-S*o,t[2]=g*a-I*o,t[3]=v*a-D*o,t[8]=l*o+b*a,t[9]=d*o+S*a,t[10]=g*o+I*a,t[11]=v*o+D*a,t},Xn.rotateZ=function(t,e,n){var o=Math.sin(n),a=Math.cos(n),l=e[0],d=e[1],g=e[2],v=e[3],b=e[4],S=e[5],I=e[6],D=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=l*a+b*o,t[1]=d*a+S*o,t[2]=g*a+I*o,t[3]=v*a+D*o,t[4]=b*a-l*o,t[5]=S*a-d*o,t[6]=I*a-g*o,t[7]=D*a-v*o,t},Xn.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},Xn.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Xn.fromRotation=function(t,e,n){var o,a,l,d=n[0],g=n[1],v=n[2],b=Math.hypot(d,g,v);return b<Li.EPSILON?null:(d*=b=1/b,g*=b,v*=b,o=Math.sin(e),a=Math.cos(e),t[0]=d*d*(l=1-a)+a,t[1]=g*d*l+v*o,t[2]=v*d*l-g*o,t[3]=0,t[4]=d*g*l-v*o,t[5]=g*g*l+a,t[6]=v*g*l+d*o,t[7]=0,t[8]=d*v*l+g*o,t[9]=g*v*l-d*o,t[10]=v*v*l+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},Xn.fromXRotation=function(t,e){var n=Math.sin(e),o=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Xn.fromYRotation=function(t,e){var n=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Xn.fromZRotation=function(t,e){var n=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Xn.fromRotationTranslation=nx,Xn.fromQuat2=function(t,e){var n=new Li.ARRAY_TYPE(3),o=-e[0],a=-e[1],l=-e[2],d=e[3],g=e[4],v=e[5],b=e[6],S=e[7],I=o*o+a*a+l*l+d*d;return I>0?(n[0]=2*(g*d+S*o+v*l-b*a)/I,n[1]=2*(v*d+S*a+b*o-g*l)/I,n[2]=2*(b*d+S*l+g*a-v*o)/I):(n[0]=2*(g*d+S*o+v*l-b*a),n[1]=2*(v*d+S*a+b*o-g*l),n[2]=2*(b*d+S*l+g*a-v*o)),nx(t,e,n),t},Xn.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},Xn.getScaling=rx,Xn.getRotation=function(t,e){var n=new Li.ARRAY_TYPE(3);rx(n,e);var o=1/n[0],a=1/n[1],l=1/n[2],d=e[0]*o,g=e[1]*a,v=e[2]*l,b=e[4]*o,S=e[5]*a,I=e[6]*l,D=e[8]*o,F=e[9]*a,N=e[10]*l,V=d+S+N,q=0;return V>0?(q=2*Math.sqrt(V+1),t[3]=.25*q,t[0]=(I-F)/q,t[1]=(D-v)/q,t[2]=(g-b)/q):d>S&&d>N?(q=2*Math.sqrt(1+d-S-N),t[3]=(I-F)/q,t[0]=.25*q,t[1]=(g+b)/q,t[2]=(D+v)/q):S>N?(q=2*Math.sqrt(1+S-d-N),t[3]=(D-v)/q,t[0]=(g+b)/q,t[1]=.25*q,t[2]=(I+F)/q):(q=2*Math.sqrt(1+N-d-S),t[3]=(g-b)/q,t[0]=(D+v)/q,t[1]=(I+F)/q,t[2]=.25*q),t},Xn.fromRotationTranslationScale=function(t,e,n,o){var a=e[0],l=e[1],d=e[2],g=e[3],v=a+a,b=l+l,S=d+d,I=a*v,D=a*b,F=a*S,N=l*b,V=l*S,q=d*S,Y=g*v,oe=g*b,le=g*S,ae=o[0],be=o[1],ge=o[2];return t[0]=(1-(N+q))*ae,t[1]=(D+le)*ae,t[2]=(F-oe)*ae,t[3]=0,t[4]=(D-le)*be,t[5]=(1-(I+q))*be,t[6]=(V+Y)*be,t[7]=0,t[8]=(F+oe)*ge,t[9]=(V-Y)*ge,t[10]=(1-(I+N))*ge,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},Xn.fromRotationTranslationScaleOrigin=function(t,e,n,o,a){var l=e[0],d=e[1],g=e[2],v=e[3],b=l+l,S=d+d,I=g+g,D=l*b,F=l*S,N=l*I,V=d*S,q=d*I,Y=g*I,oe=v*b,le=v*S,ae=v*I,be=o[0],ge=o[1],Ie=o[2],Ne=a[0],Ge=a[1],tt=a[2],qe=(1-(V+Y))*be,_t=(F+ae)*be,Et=(N-le)*be,ct=(F-ae)*ge,wt=(1-(D+Y))*ge,st=(q+oe)*ge,bt=(N+le)*Ie,$t=(q-oe)*Ie,St=(1-(D+V))*Ie;return t[0]=qe,t[1]=_t,t[2]=Et,t[3]=0,t[4]=ct,t[5]=wt,t[6]=st,t[7]=0,t[8]=bt,t[9]=$t,t[10]=St,t[11]=0,t[12]=n[0]+Ne-(qe*Ne+ct*Ge+bt*tt),t[13]=n[1]+Ge-(_t*Ne+wt*Ge+$t*tt),t[14]=n[2]+tt-(Et*Ne+st*Ge+St*tt),t[15]=1,t},Xn.fromQuat=function(t,e){var n=e[0],o=e[1],a=e[2],l=e[3],d=n+n,g=o+o,v=a+a,b=n*d,S=o*d,I=o*g,D=a*d,F=a*g,N=a*v,V=l*d,q=l*g,Y=l*v;return t[0]=1-I-N,t[1]=S+Y,t[2]=D-q,t[3]=0,t[4]=S-Y,t[5]=1-b-N,t[6]=F+V,t[7]=0,t[8]=D+q,t[9]=F-V,t[10]=1-b-I,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Xn.frustum=function(t,e,n,o,a,l,d){var g=1/(n-e),v=1/(a-o),b=1/(l-d);return t[0]=2*l*g,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*l*v,t[6]=0,t[7]=0,t[8]=(n+e)*g,t[9]=(a+o)*v,t[10]=(d+l)*b,t[11]=-1,t[12]=0,t[13]=0,t[14]=d*l*2*b,t[15]=0,t},Xn.perspectiveNO=ix,Xn.perspectiveZO=function(t,e,n,o,a){var l,d=1/Math.tan(e/2);return t[0]=d/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=d,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,a!=null&&a!==1/0?(t[10]=a*(l=1/(o-a)),t[14]=a*o*l):(t[10]=-1,t[14]=-o),t},Xn.perspectiveFromFieldOfView=function(t,e,n,o){var a=Math.tan(e.upDegrees*Math.PI/180),l=Math.tan(e.downDegrees*Math.PI/180),d=Math.tan(e.leftDegrees*Math.PI/180),g=Math.tan(e.rightDegrees*Math.PI/180),v=2/(d+g),b=2/(a+l);return t[0]=v,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=b,t[6]=0,t[7]=0,t[8]=-(d-g)*v*.5,t[9]=(a-l)*b*.5,t[10]=o/(n-o),t[11]=-1,t[12]=0,t[13]=0,t[14]=o*n/(n-o),t[15]=0,t},Xn.orthoNO=ox,Xn.orthoZO=function(t,e,n,o,a,l,d){var g=1/(e-n),v=1/(o-a),b=1/(l-d);return t[0]=-2*g,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*v,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=b,t[11]=0,t[12]=(e+n)*g,t[13]=(a+o)*v,t[14]=l*b,t[15]=1,t},Xn.lookAt=function(t,e,n,o){var a,l,d,g,v,b,S,I,D,F,N=e[0],V=e[1],q=e[2],Y=o[0],oe=o[1],le=o[2],ae=n[0],be=n[1],ge=n[2];return Math.abs(N-ae)<Li.EPSILON&&Math.abs(V-be)<Li.EPSILON&&Math.abs(q-ge)<Li.EPSILON?ex(t):(S=N-ae,I=V-be,D=q-ge,a=oe*(D*=F=1/Math.hypot(S,I,D))-le*(I*=F),l=le*(S*=F)-Y*D,d=Y*I-oe*S,(F=Math.hypot(a,l,d))?(a*=F=1/F,l*=F,d*=F):(a=0,l=0,d=0),g=I*d-D*l,v=D*a-S*d,b=S*l-I*a,(F=Math.hypot(g,v,b))?(g*=F=1/F,v*=F,b*=F):(g=0,v=0,b=0),t[0]=a,t[1]=g,t[2]=S,t[3]=0,t[4]=l,t[5]=v,t[6]=I,t[7]=0,t[8]=d,t[9]=b,t[10]=D,t[11]=0,t[12]=-(a*N+l*V+d*q),t[13]=-(g*N+v*V+b*q),t[14]=-(S*N+I*V+D*q),t[15]=1,t)},Xn.targetTo=function(t,e,n,o){var a=e[0],l=e[1],d=e[2],g=o[0],v=o[1],b=o[2],S=a-n[0],I=l-n[1],D=d-n[2],F=S*S+I*I+D*D;F>0&&(S*=F=1/Math.sqrt(F),I*=F,D*=F);var N=v*D-b*I,V=b*S-g*D,q=g*I-v*S;return(F=N*N+V*V+q*q)>0&&(N*=F=1/Math.sqrt(F),V*=F,q*=F),t[0]=N,t[1]=V,t[2]=q,t[3]=0,t[4]=I*q-D*V,t[5]=D*N-S*q,t[6]=S*V-I*N,t[7]=0,t[8]=S,t[9]=I,t[10]=D,t[11]=0,t[12]=a,t[13]=l,t[14]=d,t[15]=1,t},Xn.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},Xn.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},Xn.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},Xn.subtract=sx,Xn.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},Xn.multiplyScalarAndAdd=function(t,e,n,o){return t[0]=e[0]+n[0]*o,t[1]=e[1]+n[1]*o,t[2]=e[2]+n[2]*o,t[3]=e[3]+n[3]*o,t[4]=e[4]+n[4]*o,t[5]=e[5]+n[5]*o,t[6]=e[6]+n[6]*o,t[7]=e[7]+n[7]*o,t[8]=e[8]+n[8]*o,t[9]=e[9]+n[9]*o,t[10]=e[10]+n[10]*o,t[11]=e[11]+n[11]*o,t[12]=e[12]+n[12]*o,t[13]=e[13]+n[13]*o,t[14]=e[14]+n[14]*o,t[15]=e[15]+n[15]*o,t},Xn.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},Xn.equals=function(t,e){var n=t[0],o=t[1],a=t[2],l=t[3],d=t[4],g=t[5],v=t[6],b=t[7],S=t[8],I=t[9],D=t[10],F=t[11],N=t[12],V=t[13],q=t[14],Y=t[15],oe=e[0],le=e[1],ae=e[2],be=e[3],ge=e[4],Ie=e[5],Ne=e[6],Ge=e[7],tt=e[8],qe=e[9],_t=e[10],Et=e[11],ct=e[12],wt=e[13],st=e[14],bt=e[15];return Math.abs(n-oe)<=Li.EPSILON*Math.max(1,Math.abs(n),Math.abs(oe))&&Math.abs(o-le)<=Li.EPSILON*Math.max(1,Math.abs(o),Math.abs(le))&&Math.abs(a-ae)<=Li.EPSILON*Math.max(1,Math.abs(a),Math.abs(ae))&&Math.abs(l-be)<=Li.EPSILON*Math.max(1,Math.abs(l),Math.abs(be))&&Math.abs(d-ge)<=Li.EPSILON*Math.max(1,Math.abs(d),Math.abs(ge))&&Math.abs(g-Ie)<=Li.EPSILON*Math.max(1,Math.abs(g),Math.abs(Ie))&&Math.abs(v-Ne)<=Li.EPSILON*Math.max(1,Math.abs(v),Math.abs(Ne))&&Math.abs(b-Ge)<=Li.EPSILON*Math.max(1,Math.abs(b),Math.abs(Ge))&&Math.abs(S-tt)<=Li.EPSILON*Math.max(1,Math.abs(S),Math.abs(tt))&&Math.abs(I-qe)<=Li.EPSILON*Math.max(1,Math.abs(I),Math.abs(qe))&&Math.abs(D-_t)<=Li.EPSILON*Math.max(1,Math.abs(D),Math.abs(_t))&&Math.abs(F-Et)<=Li.EPSILON*Math.max(1,Math.abs(F),Math.abs(Et))&&Math.abs(N-ct)<=Li.EPSILON*Math.max(1,Math.abs(N),Math.abs(ct))&&Math.abs(V-wt)<=Li.EPSILON*Math.max(1,Math.abs(V),Math.abs(wt))&&Math.abs(q-st)<=Li.EPSILON*Math.max(1,Math.abs(q),Math.abs(st))&&Math.abs(Y-bt)<=Li.EPSILON*Math.max(1,Math.abs(Y),Math.abs(bt))},Xn.sub=Xn.mul=Xn.ortho=Xn.perspective=void 0;var Li=function(t,e){if(t&&t.__esModule)return t;if(t===null||jg(t)!=="object"&&typeof t!="function")return{default:t};var n=Qv(void 0);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var d=a?Object.getOwnPropertyDescriptor(t,l):null;d&&(d.get||d.set)?Object.defineProperty(o,l,d):o[l]=t[l]}return o.default=t,n&&n.set(t,o),o}(uo);function Qv(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Qv=function(o){return o?n:e})(t)}function ex(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function tx(t,e,n){var o=e[0],a=e[1],l=e[2],d=e[3],g=e[4],v=e[5],b=e[6],S=e[7],I=e[8],D=e[9],F=e[10],N=e[11],V=e[12],q=e[13],Y=e[14],oe=e[15],le=n[0],ae=n[1],be=n[2],ge=n[3];return t[0]=le*o+ae*g+be*I+ge*V,t[1]=le*a+ae*v+be*D+ge*q,t[2]=le*l+ae*b+be*F+ge*Y,t[3]=le*d+ae*S+be*N+ge*oe,t[4]=(le=n[4])*o+(ae=n[5])*g+(be=n[6])*I+(ge=n[7])*V,t[5]=le*a+ae*v+be*D+ge*q,t[6]=le*l+ae*b+be*F+ge*Y,t[7]=le*d+ae*S+be*N+ge*oe,t[8]=(le=n[8])*o+(ae=n[9])*g+(be=n[10])*I+(ge=n[11])*V,t[9]=le*a+ae*v+be*D+ge*q,t[10]=le*l+ae*b+be*F+ge*Y,t[11]=le*d+ae*S+be*N+ge*oe,t[12]=(le=n[12])*o+(ae=n[13])*g+(be=n[14])*I+(ge=n[15])*V,t[13]=le*a+ae*v+be*D+ge*q,t[14]=le*l+ae*b+be*F+ge*Y,t[15]=le*d+ae*S+be*N+ge*oe,t}function nx(t,e,n){var o=e[0],a=e[1],l=e[2],d=e[3],g=o+o,v=a+a,b=l+l,S=o*g,I=o*v,D=o*b,F=a*v,N=a*b,V=l*b,q=d*g,Y=d*v,oe=d*b;return t[0]=1-(F+V),t[1]=I+oe,t[2]=D-Y,t[3]=0,t[4]=I-oe,t[5]=1-(S+V),t[6]=N+q,t[7]=0,t[8]=D+Y,t[9]=N-q,t[10]=1-(S+F),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function rx(t,e){var n=e[4],o=e[5],a=e[6],l=e[8],d=e[9],g=e[10];return t[0]=Math.hypot(e[0],e[1],e[2]),t[1]=Math.hypot(n,o,a),t[2]=Math.hypot(l,d,g),t}function ix(t,e,n,o,a){var l,d=1/Math.tan(e/2);return t[0]=d/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=d,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,a!=null&&a!==1/0?(t[10]=(a+o)*(l=1/(o-a)),t[14]=2*a*o*l):(t[10]=-1,t[14]=-2*o),t}function ox(t,e,n,o,a,l,d){var g=1/(e-n),v=1/(o-a),b=1/(l-d);return t[0]=-2*g,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*v,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*b,t[11]=0,t[12]=(e+n)*g,t[13]=(a+o)*v,t[14]=(d+l)*b,t[15]=1,t}function sx(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}Xn.perspective=ix,Xn.ortho=ox,Xn.mul=tx,Xn.sub=sx;var Vn={},Wn={};function Vg(t){return Vg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vg(t)}Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.create=lx,Wn.clone=function(t){var e=new Rl.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},Wn.length=cx,Wn.fromValues=function(t,e,n){var o=new Rl.ARRAY_TYPE(3);return o[0]=t,o[1]=e,o[2]=n,o},Wn.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},Wn.set=function(t,e,n,o){return t[0]=e,t[1]=n,t[2]=o,t},Wn.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},Wn.subtract=ux,Wn.multiply=hx,Wn.divide=dx,Wn.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},Wn.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},Wn.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},Wn.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},Wn.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},Wn.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},Wn.scaleAndAdd=function(t,e,n,o){return t[0]=e[0]+n[0]*o,t[1]=e[1]+n[1]*o,t[2]=e[2]+n[2]*o,t},Wn.distance=fx,Wn.squaredDistance=px,Wn.squaredLength=mx,Wn.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},Wn.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},Wn.normalize=function(t,e){var n=e[0],o=e[1],a=e[2],l=n*n+o*o+a*a;return l>0&&(l=1/Math.sqrt(l)),t[0]=e[0]*l,t[1]=e[1]*l,t[2]=e[2]*l,t},Wn.dot=_x,Wn.cross=function(t,e,n){var o=e[0],a=e[1],l=e[2],d=n[0],g=n[1],v=n[2];return t[0]=a*v-l*g,t[1]=l*d-o*v,t[2]=o*g-a*d,t},Wn.lerp=function(t,e,n,o){var a=e[0],l=e[1],d=e[2];return t[0]=a+o*(n[0]-a),t[1]=l+o*(n[1]-l),t[2]=d+o*(n[2]-d),t},Wn.hermite=function(t,e,n,o,a,l){var d=l*l,g=d*(2*l-3)+1,v=d*(l-2)+l,b=d*(l-1),S=d*(3-2*l);return t[0]=e[0]*g+n[0]*v+o[0]*b+a[0]*S,t[1]=e[1]*g+n[1]*v+o[1]*b+a[1]*S,t[2]=e[2]*g+n[2]*v+o[2]*b+a[2]*S,t},Wn.bezier=function(t,e,n,o,a,l){var d=1-l,g=d*d,v=l*l,b=g*d,S=3*l*g,I=3*v*d,D=v*l;return t[0]=e[0]*b+n[0]*S+o[0]*I+a[0]*D,t[1]=e[1]*b+n[1]*S+o[1]*I+a[1]*D,t[2]=e[2]*b+n[2]*S+o[2]*I+a[2]*D,t},Wn.random=function(t,e){e=e||1;var n=2*Rl.RANDOM()*Math.PI,o=2*Rl.RANDOM()-1,a=Math.sqrt(1-o*o)*e;return t[0]=Math.cos(n)*a,t[1]=Math.sin(n)*a,t[2]=o*e,t},Wn.transformMat4=function(t,e,n){var o=e[0],a=e[1],l=e[2],d=n[3]*o+n[7]*a+n[11]*l+n[15];return t[0]=(n[0]*o+n[4]*a+n[8]*l+n[12])/(d=d||1),t[1]=(n[1]*o+n[5]*a+n[9]*l+n[13])/d,t[2]=(n[2]*o+n[6]*a+n[10]*l+n[14])/d,t},Wn.transformMat3=function(t,e,n){var o=e[0],a=e[1],l=e[2];return t[0]=o*n[0]+a*n[3]+l*n[6],t[1]=o*n[1]+a*n[4]+l*n[7],t[2]=o*n[2]+a*n[5]+l*n[8],t},Wn.transformQuat=function(t,e,n){var o=n[0],a=n[1],l=n[2],d=e[0],g=e[1],v=e[2],b=a*v-l*g,S=l*d-o*v,I=o*g-a*d,D=a*I-l*S,F=l*b-o*I,N=o*S-a*b,V=2*n[3];return S*=V,I*=V,F*=2,N*=2,t[0]=d+(b*=V)+(D*=2),t[1]=g+S+F,t[2]=v+I+N,t},Wn.rotateX=function(t,e,n,o){var a=[],l=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],l[0]=a[0],l[1]=a[1]*Math.cos(o)-a[2]*Math.sin(o),l[2]=a[1]*Math.sin(o)+a[2]*Math.cos(o),t[0]=l[0]+n[0],t[1]=l[1]+n[1],t[2]=l[2]+n[2],t},Wn.rotateY=function(t,e,n,o){var a=[],l=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],l[0]=a[2]*Math.sin(o)+a[0]*Math.cos(o),l[1]=a[1],l[2]=a[2]*Math.cos(o)-a[0]*Math.sin(o),t[0]=l[0]+n[0],t[1]=l[1]+n[1],t[2]=l[2]+n[2],t},Wn.rotateZ=function(t,e,n,o){var a=[],l=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],l[0]=a[0]*Math.cos(o)-a[1]*Math.sin(o),l[1]=a[0]*Math.sin(o)+a[1]*Math.cos(o),l[2]=a[2],t[0]=l[0]+n[0],t[1]=l[1]+n[1],t[2]=l[2]+n[2],t},Wn.angle=function(t,e){var n=t[0],o=t[1],a=t[2],l=e[0],d=e[1],g=e[2],v=Math.sqrt(n*n+o*o+a*a)*Math.sqrt(l*l+d*d+g*g),b=v&&_x(t,e)/v;return Math.acos(Math.min(Math.max(b,-1),1))},Wn.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t},Wn.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},Wn.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},Wn.equals=function(t,e){var n=t[0],o=t[1],a=t[2],l=e[0],d=e[1],g=e[2];return Math.abs(n-l)<=Rl.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(o-d)<=Rl.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-g)<=Rl.EPSILON*Math.max(1,Math.abs(a),Math.abs(g))},Wn.forEach=Wn.sqrLen=Wn.len=Wn.sqrDist=Wn.dist=Wn.div=Wn.mul=Wn.sub=void 0;var Rl=function(t,e){if(t&&t.__esModule)return t;if(t===null||Vg(t)!=="object"&&typeof t!="function")return{default:t};var n=ax(void 0);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var d=a?Object.getOwnPropertyDescriptor(t,l):null;d&&(d.get||d.set)?Object.defineProperty(o,l,d):o[l]=t[l]}return o.default=t,n&&n.set(t,o),o}(uo);function ax(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(ax=function(o){return o?n:e})(t)}function lx(){var t=new Rl.ARRAY_TYPE(3);return Rl.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function cx(t){return Math.hypot(t[0],t[1],t[2])}function ux(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function hx(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function dx(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function fx(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])}function px(t,e){var n=e[0]-t[0],o=e[1]-t[1],a=e[2]-t[2];return n*n+o*o+a*a}function mx(t){var e=t[0],n=t[1],o=t[2];return e*e+n*n+o*o}function _x(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}Wn.sub=ux,Wn.mul=hx,Wn.div=dx,Wn.dist=fx,Wn.sqrDist=px,Wn.len=cx,Wn.sqrLen=mx;var Ll,eA=(Ll=lx(),function(t,e,n,o,a,l){var d,g;for(e||(e=3),n||(n=0),g=o?Math.min(o*e+n,t.length):t.length,d=n;d<g;d+=e)Ll[0]=t[d],Ll[1]=t[d+1],Ll[2]=t[d+2],a(Ll,Ll,l),t[d]=Ll[0],t[d+1]=Ll[1],t[d+2]=Ll[2];return t});Wn.forEach=eA;var ur={};function Ug(t){return Ug=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ug(t)}Object.defineProperty(ur,"__esModule",{value:!0}),ur.create=yx,ur.clone=function(t){var e=new ia.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},ur.fromValues=function(t,e,n,o){var a=new ia.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=n,a[3]=o,a},ur.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},ur.set=function(t,e,n,o,a){return t[0]=e,t[1]=n,t[2]=o,t[3]=a,t},ur.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},ur.subtract=vx,ur.multiply=xx,ur.divide=bx,ur.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},ur.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},ur.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},ur.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},ur.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},ur.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},ur.scaleAndAdd=function(t,e,n,o){return t[0]=e[0]+n[0]*o,t[1]=e[1]+n[1]*o,t[2]=e[2]+n[2]*o,t[3]=e[3]+n[3]*o,t},ur.distance=wx,ur.squaredDistance=Tx,ur.length=Ex,ur.squaredLength=Sx,ur.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},ur.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},ur.normalize=function(t,e){var n=e[0],o=e[1],a=e[2],l=e[3],d=n*n+o*o+a*a+l*l;return d>0&&(d=1/Math.sqrt(d)),t[0]=n*d,t[1]=o*d,t[2]=a*d,t[3]=l*d,t},ur.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},ur.cross=function(t,e,n,o){var a=n[0]*o[1]-n[1]*o[0],l=n[0]*o[2]-n[2]*o[0],d=n[0]*o[3]-n[3]*o[0],g=n[1]*o[2]-n[2]*o[1],v=n[1]*o[3]-n[3]*o[1],b=n[2]*o[3]-n[3]*o[2],S=e[0],I=e[1],D=e[2],F=e[3];return t[0]=I*b-D*v+F*g,t[1]=-S*b+D*d-F*l,t[2]=S*v-I*d+F*a,t[3]=-S*g+I*l-D*a,t},ur.lerp=function(t,e,n,o){var a=e[0],l=e[1],d=e[2],g=e[3];return t[0]=a+o*(n[0]-a),t[1]=l+o*(n[1]-l),t[2]=d+o*(n[2]-d),t[3]=g+o*(n[3]-g),t},ur.random=function(t,e){var n,o,a,l,d,g;e=e||1;do d=(n=2*ia.RANDOM()-1)*n+(o=2*ia.RANDOM()-1)*o;while(d>=1);do g=(a=2*ia.RANDOM()-1)*a+(l=2*ia.RANDOM()-1)*l;while(g>=1);var v=Math.sqrt((1-d)/g);return t[0]=e*n,t[1]=e*o,t[2]=e*a*v,t[3]=e*l*v,t},ur.transformMat4=function(t,e,n){var o=e[0],a=e[1],l=e[2],d=e[3];return t[0]=n[0]*o+n[4]*a+n[8]*l+n[12]*d,t[1]=n[1]*o+n[5]*a+n[9]*l+n[13]*d,t[2]=n[2]*o+n[6]*a+n[10]*l+n[14]*d,t[3]=n[3]*o+n[7]*a+n[11]*l+n[15]*d,t},ur.transformQuat=function(t,e,n){var o=e[0],a=e[1],l=e[2],d=n[0],g=n[1],v=n[2],b=n[3],S=b*o+g*l-v*a,I=b*a+v*o-d*l,D=b*l+d*a-g*o,F=-d*o-g*a-v*l;return t[0]=S*b+F*-d+I*-v-D*-g,t[1]=I*b+F*-g+D*-d-S*-v,t[2]=D*b+F*-v+S*-g-I*-d,t[3]=e[3],t},ur.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},ur.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},ur.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},ur.equals=function(t,e){var n=t[0],o=t[1],a=t[2],l=t[3],d=e[0],g=e[1],v=e[2],b=e[3];return Math.abs(n-d)<=ia.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(o-g)<=ia.EPSILON*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(a-v)<=ia.EPSILON*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(l-b)<=ia.EPSILON*Math.max(1,Math.abs(l),Math.abs(b))},ur.forEach=ur.sqrLen=ur.len=ur.sqrDist=ur.dist=ur.div=ur.mul=ur.sub=void 0;var ia=function(t,e){if(t&&t.__esModule)return t;if(t===null||Ug(t)!=="object"&&typeof t!="function")return{default:t};var n=gx(void 0);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var d=a?Object.getOwnPropertyDescriptor(t,l):null;d&&(d.get||d.set)?Object.defineProperty(o,l,d):o[l]=t[l]}return o.default=t,n&&n.set(t,o),o}(uo);function gx(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(gx=function(o){return o?n:e})(t)}function yx(){var t=new ia.ARRAY_TYPE(4);return ia.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function vx(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function xx(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function bx(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function wx(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2],e[3]-t[3])}function Tx(t,e){var n=e[0]-t[0],o=e[1]-t[1],a=e[2]-t[2],l=e[3]-t[3];return n*n+o*o+a*a+l*l}function Ex(t){return Math.hypot(t[0],t[1],t[2],t[3])}function Sx(t){var e=t[0],n=t[1],o=t[2],a=t[3];return e*e+n*n+o*o+a*a}ur.sub=vx,ur.mul=xx,ur.div=bx,ur.dist=wx,ur.sqrDist=Tx,ur.len=Ex,ur.sqrLen=Sx;var tA=function(){var t=yx();return function(e,n,o,a,l,d){var g,v;for(n||(n=4),o||(o=0),v=a?Math.min(a*n+o,e.length):e.length,g=o;g<v;g+=n)t[0]=e[g],t[1]=e[g+1],t[2]=e[g+2],t[3]=e[g+3],l(t,t,d),e[g]=t[0],e[g+1]=t[1],e[g+2]=t[2],e[g+3]=t[3];return e}}();function $g(t){return $g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$g(t)}ur.forEach=tA,Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.create=Gg,Vn.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},Vn.setAxisAngle=Ax,Vn.getAxisAngle=function(t,e){var n=2*Math.acos(e[3]),o=Math.sin(n/2);return o>Hu.EPSILON?(t[0]=e[0]/o,t[1]=e[1]/o,t[2]=e[2]/o):(t[0]=1,t[1]=0,t[2]=0),n},Vn.getAngle=function(t,e){var n=Ox(t,e);return Math.acos(2*n*n-1)},Vn.multiply=Ix,Vn.rotateX=function(t,e,n){n*=.5;var o=e[0],a=e[1],l=e[2],d=e[3],g=Math.sin(n),v=Math.cos(n);return t[0]=o*v+d*g,t[1]=a*v+l*g,t[2]=l*v-a*g,t[3]=d*v-o*g,t},Vn.rotateY=function(t,e,n){n*=.5;var o=e[0],a=e[1],l=e[2],d=e[3],g=Math.sin(n),v=Math.cos(n);return t[0]=o*v-l*g,t[1]=a*v+d*g,t[2]=l*v+o*g,t[3]=d*v-a*g,t},Vn.rotateZ=function(t,e,n){n*=.5;var o=e[0],a=e[1],l=e[2],d=e[3],g=Math.sin(n),v=Math.cos(n);return t[0]=o*v+a*g,t[1]=a*v-o*g,t[2]=l*v+d*g,t[3]=d*v-l*g,t},Vn.calculateW=function(t,e){var n=e[0],o=e[1],a=e[2];return t[0]=n,t[1]=o,t[2]=a,t[3]=Math.sqrt(Math.abs(1-n*n-o*o-a*a)),t},Vn.exp=Cx,Vn.ln=Px,Vn.pow=function(t,e,n){return Px(t,e),kx(t,t,n),Cx(t,t),t},Vn.slerp=xm,Vn.random=function(t){var e=Hu.RANDOM(),n=Hu.RANDOM(),o=Hu.RANDOM(),a=Math.sqrt(1-e),l=Math.sqrt(e);return t[0]=a*Math.sin(2*Math.PI*n),t[1]=a*Math.cos(2*Math.PI*n),t[2]=l*Math.sin(2*Math.PI*o),t[3]=l*Math.cos(2*Math.PI*o),t},Vn.invert=function(t,e){var n=e[0],o=e[1],a=e[2],l=e[3],d=n*n+o*o+a*a+l*l,g=d?1/d:0;return t[0]=-n*g,t[1]=-o*g,t[2]=-a*g,t[3]=l*g,t},Vn.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},Vn.fromMat3=Dx,Vn.fromEuler=function(t,e,n,o){var a=.5*Math.PI/180;e*=a,n*=a,o*=a;var l=Math.sin(e),d=Math.cos(e),g=Math.sin(n),v=Math.cos(n),b=Math.sin(o),S=Math.cos(o);return t[0]=l*v*S-d*g*b,t[1]=d*g*S+l*v*b,t[2]=d*v*b-l*g*S,t[3]=d*v*S+l*g*b,t},Vn.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},Vn.setAxes=Vn.sqlerp=Vn.rotationTo=Vn.equals=Vn.exactEquals=Vn.normalize=Vn.sqrLen=Vn.squaredLength=Vn.len=Vn.length=Vn.lerp=Vn.dot=Vn.scale=Vn.mul=Vn.add=Vn.set=Vn.copy=Vn.fromValues=Vn.clone=void 0;var Hu=vm(uo),nA=vm(qr),zl=vm(Wn),Fs=vm(ur);function Mx(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Mx=function(o){return o?n:e})(t)}function vm(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||$g(t)!=="object"&&typeof t!="function")return{default:t};var n=Mx(e);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var d=a?Object.getOwnPropertyDescriptor(t,l):null;d&&(d.get||d.set)?Object.defineProperty(o,l,d):o[l]=t[l]}return o.default=t,n&&n.set(t,o),o}function Gg(){var t=new Hu.ARRAY_TYPE(4);return Hu.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Ax(t,e,n){n*=.5;var o=Math.sin(n);return t[0]=o*e[0],t[1]=o*e[1],t[2]=o*e[2],t[3]=Math.cos(n),t}function Ix(t,e,n){var o=e[0],a=e[1],l=e[2],d=e[3],g=n[0],v=n[1],b=n[2],S=n[3];return t[0]=o*S+d*g+a*b-l*v,t[1]=a*S+d*v+l*g-o*b,t[2]=l*S+d*b+o*v-a*g,t[3]=d*S-o*g-a*v-l*b,t}function Cx(t,e){var n=e[0],o=e[1],a=e[2],l=e[3],d=Math.sqrt(n*n+o*o+a*a),g=Math.exp(l),v=d>0?g*Math.sin(d)/d:0;return t[0]=n*v,t[1]=o*v,t[2]=a*v,t[3]=g*Math.cos(d),t}function Px(t,e){var n=e[0],o=e[1],a=e[2],l=e[3],d=Math.sqrt(n*n+o*o+a*a),g=d>0?Math.atan2(d,l)/d:0;return t[0]=n*g,t[1]=o*g,t[2]=a*g,t[3]=.5*Math.log(n*n+o*o+a*a+l*l),t}function xm(t,e,n,o){var a,l,d,g,v,b=e[0],S=e[1],I=e[2],D=e[3],F=n[0],N=n[1],V=n[2],q=n[3];return(l=b*F+S*N+I*V+D*q)<0&&(l=-l,F=-F,N=-N,V=-V,q=-q),1-l>Hu.EPSILON?(a=Math.acos(l),d=Math.sin(a),g=Math.sin((1-o)*a)/d,v=Math.sin(o*a)/d):(g=1-o,v=o),t[0]=g*b+v*F,t[1]=g*S+v*N,t[2]=g*I+v*V,t[3]=g*D+v*q,t}function Dx(t,e){var n,o=e[0]+e[4]+e[8];if(o>0)n=Math.sqrt(o+1),t[3]=.5*n,t[0]=(e[5]-e[7])*(n=.5/n),t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[3*a+a]&&(a=2);var l=(a+1)%3,d=(a+2)%3;n=Math.sqrt(e[3*a+a]-e[3*l+l]-e[3*d+d]+1),t[a]=.5*n,t[3]=(e[3*l+d]-e[3*d+l])*(n=.5/n),t[l]=(e[3*l+a]+e[3*a+l])*n,t[d]=(e[3*d+a]+e[3*a+d])*n}return t}Vn.clone=Fs.clone,Vn.fromValues=Fs.fromValues,Vn.copy=Fs.copy,Vn.set=Fs.set,Vn.add=Fs.add,Vn.mul=Ix;var kx=Fs.scale;Vn.scale=kx;var Ox=Fs.dot;Vn.dot=Ox,Vn.lerp=Fs.lerp;var Rx=Fs.length;Vn.length=Rx,Vn.len=Rx;var Lx=Fs.squaredLength;Vn.squaredLength=Lx,Vn.sqrLen=Lx;var Hg=Fs.normalize;Vn.normalize=Hg,Vn.exactEquals=Fs.exactEquals,Vn.equals=Fs.equals;var Ma,zx,Fx,rA=(Ma=zl.create(),zx=zl.fromValues(1,0,0),Fx=zl.fromValues(0,1,0),function(t,e,n){var o=zl.dot(e,n);return o<-.999999?(zl.cross(Ma,zx,e),zl.len(Ma)<1e-6&&zl.cross(Ma,Fx,e),zl.normalize(Ma,Ma),Ax(t,Ma,Math.PI),t):o>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(zl.cross(Ma,e,n),t[0]=Ma[0],t[1]=Ma[1],t[2]=Ma[2],t[3]=1+o,Hg(t,t))});Vn.rotationTo=rA;var qg,Wg,iA=(qg=Gg(),Wg=Gg(),function(t,e,n,o,a,l){return xm(qg,e,a,l),xm(Wg,n,o,l),xm(t,qg,Wg,2*l*(1-l)),t});Vn.sqlerp=iA;var Aa,oA=(Aa=nA.create(),function(t,e,n,o){return Aa[0]=n[0],Aa[3]=n[1],Aa[6]=n[2],Aa[1]=o[0],Aa[4]=o[1],Aa[7]=o[2],Aa[2]=-e[0],Aa[5]=-e[1],Aa[8]=-e[2],Hg(t,Dx(t,Aa))});Vn.setAxes=oA;var br={};function Zg(t){return Zg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zg(t)}Object.defineProperty(br,"__esModule",{value:!0}),br.create=function(){var t=new os.ARRAY_TYPE(8);return os.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t},br.clone=function(t){var e=new os.ARRAY_TYPE(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e},br.fromValues=function(t,e,n,o,a,l,d,g){var v=new os.ARRAY_TYPE(8);return v[0]=t,v[1]=e,v[2]=n,v[3]=o,v[4]=a,v[5]=l,v[6]=d,v[7]=g,v},br.fromRotationTranslationValues=function(t,e,n,o,a,l,d){var g=new os.ARRAY_TYPE(8);g[0]=t,g[1]=e,g[2]=n,g[3]=o;var v=.5*a,b=.5*l,S=.5*d;return g[4]=v*o+b*n-S*e,g[5]=b*o+S*t-v*n,g[6]=S*o+v*e-b*t,g[7]=-v*t-b*e-S*n,g},br.fromRotationTranslation=jx,br.fromTranslation=function(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t},br.fromRotation=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},br.fromMat4=function(t,e){var n=Fl.create();Bx.getRotation(n,e);var o=new os.ARRAY_TYPE(3);return Bx.getTranslation(o,e),jx(t,n,o),t},br.copy=Vx,br.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},br.set=function(t,e,n,o,a,l,d,g,v){return t[0]=e,t[1]=n,t[2]=o,t[3]=a,t[4]=l,t[5]=d,t[6]=g,t[7]=v,t},br.getDual=function(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t},br.setDual=function(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t},br.getTranslation=function(t,e){var n=e[4],o=e[5],a=e[6],l=e[7],d=-e[0],g=-e[1],v=-e[2],b=e[3];return t[0]=2*(n*b+l*d+o*v-a*g),t[1]=2*(o*b+l*g+a*d-n*v),t[2]=2*(a*b+l*v+n*g-o*d),t},br.translate=function(t,e,n){var o=e[0],a=e[1],l=e[2],d=e[3],g=.5*n[0],v=.5*n[1],b=.5*n[2],S=e[4],I=e[5],D=e[6],F=e[7];return t[0]=o,t[1]=a,t[2]=l,t[3]=d,t[4]=d*g+a*b-l*v+S,t[5]=d*v+l*g-o*b+I,t[6]=d*b+o*v-a*g+D,t[7]=-o*g-a*v-l*b+F,t},br.rotateX=function(t,e,n){var o=-e[0],a=-e[1],l=-e[2],d=e[3],g=e[4],v=e[5],b=e[6],S=e[7],I=g*d+S*o+v*l-b*a,D=v*d+S*a+b*o-g*l,F=b*d+S*l+g*a-v*o,N=S*d-g*o-v*a-b*l;return Fl.rotateX(t,e,n),t[4]=I*(d=t[3])+N*(o=t[0])+D*(l=t[2])-F*(a=t[1]),t[5]=D*d+N*a+F*o-I*l,t[6]=F*d+N*l+I*a-D*o,t[7]=N*d-I*o-D*a-F*l,t},br.rotateY=function(t,e,n){var o=-e[0],a=-e[1],l=-e[2],d=e[3],g=e[4],v=e[5],b=e[6],S=e[7],I=g*d+S*o+v*l-b*a,D=v*d+S*a+b*o-g*l,F=b*d+S*l+g*a-v*o,N=S*d-g*o-v*a-b*l;return Fl.rotateY(t,e,n),t[4]=I*(d=t[3])+N*(o=t[0])+D*(l=t[2])-F*(a=t[1]),t[5]=D*d+N*a+F*o-I*l,t[6]=F*d+N*l+I*a-D*o,t[7]=N*d-I*o-D*a-F*l,t},br.rotateZ=function(t,e,n){var o=-e[0],a=-e[1],l=-e[2],d=e[3],g=e[4],v=e[5],b=e[6],S=e[7],I=g*d+S*o+v*l-b*a,D=v*d+S*a+b*o-g*l,F=b*d+S*l+g*a-v*o,N=S*d-g*o-v*a-b*l;return Fl.rotateZ(t,e,n),t[4]=I*(d=t[3])+N*(o=t[0])+D*(l=t[2])-F*(a=t[1]),t[5]=D*d+N*a+F*o-I*l,t[6]=F*d+N*l+I*a-D*o,t[7]=N*d-I*o-D*a-F*l,t},br.rotateByQuatAppend=function(t,e,n){var o=n[0],a=n[1],l=n[2],d=n[3],g=e[0],v=e[1],b=e[2],S=e[3];return t[0]=g*d+S*o+v*l-b*a,t[1]=v*d+S*a+b*o-g*l,t[2]=b*d+S*l+g*a-v*o,t[3]=S*d-g*o-v*a-b*l,t[4]=(g=e[4])*d+(S=e[7])*o+(v=e[5])*l-(b=e[6])*a,t[5]=v*d+S*a+b*o-g*l,t[6]=b*d+S*l+g*a-v*o,t[7]=S*d-g*o-v*a-b*l,t},br.rotateByQuatPrepend=function(t,e,n){var o=e[0],a=e[1],l=e[2],d=e[3],g=n[0],v=n[1],b=n[2],S=n[3];return t[0]=o*S+d*g+a*b-l*v,t[1]=a*S+d*v+l*g-o*b,t[2]=l*S+d*b+o*v-a*g,t[3]=d*S-o*g-a*v-l*b,t[4]=o*(S=n[7])+d*(g=n[4])+a*(b=n[6])-l*(v=n[5]),t[5]=a*S+d*v+l*g-o*b,t[6]=l*S+d*b+o*v-a*g,t[7]=d*S-o*g-a*v-l*b,t},br.rotateAroundAxis=function(t,e,n,o){if(Math.abs(o)<os.EPSILON)return Vx(t,e);var a=Math.hypot(n[0],n[1],n[2]);o*=.5;var l=Math.sin(o),d=l*n[0]/a,g=l*n[1]/a,v=l*n[2]/a,b=Math.cos(o),S=e[0],I=e[1],D=e[2],F=e[3];t[0]=S*b+F*d+I*v-D*g,t[1]=I*b+F*g+D*d-S*v,t[2]=D*b+F*v+S*g-I*d,t[3]=F*b-S*d-I*g-D*v;var N=e[4],V=e[5],q=e[6],Y=e[7];return t[4]=N*b+Y*d+V*v-q*g,t[5]=V*b+Y*g+q*d-N*v,t[6]=q*b+Y*v+N*g-V*d,t[7]=Y*b-N*d-V*g-q*v,t},br.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t},br.multiply=Ux,br.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t},br.lerp=function(t,e,n,o){var a=1-o;return $x(e,n)<0&&(o=-o),t[0]=e[0]*a+n[0]*o,t[1]=e[1]*a+n[1]*o,t[2]=e[2]*a+n[2]*o,t[3]=e[3]*a+n[3]*o,t[4]=e[4]*a+n[4]*o,t[5]=e[5]*a+n[5]*o,t[6]=e[6]*a+n[6]*o,t[7]=e[7]*a+n[7]*o,t},br.invert=function(t,e){var n=bm(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t},br.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t},br.normalize=function(t,e){var n=bm(e);if(n>0){n=Math.sqrt(n);var o=e[0]/n,a=e[1]/n,l=e[2]/n,d=e[3]/n,g=e[4],v=e[5],b=e[6],S=e[7],I=o*g+a*v+l*b+d*S;t[0]=o,t[1]=a,t[2]=l,t[3]=d,t[4]=(g-o*I)/n,t[5]=(v-a*I)/n,t[6]=(b-l*I)/n,t[7]=(S-d*I)/n}return t},br.str=function(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"},br.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]},br.equals=function(t,e){var n=t[0],o=t[1],a=t[2],l=t[3],d=t[4],g=t[5],v=t[6],b=t[7],S=e[0],I=e[1],D=e[2],F=e[3],N=e[4],V=e[5],q=e[6],Y=e[7];return Math.abs(n-S)<=os.EPSILON*Math.max(1,Math.abs(n),Math.abs(S))&&Math.abs(o-I)<=os.EPSILON*Math.max(1,Math.abs(o),Math.abs(I))&&Math.abs(a-D)<=os.EPSILON*Math.max(1,Math.abs(a),Math.abs(D))&&Math.abs(l-F)<=os.EPSILON*Math.max(1,Math.abs(l),Math.abs(F))&&Math.abs(d-N)<=os.EPSILON*Math.max(1,Math.abs(d),Math.abs(N))&&Math.abs(g-V)<=os.EPSILON*Math.max(1,Math.abs(g),Math.abs(V))&&Math.abs(v-q)<=os.EPSILON*Math.max(1,Math.abs(v),Math.abs(q))&&Math.abs(b-Y)<=os.EPSILON*Math.max(1,Math.abs(b),Math.abs(Y))},br.sqrLen=br.squaredLength=br.len=br.length=br.dot=br.mul=br.setReal=br.getReal=void 0;var os=Yg(uo),Fl=Yg(Vn),Bx=Yg(Xn);function Nx(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Nx=function(o){return o?n:e})(t)}function Yg(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||Zg(t)!=="object"&&typeof t!="function")return{default:t};var n=Nx(e);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var d=a?Object.getOwnPropertyDescriptor(t,l):null;d&&(d.get||d.set)?Object.defineProperty(o,l,d):o[l]=t[l]}return o.default=t,n&&n.set(t,o),o}function jx(t,e,n){var o=.5*n[0],a=.5*n[1],l=.5*n[2],d=e[0],g=e[1],v=e[2],b=e[3];return t[0]=d,t[1]=g,t[2]=v,t[3]=b,t[4]=o*b+a*v-l*g,t[5]=a*b+l*d-o*v,t[6]=l*b+o*g-a*d,t[7]=-o*d-a*g-l*v,t}function Vx(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Ux(t,e,n){var o=e[0],a=e[1],l=e[2],d=e[3],g=n[4],v=n[5],b=n[6],S=n[7],I=e[4],D=e[5],F=e[6],N=e[7],V=n[0],q=n[1],Y=n[2],oe=n[3];return t[0]=o*oe+d*V+a*Y-l*q,t[1]=a*oe+d*q+l*V-o*Y,t[2]=l*oe+d*Y+o*q-a*V,t[3]=d*oe-o*V-a*q-l*Y,t[4]=o*S+d*g+a*b-l*v+I*oe+N*V+D*Y-F*q,t[5]=a*S+d*v+l*g-o*b+D*oe+N*q+F*V-I*Y,t[6]=l*S+d*b+o*v-a*g+F*oe+N*Y+I*q-D*V,t[7]=d*S-o*g-a*v-l*b+N*oe-I*V-D*q-F*Y,t}br.getReal=Fl.copy,br.setReal=Fl.copy,br.mul=Ux;var $x=Fl.dot;br.dot=$x;var Gx=Fl.length;br.length=Gx,br.len=Gx;var bm=Fl.squaredLength;br.squaredLength=bm,br.sqrLen=bm;var nr={};function Xg(t){return Xg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xg(t)}Object.defineProperty(nr,"__esModule",{value:!0}),nr.create=qx,nr.clone=function(t){var e=new qu.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},nr.fromValues=function(t,e){var n=new qu.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},nr.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},nr.set=function(t,e,n){return t[0]=e,t[1]=n,t},nr.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},nr.subtract=Wx,nr.multiply=Zx,nr.divide=Yx,nr.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},nr.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},nr.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},nr.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},nr.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},nr.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},nr.scaleAndAdd=function(t,e,n,o){return t[0]=e[0]+n[0]*o,t[1]=e[1]+n[1]*o,t},nr.distance=Xx,nr.squaredDistance=Kx,nr.length=Jx,nr.squaredLength=Qx,nr.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},nr.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},nr.normalize=function(t,e){var n=e[0],o=e[1],a=n*n+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t},nr.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},nr.cross=function(t,e,n){var o=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=o,t},nr.lerp=function(t,e,n,o){var a=e[0],l=e[1];return t[0]=a+o*(n[0]-a),t[1]=l+o*(n[1]-l),t},nr.random=function(t,e){e=e||1;var n=2*qu.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},nr.transformMat2=function(t,e,n){var o=e[0],a=e[1];return t[0]=n[0]*o+n[2]*a,t[1]=n[1]*o+n[3]*a,t},nr.transformMat2d=function(t,e,n){var o=e[0],a=e[1];return t[0]=n[0]*o+n[2]*a+n[4],t[1]=n[1]*o+n[3]*a+n[5],t},nr.transformMat3=function(t,e,n){var o=e[0],a=e[1];return t[0]=n[0]*o+n[3]*a+n[6],t[1]=n[1]*o+n[4]*a+n[7],t},nr.transformMat4=function(t,e,n){var o=e[0],a=e[1];return t[0]=n[0]*o+n[4]*a+n[12],t[1]=n[1]*o+n[5]*a+n[13],t},nr.rotate=function(t,e,n,o){var a=e[0]-n[0],l=e[1]-n[1],d=Math.sin(o),g=Math.cos(o);return t[0]=a*g-l*d+n[0],t[1]=a*d+l*g+n[1],t},nr.angle=function(t,e){var n=t[0],o=t[1],a=e[0],l=e[1],d=Math.sqrt(n*n+o*o)*Math.sqrt(a*a+l*l);return Math.acos(Math.min(Math.max(d&&(n*a+o*l)/d,-1),1))},nr.zero=function(t){return t[0]=0,t[1]=0,t},nr.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},nr.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},nr.equals=function(t,e){var n=t[0],o=t[1],a=e[0],l=e[1];return Math.abs(n-a)<=qu.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(o-l)<=qu.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))},nr.forEach=nr.sqrLen=nr.sqrDist=nr.dist=nr.div=nr.mul=nr.sub=nr.len=void 0;var qu=function(t,e){if(t&&t.__esModule)return t;if(t===null||Xg(t)!=="object"&&typeof t!="function")return{default:t};var n=Hx(void 0);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var d=a?Object.getOwnPropertyDescriptor(t,l):null;d&&(d.get||d.set)?Object.defineProperty(o,l,d):o[l]=t[l]}return o.default=t,n&&n.set(t,o),o}(uo);function Hx(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Hx=function(o){return o?n:e})(t)}function qx(){var t=new qu.ARRAY_TYPE(2);return qu.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0),t}function Wx(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function Zx(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function Yx(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function Xx(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1])}function Kx(t,e){var n=e[0]-t[0],o=e[1]-t[1];return n*n+o*o}function Jx(t){return Math.hypot(t[0],t[1])}function Qx(t){var e=t[0],n=t[1];return e*e+n*n}nr.len=Jx,nr.sub=Wx,nr.mul=Zx,nr.div=Yx,nr.dist=Xx,nr.sqrDist=Kx,nr.sqrLen=Qx;var sA=function(){var t=qx();return function(e,n,o,a,l,d){var g,v;for(n||(n=2),o||(o=0),v=a?Math.min(a*n+o,e.length):e.length,g=o;g<v;g+=n)t[0]=e[g],t[1]=e[g+1],l(t,t,d),e[g]=t[0],e[g+1]=t[1];return e}}();function Kg(t){return Kg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kg(t)}nr.forEach=sA,Object.defineProperty(co,"__esModule",{value:!0}),i.a7=co.vec4=i.N=co.vec3=co.vec2=co.quat2=i.bi=co.quat=i.a6=co.mat4=i.co=co.mat3=co.mat2d=i.b4=co.mat2=co.glMatrix=void 0;var aA=al(uo);co.glMatrix=aA;var lA=al(_i);i.b4=co.mat2=lA;var cA=al(wi);co.mat2d=cA;var uA=al(qr);i.co=co.mat3=uA;var hA=al(Xn);i.a6=co.mat4=hA;var dA=al(Vn);i.bi=co.quat=dA;var fA=al(br);co.quat2=fA;var pA=al(nr);co.vec2=pA;var mA=al(Wn);i.N=co.vec3=mA;var _A=al(ur);function eb(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(eb=function(o){return o?n:e})(t)}function al(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||Kg(t)!=="object"&&typeof t!="function")return{default:t};var n=eb(e);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var d=a?Object.getOwnPropertyDescriptor(t,l):null;d&&(d.get||d.set)?Object.defineProperty(o,l,d):o[l]=t[l]}return o.default=t,n&&n.set(t,o),o}i.a7=co.vec4=_A;class Jg{constructor(e,n){this.pos=e,this.dir=n}intersectsPlane(e,n,o){const a=i.N.dot(n,this.dir);if(Math.abs(a)<1e-6)return!1;const l=((e[0]-this.pos[0])*n[0]+(e[1]-this.pos[1])*n[1]+(e[2]-this.pos[2])*n[2])/a;return o[0]=this.pos[0]+this.dir[0]*l,o[1]=this.pos[1]+this.dir[1]*l,o[2]=this.pos[2]+this.dir[2]*l,!0}closestPointOnSphere(e,n,o){if(i.N.equals(this.pos,e)||n===0)return o[0]=o[1]=o[2]=0,!1;const[a,l,d]=this.dir,g=this.pos[0]-e[0],v=this.pos[1]-e[1],b=this.pos[2]-e[2],S=a*a+l*l+d*d,I=2*(g*a+v*l+b*d),D=I*I-4*S*(g*g+v*v+b*b-n*n);if(D<0){const F=Math.max(-I/2,0),N=g+a*F,V=v+l*F,q=b+d*F,Y=Math.hypot(N,V,q);return o[0]=N*n/Y,o[1]=V*n/Y,o[2]=q*n/Y,!1}{const F=(-I-Math.sqrt(D))/(2*S);if(F<0){const N=Math.hypot(g,v,b);return o[0]=g*n/N,o[1]=v*n/N,o[2]=b*n/N,!1}return o[0]=g+a*F,o[1]=v+l*F,o[2]=b+d*F,!0}}}class Qg{constructor(e,n,o,a,l){this.TL=e,this.TR=n,this.BR=o,this.BL=a,this.horizon=l}static fromInvProjectionMatrix(e,n,o){const a=[-1,1,1],l=[1,1,1],d=[1,-1,1],g=[-1,-1,1],v=i.N.transformMat4(a,a,e),b=i.N.transformMat4(l,l,e),S=i.N.transformMat4(d,d,e),I=i.N.transformMat4(g,g,e);return new Qg(v,b,S,I,n/o)}}function Af(t,e,n){let o=1/0,a=-1/0;const l=[];for(const d of t){i.N.sub(l,d,e);const g=i.N.dot(l,n);o=Math.min(o,g),a=Math.max(a,g)}return[o,a]}function tb(t,e){let n=!0;for(let o=0;o<t.planes.length;o++){const a=t.planes[o];let l=0;for(let d=0;d<e.length;d++)l+=i.N.dot(a,e[d])+a[3]>=0;if(l===0)return 0;l!==e.length&&(n=!1)}return n?2:1}function nb(t,e){for(const n of t.projections){const o=Af(e,t.points[0],n.axis);if(n.projection[1]<o[0]||n.projection[0]>o[1])return 0}return 1}function rb(t,e){let n=0;const o=[0,0,0,0];for(let a=0;a<t.length;a++)o[0]=t[a][0],o[1]=t[a][1],o[2]=t[a][2],o[3]=1,i.a7.dot(o,e)>=0&&n++;return n}class ey{constructor(e,n){this.points=e||new Array(8).fill([0,0,0]),this.planes=n||new Array(6).fill([0,0,0,0]),this.bounds=Ti.fromPoints(this.points),this.projections=[],this.frustumEdges=[i.N.sub([],this.points[2],this.points[3]),i.N.sub([],this.points[0],this.points[3]),i.N.sub([],this.points[4],this.points[0]),i.N.sub([],this.points[5],this.points[1]),i.N.sub([],this.points[6],this.points[2]),i.N.sub([],this.points[7],this.points[3])];for(const o of this.frustumEdges){const a=[0,-o[2],o[1]],l=[o[2],0,-o[0]];this.projections.push({axis:a,projection:Af(this.points,this.points[0],a)}),this.projections.push({axis:l,projection:Af(this.points,this.points[0],l)})}}static fromInvProjectionMatrix(e,n,o,a){const l=Math.pow(2,o),d=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(b=>{const S=i.a7.transformMat4([],b,e),I=1/S[3]/n*l;return i.a7.mul(S,S,[I,I,a?1/S[3]:I,I])}),g=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(b=>{const S=i.N.sub([],d[b[0]],d[b[1]]),I=i.N.sub([],d[b[2]],d[b[1]]),D=i.N.normalize([],i.N.cross([],S,I)),F=-i.N.dot(D,d[b[1]]);return D.concat(F)}),v=[];for(let b=0;b<d.length;b++)v.push([d[b][0],d[b][1],d[b][2]]);return new ey(v,g)}intersectsPrecise(e,n,o){for(let a=0;a<n.length;a++)if(!rb(e,n[a]))return 0;for(let a=0;a<this.planes.length;a++)if(!rb(e,this.planes[a]))return 0;for(const a of o)for(const l of this.frustumEdges){const d=i.N.cross([],a,l),g=i.N.length(d);if(g===0)continue;i.N.scale(d,d,1/g);const v=Af(this.points,this.points[0],d),b=Af(e,this.points[0],d);if(v[0]>b[1]||b[0]>v[1])return 0}return 1}}class Ti{static fromPoints(e){const n=[1/0,1/0,1/0],o=[-1/0,-1/0,-1/0];for(const a of e)i.N.min(n,n,a),i.N.max(o,o,a);return new Ti(n,o)}static fromTileIdAndHeight(e,n,o){const a=1<<e.canonical.z,l=e.canonical.x,d=e.canonical.y;return new Ti([l/a,d/a,n],[(l+1)/a,(d+1)/a,o])}static applyTransform(e,n){const o=e.getCorners();for(let a=0;a<o.length;++a)i.N.transformMat4(o[a],o[a],n);return Ti.fromPoints(o)}static projectAabbCorners(e,n){const o=e.getCorners();for(let a=0;a<o.length;++a)i.N.transformMat4(o[a],o[a],n);return o}constructor(e,n){this.min=e,this.max=n,this.center=i.N.scale([],i.N.add([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],o=i.N.clone(this.min),a=i.N.clone(this.max);for(let l=0;l<n.length;l++)o[l]=n[l]?this.min[l]:this.center[l],a[l]=n[l]?this.center[l]:this.max[l];return a[2]=this.max[2],new Ti(o,a)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,n=this.max;return[[e[0],e[1],e[2]],[n[0],e[1],e[2]],[n[0],n[1],e[2]],[e[0],n[1],e[2]],[e[0],e[1],n[2]],[n[0],e[1],n[2]],[n[0],n[1],n[2]],[e[0],n[1],n[2]]]}intersects(e){return this.intersectsAabb(e.bounds)?tb(e,this.getCorners()):0}intersectsFlat(e){return this.intersectsAabb(e.bounds)?tb(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(e,n){return n||this.intersects(e)?nb(e,this.getCorners()):0}intersectsPreciseFlat(e,n){return n||this.intersectsFlat(e)?nb(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(e){for(let n=0;n<3;++n)if(this.min[n]>e.max[n]||e.min[n]>this.max[n])return!1;return!0}intersectsAabbXY(e){return!(this.min[0]>e.max[0]||e.min[0]>this.max[0]||this.min[1]>e.max[1]||e.min[1]>this.max[1])}encapsulate(e){for(let n=0;n<3;n++)this.min[n]=Math.min(this.min[n],e.min[n]),this.max[n]=Math.max(this.max[n],e.max[n])}encapsulatePoint(e){for(let n=0;n<3;n++)this.min[n]=Math.min(this.min[n],e[n]),this.max[n]=Math.max(this.max[n],e[n])}closestPoint(e){return[Math.max(Math.min(this.max[0],e[0]),this.min[0]),Math.max(Math.min(this.max[1],e[1]),this.min[1]),Math.max(Math.min(this.max[2],e[2]),this.min[2])]}}sn(Ti,"Aabb");const gA=jr([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:wm}=gA,yA=jr([{name:"a_pos_3",components:3,type:"Int16"}]);var ib=jr([{name:"a_pos",type:"Int16",components:2}]);function Tm(t){return t*se/at}const vA=[new Ti([Le,Le,Le],[et,et,et]),new Ti([Le,Le,Le],[0,0,et]),new Ti([0,Le,Le],[et,0,et]),new Ti([Le,0,Le],[0,et,et]),new Ti([0,0,Le],[et,et,et])];function ob(t,e,n,o=!0){const a=i.N.scale([],t._camera.position,t.worldSize),l=[e,n,1,1];i.a7.transformMat4(l,l,t.pixelMatrixInverse),i.a7.scale(l,l,1/l[3]);const d=i.N.sub([],l,a),g=i.N.normalize([],d),v=t.globeMatrix,b=[v[12],v[13],v[14]],S=i.N.sub([],b,a),I=i.N.length(S),D=i.N.normalize([],S),F=t.worldSize/(2*Math.PI),N=i.N.dot(D,g),V=Math.asin(F/I);if(V<Math.acos(N)){if(!o)return null;const qe=[],_t=[];i.N.scale(qe,g,I/N),i.N.normalize(_t,i.N.sub(_t,qe,S)),i.N.normalize(g,i.N.add(g,S,i.N.scale(g,_t,Math.tan(V)*I)))}const q=[];new Jg(a,g).closestPointOnSphere(b,F,q);const Y=i.N.normalize([],ue(v,0)),oe=i.N.normalize([],ue(v,1)),le=i.N.normalize([],ue(v,2)),ae=i.N.dot(Y,q),be=i.N.dot(oe,q),ge=i.N.dot(le,q),Ie=lt(Math.asin(-be/F));let Ne=lt(Math.atan2(ae,ge));Ne=t.center.lng+function(qe,_t){const Et=(_t-qe+180)%360-180;return Et<-180?Et+360:Et}(t.center.lng,Ne);const Ge=qn(Ne),tt=vt(kn(Ie),0,1);return new Sr(Ge,tt)}class xA{constructor(e,n,o){this.a=i.N.sub([],e,o),this.b=i.N.sub([],n,o),this.center=o;const a=i.N.normalize([],this.a),l=i.N.normalize([],this.b);this.angle=Math.acos(i.N.dot(a,l))}}function ty(t,e){if(t.angle===0)return null;let n;return n=t.a[e]===0?1/t.angle*.5*Math.PI:1/t.angle*Math.atan(t.b[e]/t.a[e]/Math.sin(t.angle)-1/Math.tan(t.angle)),n<0||n>1?null:function(o,a,l,d){const g=Math.sin(l);return o*(Math.sin((1-d)*l)/g)+a*(Math.sin(d*l)/g)}(t.a[e],t.b[e],t.angle,vt(n,0,1))+t.center[e]}function ll(t){if(t.z<=1)return vA[t.z+2*t.y+t.x];const e=ny(Em(t));return Ti.fromPoints(e)}function Bl(t,e,n){return i.N.scale(t,t,1-n),i.N.scaleAndAdd(t,t,e,n)}function sb(t,e,n){for(const o of t)i.N.transformMat4(o,o,e),i.N.scale(o,o,n)}function ab(t,e,n,o){const a=e/t.worldSize,l=t.globeMatrix;if(n.z<=1){const Ge=ll(n).getCorners();return sb(Ge,l,a),Ti.fromPoints(Ge)}const d=Em(n,o),g=ny(d,se+Tm(t._tileCoverLift));sb(g,l,a);const v=Number.MAX_VALUE,b=[-v,-v,-v],S=[v,v,v];if(d.contains(t.center)){for(const qe of g)i.N.min(S,S,qe),i.N.max(b,b,qe);b[2]=0;const Ge=t.point,tt=[Ge.x*a,Ge.y*a,0];return i.N.min(S,S,tt),i.N.max(b,b,tt),new Ti(S,b)}if(t._tileCoverLift>0){for(const Ge of g)i.N.min(S,S,Ge),i.N.max(b,b,Ge);return new Ti(S,b)}const I=[l[12]*a,l[13]*a,l[14]*a],D=d.getCenter(),F=vt(t.center.lat,-ir,ir),N=vt(D.lat,-ir,ir),V=qn(t.center.lng),q=kn(F);let Y=V-qn(D.lng);const oe=q-kn(N);Y>.5?Y-=1:Y<-.5&&(Y+=1);let le=0;if(Math.abs(Y)>Math.abs(oe))le=Y>=0?1:3;else{le=oe>=0?0:2;const Ge=[l[4]*a,l[5]*a,l[6]*a],tt=-Math.sin(Oe(oe>=0?d.getSouth():d.getNorth()))*se;i.N.scaleAndAdd(I,I,Ge,tt)}const ae=g[le],be=g[(le+1)%4],ge=new xA(ae,be,I),Ie=[ty(ge,0)||ae[0],ty(ge,1)||ae[1],ty(ge,2)||ae[2]],Ne=xc(t.zoom);if(Ne>0){const Ge=function({x:qe,y:_t,z:Et},ct,wt,st,bt){const $t=1/(1<<Et);let St=qe*$t,cn=St+$t,rn=_t*$t,Dt=rn+$t,An=0;const _n=(St+cn)/2-st;return _n>.5?An=-1:_n<-.5&&(An=1),St=((St+An)*ct-(st*=ct))*wt+st,cn=((cn+An)*ct-st)*wt+st,rn=(rn*ct-(bt*=ct))*wt+bt,Dt=(Dt*ct-bt)*wt+bt,[[St,Dt,0],[cn,Dt,0],[cn,rn,0],[St,rn,0]]}(n,e,t._pixelsPerMercatorPixel,V,q);for(let qe=0;qe<g.length;qe++)Bl(g[qe],Ge[qe],Ne);const tt=i.N.add([],Ge[le],Ge[(le+1)%4]);i.N.scale(tt,tt,.5),Bl(Ie,tt,Ne)}for(const Ge of g)i.N.min(S,S,Ge),i.N.max(b,b,Ge);return S[2]=Math.min(ae[2],be[2]),i.N.min(S,S,Ie),i.N.max(b,b,Ie),new Ti(S,b)}function Em({x:t,y:e,z:n},o=!1){const a=1/(1<<n),l=new $e(Fn(t*a),e===(1<<n)-1&&o?-90:_r((e+1)*a)),d=new $e(Fn((t+1)*a),e===0&&o?90:_r(e*a));return new ot(l,d)}function ny(t,e=se){const n=Oe(t.getNorth()),o=Oe(t.getSouth()),a=Math.cos(n),l=Math.cos(o),d=Math.sin(n),g=Math.sin(o),v=t.getWest(),b=t.getEast();return[je(l,g,v,e),je(l,g,b,e),je(a,d,b,e),je(a,d,v,e)]}function If(t,e,n,o){const a=1<<n.z,l=(t/Jt+n.x)/a;return dt(_r((e/Jt+n.y)/a),Fn(l),o)}function Sm({min:t,max:e}){return pe/Math.max(e[0]-t[0],e[1]-t[1],e[2]-t[2])}const lb=new Float64Array(16);function Mm(t){const e=Sm(t),n=i.a6.fromScaling(lb,[e,e,e]);return i.a6.translate(n,n,i.N.negate([],t.min))}function ry(t){const e=i.a6.fromTranslation(lb,t.min),n=1/Sm(t);return i.a6.scale(e,e,[n,n,n])}function iy(t){const e=Jt/(2*Math.PI);return t/(2*Math.PI)/e}function cb(t,e){return Jt/(512*Math.pow(2,t))*Sm(ll(e))}function ub(t,e,n,o,a){const l=iy(n),d=[t,e,-n/(2*Math.PI)],g=i.a6.identity(new Float64Array(16));return i.a6.translate(g,g,d),i.a6.scale(g,g,[l,l,l]),i.a6.rotateX(g,g,Oe(-a)),i.a6.rotateY(g,g,Oe(-o)),g}function xc(t){return wr(de,ne,t)}function hb(t,e){const n=dt(e.lat,e.lng),o=function(l){const d=dt(l._center.lat,l._center.lng),g=i.N.fromValues(0,1,0);let v=i.N.cross([],g,d);const b=i.a6.fromRotation([],-l.angle,d);v=i.N.transformMat4(v,v,b),i.a6.fromRotation(b,-l._pitch,v);const S=i.N.normalize([],d);return i.N.scale(S,S,Tm(l.cameraToCenterDistance/l.pixelsPerMeter)),i.N.transformMat4(S,S,b),i.N.add([],d,S)}(t),a=i.N.subtract([],o,n);return i.N.angle(a,n)}function oy(t,e){return hb(t,e)>Math.PI/2*1.01}const db=Oe(85),bA=Math.cos(db),wA=Math.sin(db),TA=i.a6.create(),fb=t=>{const e=[];return t.paint.get("circle-pitch-alignment")==="map"&&e.push("PITCH_WITH_MAP"),t.paint.get("circle-pitch-scale")==="map"&&e.push("SCALE_WITH_MAP"),e};function pb(t,e,n,o,a,l,d,g,v){if(l&&t.queryGeometry.isAboveHorizon)return!1;l&&(v*=t.pixelToTileUnitsFactor);const b=t.tileID.canonical,S=n.projection.upVectorScale(b,n.center.lat,n.worldSize).metersToTile;for(const I of e)for(const D of I){const F=D.add(g),N=a&&n.elevation?n.elevation.exaggeration()*a.getElevationAt(F.x,F.y,!0):0,V=n.projection.projectTilePoint(F.x,F.y,b);if(N>0){const le=n.projection.upVector(b,F.x,F.y);V.x+=le[0]*S*N,V.y+=le[1]*S*N,V.z+=le[2]*S*N}const q=l?F:EA(V.x,V.y,V.z,o),Y=l?t.tilespaceRays.map(le=>MA(le,N)):t.queryGeometry.screenGeometry,oe=i.a7.transformMat4([],[V.x,V.y,V.z,1],o);if(!d&&l?v*=oe[3]/n.cameraToCenterDistance:d&&!l&&(v*=n.cameraToCenterDistance/oe[3]),l){const le=_r((D.y/Jt+b.y)/(1<<b.z));v/=n.projection.pixelsPerMeter(le,1)/Nn(1,le)}if(ol(Y,q,v))return!0}return!1}function EA(t,e,n,o){const a=i.a7.transformMat4([],[t,e,n,1],o);return new ve(a[0]/a[3],a[1]/a[3])}const mb=i.N.fromValues(0,0,0),SA=i.N.fromValues(0,0,1);function MA(t,e){const n=i.N.create();return mb[2]=e,t.intersectsPlane(mb,SA,n),new ve(n[0],n[1])}class _b extends Yo{}function gb(t,{width:e,height:n},o,a){if(a){if(a instanceof Uint8ClampedArray)a=new Uint8Array(a.buffer);else if(a.length!==e*n*o)throw new RangeError("mismatched image size")}else a=new Uint8Array(e*n*o);return t.width=e,t.height=n,t.data=a,t}function yb(t,e,n){const{width:o,height:a}=e;o===t.width&&a===t.height||(sy(t,e,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,o),height:Math.min(t.height,a)},n),t.width=o,t.height=a,t.data=e.data)}function sy(t,e,n,o,a,l,d){if(a.width===0||a.height===0)return e;if(a.width>t.width||a.height>t.height||n.x>t.width-a.width||n.y>t.height-a.height)throw new RangeError("out of range source coordinates for image copy");if(a.width>e.width||a.height>e.height||o.x>e.width-a.width||o.y>e.height-a.height)throw new RangeError("out of range destination coordinates for image copy");const g=t.data,v=e.data,b=l===4&&d;for(let S=0;S<a.height;S++){const I=((n.y+S)*t.width+n.x)*l,D=((o.y+S)*e.width+o.x)*l;if(b)for(let F=0;F<a.width;F++){const N=I+F*l+3,V=D+F*l;v[V+0]=255,v[V+1]=255,v[V+2]=255,v[V+3]=g[N]}else for(let F=0;F<a.width*l;F++)v[D+F]=g[I+F]}return e}sn(_b,"HeatmapBucket",{omit:["layers"]});class bc{constructor(e,n){gb(this,e,1,n)}resize(e){yb(this,new bc(e),1)}clone(){return new bc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,o,a,l){sy(e,n,o,a,l,1)}}class Bs{constructor(e,n){gb(this,e,4,n)}resize(e){yb(this,new Bs(e),4)}replace(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Bs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,o,a,l,d){sy(e,n,o,a,l,4,d)}}class vb{constructor(e,n){this.width=e.width,this.height=e.height,this.data=n instanceof Uint8Array?new Float32Array(n.buffer):n}}sn(bc,"AlphaImage"),sn(Bs,"RGBAImage");const AA=new pi({visibility:new Nt(Je.layout_heatmap.visibility)});var IA={paint:new pi({"heatmap-radius":new wn(Je.paint_heatmap["heatmap-radius"]),"heatmap-weight":new wn(Je.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Nt(Je.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Dl(Je.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Nt(Je.paint_heatmap["heatmap-opacity"])}),layout:AA};function Cf(t){const e={},n=t.resolution||256,o=t.clips?t.clips.length:1,a=t.image||new Bs({width:n,height:o}),l=(d,g,v)=>{e[t.evaluationKey]=v;const b=t.expression.evaluate(e);b&&(a.data[d+g+0]=Math.floor(255*b.r/b.a),a.data[d+g+1]=Math.floor(255*b.g/b.a),a.data[d+g+2]=Math.floor(255*b.b/b.a),a.data[d+g+3]=Math.floor(255*b.a))};if(t.clips)for(let d=0,g=0;d<o;++d,g+=4*n)for(let v=0,b=0;v<n;v++,b+=4){const S=v/(n-1),{start:I,end:D}=t.clips[d];l(g,b,I*(1-S)+D*S)}else for(let d=0,g=0;d<n;d++,g+=4)l(0,g,d/(n-1));return a}const CA=new pi({visibility:new Nt(Je.layout_hillshade.visibility)});var PA={paint:new pi({"hillshade-illumination-direction":new Nt(Je.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Nt(Je.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Nt(Je.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Nt(Je.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Nt(Je.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Nt(Je.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Nt(Je.paint_hillshade["hillshade-emissive-strength"])}),layout:CA};const DA=jr([{name:"a_pos",components:2,type:"Int16"}],4),{members:kA}=DA;var ay={exports:{}};function Am(t,e,n){n=n||2;var o,a,l,d,g,v,b,S=e&&e.length,I=S?e[0]*n:t.length,D=xb(t,0,I,n,!0),F=[];if(!D||D.next===D.prev)return F;if(S&&(D=function(V,q,Y,oe){var le,ae,be,ge=[];for(le=0,ae=q.length;le<ae;le++)(be=xb(V,q[le]*oe,le<ae-1?q[le+1]*oe:V.length,oe,!1))===be.next&&(be.steiner=!0),ge.push(jA(be));for(ge.sort(FA),le=0;le<ge.length;le++)Y=BA(ge[le],Y);return Y}(t,e,D,n)),t.length>80*n){o=l=t[0],a=d=t[1];for(var N=n;N<I;N+=n)(g=t[N])<o&&(o=g),(v=t[N+1])<a&&(a=v),g>l&&(l=g),v>d&&(d=v);b=(b=Math.max(l-o,d-a))!==0?32767/b:0}return Pf(D,F,n,o,a,b,0),F}function xb(t,e,n,o,a){var l,d;if(a===uy(t,e,n,o)>0)for(l=e;l<n;l+=o)d=Tb(l,t[l],t[l+1],d);else for(l=n-o;l>=e;l-=o)d=Tb(l,t[l],t[l+1],d);return d&&Im(d,d.next)&&(kf(d),d=d.next),d}function Wu(t,e){if(!t)return t;e||(e=t);var n,o=t;do if(n=!1,o.steiner||!Im(o,o.next)&&Xi(o.prev,o,o.next)!==0)o=o.next;else{if(kf(o),(o=e=o.prev)===o.next)break;n=!0}while(n||o!==e);return e}function Pf(t,e,n,o,a,l,d){if(t){!d&&l&&function(S,I,D,F){var N=S;do N.z===0&&(N.z=ly(N.x,N.y,I,D,F)),N.prevZ=N.prev,N.nextZ=N.next,N=N.next;while(N!==S);N.prevZ.nextZ=null,N.prevZ=null,function(V){var q,Y,oe,le,ae,be,ge,Ie,Ne=1;do{for(Y=V,V=null,ae=null,be=0;Y;){for(be++,oe=Y,ge=0,q=0;q<Ne&&(ge++,oe=oe.nextZ);q++);for(Ie=Ne;ge>0||Ie>0&&oe;)ge!==0&&(Ie===0||!oe||Y.z<=oe.z)?(le=Y,Y=Y.nextZ,ge--):(le=oe,oe=oe.nextZ,Ie--),ae?ae.nextZ=le:V=le,le.prevZ=ae,ae=le;Y=oe}ae.nextZ=null,Ne*=2}while(be>1)}(N)}(t,o,a,l);for(var g,v,b=t;t.prev!==t.next;)if(g=t.prev,v=t.next,l?RA(t,o,a,l):OA(t))e.push(g.i/n|0),e.push(t.i/n|0),e.push(v.i/n|0),kf(t),t=v.next,b=v.next;else if((t=v)===b){d?d===1?Pf(t=LA(Wu(t),e,n),e,n,o,a,l,2):d===2&&zA(t,e,n,o,a,l):Pf(Wu(t),e,n,o,a,l,1);break}}}function OA(t){var e=t.prev,n=t,o=t.next;if(Xi(e,n,o)>=0)return!1;for(var a=e.x,l=n.x,d=o.x,g=e.y,v=n.y,b=o.y,S=a<l?a<d?a:d:l<d?l:d,I=g<v?g<b?g:b:v<b?v:b,D=a>l?a>d?a:d:l>d?l:d,F=g>v?g>b?g:b:v>b?v:b,N=o.next;N!==e;){if(N.x>=S&&N.x<=D&&N.y>=I&&N.y<=F&&Uh(a,g,l,v,d,b,N.x,N.y)&&Xi(N.prev,N,N.next)>=0)return!1;N=N.next}return!0}function RA(t,e,n,o){var a=t.prev,l=t,d=t.next;if(Xi(a,l,d)>=0)return!1;for(var g=a.x,v=l.x,b=d.x,S=a.y,I=l.y,D=d.y,F=g<v?g<b?g:b:v<b?v:b,N=S<I?S<D?S:D:I<D?I:D,V=g>v?g>b?g:b:v>b?v:b,q=S>I?S>D?S:D:I>D?I:D,Y=ly(F,N,e,n,o),oe=ly(V,q,e,n,o),le=t.prevZ,ae=t.nextZ;le&&le.z>=Y&&ae&&ae.z<=oe;){if(le.x>=F&&le.x<=V&&le.y>=N&&le.y<=q&&le!==a&&le!==d&&Uh(g,S,v,I,b,D,le.x,le.y)&&Xi(le.prev,le,le.next)>=0||(le=le.prevZ,ae.x>=F&&ae.x<=V&&ae.y>=N&&ae.y<=q&&ae!==a&&ae!==d&&Uh(g,S,v,I,b,D,ae.x,ae.y)&&Xi(ae.prev,ae,ae.next)>=0))return!1;ae=ae.nextZ}for(;le&&le.z>=Y;){if(le.x>=F&&le.x<=V&&le.y>=N&&le.y<=q&&le!==a&&le!==d&&Uh(g,S,v,I,b,D,le.x,le.y)&&Xi(le.prev,le,le.next)>=0)return!1;le=le.prevZ}for(;ae&&ae.z<=oe;){if(ae.x>=F&&ae.x<=V&&ae.y>=N&&ae.y<=q&&ae!==a&&ae!==d&&Uh(g,S,v,I,b,D,ae.x,ae.y)&&Xi(ae.prev,ae,ae.next)>=0)return!1;ae=ae.nextZ}return!0}function LA(t,e,n){var o=t;do{var a=o.prev,l=o.next.next;!Im(a,l)&&bb(a,o,o.next,l)&&Df(a,l)&&Df(l,a)&&(e.push(a.i/n|0),e.push(o.i/n|0),e.push(l.i/n|0),kf(o),kf(o.next),o=t=l),o=o.next}while(o!==t);return Wu(o)}function zA(t,e,n,o,a,l){var d=t;do{for(var g=d.next.next;g!==d.prev;){if(d.i!==g.i&&VA(d,g)){var v=wb(d,g);return d=Wu(d,d.next),v=Wu(v,v.next),Pf(d,e,n,o,a,l,0),void Pf(v,e,n,o,a,l,0)}g=g.next}d=d.next}while(d!==t)}function FA(t,e){return t.x-e.x}function BA(t,e){var n=function(a,l){var d,g=l,v=a.x,b=a.y,S=-1/0;do{if(b<=g.y&&b>=g.next.y&&g.next.y!==g.y){var I=g.x+(b-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(I<=v&&I>S&&(S=I,d=g.x<g.next.x?g:g.next,I===v))return d}g=g.next}while(g!==l);if(!d)return null;var D,F=d,N=d.x,V=d.y,q=1/0;g=d;do v>=g.x&&g.x>=N&&v!==g.x&&Uh(b<V?v:S,b,N,V,b<V?S:v,b,g.x,g.y)&&(D=Math.abs(b-g.y)/(v-g.x),Df(g,a)&&(D<q||D===q&&(g.x>d.x||g.x===d.x&&NA(d,g)))&&(d=g,q=D)),g=g.next;while(g!==F);return d}(t,e);if(!n)return e;var o=wb(n,t);return Wu(o,o.next),Wu(n,n.next)}function NA(t,e){return Xi(t.prev,t,e.prev)<0&&Xi(e.next,t,t.next)<0}function ly(t,e,n,o,a){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*a|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-o)*a|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function jA(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function Uh(t,e,n,o,a,l,d,g){return(a-d)*(e-g)>=(t-d)*(l-g)&&(t-d)*(o-g)>=(n-d)*(e-g)&&(n-d)*(l-g)>=(a-d)*(o-g)}function VA(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(n,o){var a=n;do{if(a.i!==n.i&&a.next.i!==n.i&&a.i!==o.i&&a.next.i!==o.i&&bb(a,a.next,n,o))return!0;a=a.next}while(a!==n);return!1}(t,e)&&(Df(t,e)&&Df(e,t)&&function(n,o){var a=n,l=!1,d=(n.x+o.x)/2,g=(n.y+o.y)/2;do a.y>g!=a.next.y>g&&a.next.y!==a.y&&d<(a.next.x-a.x)*(g-a.y)/(a.next.y-a.y)+a.x&&(l=!l),a=a.next;while(a!==n);return l}(t,e)&&(Xi(t.prev,t,e.prev)||Xi(t,e.prev,e))||Im(t,e)&&Xi(t.prev,t,t.next)>0&&Xi(e.prev,e,e.next)>0)}function Xi(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Im(t,e){return t.x===e.x&&t.y===e.y}function bb(t,e,n,o){var a=Pm(Xi(t,e,n)),l=Pm(Xi(t,e,o)),d=Pm(Xi(n,o,t)),g=Pm(Xi(n,o,e));return a!==l&&d!==g||!(a!==0||!Cm(t,n,e))||!(l!==0||!Cm(t,o,e))||!(d!==0||!Cm(n,t,o))||!(g!==0||!Cm(n,e,o))}function Cm(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Pm(t){return t>0?1:t<0?-1:0}function Df(t,e){return Xi(t.prev,t,t.next)<0?Xi(t,e,t.next)>=0&&Xi(t,t.prev,e)>=0:Xi(t,e,t.prev)<0||Xi(t,t.next,e)<0}function wb(t,e){var n=new cy(t.i,t.x,t.y),o=new cy(e.i,e.x,e.y),a=t.next,l=e.prev;return t.next=e,e.prev=t,n.next=a,a.prev=n,o.next=n,n.prev=o,l.next=o,o.prev=l,o}function Tb(t,e,n,o){var a=new cy(t,e,n);return o?(a.next=o.next,a.prev=o,o.next.prev=a,o.next=a):(a.prev=a,a.next=a),a}function kf(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function cy(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function uy(t,e,n,o){for(var a=0,l=e,d=n-o;l<n;l+=o)a+=(t[d]-t[l])*(t[l+1]+t[d+1]),d=l;return a}ay.exports=Am,ay.exports.default=Am,Am.deviation=function(t,e,n,o){var a=e&&e.length,l=Math.abs(uy(t,0,a?e[0]*n:t.length,n));if(a)for(var d=0,g=e.length;d<g;d++)l-=Math.abs(uy(t,e[d]*n,d<g-1?e[d+1]*n:t.length,n));var v=0;for(d=0;d<o.length;d+=3){var b=o[d]*n,S=o[d+1]*n,I=o[d+2]*n;v+=Math.abs((t[b]-t[I])*(t[S+1]-t[b+1])-(t[b]-t[S])*(t[I+1]-t[b+1]))}return l===0&&v===0?0:Math.abs((v-l)/l)},Am.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},o=0,a=0;a<t.length;a++){for(var l=0;l<t[a].length;l++)for(var d=0;d<e;d++)n.vertices.push(t[a][l][d]);a>0&&n.holes.push(o+=t[a-1].length)}return n};var Dm=ye(ay.exports);function hy(t,e){const n=t.length;if(n<=1)return[t];const o=[];let a,l;for(let d=0;d<n;d++){const g=Lt(t[d]);g!==0&&(t[d].area=Math.abs(g),l===void 0&&(l=g<0),l===g<0?(a&&o.push(a),a=[t[d]]):a.push(t[d]))}if(a&&o.push(a),e>1)for(let d=0;d<o.length;d++)o[d].length<=e||(Dd(o[d],e,1,o[d].length-1,UA),o[d]=o[d].slice(0,e));return o}function UA(t,e){return e.area-t.area}function dy(t,e,n){const o=n.patternDependencies;let a=!1;for(const l of e){const d=l.paint.get(`${t}-pattern`);d.isConstant()||(a=!0);const g=d.constantOr(null);g&&(a=!0,o[g]=!0)}return a}function fy(t,e,n,o,a){const l=a.patternDependencies;for(const d of e){const g=d.paint.get(`${t}-pattern`).value;if(g.kind!=="constant"){let v=g.evaluate({zoom:o},n,{},a.availableImages);v=v&&v.name?v.name:v,l[v]=!0,n.patterns[d.id]=v}}return n}class py{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.fqid),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ls,this.indexArray=new eo,this.indexArray2=new ta,this.programConfigurations=new K(e.layers,e.zoom),this.segments=new Ii,this.segments2=new Ii,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.projection=e.projection}populate(e,n,o,a){this.hasPattern=dy("fill",this.layers,n);const l=this.layers[0].layout.get("fill-sort-key"),d=[];for(const{feature:g,id:v,index:b,sourceLayerIndex:S}of e){const I=this.layers[0]._featureFilter.needGeometry,D=qi(g,I);if(!this.layers[0]._featureFilter.filter(new fi(this.zoom),D,o))continue;const F=l?l.evaluate(D,{},o,n.availableImages):void 0,N={id:v,properties:g.properties,type:g.type,sourceLayerIndex:S,index:b,geometry:I?D.geometry:no(g,o,a),patterns:{},sortKey:F};d.push(N)}l&&d.sort((g,v)=>g.sortKey-v.sortKey);for(const g of d){const{geometry:v,index:b,sourceLayerIndex:S}=g;if(this.hasPattern){const I=fy("fill",this.layers,g,this.zoom,n);this.patternFeatures.push(I)}else this.addFeature(g,v,b,o,{},n.availableImages,n.brightness);n.featureIndex.insert(e[b].feature,v,b,S,this.index)}}update(e,n,o,a,l){const d=Object.keys(e).length!==0;d&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,n,d?this.stateDependentLayers:this.layers,o,a,l)}addFeatures(e,n,o,a,l,d){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,n,o,a,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,kA),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,n,o,a,l,d=[],g){for(const v of hy(n,500)){let b=0;for(const V of v)b+=V.length;const S=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),I=S.vertexLength,D=[],F=[];for(const V of v){if(V.length===0)continue;V!==v[0]&&F.push(D.length/2);const q=this.segments2.prepareSegment(V.length,this.layoutVertexArray,this.indexArray2),Y=q.vertexLength;this.layoutVertexArray.emplaceBack(V[0].x,V[0].y),this.indexArray2.emplaceBack(Y+V.length-1,Y),D.push(V[0].x),D.push(V[0].y);for(let oe=1;oe<V.length;oe++)this.layoutVertexArray.emplaceBack(V[oe].x,V[oe].y),this.indexArray2.emplaceBack(Y+oe-1,Y+oe),D.push(V[oe].x),D.push(V[oe].y);q.vertexLength+=V.length,q.primitiveLength+=V.length}const N=Dm(D,F);for(let V=0;V<N.length;V+=3)this.indexArray.emplaceBack(I+N[V],I+N[V+1],I+N[V+2]);S.vertexLength+=b,S.primitiveLength+=N.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,l,d,a,g)}}sn(py,"FillBucket",{omit:["layers","patternFeatures"]});const $A=new pi({"fill-sort-key":new wn(Je.layout_fill["fill-sort-key"]),visibility:new Nt(Je.layout_fill.visibility)});var GA={paint:new pi({"fill-antialias":new Nt(Je.paint_fill["fill-antialias"]),"fill-opacity":new wn(Je.paint_fill["fill-opacity"]),"fill-color":new wn(Je.paint_fill["fill-color"]),"fill-outline-color":new wn(Je.paint_fill["fill-outline-color"]),"fill-translate":new Nt(Je.paint_fill["fill-translate"]),"fill-translate-anchor":new Nt(Je.paint_fill["fill-translate-anchor"]),"fill-pattern":new wn(Je.paint_fill["fill-pattern"]),"fill-emissive-strength":new Nt(Je.paint_fill["fill-emissive-strength"])}),layout:$A};const HA=jr([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),qA=jr([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),WA=jr([{name:"a_centroid_pos",components:2,type:"Uint16"}]),ZA=jr([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),YA=jr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:XA}=HA;var km={},KA=He,Eb=$h;function $h(t,e,n,o,a){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=o,this._values=a,t.readFields(JA,this,e)}function JA(t,e,n){t==1?e.id=n.readVarint():t==2?function(o,a){for(var l=o.readVarint()+o.pos;o.pos<l;){var d=a._keys[o.readVarint()],g=a._values[o.readVarint()];a.properties[d]=g}}(n,e):t==3?e.type=n.readVarint():t==4&&(e._geometry=n.pos)}function QA(t){for(var e,n,o=0,a=0,l=t.length,d=l-1;a<l;d=a++)o+=((n=t[d]).x-(e=t[a]).x)*(e.y+n.y);return o}$h.types=["Unknown","Point","LineString","Polygon"],$h.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,o=1,a=0,l=0,d=0,g=[];t.pos<n;){if(a<=0){var v=t.readVarint();o=7&v,a=v>>3}if(a--,o===1||o===2)l+=t.readSVarint(),d+=t.readSVarint(),o===1&&(e&&g.push(e),e=[]),e.push(new KA(l,d));else{if(o!==7)throw new Error("unknown command "+o);e&&e.push(e[0].clone())}}return e&&g.push(e),g},$h.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,o=0,a=0,l=0,d=1/0,g=-1/0,v=1/0,b=-1/0;t.pos<e;){if(o<=0){var S=t.readVarint();n=7&S,o=S>>3}if(o--,n===1||n===2)(a+=t.readSVarint())<d&&(d=a),a>g&&(g=a),(l+=t.readSVarint())<v&&(v=l),l>b&&(b=l);else if(n!==7)throw new Error("unknown command "+n)}return[d,v,g,b]},$h.prototype.toGeoJSON=function(t,e,n){var o,a,l=this.extent*Math.pow(2,n),d=this.extent*t,g=this.extent*e,v=this.loadGeometry(),b=$h.types[this.type];function S(F){for(var N=0;N<F.length;N++){var V=F[N];F[N]=[360*(V.x+d)/l-180,360/Math.PI*Math.atan(Math.exp((180-360*(V.y+g)/l)*Math.PI/180))-90]}}switch(this.type){case 1:var I=[];for(o=0;o<v.length;o++)I[o]=v[o][0];S(v=I);break;case 2:for(o=0;o<v.length;o++)S(v[o]);break;case 3:for(v=function(F){var N=F.length;if(N<=1)return[F];for(var V,q,Y=[],oe=0;oe<N;oe++){var le=QA(F[oe]);le!==0&&(q===void 0&&(q=le<0),q===le<0?(V&&Y.push(V),V=[F[oe]]):V.push(F[oe]))}return V&&Y.push(V),Y}(v),o=0;o<v.length;o++)for(a=0;a<v[o].length;a++)S(v[o][a])}v.length===1?v=v[0]:b="Multi"+b;var D={type:"Feature",geometry:{type:b,coordinates:v},properties:this.properties};return"id"in this&&(D.id=this.id),D};var eI=Eb,Sb=Mb;function Mb(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(tI,this,e),this.length=this._features.length}function tI(t,e,n){t===15?e.version=n.readVarint():t===1?e.name=n.readString():t===5?e.extent=n.readVarint():t===2?e._features.push(n.pos):t===3?e._keys.push(n.readString()):t===4&&e._values.push(function(o){for(var a=null,l=o.readVarint()+o.pos;o.pos<l;){var d=o.readVarint()>>3;a=d===1?o.readString():d===2?o.readFloat():d===3?o.readDouble():d===4?o.readVarint64():d===5?o.readVarint():d===6?o.readSVarint():d===7?o.readBoolean():null}return a}(n))}Mb.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new eI(this._pbf,e,this.extent,this._keys,this._values)};var nI=Sb;function rI(t,e,n){if(t===3){var o=new nI(n,n.readVarint()+n.pos);o.length&&(e[o.name]=o)}}var my=km.VectorTile=function(t,e){this.layers=t.readFields(rI,{},e)},Om=km.VectorTileFeature=Eb;function Rm(t,e,n,o){const a=[],l=o===0?(d,g,v,b,S,I)=>{d.push(new ve(I,v+(I-g)/(b-g)*(S-v)))}:(d,g,v,b,S,I)=>{d.push(new ve(g+(I-v)/(S-v)*(b-g),I))};for(const d of t){const g=[];for(const v of d){if(v.length<=2)continue;const b=[];for(let D=0;D<v.length-1;D++){const F=v[D].x,N=v[D].y,V=v[D+1].x,q=v[D+1].y,Y=o===0?F:N,oe=o===0?V:q;Y<e?oe>e&&l(b,F,N,V,q,e):Y>n?oe<n&&l(b,F,N,V,q,n):b.push(v[D]),oe<e&&Y>=e&&l(b,F,N,V,q,e),oe>n&&Y<=n&&l(b,F,N,V,q,n)}let S=v[v.length-1];const I=o===0?S.x:S.y;I>=e&&I<=n&&b.push(S),b.length&&(S=b[b.length-1],b[0].x===S.x&&b[0].y===S.y||b.push(b[0]),g.push(b))}g.length&&a.push(g)}return a}function Lm(t,e){return t.x-e.x||t.y-e.y}function Ab(t,e){return Lm(t.min,e.min)===0&&Lm(t.max,e.max)===0}function Ib(t,e){return!(t.min.x>e.max.x||t.max.x<e.min.x||t.min.y>e.max.y||t.max.y<e.min.y)}function Cb(t,e,n){const o=1/Jt,a=1/(1<<n.canonical.z),l=(e.x*o+n.canonical.x)*a+n.wrap,d=(e.y*o+n.canonical.y)*a;return{min:new ve((t.x*o+n.canonical.x)*a+n.wrap,(t.y*o+n.canonical.y)*a),max:new ve(l,d)}}function iI(t,e,n){const o=1<<n.canonical.z,a=((e.x-n.wrap)*o-n.canonical.x)*Jt,l=(e.y*o-n.canonical.y)*Jt;return{min:new ve(((t.x-n.wrap)*o-n.canonical.x)*Jt,(t.y*o-n.canonical.y)*Jt),max:new ve(a,l)}}function Pb(t,e,n,o,a,l,d){const g=t.indices,v=t.vertices,b=[];for(let S=o;S<o+a;S+=3){const I=e[n[S+0]+l],D=e[n[S+1]+l],F=e[n[S+2]+l],N=Math.min(I.x,D.x,F.x),V=Math.max(I.x,D.x,F.x),q=Math.min(I.y,D.y,F.y),Y=Math.max(I.y,D.y,F.y);b.length=0,t.grid.query(new ve(N,q),new ve(V,Y),b);for(let oe=0;oe<b.length;oe++){const le=b[oe];if(zg(v[g[3*le+0]],v[g[3*le+1]],v[g[3*le+2]],I,D,F,d))return!0}}return!1}function Db(t,e,n,o){if(!t||!n)return!1;let a=t.vertices;if(!e.canonical.equals(o.canonical)||e.wrap!==o.wrap){if(n.vertices.length<t.vertices.length)return Db(n,o,t,e);const l=e.canonical,d=o.canonical,g=Math.pow(2,d.z-l.z);a=t.vertices.map(v=>new ve(v.x*l.x*Jt*g-d.x*Jt,v.y*l.y*Jt*g-d.y*Jt))}return Pb(n,a,t.indices,0,t.indices.length,0,0)}km.VectorTileLayer=Sb;class kb{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,n){const o=this.toIdx(e,n);return{min:this.minimums[o],max:this.maximums[o]}}isLeaf(e,n){return this.leaves[this.toIdx(e,n)]}toIdx(e,n){return n*this.size+e}}function Ob(t,e,n,o){let a=0,l=Number.MAX_VALUE;for(let d=0;d<3;d++)if(Math.abs(o[d])<1e-15){if(n[d]<t[d]||n[d]>e[d])return null}else{const g=1/o[d];let v=(t[d]-n[d])*g,b=(e[d]-n[d])*g;if(v>b){const S=v;v=b,b=S}if(v>a&&(a=v),b<l&&(l=b),a>l)return null}return a}function Rb(t,e,n,o,a,l,d,g,v,b,S){const I=o-t,D=a-e,F=l-n,N=d-t,V=g-e,q=v-n,Y=S[1]*q-S[2]*V,oe=S[2]*N-S[0]*q,le=S[0]*V-S[1]*N,ae=I*Y+D*oe+F*le;if(Math.abs(ae)<1e-15)return null;const be=1/ae,ge=b[0]-t,Ie=b[1]-e,Ne=b[2]-n,Ge=(ge*Y+Ie*oe+Ne*le)*be;if(Ge<0||Ge>1)return null;const tt=Ie*F-Ne*D,qe=Ne*I-ge*F,_t=ge*D-Ie*I,Et=(S[0]*tt+S[1]*qe+S[2]*_t)*be;return Et<0||Ge+Et>1?null:(N*tt+V*qe+q*_t)*be}function Lb(t,e,n){return(t-e)/(n-e)}function zb(t,e,n,o,a,l,d,g,v){const b=1<<n,S=l-o,I=d-a,D=(t+1)/b*S+o,F=(e+0)/b*I+a,N=(e+1)/b*I+a;g[0]=(t+0)/b*S+o,g[1]=F,v[0]=D,v[1]=N}class Fb{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const n=function(l){const d=Math.ceil(Math.log2(l.dim/8)),g=[];let v=Math.ceil(Math.pow(2,d));const b=1/v,S=(F,N,V,q,Y)=>{const oe=q?1:0,le=(F+1)*V-oe,ae=N*V,be=(N+1)*V-oe;Y[0]=F*V,Y[1]=ae,Y[2]=le,Y[3]=be};let I=new kb(v);const D=[];for(let F=0;F<v*v;F++){S(F%v,Math.floor(F/v),b,!1,D);const N=wc(D[0],D[1],l),V=wc(D[2],D[1],l),q=wc(D[2],D[3],l),Y=wc(D[0],D[3],l);I.minimums.push(Math.min(N,V,q,Y)),I.maximums.push(Math.max(N,V,q,Y)),I.leaves.push(1)}for(g.push(I),v/=2;v>=1;v/=2){const F=g[g.length-1];I=new kb(v);for(let N=0;N<v*v;N++){S(N%v,Math.floor(N/v),2,!0,D);const V=F.getElevation(D[0],D[1]),q=F.getElevation(D[2],D[1]),Y=F.getElevation(D[2],D[3]),oe=F.getElevation(D[0],D[3]),le=F.isLeaf(D[0],D[1]),ae=F.isLeaf(D[2],D[1]),be=F.isLeaf(D[2],D[3]),ge=F.isLeaf(D[0],D[3]),Ie=Math.min(V.min,q.min,Y.min,oe.min),Ne=Math.max(V.max,q.max,Y.max,oe.max),Ge=le&&ae&&be&&ge;I.maximums.push(Ne),I.minimums.push(Ie),I.leaves.push(Ne-Ie<=5&&Ge?1:0)}g.push(I)}return g}(this.dem),o=n.length-1,a=n[o];this._addNode(a.minimums[0],a.maximums[0],a.leaves[0]),this._construct(n,0,0,o,0)}raycastRoot(e,n,o,a,l,d,g=1){return Ob([e,n,-100],[o,a,this.maximums[0]*g],l,d)}raycast(e,n,o,a,l,d,g=1){if(!this.nodeCount)return null;const v=this.raycastRoot(e,n,o,a,l,d,g);if(v==null)return null;const b=[],S=[],I=[],D=[],F=[{idx:0,t:v,nodex:0,nodey:0,depth:0}];for(;F.length>0;){const{idx:N,t:V,nodex:q,nodey:Y,depth:oe}=F.pop();if(this.leaves[N]){zb(q,Y,oe,e,n,o,a,I,D);const ae=1<<oe,be=(q+0)/ae,ge=(q+1)/ae,Ie=(Y+0)/ae,Ne=(Y+1)/ae,Ge=wc(be,Ie,this.dem)*g,tt=wc(ge,Ie,this.dem)*g,qe=wc(ge,Ne,this.dem)*g,_t=wc(be,Ne,this.dem)*g,Et=Rb(I[0],I[1],Ge,D[0],I[1],tt,D[0],D[1],qe,l,d),ct=Rb(D[0],D[1],qe,I[0],D[1],_t,I[0],I[1],Ge,l,d),wt=Math.min(Et!==null?Et:Number.MAX_VALUE,ct!==null?ct:Number.MAX_VALUE);if(wt!==Number.MAX_VALUE)return wt;{const st=i.N.scaleAndAdd([],l,d,V);if(Bb(Ge,tt,_t,qe,Lb(st[0],I[0],D[0]),Lb(st[1],I[1],D[1]))>=st[2])return V}continue}let le=0;for(let ae=0;ae<this._siblingOffset.length;ae++){zb((q<<1)+this._siblingOffset[ae][0],(Y<<1)+this._siblingOffset[ae][1],oe+1,e,n,o,a,I,D),I[2]=-100,D[2]=this.maximums[this.childOffsets[N]+ae]*g;const be=Ob(I,D,l,d);if(be!=null){const ge=be;b[ae]=ge;let Ie=!1;for(let Ne=0;Ne<le&&!Ie;Ne++)ge>=b[S[Ne]]&&(S.splice(Ne,0,ae),Ie=!0);Ie||(S[le]=ae),le++}}for(let ae=0;ae<le;ae++){const be=S[ae];F.push({idx:this.childOffsets[N]+be,t:b[be],nodex:(q<<1)+this._siblingOffset[be][0],nodey:(Y<<1)+this._siblingOffset[be][1],depth:oe+1})}}return null}_addNode(e,n,o){return this.minimums.push(e),this.maximums.push(n),this.leaves.push(o),this.childOffsets.push(0),this.nodeCount++}_construct(e,n,o,a,l){if(e[a].isLeaf(n,o)===1)return;this.childOffsets[l]||(this.childOffsets[l]=this.nodeCount);const d=a-1,g=e[d];let v=0,b=0;for(let S=0;S<this._siblingOffset.length;S++){const I=2*n+this._siblingOffset[S][0],D=2*o+this._siblingOffset[S][1],F=g.getElevation(I,D),N=g.isLeaf(I,D),V=this._addNode(F.min,F.max,N);N&&(v|=1<<S),b||(b=V)}for(let S=0;S<this._siblingOffset.length;S++)v&1<<S||this._construct(e,2*n+this._siblingOffset[S][0],2*o+this._siblingOffset[S][1],d,b+S)}}function Bb(t,e,n,o,a,l){return Zn(Zn(t,n,l),Zn(e,o,l),a)}function wc(t,e,n){const o=n.dim,a=vt(t*o-.5,0,o-1),l=vt(e*o-.5,0,o-1),d=Math.floor(a),g=Math.floor(l),v=Math.min(d+1,o-1),b=Math.min(g+1,o-1);return Bb(n.get(d,g),n.get(v,g),n.get(d,b),n.get(v,b),a-d,l-g)}const oI={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function sI(t,e,n){return(256*t*256+256*e+n)/10-1e4}function aI(t,e,n){return 256*t+e+n/256-32768}class zm{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,n,o,a=!1){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(o&&o!=="mapbox"&&o!=="terrarium")return Re(`"${o}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=n.height;const l=this.dim=n.height-2,d=new Uint32Array(n.data.buffer);if(this.pixels=new Uint8Array(n.data.buffer),this.floatView=new Float32Array(n.data.buffer),this.borderReady=a,this._modifiedForSources={},!a){for(let v=0;v<l;v++)d[this._idx(-1,v)]=d[this._idx(0,v)],d[this._idx(l,v)]=d[this._idx(l-1,v)],d[this._idx(v,-1)]=d[this._idx(v,0)],d[this._idx(v,l)]=d[this._idx(v,l-1)];d[this._idx(-1,-1)]=d[this._idx(0,0)],d[this._idx(l,-1)]=d[this._idx(l-1,0)],d[this._idx(-1,l)]=d[this._idx(0,l-1)],d[this._idx(l,l)]=d[this._idx(l-1,l-1)]}const g=o==="terrarium"?aI:sI;for(let v=0;v<d.length;++v){const b=4*v;this.floatView[v]=g(this.pixels[b],this.pixels[b+1],this.pixels[b+2])}this._timestamp=Mt.now()}_buildQuadTree(){this._tree=new Fb(this)}get(e,n,o=!1){o&&(e=vt(e,-1,this.dim),n=vt(n,-1,this.dim));const a=this._idx(e,n);return this.floatView[a]}set(e,n,o){const a=this._idx(e,n),l=this.floatView[a];return this.floatView[a]=o,o-l}static getUnpackVector(e){return oI[e]}_idx(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(e+1)}static pack(e,n){const o=[0,0,0,0],a=zm.getUnpackVector(n);let l=Math.floor((e+a[3])/a[2]);return o[2]=l%256,l=Math.floor(l/256),o[1]=l%256,l=Math.floor(l/256),o[0]=l,o}getPixels(){return new vb({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,n,o){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let a=n*this.dim,l=n*this.dim+this.dim,d=o*this.dim,g=o*this.dim+this.dim;switch(n){case-1:a=l-1;break;case 1:l=a+1}switch(o){case-1:d=g-1;break;case 1:g=d+1}const v=-n*this.dim,b=-o*this.dim;for(let S=d;S<g;S++)for(let I=a;I<l;I++){const D=4*this._idx(I,S),F=4*this._idx(I+v,S+b);this.pixels[D+0]=e.pixels[F+0],this.pixels[D+1]=e.pixels[F+1],this.pixels[D+2]=e.pixels[F+2],this.pixels[D+3]=e.pixels[F+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}sn(zm,"DEMData"),sn(Fb,"DemMinMaxQuadTree",{omit:["dem"]});class Gh{constructor(e,n,o){this._demTile=e,this._dem=this._demTile.dem,this._scale=n,this._offset=o}static create(e,n,o){const a=o||e.findDEMTileFor(n);if(!a||!a.dem)return;const l=a.dem,d=a.tileID,g=1<<n.canonical.z-d.canonical.z;return new Gh(a,l.dim/Jt/g,[(n.canonical.x/g-d.canonical.x)*l.dim,(n.canonical.y/g-d.canonical.y)*l.dim])}tileCoordToPixel(e,n){const o=n*this._scale+this._offset[1],a=Math.floor(e*this._scale+this._offset[0]),l=Math.floor(o);return new ve(a,l)}getElevationAt(e,n,o,a){const l=e*this._scale+this._offset[0],d=n*this._scale+this._offset[1],g=Math.floor(l),v=Math.floor(d),b=this._dem;return a=!!a,o?Zn(Zn(b.get(g,v,a),b.get(g,v+1,a),d-v),Zn(b.get(g+1,v,a),b.get(g+1,v+1,a),d-v),l-g):b.get(g,v,a)}getElevationAtPixel(e,n,o){return this._dem.get(e,n,!!o)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Nn(1,e)*this._dem.stride}}const lI=Om.types,cI=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],uI=["fill-extrusion-flood-light-ground-radius"],hI=Math.pow(2,13),dI=Math.pow(2,15)-1,Nb=new ve(0,1),Tc=2147483648;function Of(t,e,n,o,a,l,d,g){t.emplaceBack((e<<1)+d,(n<<1)+l,(Math.floor(o*hI)<<1)+a,Math.round(g))}function Fm(t,e,n,o,a,l){t.emplaceBack(e.x,e.y,(n.x<<1)+o,(n.y<<1)+a,l)}function Rf(t,e,n){t.emplaceBack(e.x,e.y,e.z,n[0]*16384,n[1]*16384,n[2]*16384)}class jb{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class Vb{constructor(){this.centroidXY=new ve(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new ve(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new ve(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new ve(this.max.x-this.min.x,this.max.y-this.min.y)}}class Ub{constructor(){this.acc=new ve(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(e,n){e.min.x===Number.MAX_VALUE&&(e.min.x=e.max.x=n.x,e.min.y=e.max.y=n.y)}appendEdge(e,n,o){this.accCount++,this.acc._add(n);let a=!!this.borders;n.x<e.min.x?(e.min.x=n.x,a=!0):n.x>e.max.x&&(e.max.x=n.x,a=!0),n.y<e.min.y?(e.min.y=n.y,a=!0):n.y>e.max.y&&(e.max.y=n.y,a=!0),((n.x===0||n.x===Jt)&&n.x===o.x)!=((n.y===0||n.y===Jt)&&n.y===o.y)&&this.processBorderOverlap(n,o),a&&this.checkBorderIntersection(n,o)}checkBorderIntersection(e,n){n.x<0!=e.x<0&&this.addBorderIntersection(0,Zn(n.y,e.y,(0-n.x)/(e.x-n.x))),n.x>Jt!=e.x>Jt&&this.addBorderIntersection(1,Zn(n.y,e.y,(Jt-n.x)/(e.x-n.x))),n.y<0!=e.y<0&&this.addBorderIntersection(2,Zn(n.x,e.x,(0-n.y)/(e.y-n.y))),n.y>Jt!=e.y>Jt&&this.addBorderIntersection(3,Zn(n.x,e.x,(Jt-n.y)/(e.y-n.y)))}addBorderIntersection(e,n){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const o=this.borders[e];n<o[0]&&(o[0]=n),n>o[1]&&(o[1]=n)}processBorderOverlap(e,n){if(e.x===n.x){if(e.y===n.y)return;const o=e.x===0?0:1;this.addBorderIntersection(o,n.y),this.addBorderIntersection(o,e.y)}else{const o=e.y===0?2:3;this.addBorderIntersection(o,n.x),this.addBorderIntersection(o,e.x)}}centroid(){return this.accCount===0?new ve(0,0):new ve(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((e,n)=>e+ +(n[0]!==Number.MAX_VALUE),0):0}}function $b(t,e){const n=t.add(e)._unit(),o=vt(t.x*n.x+t.y*n.y,-1,1);var a,l,d;return a=Math.acos(o),Math.min(4,Math.max(-4,Math.tan(a)))/4*dI*((l=t).x*(d=e).y-l.y*d.x<0?-1:1)}const fI=[t=>t.x<0,t=>t.x>Jt,t=>t.y<0,t=>t.y>Jt];function pI(t,e,n,o){const a=[4];if(o===0)return a;n._mult(o);const l=t.sub(n),d=e.sub(n),g=[t,e,l,d];for(let v=0;v<4;v++)for(const b of g)if(fI[v](b)){a.push(v);break}return a}class Gb{constructor(e){this.vertexArray=new df,this.indexArray=new eo,this.programConfigurations=new K(e.layers,e.zoom,n=>uI.includes(n)),this._segments=new Ii,this.hiddenByLandmarkVertexArray=new bf,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Ii}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(e,n,o,a=!1){const l=e.length;if(l>2){let d=Math.max(0,this._segments.get().length-1);const g=this._segments._prepareSegment(4*l,this.vertexArray.length,2*this._segmentToGroundQuads[d].length);let v;d!==this._segments.get().length-1&&(d++,this._segmentToGroundQuads[d]=[],this._segmentToRegionTriCounts[d]=[0,0,0,0,0]);{const b=e[0],S=e[1];v=$b(b.sub(e[l-1])._perp()._unit(),S.sub(b)._perp()._unit())}for(let b=0;b<l;b++){const S=b===l-1?0:b+1,I=e[b],D=e[S],F=e[S===l-1?0:S+1],N=D.sub(I)._perp()._unit(),V=$b(N,F.sub(D)._perp()._unit()),q=v,Y=V;if(_y(I,D,n)||a&&Wb(I,n)&&Wb(D,n)){v=V;continue}const oe=g.vertexLength;Fm(this.vertexArray,I,D,1,1,q),Fm(this.vertexArray,I,D,1,0,q),Fm(this.vertexArray,I,D,0,1,Y),Fm(this.vertexArray,I,D,0,0,Y),g.vertexLength+=4;const le=pI(I,D,N,o);for(const ae of le)this._segmentToGroundQuads[d].push({id:oe,region:ae}),this._segmentToRegionTriCounts[d][ae]+=2,g.primitiveLength+=2;v=V}}}prepareBorderSegments(){if(!this.hasData())return;const e=this._segments.get(),n=e.length;for(let o=0;o<n;o++)this._segmentToGroundQuads[o].sort((a,l)=>a.region-l.region);for(let o=0;o<n;o++){const a=this._segmentToGroundQuads[o],l=e[o],d=this._segmentToRegionTriCounts[o];d.reduce((v,b)=>v+b,0);let g=0;for(let v=0;v<=4;v++){const b=d[v];if(b!==0){let S=this.regionSegments[v];S||(S=this.regionSegments[v]=new Ii);const I={vertexOffset:l.vertexOffset,primitiveOffset:l.primitiveOffset+g,vertexLength:l.vertexLength,primitiveLength:b};S.get().push(I)}g+=b}for(let v=0;v<a.length;v++){const b=a[v].id;this.indexArray.emplaceBack(b,b+1,b+3),this.indexArray.emplaceBack(b,b+3,b+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(e,n,o,a,l,d){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,e,n,o,a,l,d)}upload(e){this.hasData()&&(this.vertexBuffer=e.createVertexBuffer(this.vertexArray,qA.members),this.indexBuffer=e.createIndexBuffer(this.indexArray))}uploadPaintProperties(e){this.hasData()&&this.programConfigurations.upload(e)}update(e,n,o,a,l,d){this.hasData()&&this.programConfigurations.updatePaintArrays(e,n,o,a,l,d)}updateHiddenByLandmark(e){if(!this.hasData())return;const n=e.groundVertexCount+e.groundVertexArrayOffset;if(e.groundVertexCount===0)return;const o=e.flags&Tc?1:0;for(let a=e.groundVertexArrayOffset;a<n;++a)this.hiddenByLandmarkVertexArray.emplace(a,o);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(e){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=e.createVertexBuffer(this.hiddenByLandmarkVertexArray,ZA.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let e=0;e<=4;e++){const n=this.regionSegments[e];n&&n.destroy()}}}}class Bm{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.fqid),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new eo,this.footprintVertices=new Ls,this.footprintSegments=[],this.layoutVertexArray=new Ta,this.centroidVertexArray=new Nu,this.indexArray=new eo,this.programConfigurations=new K(e.layers,e.zoom,n=>cI.includes(n)),this.segments=new Ii,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.groundEffect=new Gb(e),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}populate(e,n,o,a){this.features=[],this.hasPattern=dy("fill-extrusion",this.layers,n),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=sr(o),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:l,id:d,index:g,sourceLayerIndex:v}of e){const b=this.layers[0]._featureFilter.needGeometry,S=qi(l,b);if(!this.layers[0]._featureFilter.filter(new fi(this.zoom),S,o))continue;const I={id:d,sourceLayerIndex:v,index:g,geometry:b?S.geometry:no(l,o,a),properties:l.properties,type:l.type,patterns:{}},D=this.layoutVertexArray.length;this.hasPattern?this.features.push(fy("fill-extrusion",this.layers,I,this.zoom,n)):this.addFeature(I,I.geometry,g,o,{},n.availableImages,a,n.brightness),n.featureIndex.insert(l,I.geometry,g,v,this.index,D)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(e,n,o,a,l,d){for(const g of this.features){const{geometry:v}=g;this.addFeature(g,v,g.index,n,o,a,l,d)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(e,n,o,a,l){const d=Object.keys(e).length!==0;if(d&&!this.stateDependentLayers.length)return;const g=d?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(e,n,g,o,a,l),this.groundEffect.update(e,n,g,o,a,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,XA),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,YA.members,!0)),this.groundEffect.upload(e)),this.groundEffect.uploadPaintProperties(e),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.groundEffect.uploadHiddenByLandmark(e),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,WA.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,o,a,l,d,g,v){const b=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(e,{})/this.tileToMeter,S=[new ve(0,0),new ve(Jt,Jt)],I=g.projection,D=I.name==="globe",F=lI[e.type]==="Polygon",N=new Ub;N.centroidDataIndex=this.centroidData.length;const V=new Vb,q=this.layers[0].paint.get("fill-extrusion-base").evaluate(e,{},a)<=0,Y=this.layers[0].paint.get("fill-extrusion-height").evaluate(e,{},a);V.height=Y,V.vertexArrayOffset=this.layoutVertexArray.length,V.groundVertexArrayOffset=this.groundEffect.vertexArray.length,D&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Oh);const oe=hy(n,500);for(let Ne=oe.length-1;Ne>=0;Ne--){const Ge=oe[Ne];(Ge.length===0||(le=Ge[0]).every(tt=>tt.x<=0)||le.every(tt=>tt.x>=Jt)||le.every(tt=>tt.y<=0)||le.every(tt=>tt.y>=Jt))&&oe.splice(Ne,1)}var le;let ae;if(D)ae=Kb(oe,S,a);else{ae=[];for(const Ne of oe)ae.push({polygon:Ne,bounds:S})}const be=F?this.edgeRadius:0,ge=be>0&&this.zoom<17,Ie=(Ne,Ge)=>{if(Ne.length===0)return!1;const tt=Ne[Ne.length-1];return Ge.x===tt.x&&Ge.y===tt.y};for(const{polygon:Ne,bounds:Ge}of ae){let tt=0,qe=0;for(const wt of Ne)F&&!wt[0].equals(wt[wt.length-1])&&wt.push(wt[0]),qe+=F?wt.length-1:wt.length;const _t=this.segments.prepareSegment((F?5:4)*qe,this.layoutVertexArray,this.indexArray);V.footprintSegIdx<0&&(V.footprintSegIdx=this.footprintSegments.length),V.polygonSegIdx<0&&(V.polygonSegIdx=this.polygonSegments.length);const Et={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},ct=new jb;if(ct.vertexOffset=this.footprintVertices.length,ct.indexOffset=3*this.footprintIndices.length,ct.ringIndices=[],F){const wt=[],st=[];tt=_t.vertexLength;for(let $t=0;$t<Ne.length;$t++){const St=Ne[$t];St.length&&$t!==0&&st.push(wt.length/2);const cn=[];let rn,Dt;rn=St[1].sub(St[0])._perp()._unit(),ct.ringIndices.push(St.length-1);for(let An=1;An<St.length;An++){const _n=St[An],ln=St[An===St.length-1?1:An+1],kt=_n.clone();if(be){Dt=ln.sub(_n)._perp()._unit();const Tn=rn.add(Dt)._unit(),Kn=be*Math.min(4,1/(rn.x*Tn.x+rn.y*Tn.y));kt.x+=Kn*Tn.x,kt.y+=Kn*Tn.y,kt.x=Math.round(kt.x),kt.y=Math.round(kt.y),rn=Dt}!q||be!==0&&!ge||Ie(cn,kt)||cn.push(kt),Of(this.layoutVertexArray,kt.x,kt.y,0,0,1,1,0),_t.vertexLength++,this.footprintVertices.emplaceBack(_n.x,_n.y),wt.push(_n.x,_n.y),D&&Rf(this.layoutVertexExtArray,I.projectTilePoint(kt.x,kt.y,a),I.upVector(a,kt.x,kt.y))}q&&(be===0||ge)&&(cn.length!==0&&Ie(cn,cn[0])&&cn.pop(),this.groundEffect.addData(cn,Ge,b))}const bt=Dm(wt,st);for(let $t=0;$t<bt.length;$t+=3)this.footprintIndices.emplaceBack(ct.vertexOffset+bt[$t+0],ct.vertexOffset+bt[$t+1],ct.vertexOffset+bt[$t+2]),this.indexArray.emplaceBack(tt+bt[$t],tt+bt[$t+2],tt+bt[$t+1]),_t.primitiveLength++;ct.indexCount+=bt.length,ct.vertexCount+=this.footprintVertices.length-ct.vertexOffset}for(let wt=0;wt<Ne.length;wt++){const st=Ne[wt];N.startRing(V,st[0]);let bt=st.length>4&&Zb(st[st.length-2],st[0],st[1]),$t=be?mI(st[st.length-2],st[0],st[1],be):0;const St=[];let cn,rn,Dt;rn=st[1].sub(st[0])._perp()._unit();let An=!0;for(let _n=1,ln=0;_n<st.length;_n++){let kt=st[_n-1],Tn=st[_n];const Kn=st[_n===st.length-1?1:_n+1];if(N.appendEdge(V,Tn,kt),_y(Tn,kt,Ge)){be&&(rn=Kn.sub(Tn)._perp()._unit(),An=!An);continue}const In=Tn.sub(kt)._perp(),Jn=In.x/(Math.abs(In.x)+Math.abs(In.y)),On=In.y>0?1:0,pr=kt.dist(Tn);if(ln+pr>32768&&(ln=0),be){Dt=Kn.sub(Tn)._perp()._unit();let kr=qb(kt,Tn,Kn,Hb(rn,Dt),be);isNaN(kr)&&(kr=0);const Br=Tn.sub(kt)._unit();kt=kt.add(Br.mult($t))._round(),Tn=Tn.add(Br.mult(-kr))._round(),$t=kr,rn=Dt,q&&this.zoom>=17&&(Ie(St,kt)||St.push(kt),Ie(St,Tn)||St.push(Tn))}const jn=_t.vertexLength,Wr=st.length>4&&Zb(kt,Tn,Kn);let Ir=Yb(ln,bt,An);if(Of(this.layoutVertexArray,kt.x,kt.y,Jn,On,0,0,Ir),Of(this.layoutVertexArray,kt.x,kt.y,Jn,On,0,1,Ir),ln+=pr,Ir=Yb(ln,Wr,!An),bt=Wr,Of(this.layoutVertexArray,Tn.x,Tn.y,Jn,On,0,0,Ir),Of(this.layoutVertexArray,Tn.x,Tn.y,Jn,On,0,1,Ir),_t.vertexLength+=4,this.indexArray.emplaceBack(jn+0,jn+1,jn+2),this.indexArray.emplaceBack(jn+1,jn+3,jn+2),_t.primitiveLength+=2,be){const kr=tt+(_n===1?st.length-2:_n-2),Br=_n===1?tt:kr+1;if(this.indexArray.emplaceBack(jn+1,kr,jn+3),this.indexArray.emplaceBack(kr,Br,jn+3),_t.primitiveLength+=2,cn===void 0&&(cn=jn),!_y(Kn,st[_n],Ge)){const Cr=_n===st.length-1?cn:_t.vertexLength;this.indexArray.emplaceBack(jn+2,jn+3,Cr),this.indexArray.emplaceBack(jn+3,Cr+1,Cr),this.indexArray.emplaceBack(jn+3,Br,Cr+1),_t.primitiveLength+=3}An=!An}if(D){const kr=this.layoutVertexExtArray,Br=I.projectTilePoint(kt.x,kt.y,a),Cr=I.projectTilePoint(Tn.x,Tn.y,a),hi=I.upVector(a,kt.x,kt.y),Ur=I.upVector(a,Tn.x,Tn.y);Rf(kr,Br,hi),Rf(kr,Br,hi),Rf(kr,Cr,Ur),Rf(kr,Cr,Ur)}}F&&(tt+=st.length-1),q&&be&&this.zoom>=17&&(St.length!==0&&Ie(St,St[0])&&St.pop(),this.groundEffect.addData(St,Ge,b,be>0))}this.footprintSegments.push(ct),Et.triangleCount=this.indexArray.length-Et.triangleArrayOffset,this.polygonSegments.push(Et),++V.footprintSegLen,++V.polygonSegLen}if(V.vertexCount=this.layoutVertexArray.length-V.vertexArrayOffset,V.groundVertexCount=this.groundEffect.vertexArray.length-V.groundVertexArrayOffset,V.vertexCount!==0){if(V.centroidXY=N.borders?Nb:this.encodeCentroid(N,V),this.centroidData.push(V),N.borders){this.featuresOnBorder.push(N);const Ne=this.featuresOnBorder.length-1;for(let Ge=0;Ge<N.borders.length;Ge++)N.borders[Ge][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Ge].push(Ne)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,l,d,a,v),this.groundEffect.addPaintPropertiesData(e,o,l,d,a,v),this.maxHeight=Math.max(this.maxHeight,Y)}}sortBorders(){for(let e=0;e<this.borderFeatureIndices.length;e++)this.borderFeatureIndices[e].sort((n,o)=>this.featuresOnBorder[n].borders[e][0]-this.featuresOnBorder[o].borders[e][0])}splitToSubtiles(){const e=[];for(let g=0;g<this.centroidData.length;g++){const v=this.centroidData[g],b=+(v.min.y+v.max.y>Jt),S=2*b+(+(v.min.x+v.max.x>Jt)^b);for(let I=0;I<v.polygonSegLen;I++){const D=v.polygonSegIdx+I;e.push({centroidIdx:g,subtile:S,polygonSegmentIdx:D,triangleSegmentIdx:this.polygonSegments[D].triangleSegIdx})}}const n=new eo;e.sort((g,v)=>g.triangleSegmentIdx===v.triangleSegmentIdx?g.subtile-v.subtile:g.triangleSegmentIdx-v.triangleSegmentIdx);let o=0,a=0,l=0;for(const g of e){if(g.triangleSegmentIdx!==o)break;l++}const d=e.length;for(;a!==e.length;){o=e[a].triangleSegmentIdx;let g=0,v=a,b=a;for(let S=v;S<l&&e[S].subtile===g;S++)b++;for(;v!==l;){const S=e[v];g=S.subtile;const I=this.centroidData[S.centroidIdx].min.clone(),D=this.centroidData[S.centroidIdx].max.clone(),F={vertexOffset:this.segments.segments[o].vertexOffset,primitiveOffset:n.length,vertexLength:this.segments.segments[o].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let N=v;N<b;N++){const V=e[N],q=this.polygonSegments[V.polygonSegmentIdx],Y=this.centroidData[V.centroidIdx].min,oe=this.centroidData[V.centroidIdx].max,le=this.indexArray.uint16;for(let ae=q.triangleArrayOffset;ae<q.triangleArrayOffset+q.triangleCount;ae++)n.emplaceBack(le[3*ae],le[3*ae+1],le[3*ae+2]);F.primitiveLength+=q.triangleCount,I.x=Math.min(I.x,Y.x),I.y=Math.min(I.y,Y.y),D.x=Math.max(D.x,oe.x),D.y=Math.max(D.y,oe.y)}F.primitiveLength>0&&this.triangleSubSegments.push({segment:F,min:I,max:D}),v=b;for(let N=v;N<l&&e[N].subtile===e[v].subtile;N++)b++}a=l;for(let S=a;S<d&&e[S].triangleSegmentIdx===e[a].triangleSegmentIdx;S++)l++}n._trim(),this.indexArray=n}getVisibleSegments(e,n,o){let a=0,l=0;const d=1<<e.canonical.z;if(n){const V=n.getMinMaxForTile(e);V&&(a=V.min,l=V.max)}l+=this.maxHeight;const g=e.toUnwrapped();let v;const b=[g.canonical.x/d+g.wrap,g.canonical.y/d],S=[(g.canonical.x+1)/d+g.wrap,(g.canonical.y+1)/d],I=new Ii,D=(V,q,Y)=>[V[0]*(1-Y[0])+q[0]*Y[0],V[1]*(1-Y[1])+q[1]*Y[1]],F=[],N=[];for(const V of this.triangleSubSegments){F[0]=V.min.x/Jt,F[1]=V.min.y/Jt,N[0]=V.max.x/Jt,N[1]=V.max.y/Jt;const q=D(b,S,F),Y=D(b,S,N);if(new Ti([q[0],q[1],a],[Y[0],Y[1],l]).intersectsPrecise(o)===0){v&&(I.segments.push(v),v=void 0);continue}const oe=V.segment;v&&v.vertexOffset!==oe.vertexOffset&&(I.segments.push(v),v=void 0),v?(v.vertexLength+=oe.vertexLength,v.primitiveLength+=oe.primitiveLength):v={vertexOffset:oe.vertexOffset,primitiveLength:oe.primitiveLength,vertexLength:oe.vertexLength,primitiveOffset:oe.primitiveOffset,sortKey:void 0,vaos:{}}}return v&&I.segments.push(v),I}encodeCentroid(e,n){const o=e.centroid(),a=n.span(),l=Math.min(7,Math.round(a.x*this.tileToMeter/10)),d=Math.min(7,Math.round(a.y*this.tileToMeter/10));return new ve(vt(o.x,1,Jt-1)<<3|l,vt(o.y,1,Jt-1)<<3|d)}encodeBorderCentroid(e){if(!e.borders)return new ve(0,0);const n=e.borders,o=Number.MAX_VALUE;if(n[0][0]!==o||n[1][0]!==o){const a=n[0][0]!==o?0:1;return new ve(6|(n[0][0]!==o?0:65528),(n[a][0]+n[a][1])/2<<3|6)}{const a=n[2][0]!==o?2:3;return new ve((n[a][0]+n[a][1])/2<<3|6,6|(n[2][0]!==o?0:65528))}}showCentroid(e){const n=this.centroidData[e.centroidDataIndex];n.flags&=Tc,n.centroidXY.x=0,n.centroidXY.y=0,this.writeCentroidToBuffer(n)}writeCentroidToBuffer(e){this.groundEffect.updateHiddenByLandmark(e);const n=e.vertexArrayOffset,o=e.vertexCount+e.vertexArrayOffset,a=e.flags&Tc?Nb:e.centroidXY,l=this.centroidVertexArray.geta_centroid_pos0(n);if(this.centroidVertexArray.geta_centroid_pos1(n)!==a.y||l!==a.x){for(let d=n;d<o;++d)this.centroidVertexArray.emplace(d,a.x,a.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const e of this.centroidData)this.writeCentroidToBuffer(e)}updateReplacement(e,n){if(n.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=n.updateTime;const o=n.getReplacementRegionsForTile(e.toUnwrapped());if(function(l,d){if(l.length!==d.length)return!1;for(let g=0;g<l.length;g++)if(l[g].sourceId!==d[g].sourceId||!Ab(l[g],d[g]))return!1;return!0}(this.activeReplacements,o))return;if(this.activeReplacements=o,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const l of this.centroidData)l.flags&=2147483647;const a=[];for(const l of this.activeReplacements){const d=Math.pow(2,l.footprintTileId.canonical.z-e.canonical.z);for(const g of this.centroidData)if(!(g.flags&Tc||l.min.x>g.max.x||g.min.x>l.max.x||l.min.y>g.max.y||g.min.y>l.max.y))for(let v=0;v<g.footprintSegLen;v++){const b=this.footprintSegments[g.footprintSegIdx+v];if(a.length=0,_I(this.footprintVertices,b.vertexOffset,b.vertexCount,l.footprintTileId.canonical,e.canonical,a),Pb(l.footprint,a,this.footprintIndices.uint16,b.indexOffset,b.indexCount,-b.vertexOffset,-d)){g.flags|=Tc;break}}}for(const l of this.centroidData)this.writeCentroidToBuffer(l);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(e,n,o){let a=!1;for(let l=0;l<o.footprintSegLen;l++){const d=this.footprintSegments[o.footprintSegIdx+l];let g=0;for(const v of d.ringIndices){for(let b=g,S=v+g-1;b<v+g;S=b++){const I=this.footprintVertices.int16[2*(b+d.vertexOffset)+0],D=this.footprintVertices.int16[2*(b+d.vertexOffset)+1],F=this.footprintVertices.int16[2*(S+d.vertexOffset)+1];D>n!=F>n&&e<(this.footprintVertices.int16[2*(S+d.vertexOffset)+0]-I)*(n-D)/(F-D)+I&&(a=!a)}g=v}}return a}getHeightAtTileCoord(e,n){let o=Number.NEGATIVE_INFINITY,a=!0;const l=4*(e+Jt)*Jt+(n+Jt);if(this.partLookup.hasOwnProperty(l)){const d=this.partLookup[l];return d?{height:d.height,hidden:!!(d.flags&Tc)}:void 0}for(const d of this.centroidData)e>d.max.x||d.min.x>e||n>d.max.y||d.min.y>n||this.footprintContainsPoint(e,n,d)&&d&&d.height>o&&(o=d.height,this.partLookup[l]=d,a=!!(d.flags&Tc));if(o!==Number.NEGATIVE_INFINITY)return{height:o,hidden:a};this.partLookup[l]=void 0}}function Hb(t,e){const n=t.add(e)._unit();return t.x*n.x+t.y*n.y}function mI(t,e,n,o){const a=e.sub(t)._perp()._unit(),l=n.sub(e)._perp()._unit();return qb(t,e,n,Hb(a,l),o)}function qb(t,e,n,o,a){const l=Math.sqrt(1-o*o);return Math.min(t.dist(e)/3,e.dist(n)/3,a*l/o)}function _y(t,e,n){return t.x<n[0].x&&e.x<n[0].x||t.x>n[1].x&&e.x>n[1].x||t.y<n[0].y&&e.y<n[0].y||t.y>n[1].y&&e.y>n[1].y}function Wb(t,e){return t.x<e[0].x||t.x>e[1].x||t.y<e[0].y||t.y>e[1].y}function Zb(t,e,n){if(t.x<0||t.x>=Jt||e.x<0||e.x>=Jt||n.x<0||n.x>=Jt)return!1;const o=n.sub(e),a=o.perp(),l=t.sub(e);return(o.x*l.x+o.y*l.y)/Math.sqrt((o.x*o.x+o.y*o.y)*(l.x*l.x+l.y*l.y))>-.866&&a.x*l.x+a.y*l.y<0}function Yb(t,e,n){const o=e?2|t:-3&t;return n?1|o:-2&o}function Xb(){const t=Math.PI/32,e=Math.tan(t),n=at;return n*Math.sqrt(1+2*e*e)-n}function Kb(t,e,n){const o=1<<n.z,a=Fn(n.x/o),l=Fn((n.x+1)/o),d=_r(n.y/o),g=_r((n.y+1)/o);return function(v,b,S,I,D=0,F){const N=[];if(!v.length||!S||!I)return N;const V=(ge,Ie)=>{for(const Ne of ge)N.push({polygon:Ne,bounds:Ie})},q=Math.ceil(Math.log2(S)),Y=Math.ceil(Math.log2(I)),oe=q-Y,le=[];for(let ge=0;ge<Math.abs(oe);ge++)le.push(oe>0?0:1);for(let ge=0;ge<Math.min(q,Y);ge++)le.push(0),le.push(1);let ae=v;if(ae=Rm(ae,b[0].y-D,b[1].y+D,1),ae=Rm(ae,b[0].x-D,b[1].x+D,0),!ae.length)return N;const be=[];for(le.length?be.push({polygons:ae,bounds:b,depth:0}):V(ae,b);be.length;){const ge=be.pop(),Ie=ge.depth,Ne=le[Ie],Ge=ge.bounds[0],tt=ge.bounds[1],qe=Ne===0?Ge.x:Ge.y,_t=Ne===0?tt.x:tt.y,Et=F?F(Ne,qe,_t):.5*(qe+_t),ct=Rm(ge.polygons,qe-D,Et+D,Ne),wt=Rm(ge.polygons,Et-D,_t+D,Ne);if(ct.length){const st=[Ge,new ve(Ne===0?Et:tt.x,Ne===1?Et:tt.y)];le.length>Ie+1?be.push({polygons:ct,bounds:st,depth:Ie+1}):V(ct,st)}if(wt.length){const st=[new ve(Ne===0?Et:Ge.x,Ne===1?Et:Ge.y),tt];le.length>Ie+1?be.push({polygons:wt,bounds:st,depth:Ie+1}):V(wt,st)}}return N}(t,e,Math.ceil((l-a)/11.25),Math.ceil((d-g)/11.25),1,(v,b,S)=>{if(v===0)return .5*(b+S);{const I=_r((n.y+b/Jt)/o);return(kn(.5*(_r((n.y+S/Jt)/o)+I))*o-n.y)*Jt}})}function _I(t,e,n,o,a,l){const d=Math.pow(2,o.z-a.z);for(let g=0;g<n;g++){let v=t.int16[2*(g+e)+0],b=t.int16[2*(g+e)+1];v=(v+a.x*Jt)*d-o.x*Jt,b=(b+a.y*Jt)*d-o.y*Jt,l.push(new ve(v,b))}}sn(Bm,"FillExtrusionBucket",{omit:["layers","features"]}),sn(Vb,"PartData"),sn(jb,"FootprintSegment"),sn(Ub,"BorderCentroidData"),sn(Gb,"GroundEffect");const gI=new pi({visibility:new Nt(Je["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Nt(Je["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var yI={paint:new pi({"fill-extrusion-opacity":new Nt(Je["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new wn(Je["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Nt(Je["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Nt(Je["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new wn(Je["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new wn(Je["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new wn(Je["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Nt(Je["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Nt(Je["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Nt(Je["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Nt(Je["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Nt(Je["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Nt(Je["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Nt(Je["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Nt(Je["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new wn(Je["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new wn(Je["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Nt(Je["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Nt(Je["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Nt(Je["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Nt(Je["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Nt(Je["paint_fill-extrusion"]["fill-extrusion-emissive-strength"])}),layout:gI};class Hh extends ve{constructor(e,n,o){super(e,n),this.z=o}}function Lf(t,e){return t.x*e.x+t.y*e.y}function Jb(t,e){if(t.length===1){let n=0;const o=e[n++];let a;for(;!a||o.equals(a);)if(a=e[n++],!a)return 1/0;for(;n<e.length;n++){const l=e[n],d=t[0],g=a.sub(o),v=l.sub(o),b=d.sub(o),S=Lf(g,g),I=Lf(g,v),D=Lf(v,v),F=Lf(b,g),N=Lf(b,v),V=S*D-I*I,q=(D*F-I*N)/V,Y=(S*N-I*F)/V,oe=o.z*(1-q-Y)+a.z*q+l.z*Y;if(isFinite(oe))return oe}return 1/0}{let n=1/0;for(const o of e)n=Math.min(n,o.z);return n}}function Qb(t,e,n,o,a,l,d,g){const v=d*a.getElevationAt(t,e,!0,!0),b=l[0]!==0,S=b?l[1]===0?d*(l[0]/7-450):d*function(I,D,F){const N=Math.floor(D[0]/8),V=Math.floor(D[1]/8),q=10*(D[0]-8*N),Y=10*(D[1]-8*V),oe=I.getElevationAt(N,V,!0,!0),le=I.getMeterToDEM(F),ae=Math.floor(.5*(q*le-1)),be=Math.floor(.5*(Y*le-1)),ge=I.tileCoordToPixel(N,V),Ie=2*ae+1,Ne=2*be+1,Ge=function(wt,st,bt,$t,St){return[wt.getElevationAtPixel(st,bt,!0),wt.getElevationAtPixel(st+St,bt,!0),wt.getElevationAtPixel(st,bt+St,!0),wt.getElevationAtPixel(st+$t,bt+St,!0)]}(I,ge.x-ae,ge.y-be,Ie,Ne),tt=Math.abs(Ge[0]-Ge[1]),qe=Math.abs(Ge[2]-Ge[3]),_t=Math.abs(Ge[0]-Ge[2])+Math.abs(Ge[1]-Ge[3]),Et=Math.min(.25,.5*le*(tt+qe)/Ie),ct=Math.min(.25,.5*le*_t/Ne);return oe+Math.max(Et*q,ct*Y)}(a,l,g):v;return{base:v+(n===0)?-1:n,top:b?Math.max(S+o,v+n+2):v+o}}const vI=jr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:xI}=vI,bI=jr([{name:"a_packed",components:4,type:"Float32"}]),{members:wI}=bI;class e1{constructor(e,n){this.width=e,this.height=n,this.nextRow=0,this.image=new bc({width:e,height:n}),this.positions={},this.uploaded=!1}getDash(e,n){const o=this.getKey(e,n);return this.positions[o]}trim(){const e=this.width,n=this.height=zr(this.nextRow);this.image.resize({width:e,height:n})}getKey(e,n){return e.join(",")+n}getDashRanges(e,n,o){const a=[];let l=e.length%2==1?-e[e.length-1]*o:0,d=e[0]*o,g=!0;a.push({left:l,right:d,isDash:g,zeroLength:e[0]===0});let v=e[0];for(let b=1;b<e.length;b++){g=!g;const S=e[b];l=v*o,v+=S,d=v*o,a.push({left:l,right:d,isDash:g,zeroLength:S===0})}return a}addRoundDash(e,n,o){const a=n/2;for(let l=-o;l<=o;l++){const d=this.width*(this.nextRow+o+l);let g=0,v=e[g];for(let b=0;b<this.width;b++){b/v.right>1&&(v=e[++g]);const S=Math.abs(b-v.left),I=Math.abs(b-v.right),D=Math.min(S,I);let F;const N=l/o*(a+1);if(v.isDash){const V=a-Math.abs(N);F=Math.sqrt(D*D+V*V)}else F=a-Math.sqrt(D*D+N*N);this.image.data[d+b]=Math.max(0,Math.min(255,F+128))}}}addRegularDash(e,n){for(let v=e.length-1;v>=0;--v){const b=e[v],S=e[v+1];b.zeroLength?e.splice(v,1):S&&S.isDash===b.isDash&&(S.left=b.left,e.splice(v,1))}const o=e[0],a=e[e.length-1];o.isDash===a.isDash&&(o.left=a.left-this.width,a.right=o.right+this.width);const l=this.width*this.nextRow;let d=0,g=e[d];for(let v=0;v<this.width;v++){v/g.right>1&&(g=e[++d]);const b=Math.abs(v-g.left),S=Math.abs(v-g.right),I=Math.min(b,S);this.image.data[l+v]=Math.max(0,Math.min(255,(g.isDash?I:-I)+n+128))}}addDash(e,n){const o=this.getKey(e,n);if(this.positions[o])return this.positions[o];const a=n==="round",l=a?7:0,d=2*l+1;if(this.nextRow+d>this.height)return Re("LineAtlas out of space"),null;e.length===0&&e.push(1);let g=0;for(let S=0;S<e.length;S++)e[S]<0&&(Re("Negative value is found in line dasharray, replacing values with 0"),e[S]=0),g+=e[S];if(g!==0){const S=this.width/g,I=this.getDashRanges(e,this.width,S);a?this.addRoundDash(I,S,l):this.addRegularDash(I,n==="square"?.5*S:0)}const v=this.nextRow+l;this.nextRow+=d;const b={tl:[v,l],br:[g,0]};return this.positions[o]=b,b}}sn(e1,"LineAtlas");const TI=Om.types,EI=Math.cos(Math.PI/180*37.5);class gy{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.fqid),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new ff,this.layoutVertexArray2=new tl,this.indexArray=new eo,this.programConfigurations=new K(e.layers,e.zoom),this.segments=new Ii,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,o,a){this.hasPattern=dy("line",this.layers,n);const l=this.layers[0].layout.get("line-sort-key"),d=[];for(const{feature:S,id:I,index:D,sourceLayerIndex:F}of e){const N=this.layers[0]._featureFilter.needGeometry,V=qi(S,N);if(!this.layers[0]._featureFilter.filter(new fi(this.zoom),V,o))continue;const q=l?l.evaluate(V,{},o):void 0,Y={id:I,properties:S.properties,type:S.type,sourceLayerIndex:F,index:D,geometry:N?V.geometry:no(S,o,a),patterns:{},sortKey:q};d.push(Y)}l&&d.sort((S,I)=>S.sortKey-I.sortKey);const{lineAtlas:g,featureIndex:v}=n,b=this.addConstantDashes(g);for(const S of d){const{geometry:I,index:D,sourceLayerIndex:F}=S;if(b&&this.addFeatureDashes(S,g),this.hasPattern){const N=fy("line",this.layers,S,this.zoom,n);this.patternFeatures.push(N)}else this.addFeature(S,I,D,o,g.positions,n.availableImages,n.brightness);v.insert(e[D].feature,I,D,F,this.index)}}addConstantDashes(e){let n=!1;for(const o of this.layers){const a=o.paint.get("line-dasharray").value,l=o.layout.get("line-cap").value;if(a.kind!=="constant"||l.kind!=="constant")n=!0;else{const d=l.value,g=a.value;if(!g)continue;e.addDash(g,d)}}return n}addFeatureDashes(e,n){const o=this.zoom;for(const a of this.layers){const l=a.paint.get("line-dasharray").value,d=a.layout.get("line-cap").value;if(l.kind==="constant"&&d.kind==="constant")continue;let g,v;if(l.kind==="constant"){if(g=l.value,!g)continue}else g=l.evaluate({zoom:o},e);v=d.kind==="constant"?d.value:d.evaluate({zoom:o},e),n.addDash(g,v),e.patterns[a.id]=n.getKey(g,v)}}update(e,n,o,a,l){const d=Object.keys(e).length!==0;d&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,n,d?this.stateDependentLayers:this.layers,o,a,l)}addFeatures(e,n,o,a,l,d){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,n,o,a,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,wI)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,xI),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,n,o,a,l,d,g){const v=this.layers[0].layout,b=v.get("line-join").evaluate(e,{}),S=v.get("line-cap").evaluate(e,{}),I=v.get("line-miter-limit"),D=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const F of n)this.addLine(F,e,b,S,I,D);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,l,d,a,g)}addLine(e,n,o,a,l,d){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Y=0;Y<e.length-1;Y++)this.totalDistance+=e[Y].dist(e[Y+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const g=TI[n.type]==="Polygon";let v=e.length;for(;v>=2&&e[v-1].equals(e[v-2]);)v--;let b=0;for(;b<v-1&&e[b].equals(e[b+1]);)b++;if(v<(g?3:2))return;o==="bevel"&&(l=1.05);const S=this.overscaling<=16?15*Jt/(512*this.overscaling):0,I=this.segments.prepareSegment(10*v,this.layoutVertexArray,this.indexArray);let D,F,N,V,q;this.e1=this.e2=-1,g&&(D=e[v-2],q=e[b].sub(D)._unit()._perp());for(let Y=b;Y<v;Y++){if(N=Y===v-1?g?e[b+1]:void 0:e[Y+1],N&&e[Y].equals(N))continue;q&&(V=q),D&&(F=D),D=e[Y],q=N?N.sub(D)._unit()._perp():V,V=V||q;let oe=V.add(q);oe.x===0&&oe.y===0||oe._unit();const le=V.x*q.x+V.y*q.y,ae=oe.x*q.x+oe.y*q.y,be=ae!==0?1/ae:1/0,ge=2*Math.sqrt(2-2*ae),Ie=ae<EI&&F&&N,Ne=V.x*q.y-V.y*q.x>0;if(Ie&&Y>b){const qe=D.dist(F);if(qe>2*S){const _t=D.sub(D.sub(F)._mult(S/qe)._round());this.updateDistance(F,_t),this.addCurrentVertex(_t,V,0,0,I),F=_t}}const Ge=F&&N;let tt=Ge?o:g?"butt":a;if(Ge&&tt==="round"&&(be<d?tt="miter":be<=2&&(tt="fakeround")),tt==="miter"&&be>l&&(tt="bevel"),tt==="bevel"&&(be>2&&(tt="flipbevel"),be<l&&(tt="miter")),F&&this.updateDistance(F,D),tt==="miter")oe._mult(be),this.addCurrentVertex(D,oe,0,0,I);else if(tt==="flipbevel"){if(be>100)oe=q.mult(-1);else{const qe=be*V.add(q).mag()/V.sub(q).mag();oe._perp()._mult(qe*(Ne?-1:1))}this.addCurrentVertex(D,oe,0,0,I),this.addCurrentVertex(D,oe.mult(-1),0,0,I)}else if(tt==="bevel"||tt==="fakeround"){const qe=-Math.sqrt(be*be-1),_t=Ne?qe:0,Et=Ne?0:qe;if(F&&this.addCurrentVertex(D,V,_t,Et,I),tt==="fakeround"){const ct=Math.round(180*ge/Math.PI/20);for(let wt=1;wt<ct;wt++){let st=wt/ct;if(st!==.5){const $t=st-.5;st+=st*$t*(st-1)*((1.0904+le*(le*(3.55645-1.43519*le)-3.2452))*$t*$t+(.848013+le*(.215638*le-1.06021)))}const bt=q.sub(V)._mult(st)._add(V)._unit()._mult(Ne?-1:1);this.addHalfVertex(D,bt.x,bt.y,!1,Ne,0,I)}}N&&this.addCurrentVertex(D,q,-_t,-Et,I)}else if(tt==="butt")this.addCurrentVertex(D,oe,0,0,I);else if(tt==="square"){const qe=F?1:-1;F||this.addCurrentVertex(D,oe,qe,qe,I),this.addCurrentVertex(D,oe,0,0,I),F&&this.addCurrentVertex(D,oe,qe,qe,I)}else tt==="round"&&(F&&(this.addCurrentVertex(D,V,0,0,I),this.addCurrentVertex(D,V,1,1,I,!0)),N&&(this.addCurrentVertex(D,q,-1,-1,I,!0),this.addCurrentVertex(D,q,0,0,I)));if(Ie&&Y<v-1){const qe=D.dist(N);if(qe>2*S){const _t=D.add(N.sub(D)._mult(S/qe)._round());this.updateDistance(D,_t),this.addCurrentVertex(_t,q,0,0,I),D=_t}}}}addCurrentVertex(e,n,o,a,l,d=!1){const g=n.y*a-n.x,v=-n.y-n.x*a;this.addHalfVertex(e,n.x+n.y*o,n.y-n.x*o,d,!1,o,l),this.addHalfVertex(e,g,v,d,!0,-a,l)}addHalfVertex({x:e,y:n},o,a,l,d,g,v){this.layoutVertexArray.emplaceBack((e<<1)+(l?1:0),(n<<1)+(d?1:0),Math.round(63*o)+128,Math.round(63*a)+128,1+(g===0?0:g<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const b=v.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,b),v.primitiveLength++),d?this.e2=b:this.e1=b}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,n){this.distance+=e.dist(n),this.updateScaledDistance()}}sn(gy,"LineBucket",{omit:["layers","patternFeatures"]});const SI=new pi({"line-cap":new wn(Je.layout_line["line-cap"]),"line-join":new wn(Je.layout_line["line-join"]),"line-miter-limit":new Nt(Je.layout_line["line-miter-limit"]),"line-round-limit":new Nt(Je.layout_line["line-round-limit"]),"line-sort-key":new wn(Je.layout_line["line-sort-key"]),visibility:new Nt(Je.layout_line.visibility)});var t1={paint:new pi({"line-opacity":new wn(Je.paint_line["line-opacity"]),"line-color":new wn(Je.paint_line["line-color"]),"line-translate":new Nt(Je.paint_line["line-translate"]),"line-translate-anchor":new Nt(Je.paint_line["line-translate-anchor"]),"line-width":new wn(Je.paint_line["line-width"]),"line-gap-width":new wn(Je.paint_line["line-gap-width"]),"line-offset":new wn(Je.paint_line["line-offset"]),"line-blur":new wn(Je.paint_line["line-blur"]),"line-dasharray":new wn(Je.paint_line["line-dasharray"]),"line-pattern":new wn(Je.paint_line["line-pattern"]),"line-gradient":new Dl(Je.paint_line["line-gradient"]),"line-trim-offset":new Nt(Je.paint_line["line-trim-offset"]),"line-emissive-strength":new Nt(Je.paint_line["line-emissive-strength"]),"line-border-width":new wn(Je.paint_line["line-border-width"]),"line-border-color":new wn(Je.paint_line["line-border-color"])}),layout:SI};function n1(t,e,n){return e*(Jt/(t.tileSize*Math.pow(2,n-t.tileID.overscaledZ)))}function r1(t,e){return 1/n1(t,1,e.tileZoom)}function i1(t,e,n,o){return t.translatePosMatrix(o||e.tileID.projMatrix,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const o1=t=>{const e=[];s1(t)&&e.push("RENDER_LINE_DASH"),t.paint.get("line-gradient")&&e.push("RENDER_LINE_GRADIENT");const n=t.paint.get("line-trim-offset");return n[0]===0&&n[1]===0||e.push("RENDER_LINE_TRIM_OFFSET"),t.paint.get("line-border-width").constantOr(1)!==0&&e.push("RENDER_LINE_BORDER"),e};function s1(t){const e=t.paint.get("line-dasharray").value;return e.value||e.kind!=="constant"}const a1=new class extends wn{possiblyEvaluate(t,e){return e=new fi(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,n,o){return e=Or({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,n,o)}}(t1.paint.properties["line-width"].specification);function l1(t,e){return e>0?e+2*t:t}a1.useIntegerZoom=!0;const MI=jr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),AI=jr([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),II=jr([{name:"a_projected_pos",components:4,type:"Float32"}],4);jr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const CI=jr([{name:"a_z_offset",components:1,type:"Float32"}],4),PI=jr([{name:"a_texb",components:2,type:"Uint16"}]),DI=jr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),kI=jr([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_z_offset",components:1,type:"Float32"}]);jr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const c1=jr([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),OI=jr([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);jr([{name:"triangle",components:3,type:"Uint16"}]),jr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),jr([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),jr([{type:"Float32",name:"offsetX"}]),jr([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var bo=24;const Ia=128;function yy(t,e){const{expression:n}=e;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new fi(t+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:o,interpolationType:a}=n;let l=0;for(;l<o.length&&o[l]<=t;)l++;l=Math.max(0,l-1);let d=l;for(;d<o.length&&o[d]<t+1;)d++;d=Math.min(o.length-1,d);const g=o[l],v=o[d];return n.kind==="composite"?{kind:"composite",minZoom:g,maxZoom:v,interpolationType:a}:{kind:"camera",minZoom:g,maxZoom:v,minSize:n.evaluate(new fi(g)),maxSize:n.evaluate(new fi(v)),interpolationType:a}}}function Nm(t,{uSize:e,uSizeT:n},{lowerSize:o,upperSize:a}){return t.kind==="source"?o/Ia:t.kind==="composite"?Zn(o/Ia,a/Ia,n):e}function qh(t,e){let n=0,o=0;if(t.kind==="constant")o=t.layoutSize;else if(t.kind!=="source"){const{interpolationType:a,minZoom:l,maxZoom:d}=t,g=a?vt(lo.interpolationFactor(a,e,l,d),0,1):0;t.kind==="camera"?o=Zn(t.minSize,t.maxSize,g):n=g}return{uSizeT:n,uSize:o}}var RI=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Ia,evaluateSizeForFeature:Nm,evaluateSizeForZoom:qh,getSizeData:yy});function LI(t,e,n){return t.sections.forEach(o=>{o.text=function(a,l,d){const g=l.layout.get("text-transform").evaluate(d,{});return g==="uppercase"?a=a.toLocaleUpperCase():g==="lowercase"&&(a=a.toLocaleLowerCase()),rs.applyArabicShaping&&(a=rs.applyArabicShaping(a)),a}(o.text,e,n)}),t}const zf={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function zI(t){return t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""}function FI(t){return t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""||t===""}var BI={read:function(t,e,n,o,a){var l,d,g=8*a-o-1,v=(1<<g)-1,b=v>>1,S=-7,I=n?a-1:0,D=n?-1:1,F=t[e+I];for(I+=D,l=F&(1<<-S)-1,F>>=-S,S+=g;S>0;l=256*l+t[e+I],I+=D,S-=8);for(d=l&(1<<-S)-1,l>>=-S,S+=o;S>0;d=256*d+t[e+I],I+=D,S-=8);if(l===0)l=1-b;else{if(l===v)return d?NaN:1/0*(F?-1:1);d+=Math.pow(2,o),l-=b}return(F?-1:1)*d*Math.pow(2,l-o)},write:function(t,e,n,o,a,l){var d,g,v,b=8*l-a-1,S=(1<<b)-1,I=S>>1,D=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,F=o?0:l-1,N=o?1:-1,V=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(g=isNaN(e)?1:0,d=S):(d=Math.floor(Math.log(e)/Math.LN2),e*(v=Math.pow(2,-d))<1&&(d--,v*=2),(e+=d+I>=1?D/v:D*Math.pow(2,1-I))*v>=2&&(d++,v/=2),d+I>=S?(g=0,d=S):d+I>=1?(g=(e*v-1)*Math.pow(2,a),d+=I):(g=e*Math.pow(2,I-1)*Math.pow(2,a),d=0));a>=8;t[n+F]=255&g,F+=N,g/=256,a-=8);for(d=d<<a|g,b+=a;b>0;t[n+F]=255&d,F+=N,d/=256,b-=8);t[n+F-N]|=128*V}},u1=ui,jm=BI;function ui(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}ui.Varint=0,ui.Fixed64=1,ui.Bytes=2,ui.Fixed32=5;var vy=4294967296,h1=1/vy,d1=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Nl(t){return t.type===ui.Bytes?t.readVarint()+t.pos:t.pos+1}function Wh(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function f1(t,e,n){var o=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(o);for(var a=n.pos-1;a>=t;a--)n.buf[a+o]=n.buf[a]}function NI(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function jI(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function VI(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function UI(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function $I(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function GI(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function HI(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function qI(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function WI(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function Vm(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Zh(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function p1(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}ui.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var o=this.readVarint(),a=o>>3,l=this.pos;this.type=7&o,t(a,e,this),this.pos===l&&this.skip(o)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Vm(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=p1(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Vm(this.buf,this.pos)+Vm(this.buf,this.pos+4)*vy;return this.pos+=8,t},readSFixed64:function(){var t=Vm(this.buf,this.pos)+p1(this.buf,this.pos+4)*vy;return this.pos+=8,t},readFloat:function(){var t=jm.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=jm.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,o=this.buf;return e=127&(n=o[this.pos++]),n<128?e:(e|=(127&(n=o[this.pos++]))<<7,n<128?e:(e|=(127&(n=o[this.pos++]))<<14,n<128?e:(e|=(127&(n=o[this.pos++]))<<21,n<128?e:function(a,l,d){var g,v,b=d.buf;if(g=(112&(v=b[d.pos++]))>>4,v<128||(g|=(127&(v=b[d.pos++]))<<3,v<128)||(g|=(127&(v=b[d.pos++]))<<10,v<128)||(g|=(127&(v=b[d.pos++]))<<17,v<128)||(g|=(127&(v=b[d.pos++]))<<24,v<128)||(g|=(1&(v=b[d.pos++]))<<31,v<128))return Wh(a,g,l);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=o[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&d1?function(n,o,a){return d1.decode(n.subarray(o,a))}(this.buf,e,t):function(n,o,a){for(var l="",d=o;d<a;){var g,v,b,S=n[d],I=null,D=S>239?4:S>223?3:S>191?2:1;if(d+D>a)break;D===1?S<128&&(I=S):D===2?(192&(g=n[d+1]))==128&&(I=(31&S)<<6|63&g)<=127&&(I=null):D===3?(v=n[d+2],(192&(g=n[d+1]))==128&&(192&v)==128&&((I=(15&S)<<12|(63&g)<<6|63&v)<=2047||I>=55296&&I<=57343)&&(I=null)):D===4&&(v=n[d+2],b=n[d+3],(192&(g=n[d+1]))==128&&(192&v)==128&&(192&b)==128&&((I=(15&S)<<18|(63&g)<<12|(63&v)<<6|63&b)<=65535||I>=1114112)&&(I=null)),I===null?(I=65533,D=1):I>65535&&(I-=65536,l+=String.fromCharCode(I>>>10&1023|55296),I=56320|1023&I),l+=String.fromCharCode(I),d+=D}return l}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==ui.Bytes)return t.push(this.readVarint(e));var n=Nl(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==ui.Bytes)return t.push(this.readSVarint());var e=Nl(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==ui.Bytes)return t.push(this.readBoolean());var e=Nl(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==ui.Bytes)return t.push(this.readFloat());var e=Nl(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==ui.Bytes)return t.push(this.readDouble());var e=Nl(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==ui.Bytes)return t.push(this.readFixed32());var e=Nl(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==ui.Bytes)return t.push(this.readSFixed32());var e=Nl(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==ui.Bytes)return t.push(this.readFixed64());var e=Nl(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==ui.Bytes)return t.push(this.readSFixed64());var e=Nl(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===ui.Varint)for(;this.buf[this.pos++]>127;);else if(e===ui.Bytes)this.pos=this.readVarint()+this.pos;else if(e===ui.Fixed32)this.pos+=4;else{if(e!==ui.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Zh(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Zh(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Zh(this.buf,-1&t,this.pos),Zh(this.buf,Math.floor(t*h1),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Zh(this.buf,-1&t,this.pos),Zh(this.buf,Math.floor(t*h1),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,n){var o,a;if(e>=0?(o=e%4294967296|0,a=e/4294967296|0):(a=~(-e/4294967296),4294967295^(o=~(-e%4294967296))?o=o+1|0:(o=0,a=a+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");n.realloc(10),function(l,d,g){g.buf[g.pos++]=127&l|128,l>>>=7,g.buf[g.pos++]=127&l|128,l>>>=7,g.buf[g.pos++]=127&l|128,l>>>=7,g.buf[g.pos++]=127&l|128,g.buf[g.pos]=127&(l>>>=7)}(o,0,n),function(l,d){var g=(7&l)<<4;d.buf[d.pos++]|=g|((l>>>=3)?128:0),l&&(d.buf[d.pos++]=127&l|((l>>>=7)?128:0),l&&(d.buf[d.pos++]=127&l|((l>>>=7)?128:0),l&&(d.buf[d.pos++]=127&l|((l>>>=7)?128:0),l&&(d.buf[d.pos++]=127&l|((l>>>=7)?128:0),l&&(d.buf[d.pos++]=127&l)))))}(a,n)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(!!t)},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(o,a,l){for(var d,g,v=0;v<a.length;v++){if((d=a.charCodeAt(v))>55295&&d<57344){if(!g){d>56319||v+1===a.length?(o[l++]=239,o[l++]=191,o[l++]=189):g=d;continue}if(d<56320){o[l++]=239,o[l++]=191,o[l++]=189,g=d;continue}d=g-55296<<10|d-56320|65536,g=null}else g&&(o[l++]=239,o[l++]=191,o[l++]=189,g=null);d<128?o[l++]=d:(d<2048?o[l++]=d>>6|192:(d<65536?o[l++]=d>>12|224:(o[l++]=d>>18|240,o[l++]=d>>12&63|128),o[l++]=d>>6&63|128),o[l++]=63&d|128)}return l}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&f1(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),jm.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),jm.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var o=this.pos-n;o>=128&&f1(n,o,this),this.pos=n-1,this.writeVarint(o),this.pos+=o},writeMessage:function(t,e,n){this.writeTag(t,ui.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,NI,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,jI,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,$I,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,VI,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,UI,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,GI,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,HI,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,qI,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,WI,e)},writeBytesField:function(t,e){this.writeTag(t,ui.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,ui.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,ui.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,ui.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,ui.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,ui.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,ui.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,ui.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,ui.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,ui.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,!!e)}};var Yh=ye(u1);const xy=3;function ZI(t,e,n){e.glyphs=[],t===1&&n.readMessage(YI,e)}function YI(t,e,n){if(t===3){const{id:o,bitmap:a,width:l,height:d,left:g,top:v,advance:b}=n.readMessage(XI,{});e.glyphs.push({id:o,bitmap:new bc({width:l+2*xy,height:d+2*xy},a),metrics:{width:l,height:d,left:g,top:v,advance:b}})}else t===4?e.ascender=n.readSVarint():t===5&&(e.descender=n.readSVarint())}function XI(t,e,n){t===1?e.id=n.readVarint():t===2?e.bitmap=n.readBytes():t===3?e.width=n.readVarint():t===4?e.height=n.readVarint():t===5?e.left=n.readSVarint():t===6?e.top=n.readSVarint():t===7&&(e.advance=n.readVarint())}const m1=xy,Ns={horizontal:1,vertical:2,horizontalOnly:3};class Ff{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,n){const o=new Ff;return o.scale=e||1,o.fontStack=n,o}static forImage(e){const n=new Ff;return n.imageName=e,n}}class Xh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,n){const o=new Xh;for(let a=0;a<e.sections.length;a++){const l=e.sections[a];l.image?o.addImageSection(l):o.addTextSection(l,n)}return o}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCodePoint(e){return this.text.codePointAt(e)}verticalizePunctuation(e){this.text=function(n,o){let a="";for(let l=0;l<n.length;l++){const d=n.charCodeAt(l+1)||null,g=n.charCodeAt(l-1)||null;a+=!o&&(d&&Zp(d)&&!zf[n[l+1]]||g&&Zp(g)&&!zf[n[l-1]])||!zf[n[l]]?n[l]:zf[n[l]]}return a}(this.text,e)}trim(){let e=0;for(let o=0;o<this.text.length&&Um[this.text.charCodeAt(o)];o++)e++;let n=this.text.length;for(let o=this.text.length-1;o>=0&&o>=e&&Um[this.text.charCodeAt(o)];o--)n--;this.text=this.text.substring(e,n),this.sectionIndex=this.sectionIndex.slice(e,n)}substring(e,n){const o=new Xh;return o.text=this.text.substring(e,n),o.sectionIndex=this.sectionIndex.slice(e,n),o.sections=this.sections,o}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,n)=>Math.max(e,this.sections[n].scale),0)}addTextSection(e,n){this.text+=e.text,this.sections.push(Ff.forText(e.scale,e.fontStack||n));const o=this.sections.length-1;for(let a=0;a<e.text.length;++a)this.sectionIndex.push(o)}addImageSection(e){const n=e.image?e.image.namePrimary:"";if(n.length===0)return void Re("Can't add FormattedSection with an empty image.");const o=this.getNextImageSectionCharCode();o?(this.text+=String.fromCodePoint(o),this.sections.push(Ff.forImage(n)),this.sectionIndex.push(this.sections.length-1)):Re("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function by(t,e,n,o,a,l,d,g,v,b,S,I,D,F,N){const V=Xh.fromFeature(t,a);I===Ns.vertical&&V.verticalizePunctuation(D);let q=[];const Y=function(ge,Ie,Ne,Ge,tt,qe){if(!ge)return[];const _t=[],Et=function(bt,$t,St,cn,rn,Dt){let An=0;for(let _n=0;_n<bt.length();_n++){const ln=bt.getSection(_n);An+=_1(bt.getCodePoint(_n),ln,cn,rn,$t,Dt)}return An/Math.max(1,Math.ceil(An/St))}(ge,Ie,Ne,Ge,tt,qe),ct=ge.text.indexOf("")>=0;let wt=0;for(let bt=0;bt<ge.length();bt++){const $t=ge.getSection(bt),St=ge.getCodePoint(bt);if(Um[St]||(wt+=_1(St,$t,Ge,tt,Ie,qe)),bt<ge.length()-1){const cn=!((st=St)<11904||!(hn["Bopomofo Extended"](st)||hn.Bopomofo(st)||hn["CJK Compatibility Forms"](st)||hn["CJK Compatibility Ideographs"](st)||hn["CJK Compatibility"](st)||hn["CJK Radicals Supplement"](st)||hn["CJK Strokes"](st)||hn["CJK Symbols and Punctuation"](st)||hn["CJK Unified Ideographs Extension A"](st)||hn["CJK Unified Ideographs"](st)||hn["Enclosed CJK Letters and Months"](st)||hn["Halfwidth and Fullwidth Forms"](st)||hn.Hiragana(st)||hn["Ideographic Description Characters"](st)||hn["Kangxi Radicals"](st)||hn["Katakana Phonetic Extensions"](st)||hn.Katakana(st)||hn["Vertical Forms"](st)||hn["Yi Radicals"](st)||hn["Yi Syllables"](st)));(KI[St]||cn||$t.imageName)&&_t.push(y1(bt+1,wt,Et,_t,JI(St,ge.getCodePoint(bt+1),cn&&ct),!1))}}var st;return v1(y1(ge.length(),wt,Et,_t,0,!0))}(V,b,l,e,o,F),{processBidirectionalText:oe,processStyledBidirectionalText:le}=rs;if(oe&&V.sections.length===1){const ge=oe(V.toString(),Y);for(const Ie of ge){const Ne=new Xh;Ne.text=Ie,Ne.sections=V.sections;for(let Ge=0;Ge<Ie.length;Ge++)Ne.sectionIndex.push(0);q.push(Ne)}}else if(le){const ge=le(V.text,V.sectionIndex,Y);for(const Ie of ge){const Ne=new Xh;Ne.text=Ie[0],Ne.sectionIndex=Ie[1],Ne.sections=V.sections,q.push(Ne)}}else q=function(ge,Ie){const Ne=[],Ge=ge.text;let tt=0;for(const qe of Ie)Ne.push(ge.substring(tt,qe)),tt=qe;return tt<Ge.length&&Ne.push(ge.substring(tt,Ge.length)),Ne}(V,Y);const ae=[],be={positionedLines:ae,text:V.toString(),top:S[1],bottom:S[1],left:S[0],right:S[0],writingMode:I,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ge,Ie,Ne,Ge,tt,qe,_t,Et,ct,wt,st,bt){let $t=0,St=0,cn=0;const rn=Et==="right"?1:Et==="left"?0:.5;let Dt=!1;for(const Kn of tt){const In=Kn.getSections();for(const Jn of In){if(Jn.imageName)continue;const On=Ie[Jn.fontStack];if(On&&(Dt=On.ascender!==void 0&&On.descender!==void 0,!Dt))break}if(!Dt)break}let An=0;for(const Kn of tt){Kn.trim();const In=Kn.getMaxScale(),Jn=(In-1)*bo,On={positionedGlyphs:[],lineOffset:0};ge.positionedLines[An]=On;const pr=On.positionedGlyphs;let jn=0;if(!Kn.length()){St+=qe,++An;continue}let Wr=0,Ir=0;for(let Br=0;Br<Kn.length();Br++){const Cr=Kn.getSection(Br),hi=Kn.getSectionIndex(Br),Ur=Kn.getCodePoint(Br);let Ci=Cr.scale,Ki=null,yo=null,ai=null,gi=bo,ho=0;const fo=!(ct===Ns.horizontal||!st&&!Xd(Ur)||st&&(Um[Ur]||(_n=Ur,hn.Arabic(_n)||hn["Arabic Supplement"](_n)||hn["Arabic Extended-A"](_n)||hn["Arabic Presentation Forms-A"](_n)||hn["Arabic Presentation Forms-B"](_n))));if(Cr.imageName){const po=Ge[Cr.imageName];if(!po)continue;ai=Cr.imageName,ge.iconsInText=ge.iconsInText||!0,yo=po.paddedRect;const ei=po.displaySize;Ci=Ci*bo/bt,Ki={width:ei[0],height:ei[1],left:0,top:-m1,advance:fo?ei[1]:ei[0],localGlyph:!1},ho=Dt?-Ki.height*Ci:In*bo-17-ei[1]*Ci,gi=Ki.advance;const fs=(fo?ei[0]:ei[1])*Ci-bo*In;fs>0&&fs>jn&&(jn=fs)}else{const po=Ne[Cr.fontStack];if(!po)continue;po[Ur]&&(yo=po[Ur]);const ei=Ie[Cr.fontStack];if(!ei)continue;const fs=ei.glyphs[Ur];if(!fs)continue;if(Ki=fs.metrics,gi=Ur!==8203?bo:0,Dt){const Pc=ei.ascender!==void 0?Math.abs(ei.ascender):0,Xo=ei.descender!==void 0?Math.abs(ei.descender):0,Bo=(Pc+Xo)*Ci;Wr<Bo&&(Wr=Bo,Ir=(Pc-Xo)/2*Ci),ho=-Pc*Ci}else ho=(In-Ci)*bo-17}fo?(ge.verticalizable=!0,pr.push({glyph:Ur,imageName:ai,x:$t,y:St+ho,vertical:fo,scale:Ci,localGlyph:Ki.localGlyph,fontStack:Cr.fontStack,sectionIndex:hi,metrics:Ki,rect:yo}),$t+=gi*Ci+wt):(pr.push({glyph:Ur,imageName:ai,x:$t,y:St+ho,vertical:fo,scale:Ci,localGlyph:Ki.localGlyph,fontStack:Cr.fontStack,sectionIndex:hi,metrics:Ki,rect:yo}),$t+=Ki.advance*Ci+wt)}pr.length!==0&&(cn=Math.max($t-wt,cn),Dt?x1(pr,rn,jn,Ir,qe*In/2):x1(pr,rn,jn,0,qe/2)),$t=0;const kr=qe*In+jn;On.lineOffset=Math.max(jn,Jn),St+=kr,++An}var _n;const ln=St,{horizontalAlign:kt,verticalAlign:Tn}=wy(_t);(function(Kn,In,Jn,On,pr,jn){const Wr=(In-Jn)*pr,Ir=-jn*On;for(const kr of Kn)for(const Br of kr.positionedGlyphs)Br.x+=Wr,Br.y+=Ir})(ge.positionedLines,rn,kt,Tn,cn,ln),ge.top+=-Tn*ln,ge.bottom=ge.top+ln,ge.left+=-kt*cn,ge.right=ge.left+cn,ge.hasBaseline=Dt}(be,e,n,o,q,d,g,v,I,b,D,N),!function(ge){for(const Ie of ge)if(Ie.positionedGlyphs.length!==0)return!1;return!0}(ae)&&be}const Um={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},KI={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function _1(t,e,n,o,a,l){if(e.imageName){const d=o[e.imageName];return d?d.displaySize[0]*e.scale*bo/l+a:0}{const d=n[e.fontStack],g=d&&d.glyphs[t];return g?g.metrics.advance*e.scale+a:0}}function g1(t,e,n,o){const a=Math.pow(t-e,2);return o?t<e?a/2:2*a:a+Math.abs(n)*n}function JI(t,e,n){let o=0;return t===10&&(o-=1e4),n&&(o+=150),t!==40&&t!==65288||(o+=50),e!==41&&e!==65289||(o+=50),o}function y1(t,e,n,o,a,l){let d=null,g=g1(e,n,a,l);for(const v of o){const b=g1(e-v.x,n,a,l)+v.badness;b<=g&&(d=v,g=b)}return{index:t,x:e,priorBreak:d,badness:g}}function v1(t){return t?v1(t.priorBreak).concat(t.index):[]}function wy(t){let e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function x1(t,e,n,o,a){if(!(e||n||o||a))return;const l=t.length-1,d=t[l],g=(d.x+d.metrics.advance*d.scale)*e;for(let v=0;v<=l;v++)t[v].x-=g,t[v].y+=n+o+a}function QI(t,e,n,o){const{horizontalAlign:a,verticalAlign:l}=wy(o),d=n[0]-t.displaySize[0]*a,g=n[1]-t.displaySize[1]*l;return{imagePrimary:t,imageSecondary:e,top:g,bottom:g+t.displaySize[1],left:d,right:d+t.displaySize[0]}}function b1(t,e,n,o,a,l){const d=t.imagePrimary;let g;if(d.content){const q=d.content,Y=d.pixelRatio||1;g=[q[0]/Y,q[1]/Y,d.displaySize[0]-q[2]/Y,d.displaySize[1]-q[3]/Y]}const v=e.left*l,b=e.right*l;let S,I,D,F;n==="width"||n==="both"?(F=a[0]+v-o[3],I=a[0]+b+o[1]):(F=a[0]+(v+b-d.displaySize[0])/2,I=F+d.displaySize[0]);const N=e.top*l,V=e.bottom*l;return n==="height"||n==="both"?(S=a[1]+N-o[0],D=a[1]+V+o[2]):(S=a[1]+(N+V-d.displaySize[1])/2,D=S+d.displaySize[1]),{imagePrimary:d,imageSecondary:void 0,top:S,right:I,bottom:D,left:F,collisionPadding:g}}class jl extends ve{constructor(e,n,o,a,l){super(e,n),this.angle=a,this.z=o,l!==void 0&&(this.segment=l)}clone(){return new jl(this.x,this.y,this.z,this.angle,this.segment)}}function w1(t,e,n,o,a){if(e.segment===void 0)return!0;let l=e,d=e.segment+1,g=0;for(;g>-n/2;){if(d--,d<0)return!1;g-=t[d].dist(l),l=t[d]}g+=t[d].dist(t[d+1]),d++;const v=[];let b=0;for(;g<n/2;){const S=t[d],I=t[d+1];if(!I)return!1;let D=t[d-1].angleTo(S)-S.angleTo(I);for(D=Math.abs((D+3*Math.PI)%(2*Math.PI)-Math.PI),v.push({distance:g,angleDelta:D}),b+=D;g-v[0].distance>o;)b-=v.shift().angleDelta;if(b>a)return!1;d++,g+=S.dist(I)}return!0}function T1(t){let e=0;for(let n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function E1(t,e,n){return t?.6*e*n:0}function S1(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function eC(t,e,n,o,a,l){const d=E1(n,a,l),g=S1(n,o)*l;let v=0;const b=T1(t)/2;for(let S=0;S<t.length-1;S++){const I=t[S],D=t[S+1],F=I.dist(D);if(v+F>b){const N=(b-v)/F,V=Zn(I.x,D.x,N),q=Zn(I.y,D.y,N),Y=new jl(V,q,0,D.angleTo(I),S);return!d||w1(t,Y,g,d,e)?Y:void 0}v+=F}}function tC(t,e,n,o,a,l,d,g,v){const b=E1(o,l,d),S=S1(o,a),I=S*d,D=t[0].x===0||t[0].x===v||t[0].y===0||t[0].y===v;return e-I<e/4&&(e=I+e/4),M1(t,D?e/2*g%e:(S/2+2*l)*d*g%e,e,b,n,I,D,!1,v)}function M1(t,e,n,o,a,l,d,g,v){const b=l/2,S=T1(t);let I=0,D=e-n,F=[];for(let N=0;N<t.length-1;N++){const V=t[N],q=t[N+1],Y=V.dist(q),oe=q.angleTo(V);for(;D+n<I+Y;){D+=n;const le=(D-I)/Y,ae=Zn(V.x,q.x,le),be=Zn(V.y,q.y,le);if(ae>=0&&ae<v&&be>=0&&be<v&&D-b>=0&&D+b<=S){const ge=new jl(ae,be,0,oe,N);o&&!w1(t,ge,l,o,a)||F.push(ge)}}I+=Y}return g||F.length||d||(F=M1(t,I/2,n,o,a,l,d,!0,v)),F}function A1(t,e,n,o,a){const l=[];for(let d=0;d<t.length;d++){const g=t[d];let v;for(let b=0;b<g.length-1;b++){let S=g[b],I=g[b+1];S.x<e&&I.x<e||(S.x<e?S=new ve(e,S.y+(e-S.x)/(I.x-S.x)*(I.y-S.y))._round():I.x<e&&(I=new ve(e,S.y+(e-S.x)/(I.x-S.x)*(I.y-S.y))._round()),S.y<n&&I.y<n||(S.y<n?S=new ve(S.x+(n-S.y)/(I.y-S.y)*(I.x-S.x),n)._round():I.y<n&&(I=new ve(S.x+(n-S.y)/(I.y-S.y)*(I.x-S.x),n)._round()),S.x>=o&&I.x>=o||(S.x>=o?S=new ve(o,S.y+(o-S.x)/(I.x-S.x)*(I.y-S.y))._round():I.x>=o&&(I=new ve(o,S.y+(o-S.x)/(I.x-S.x)*(I.y-S.y))._round()),S.y>=a&&I.y>=a||(S.y>=a?S=new ve(S.x+(a-S.y)/(I.y-S.y)*(I.x-S.x),a)._round():I.y>=a&&(I=new ve(S.x+(a-S.y)/(I.y-S.y)*(I.x-S.x),a)._round()),v&&S.equals(v[v.length-1])||(v=[S],l.push(v)),v.push(I)))))}}return l}function I1(t){let e=0,n=0;for(const d of t)e+=d.w*d.h,n=Math.max(n,d.w);t.sort((d,g)=>g.h-d.h);const o=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let a=0,l=0;for(const d of t)for(let g=o.length-1;g>=0;g--){const v=o[g];if(!(d.w>v.w||d.h>v.h)){if(d.x=v.x,d.y=v.y,l=Math.max(l,d.y+d.h),a=Math.max(a,d.x+d.w),d.w===v.w&&d.h===v.h){const b=o.pop();g<o.length&&(o[g]=b)}else d.h===v.h?(v.x+=d.w,v.w-=d.w):d.w===v.w?(v.y+=d.h,v.h-=d.h):(o.push({x:v.x+d.w,y:v.y,w:v.w-d.w,h:d.h}),v.y+=d.h,v.h-=d.h);break}}return{w:a,h:l,fill:e/(a*l)||0}}sn(jl,"Anchor");const ds=1;class Ty{constructor(e,{pixelRatio:n,version:o,stretchX:a,stretchY:l,content:d}){this.paddedRect=e,this.pixelRatio=n,this.stretchX=a,this.stretchY=l,this.content=d,this.version=o}get tl(){return[this.paddedRect.x+ds,this.paddedRect.y+ds]}get br(){return[this.paddedRect.x+this.paddedRect.w-ds,this.paddedRect.y+this.paddedRect.h-ds]}get displaySize(){return[(this.paddedRect.w-2*ds)/this.pixelRatio,(this.paddedRect.h-2*ds)/this.pixelRatio]}}class C1{constructor(e,n){const o={},a={};this.haveRenderCallbacks=[];const l=[];this.addImages(e,o,l),this.addImages(n,a,l);const{w:d,h:g}=I1(l),v=new Bs({width:d||1,height:g||1});for(const b in e){const S=e[b],I=o[b].paddedRect;Bs.copy(S.data,v,{x:0,y:0},{x:I.x+ds,y:I.y+ds},S.data,S.sdf)}for(const b in n){const S=n[b],I=a[b].paddedRect,D=I.x+ds,F=I.y+ds,N=S.data.width,V=S.data.height;Bs.copy(S.data,v,{x:0,y:0},{x:D,y:F},S.data),Bs.copy(S.data,v,{x:0,y:V-1},{x:D,y:F-1},{width:N,height:1}),Bs.copy(S.data,v,{x:0,y:0},{x:D,y:F+V},{width:N,height:1}),Bs.copy(S.data,v,{x:N-1,y:0},{x:D-1,y:F},{width:1,height:V}),Bs.copy(S.data,v,{x:0,y:0},{x:D+N,y:F},{width:1,height:V})}this.image=v,this.iconPositions=o,this.patternPositions=a}addImages(e,n,o){for(const a in e){const l=e[a],d={x:0,y:0,w:l.data.width+2*ds,h:l.data.height+2*ds};o.push(d),n[a]=new Ty(d,l),l.hasRenderCallback&&this.haveRenderCallbacks.push(a)}}patchUpdatedImages(e,n,o){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(a=>e.hasImage(a,o)),e.dispatchRenderCallbacks(this.haveRenderCallbacks,o);for(const a in e.getUpdatedImages(o))this.patchUpdatedImage(this.iconPositions[a],e.getImage(a,o),n),this.patchUpdatedImage(this.patternPositions[a],e.getImage(a,o),n)}patchUpdatedImage(e,n,o){if(!e||!n||e.version===n.version)return;e.version=n.version;const[a,l]=e.tl,d=!!Object.keys(this.patternPositions).length;o.update(n.data,{useMipmap:d},{x:a,y:l})}}sn(Ty,"ImagePosition"),sn(C1,"ImageAtlas");const Bf=1e20;function P1(t,e,n,o,a,l,d,g,v){for(let b=e;b<e+o;b++)D1(t,n*l+b,l,a,d,g,v);for(let b=n;b<n+a;b++)D1(t,b*l+e,1,o,d,g,v)}function D1(t,e,n,o,a,l,d){l[0]=0,d[0]=-Bf,d[1]=Bf,a[0]=t[e];for(let g=1,v=0,b=0;g<o;g++){a[g]=t[e+g*n];const S=g*g;do{const I=l[v];b=(a[g]-a[I]+S-I*I)/(g-I)/2}while(b<=d[v]&&--v>-1);v++,l[v]=g,d[v]=b,d[v+1]=Bf}for(let g=0,v=0;g<o;g++){for(;d[v+1]<g;)v++;const b=l[v],S=g-b;t[e+g*n]=a[b]+S*S}}const Ca=2,Ey={none:0,ideographs:1,all:2};class Kh{constructor(e,n,o){this.requestManager=e,this.localGlyphMode=n,this.localFontFamily=o,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e,n){this.urls[n]=e}getGlyphs(e,n,o){const a=[],l=this.urls[n]||L.GLYPHS_URL;for(const d in e)for(const g of e[d])a.push({stack:d,id:g});Gr(a,({stack:d,id:g},v)=>{let b=this.entries[d];b||(b=this.entries[d]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let S=b.glyphs[g];if(S!==void 0)return void v(null,{stack:d,id:g,glyph:S});if(S=this._tinySDF(b,d,g),S)return b.glyphs[g]=S,void v(null,{stack:d,id:g,glyph:S});const I=Math.floor(g/256);if(256*I>65535)return void v(new Error("glyphs > 65535 not supported"));if(b.ranges[I])return void v(null,{stack:d,id:g,glyph:S});let D=b.requests[I];D||(D=b.requests[I]=[],Kh.loadGlyphRange(d,I,l,this.requestManager,(F,N)=>{if(N){b.ascender=N.ascender,b.descender=N.descender;for(const V in N.glyphs)this._doesCharSupportLocalGlyph(+V)||(b.glyphs[+V]=N.glyphs[+V]);b.ranges[I]=!0}for(const V of D)V(F,N);delete b.requests[I]})),D.push((F,N)=>{F?v(F):N&&v(null,{stack:d,id:g,glyph:N.glyphs[g]||null})})},(d,g)=>{if(d)o(d);else if(g){const v={};for(const{stack:b,id:S,glyph:I}of g)v[b]===void 0&&(v[b]={}),v[b].glyphs===void 0&&(v[b].glyphs={}),v[b].glyphs[S]=I&&{id:I.id,bitmap:I.bitmap.clone(),metrics:I.metrics},v[b].ascender=this.entries[b].ascender,v[b].descender=this.entries[b].descender;o(null,v)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==Ey.none&&(this.localGlyphMode===Ey.all?!!this.localFontFamily:!!this.localFontFamily&&(hn["CJK Unified Ideographs"](e)||hn["Hangul Syllables"](e)||hn.Hiragana(e)||hn.Katakana(e)||hn["CJK Symbols and Punctuation"](e)||hn["CJK Unified Ideographs Extension A"](e)||hn["CJK Unified Ideographs Extension B"](e)))}_tinySDF(e,n,o){const a=this.localFontFamily;if(!a||!this._doesCharSupportLocalGlyph(o))return;let l=e.tinySDF;if(!l){let V="400";/bold/i.test(n)?V="900":/medium/i.test(n)?V="500":/light/i.test(n)&&(V="200"),l=e.tinySDF=new Kh.TinySDF({fontFamily:a,fontWeight:V,fontSize:24*Ca,buffer:3*Ca,radius:8*Ca}),l.fontWeight=V}if(this.localGlyphs[l.fontWeight][o])return this.localGlyphs[l.fontWeight][o];const d=String.fromCodePoint(o),{data:g,width:v,height:b,glyphWidth:S,glyphHeight:I,glyphLeft:D,glyphTop:F,glyphAdvance:N}=l.draw(d);return this.localGlyphs[l.fontWeight][o]={id:o,bitmap:new bc({width:v,height:b},g),metrics:{width:S/Ca,height:I/Ca,left:D/Ca,top:F/Ca-27,advance:N/Ca,localGlyph:!0}}}}Kh.loadGlyphRange=function(t,e,n,o,a){const l=256*e,d=l+255,g=o.transformRequest(o.normalizeGlyphsURL(n).replace("{fontstack}",t).replace("{range}",`${l}-${d}`),oo.Glyphs);ce(g,(v,b)=>{if(v)a(v);else if(b){const S={},I=function(D){return new Yh(D).readFields(ZI,{})}(b);for(const D of I.glyphs)S[D.id]=D;a(null,{glyphs:S,ascender:I.ascender,descender:I.descender})}})},Kh.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:n=8,cutoff:o=.25,fontFamily:a="sans-serif",fontWeight:l="normal",fontStyle:d="normal"}={}){this.buffer=e,this.cutoff=o,this.radius=n;const g=this.size=t+4*e,v=this._createCanvas(g),b=this.ctx=v.getContext("2d",{willReadFrequently:!0});b.font=`${d} ${l} ${t}px ${a}`,b.textBaseline="alphabetic",b.textAlign="left",b.fillStyle="black",this.gridOuter=new Float64Array(g*g),this.gridInner=new Float64Array(g*g),this.f=new Float64Array(g),this.z=new Float64Array(g+1),this.v=new Uint16Array(g)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:o,actualBoundingBoxLeft:a,actualBoundingBoxRight:l}=this.ctx.measureText(t),d=Math.ceil(n),g=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(l-a))),v=Math.min(this.size-this.buffer,d+Math.ceil(o)),b=g+2*this.buffer,S=v+2*this.buffer,I=Math.max(b*S,0),D=new Uint8ClampedArray(I),F={data:D,width:b,height:S,glyphWidth:g,glyphHeight:v,glyphTop:d,glyphLeft:0,glyphAdvance:e};if(g===0||v===0)return F;const{ctx:N,buffer:V,gridInner:q,gridOuter:Y}=this;N.clearRect(V,V,g,v),N.fillText(t,V,V+d);const oe=N.getImageData(V,V,g,v);Y.fill(Bf,0,I),q.fill(0,0,I);for(let le=0;le<v;le++)for(let ae=0;ae<g;ae++){const be=oe.data[4*(le*g+ae)+3]/255;if(be===0)continue;const ge=(le+V)*b+ae+V;if(be===1)Y[ge]=0,q[ge]=Bf;else{const Ie=.5-be;Y[ge]=Ie>0?Ie*Ie:0,q[ge]=Ie<0?Ie*Ie:0}}P1(Y,0,0,b,S,b,this.f,this.v,this.z),P1(q,V,V,g,v,b,this.f,this.v,this.z);for(let le=0;le<I;le++){const ae=Math.sqrt(Y[le])-Math.sqrt(q[le]);D[le]=Math.round(255-255*(ae/this.radius+this.cutoff))}return F}};const Ec=ds;function k1(t,e,n,o){const a=[],l=t.imagePrimary,d=l.pixelRatio,g=l.paddedRect.w-2*Ec,v=l.paddedRect.h-2*Ec,b=t.right-t.left,S=t.bottom-t.top,I=l.stretchX||[[0,g]],D=l.stretchY||[[0,v]],F=(qe,_t)=>qe+_t[1]-_t[0],N=I.reduce(F,0),V=D.reduce(F,0),q=g-N,Y=v-V;let oe=0,le=N,ae=0,be=V,ge=0,Ie=q,Ne=0,Ge=Y;if(l.content&&o){const qe=l.content;oe=$m(I,0,qe[0]),ae=$m(D,0,qe[1]),le=$m(I,qe[0],qe[2]),be=$m(D,qe[1],qe[3]),ge=qe[0]-oe,Ne=qe[1]-ae,Ie=qe[2]-qe[0]-le,Ge=qe[3]-qe[1]-be}const tt=(qe,_t,Et,ct)=>{const wt=Gm(qe.stretch-oe,le,b,t.left),st=Hm(qe.fixed-ge,Ie,qe.stretch,N),bt=Gm(_t.stretch-ae,be,S,t.top),$t=Hm(_t.fixed-Ne,Ge,_t.stretch,V),St=Gm(Et.stretch-oe,le,b,t.left),cn=Hm(Et.fixed-ge,Ie,Et.stretch,N),rn=Gm(ct.stretch-ae,be,S,t.top),Dt=Hm(ct.fixed-Ne,Ge,ct.stretch,V),An=new ve(wt,bt),_n=new ve(St,bt),ln=new ve(St,rn),kt=new ve(wt,rn),Tn=new ve(st/d,$t/d),Kn=new ve(cn/d,Dt/d),In=e*Math.PI/180;if(In){const Ir=Math.sin(In),kr=Math.cos(In),Br=[kr,-Ir,Ir,kr];An._matMult(Br),_n._matMult(Br),kt._matMult(Br),ln._matMult(Br)}const Jn=qe.stretch+qe.fixed,On=Et.stretch+Et.fixed,pr=_t.stretch+_t.fixed,jn=ct.stretch+ct.fixed,Wr=t.imageSecondary;return{tl:An,tr:_n,bl:kt,br:ln,texPrimary:{x:l.paddedRect.x+Ec+Jn,y:l.paddedRect.y+Ec+pr,w:On-Jn,h:jn-pr},texSecondary:Wr?{x:Wr.paddedRect.x+Ec+Jn,y:Wr.paddedRect.y+Ec+pr,w:On-Jn,h:jn-pr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Tn,pixelOffsetBR:Kn,minFontScaleX:Ie/d/b,minFontScaleY:Ge/d/S,isSDF:n}};if(o&&(l.stretchX||l.stretchY)){const qe=O1(I,q,N),_t=O1(D,Y,V);for(let Et=0;Et<qe.length-1;Et++){const ct=qe[Et],wt=qe[Et+1];for(let st=0;st<_t.length-1;st++)a.push(tt(ct,_t[st],wt,_t[st+1]))}}else a.push(tt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:g+1},{fixed:0,stretch:v+1}));return a}function $m(t,e,n){let o=0;for(const a of t)o+=Math.max(e,Math.min(n,a[1]))-Math.max(e,Math.min(n,a[0]));return o}function O1(t,e,n){const o=[{fixed:-Ec,stretch:0}];for(const[a,l]of t){const d=o[o.length-1];o.push({fixed:a-d.stretch,stretch:d.stretch}),o.push({fixed:a-d.stretch,stretch:d.stretch+(l-a)})}return o.push({fixed:e+Ec,stretch:n}),o}function Gm(t,e,n,o){return t/e*n+o}function Hm(t,e,n,o){return t-e*n/o}function nC(t,e,n,o){const a=e+t.positionedLines[o].lineOffset;return o===0?n+a/2:n+(a+(e+t.positionedLines[o-1].lineOffset))/2}function rC(t,e=1,n=!1){let o=1/0,a=1/0,l=-1/0,d=-1/0;const g=t[0];for(let F=0;F<g.length;F++){const N=g[F];(!F||N.x<o)&&(o=N.x),(!F||N.y<a)&&(a=N.y),(!F||N.x>l)&&(l=N.x),(!F||N.y>d)&&(d=N.y)}const v=Math.min(l-o,d-a);let b=v/2;const S=new Uo([],iC);if(v===0)return new ve(o,a);for(let F=o;F<l;F+=v)for(let N=a;N<d;N+=v)S.push(new Jh(F+b,N+b,b,t));let I=function(F){let N=0,V=0,q=0;const Y=F[0];for(let oe=0,le=Y.length,ae=le-1;oe<le;ae=oe++){const be=Y[oe],ge=Y[ae],Ie=be.x*ge.y-ge.x*be.y;V+=(be.x+ge.x)*Ie,q+=(be.y+ge.y)*Ie,N+=3*Ie}return new Jh(V/N,q/N,0,F)}(t),D=S.length;for(;S.length;){const F=S.pop();(F.d>I.d||!I.d)&&(I=F,n&&console.log("found best %d after %d probes",Math.round(1e4*F.d)/1e4,D)),F.max-I.d<=e||(b=F.h/2,S.push(new Jh(F.p.x-b,F.p.y-b,b,t)),S.push(new Jh(F.p.x+b,F.p.y-b,b,t)),S.push(new Jh(F.p.x-b,F.p.y+b,b,t)),S.push(new Jh(F.p.x+b,F.p.y+b,b,t)),D+=4)}return n&&(console.log(`num probes: ${D}`),console.log(`best distance: ${I.d}`)),I.p}function iC(t,e){return e.max-t.max}class Jh{constructor(e,n,o,a){this.p=new ve(e,n),this.h=o,this.d=function(l,d){let g=!1,v=1/0;for(let b=0;b<d.length;b++){const S=d[b];for(let I=0,D=S.length,F=D-1;I<D;F=I++){const N=S[I],V=S[F];N.y>l.y!=V.y>l.y&&l.x<(V.x-N.x)*(l.y-N.y)/(V.y-N.y)+N.x&&(g=!g),v=Math.min(v,yc(l,N,V))}}return(g?1:-1)*Math.sqrt(v)}(this.p,a),this.max=this.d+this.h*Math.SQRT2}}const Sy=Number.POSITIVE_INFINITY,oC=Math.sqrt(2);function R1(t,[e,n]){let o=0,a=0;if(n===Sy){e<0&&(e=0);const l=e/oC;switch(t){case"top-right":case"top-left":a=l-7;break;case"bottom-right":case"bottom-left":a=7-l;break;case"bottom":a=7-e;break;case"top":a=e-7}switch(t){case"top-right":case"bottom-right":o=-l;break;case"top-left":case"bottom-left":o=l;break;case"left":o=e;break;case"right":o=-e}}else{switch(e=Math.abs(e),n=Math.abs(n),t){case"top-right":case"top-left":case"top":a=n-7;break;case"bottom-right":case"bottom-left":case"bottom":a=7-n}switch(t){case"top-right":case"bottom-right":case"right":o=-e;break;case"top-left":case"bottom-left":case"left":o=e}}return[o,a]}function My(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function sC(t,e,n,o,a,l,d,g,v,b,S,I,D,F,N){let V=l.textMaxSize.evaluate(e,{},I);V===void 0&&(V=d);const q=t.layers[0].layout,Y=q.get("icon-offset").evaluate(e,{},I),oe=z1(n.horizontal)||n.vertical,le=D.name==="globe",ae=bo,be=d/ae,ge=t.tilePixelRatio*V/ae,Ie=(wt=t.overscaling,t.zoom>18&&wt>2&&(wt>>=1),Math.max(Jt/(512*wt),1)*q.get("symbol-spacing")),Ne=q.get("text-padding")*t.tilePixelRatio,Ge=q.get("icon-padding")*t.tilePixelRatio,tt=Oe(q.get("text-max-angle")),qe=q.get("text-rotation-alignment")==="map"&&q.get("symbol-placement")!=="point",_t=q.get("icon-rotation-alignment")==="map"&&q.get("symbol-placement")!=="point",Et=q.get("symbol-placement"),ct=Ie/2;var wt;const st=q.get("icon-text-fit").evaluate(e,{},I),bt=q.get("icon-text-fit-padding").evaluate(e,{},I),$t=st!=="none";let St;t.hasAnyIconTextFit===!1&&$t&&(t.hasAnyIconTextFit=!0),o&&$t&&(t.allowVerticalPlacement&&n.vertical&&(St=b1(o,n.vertical,st,bt,Y,be)),oe&&(o=b1(o,oe,st,bt,Y,be)));const cn=(rn,Dt,An)=>{if(Dt.x<0||Dt.x>=Jt||Dt.y<0||Dt.y>=Jt)return;let _n=null;if(le){const{x:ln,y:kt,z:Tn}=D.projectTilePoint(Dt.x,Dt.y,An);_n={anchor:new jl(ln,kt,Tn,0,void 0),up:D.upVector(An,Dt.x,Dt.y)}}(function(ln,kt,Tn,Kn,In,Jn,On,pr,jn,Wr,Ir,kr,Br,Cr,hi,Ur,Ci,Ki,yo,ai,gi,ho,fo,po,ei,fs,Pc){const Xo=ln.addToLineVertexArray(kt,Kn);let Bo,Vs,ep,d_,zw,Fw,Bw,Nw=0,jw=0,Vw=0,Uw=0,Xy=-1,Ky=-1;const cl={};let $w=Ef("");const Ku=Tn?Tn.anchor:kt,Jy=jn.layout.get("icon-text-fit").evaluate(gi,{},ei)!=="none";let Qy=0,e0=0;if(jn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Qy,e0]=jn.layout.get("text-offset").evaluate(gi,{},ei).map(ps=>ps*bo):(Qy=jn.layout.get("text-radial-offset").evaluate(gi,{},ei)*bo,e0=Sy),ln.allowVerticalPlacement&&In.vertical){const ps=In.vertical;if(hi)Fw=Ay(ps),pr&&(Bw=Ay(pr));else{const ms=jn.layout.get("text-rotate").evaluate(gi,{},ei)+90;ep=qm(Wr,Ku,kt,Ir,kr,Br,ps,Cr,ms,Ur),pr&&(d_=qm(Wr,Ku,kt,Ir,kr,Br,pr,Ki,ms))}}if(Jn){const ps=jn.layout.get("icon-rotate").evaluate(gi,{},ei),ms=k1(Jn,ps,fo,Jy),sd=pr?k1(pr,ps,fo,Jy):void 0;Vs=qm(Wr,Ku,kt,Ir,kr,Br,Jn,Ki,ps),Nw=4*ms.length;const Gw=ln.iconSizeData;let Ju=null;Gw.kind==="source"?(Ju=[Ia*jn.layout.get("icon-size").evaluate(gi,{},ei)],Ju[0]>Sc&&Re(`${ln.layerIds[0]}: Value for "icon-size" is >= ${Nf}. Reduce your "icon-size".`)):Gw.kind==="composite"&&(Ju=[Ia*ho.compositeIconSizes[0].evaluate(gi,{},ei),Ia*ho.compositeIconSizes[1].evaluate(gi,{},ei)],(Ju[0]>Sc||Ju[1]>Sc)&&Re(`${ln.layerIds[0]}: Value for "icon-size" is >= ${Nf}. Reduce your "icon-size".`)),ln.addSymbols(ln.icon,ms,Ju,ai,yo,gi,!1,Tn,kt,Xo.lineStartIndex,Xo.lineLength,-1,po,ei,fs,Pc),Xy=ln.icon.placedSymbolArray.length-1,sd&&(jw=4*sd.length,ln.addSymbols(ln.icon,sd,Ju,ai,yo,gi,Ns.vertical,Tn,kt,Xo.lineStartIndex,Xo.lineLength,-1,po,ei,fs,Pc),Ky=ln.icon.placedSymbolArray.length-1)}for(const ps in In.horizontal){const ms=In.horizontal[ps];Bo||($w=Ef(ms.text),hi?zw=Ay(ms):Bo=qm(Wr,Ku,kt,Ir,kr,Br,ms,Cr,jn.layout.get("text-rotate").evaluate(gi,{},ei),Ur));const sd=ms.positionedLines.length===1;if(Vw+=L1(ln,Tn,kt,ms,On,jn,hi,gi,Ur,Xo,In.vertical?Ns.horizontal:Ns.horizontalOnly,sd?Object.keys(In.horizontal):[ps],cl,Xy,ho,po,ei,fs),sd)break}In.vertical&&(Uw+=L1(ln,Tn,kt,In.vertical,On,jn,hi,gi,Ur,Xo,Ns.vertical,["vertical"],cl,Ky,ho,po,ei,fs));let Dc=-1;const t0=(ps,ms)=>ps?Math.max(ps,ms):ms;Dc=t0(zw,Dc),Dc=t0(Fw,Dc),Dc=t0(Bw,Dc);const EP=Dc>-1?1:0;ln.glyphOffsetArray.length>=65535&&Re("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),gi.sortKey!==void 0&&ln.addToSortKeyRanges(ln.symbolInstances.length,gi.sortKey),ln.symbolInstances.emplaceBack(kt.x,kt.y,Ku.x,Ku.y,Ku.z,cl.right>=0?cl.right:-1,cl.center>=0?cl.center:-1,cl.left>=0?cl.left:-1,cl.vertical>=0?cl.vertical:-1,Xy,Ky,$w,Bo!==void 0?Bo:ln.collisionBoxArray.length,Bo!==void 0?Bo+1:ln.collisionBoxArray.length,ep!==void 0?ep:ln.collisionBoxArray.length,ep!==void 0?ep+1:ln.collisionBoxArray.length,Vs!==void 0?Vs:ln.collisionBoxArray.length,Vs!==void 0?Vs+1:ln.collisionBoxArray.length,d_||ln.collisionBoxArray.length,d_?d_+1:ln.collisionBoxArray.length,Ir,Vw,Uw,Nw,jw,EP,0,Qy,e0,Dc,0,Jy?1:0)})(t,Dt,_n,rn,n,o,a,St,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,Ne,qe,v,0,Ge,_t,Y,e,l,b,S,I,F,N)};if(Et==="line")for(const rn of A1(e.geometry,0,0,Jt,Jt)){const Dt=tC(rn,Ie,tt,n.vertical||oe,o,ae,ge,t.overscaling,Jt);for(const An of Dt)oe&&aC(t,oe.text,ct,An)||cn(rn,An,I)}else if(Et==="line-center"){for(const rn of e.geometry)if(rn.length>1){const Dt=eC(rn,tt,n.vertical||oe,o,ae,ge);Dt&&cn(rn,Dt,I)}}else if(e.type==="Polygon")for(const rn of hy(e.geometry,0)){const Dt=rC(rn,16);cn(rn[0],new jl(Dt.x,Dt.y,0,0,void 0),I)}else if(e.type==="LineString")for(const rn of e.geometry)cn(rn,new jl(rn[0].x,rn[0].y,0,0,void 0),I);else if(e.type==="Point")for(const rn of e.geometry)for(const Dt of rn)cn([Dt],new jl(Dt.x,Dt.y,0,0,void 0),I)}const Nf=255,Sc=Nf*Ia;function L1(t,e,n,o,a,l,d,g,v,b,S,I,D,F,N,V,q,Y){const oe=function(be,ge,Ie,Ne,Ge,tt,qe,_t){const Et=[];if(ge.positionedLines.length===0)return Et;const ct=Ne.layout.get("text-rotate").evaluate(tt,{})*Math.PI/180,wt=function(cn){const rn=cn[0],Dt=cn[1],An=rn*Dt;return An>0?[rn,-Dt]:An<0?[-rn,Dt]:rn===0?[Dt,rn]:[Dt,-rn]}(Ie);let st=Math.abs(ge.top-ge.bottom);for(const cn of ge.positionedLines)st-=cn.lineOffset;const bt=ge.positionedLines.length,$t=st/bt;let St=ge.top-Ie[1];for(let cn=0;cn<bt;++cn){const rn=ge.positionedLines[cn];St=nC(ge,$t,St,cn);for(const Dt of rn.positionedGlyphs){if(!Dt.rect)continue;const An=Dt.rect||{};let _n=m1+1,ln=!0,kt=1,Tn=0;if(Dt.imageName){const ai=qe[Dt.imageName];if(!ai)continue;if(ai.sdf){Re("SDF images are not supported in formatted text and will be ignored.");continue}ln=!1,kt=ai.pixelRatio,_n=ds/kt}const Kn=(Ge||_t)&&Dt.vertical,In=Dt.metrics.advance*Dt.scale/2,Jn=Dt.metrics,On=Dt.rect;if(On===null)continue;_t&&ge.verticalizable&&(Tn=Dt.imageName?In-Dt.metrics.width*Dt.scale/2:0);const pr=Ge?[Dt.x+In,Dt.y]:[0,0];let jn=[0,0],Wr=[0,0],Ir=!1;Ge||(Kn?(Wr=[Dt.x+In+wt[0],Dt.y+wt[1]-Tn],Ir=!0):jn=[Dt.x+In+Ie[0],Dt.y+Ie[1]-Tn]);const kr=On.w*Dt.scale/(kt*(Dt.localGlyph?Ca:1)),Br=On.h*Dt.scale/(kt*(Dt.localGlyph?Ca:1));let Cr,hi,Ur,Ci;if(Kn){const ai=Dt.y-St,gi=new ve(-In,In-ai),ho=-Math.PI/2,fo=new ve(...Wr);Cr=new ve(-In+jn[0],jn[1]),Cr._rotateAround(ho,gi)._add(fo),Cr.x+=-ai+In,Cr.y-=(Jn.left-_n)*Dt.scale;const po=Dt.imageName?Jn.advance*Dt.scale:bo*Dt.scale,ei=String.fromCodePoint(Dt.glyph);zI(ei)?Cr.x+=(1-_n)*Dt.scale:FI(ei)?Cr.x+=po-Jn.height*Dt.scale+(-_n-1)*Dt.scale:Cr.x+=Dt.imageName||Jn.width+2*_n===On.w&&Jn.height+2*_n===On.h?(po-Br)/2:(po-(Jn.height+2*_n)*Dt.scale)/2,hi=new ve(Cr.x,Cr.y-kr),Ur=new ve(Cr.x+Br,Cr.y),Ci=new ve(Cr.x+Br,Cr.y-kr)}else{const ai=(Jn.left-_n)*Dt.scale-In+jn[0],gi=(-Jn.top-_n)*Dt.scale+jn[1],ho=ai+kr,fo=gi+Br;Cr=new ve(ai,gi),hi=new ve(ho,gi),Ur=new ve(ai,fo),Ci=new ve(ho,fo)}if(ct){let ai;ai=Ge?new ve(0,0):Ir?new ve(wt[0],wt[1]):new ve(Ie[0],Ie[1]),Cr._rotateAround(ct,ai),hi._rotateAround(ct,ai),Ur._rotateAround(ct,ai),Ci._rotateAround(ct,ai)}const Ki=new ve(0,0),yo=new ve(0,0);Et.push({tl:Cr,tr:hi,bl:Ur,br:Ci,texPrimary:An,texSecondary:void 0,writingMode:ge.writingMode,glyphOffset:pr,sectionIndex:Dt.sectionIndex,isSDF:ln,pixelOffsetTL:Ki,pixelOffsetBR:yo,minFontScaleX:0,minFontScaleY:0})}}return Et}(0,o,v,l,d,g,a,t.allowVerticalPlacement),le=t.textSizeData;let ae=null;le.kind==="source"?(ae=[Ia*l.layout.get("text-size").evaluate(g,{},q)],ae[0]>Sc&&Re(`${t.layerIds[0]}: Value for "text-size" is >= ${Nf}. Reduce your "text-size".`)):le.kind==="composite"&&(ae=[Ia*N.compositeTextSizes[0].evaluate(g,{},q),Ia*N.compositeTextSizes[1].evaluate(g,{},q)],(ae[0]>Sc||ae[1]>Sc)&&Re(`${t.layerIds[0]}: Value for "text-size" is >= ${Nf}. Reduce your "text-size".`)),t.addSymbols(t.text,oe,ae,v,d,g,S,e,n,b.lineStartIndex,b.lineLength,F,V,q,Y,!1);for(const be of I)D[be]=t.text.placedSymbolArray.length-1;return 4*oe.length}function z1(t){for(const e in t)return t[e];return null}function qm(t,e,n,o,a,l,d,g,v,b){let S=d.top,I=d.bottom,D=d.left,F=d.right;const N=d.collisionPadding;if(N&&(D-=N[0],S-=N[1],F+=N[2],I+=N[3]),v){const V=new ve(D,S),q=new ve(F,S),Y=new ve(D,I),oe=new ve(F,I),le=Oe(v);let ae=new ve(0,0);b&&(ae=new ve(b[0],b[1])),V._rotateAround(le,ae),q._rotateAround(le,ae),Y._rotateAround(le,ae),oe._rotateAround(le,ae),D=Math.min(V.x,q.x,Y.x,oe.x),F=Math.max(V.x,q.x,Y.x,oe.x),S=Math.min(V.y,q.y,Y.y,oe.y),I=Math.max(V.y,q.y,Y.y,oe.y)}return t.emplaceBack(e.x,e.y,e.z,n.x,n.y,D,S,F,I,g,o,a,l),t.length-1}function Ay(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function aC(t,e,n,o){const a=t.compareText;if(e in a){const l=a[e];for(let d=l.length-1;d>=0;d--)if(o.dist(l[d])<n)return!0}else a[e]=[];return a[e].push(o),!1}function F1(t,e){const n=t.fovAboveCenter,o=t.elevation?t.elevation.getMinElevationBelowMSL()*e:0,a=(t._camera.position[2]*t.worldSize-o)/Math.cos(t._pitch),l=Math.sin(n)*a/Math.sin(Math.max(Math.PI/2-t._pitch-n,.01)),d=Math.sin(t._pitch)*l+a;return Math.min(1.01*d,a*(1/t._horizonShift))}function jf(t,e){if(!e.isReprojectedInTileSpace)return{scale:1<<t.z,x:t.x,y:t.y,x2:t.x+1,y2:t.y+1,projection:e};const n=Math.pow(2,-t.z),o=t.x*n,a=(t.x+1)*n,l=t.y*n,d=(t.y+1)*n,g=Fn(o),v=Fn(a),b=_r(l),S=_r(d),I=e.project(g,b),D=e.project(v,b),F=e.project(v,S),N=e.project(g,S);let V=Math.min(I.x,D.x,F.x,N.x),q=Math.min(I.y,D.y,F.y,N.y),Y=Math.max(I.x,D.x,F.x,N.x),oe=Math.max(I.y,D.y,F.y,N.y);const le=n/16;function ae(ge,Ie,Ne,Ge,tt,qe){const _t=(Ne+tt)/2,Et=(Ge+qe)/2,ct=e.project(Fn(_t),_r(Et)),wt=Math.max(0,V-ct.x,q-ct.y,ct.x-Y,ct.y-oe);V=Math.min(V,ct.x),Y=Math.max(Y,ct.x),q=Math.min(q,ct.y),oe=Math.max(oe,ct.y),wt>le&&(ae(ge,ct,Ne,Ge,_t,Et),ae(ct,Ie,_t,Et,tt,qe))}ae(I,D,o,l,a,l),ae(D,F,a,l,a,d),ae(F,N,a,d,o,d),ae(N,I,o,d,o,l),V-=le,q-=le,Y+=le,oe+=le;const be=1/Math.max(Y-V,oe-q);return{scale:be,x:V*be,y:q*be,x2:Y*be,y2:oe*be,projection:e}}function B1(t,{x:e,y:n},o=0){return new ve(((e-o)*t.scale-t.x)*Jt,(n*t.scale-t.y)*Jt)}const lC=i.a6.identity(new Float32Array(16));class Mc{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,n){return{x:0,y:0,z:0}}unproject(e,n){return new $e(0,0)}projectTilePoint(e,n,o){return{x:e,y:n,z:0}}locationPoint(e,n,o=!0){return e._coordinatePoint(e.locationCoordinate(n),o)}pixelsPerMeter(e,n){return Nn(1,e)*n}pixelSpaceConversion(e,n,o){return 1}farthestPixelDistance(e){return F1(e,e.pixelsPerMeter)}pointCoordinate(e,n,o,a){const l=e.horizonLineFromTop(!1),d=new ve(n,Math.max(l,o));return e.rayIntersectionCoordinate(e.pointRayIntersection(d,a))}pointCoordinate3D(e,n,o){const a=new ve(n,o);if(e.elevation)return e.elevation.pointCoordinate(a);{const l=this.pointCoordinate(e,a.x,a.y,0);return[l.x,l.y,l.z]}}isPointAboveHorizon(e,n){if(e.elevation)return!this.pointCoordinate3D(e,n.x,n.y);const o=e.horizonLineFromTop();return n.y<o}createInversionMatrix(e,n){return lC}createTileMatrix(e,n,o){let a,l,d;const g=o.canonical,v=i.a6.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const b=jf(g,this);a=1,l=b.x+o.wrap*b.scale,d=b.y,i.a6.scale(v,v,[a/b.scale,a/b.scale,e.pixelsPerMeter/n])}else a=n/e.zoomScale(g.z),l=(g.x+Math.pow(2,g.z)*o.wrap)*a,d=g.y*a;return i.a6.translate(v,v,[l,d,0]),i.a6.scale(v,v,[a/Jt,a/Jt,1]),v}upVector(e,n,o){return[0,0,1]}upVectorScale(e,n,o){return{metersToTile:1}}}class cC extends Mc{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[n,o]=this.parallels=e.parallels||[29.5,45.5],a=Math.sin(Oe(n));this.n=(a+Math.sin(Oe(o)))/2,this.c=1+a*(2*this.n-a),this.r0=Math.sqrt(this.c)/this.n}project(e,n){const{n:o,c:a,r0:l}=this,d=Oe(e-this.center[0]),g=Oe(n),v=Math.sqrt(a-2*o*Math.sin(g))/o;return{x:v*Math.sin(d*o),y:v*Math.cos(d*o)-l,z:0}}unproject(e,n){const{n:o,c:a,r0:l}=this,d=l+n;let g=Math.atan2(e,Math.abs(d))*Math.sign(d);d*o<0&&(g-=Math.PI*Math.sign(e)*Math.sign(d));const v=Oe(this.center[0])*o;g=Kr(g,-Math.PI-v,Math.PI-v);const b=vt(lt(g/o)+this.center[0],-180,180),S=Math.asin(vt((a-(e*e+d*d)*o*o)/(2*o),-1,1)),I=vt(lt(S),-ir,ir);return new $e(b,I)}}const Vf=1.340264,Uf=-.081106,$f=893e-6,Gf=.003796,Wm=Math.sqrt(3)/2;class uC extends Mc{project(e,n){n=n/180*Math.PI,e=e/180*Math.PI;const o=Math.asin(Wm*Math.sin(n)),a=o*o,l=a*a*a;return{x:.5*(e*Math.cos(o)/(Wm*(Vf+3*Uf*a+l*(7*$f+9*Gf*a)))/Math.PI+.5),y:1-.5*(o*(Vf+Uf*a+l*($f+Gf*a))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let o=n=(2*(1-n)-1)*Math.PI,a=o*o,l=a*a*a;for(let S,I,D,F=0;F<12&&(I=o*(Vf+Uf*a+l*($f+Gf*a))-n,D=Vf+3*Uf*a+l*(7*$f+9*Gf*a),S=I/D,o=vt(o-S,-Math.PI/3,Math.PI/3),a=o*o,l=a*a*a,!(Math.abs(S)<1e-12));++F);const d=Wm*e*(Vf+3*Uf*a+l*(7*$f+9*Gf*a))/Math.cos(o),g=Math.asin(Math.sin(o)/Wm),v=vt(180*d/Math.PI,-180,180),b=vt(180*g/Math.PI,-ir,ir);return new $e(v,b)}}class hC extends Mc{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){return{x:.5+e/360,y:.5-n/360,z:0}}unproject(e,n){const o=360*(e-.5),a=vt(360*(.5-n),-ir,ir);return new $e(o,a)}}const Qh=Math.PI/2;function Zm(t){return Math.tan((Qh+t)/2)}class dC extends Mc{constructor(e){super(e),this.center=e.center||[0,30];const[n,o]=this.parallels=e.parallels||[30,30];let a=Oe(n),l=Oe(o);this.southernCenter=a+l<0,this.southernCenter&&(a=-a,l=-l);const d=Math.cos(a),g=Zm(a);this.n=a===l?Math.sin(a):Math.log(d/Math.cos(l))/Math.log(Zm(l)/g),this.f=d*Math.pow(Zm(a),this.n)/this.n}project(e,n){n=Oe(n),this.southernCenter&&(n=-n),e=Oe(e-this.center[0]);const o=1e-6,{n:a,f:l}=this;l>0?n<-Qh+o&&(n=-Qh+o):n>Qh-o&&(n=Qh-o);const d=l/Math.pow(Zm(n),a);let g=d*Math.sin(a*e),v=l-d*Math.cos(a*e);return g=.5*(g/Math.PI+.5),v=.5*(v/Math.PI+.5),{x:g,y:this.southernCenter?v:1-v,z:0}}unproject(e,n){e=(2*e-.5)*Math.PI,this.southernCenter&&(n=1-n),n=(2*(1-n)-.5)*Math.PI;const{n:o,f:a}=this,l=a-n,d=Math.sign(l),g=Math.sign(o)*Math.sqrt(e*e+l*l);let v=Math.atan2(e,Math.abs(l))*d;l*o<0&&(v-=Math.PI*Math.sign(e)*d);const b=vt(lt(v/o)+this.center[0],-180,180),S=vt(lt(2*Math.atan(Math.pow(a/g,1/o))-Qh),-ir,ir);return new $e(b,this.southernCenter?-S:S)}}class N1 extends Mc{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,n){return{x:qn(e),y:kn(n),z:0}}unproject(e,n){const o=Fn(e),a=_r(n);return new $e(o,a)}}const j1=Oe(ir);class fC extends Mc{project(e,n){const o=(n=Oe(n))*n,a=o*o;return{x:.5*((e=Oe(e))*(.8707-.131979*o+a*(a*(.003971*o-.001529*a)-.013791))/Math.PI+.5),y:1-.5*(n*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let o=n=(2*(1-n)-1)*Math.PI,a=25,l=0,d=o*o;do{d=o*o;const b=d*d;l=(o*(1.007226+d*(.015085+b*(.028874*d-.044475-.005916*b)))-n)/(1.007226+d*(.045255+b*(.259866*d-.311325-.005916*11*b))),o=vt(o-l,-j1,j1)}while(Math.abs(l)>1e-6&&--a>0);d=o*o;const g=vt(lt(e/(.8707+d*(d*(d*d*d*(.003971-.001529*d)-.013791)-.131979))),-180,180),v=lt(o);return new $e(g,v)}}const V1=Oe(ir);class pC extends Mc{project(e,n){n=Oe(n),e=Oe(e);const o=Math.cos(n),a=2/Math.PI,l=Math.acos(o*Math.cos(e/2)),d=Math.sin(l)/l,g=.5*(e*a+2*o*Math.sin(e/2)/d)||0,v=.5*(n+Math.sin(n)/d)||0;return{x:.5*(g/Math.PI+.5),y:1-.5*(v/Math.PI+1),z:0}}unproject(e,n){let o=e=(2*e-.5)*Math.PI,a=n=(2*(1-n)-1)*Math.PI,l=25;const d=1e-6;let g=0,v=0;do{const b=Math.cos(a),S=Math.sin(a),I=2*S*b,D=S*S,F=b*b,N=Math.cos(o/2),V=Math.sin(o/2),q=2*N*V,Y=V*V,oe=1-F*N*N,le=oe?1/oe:0,ae=oe?Math.acos(b*N)*Math.sqrt(1/oe):0,be=.5*(2*ae*b*V+2*o/Math.PI)-e,ge=.5*(ae*S+a)-n,Ie=.5*le*(F*Y+ae*b*N*D)+1/Math.PI,Ne=le*(q*I/4-ae*S*V),Ge=.125*le*(I*V-ae*S*F*q),tt=.5*le*(D*N+ae*Y*b)+.5,qe=Ne*Ge-tt*Ie;g=(ge*Ne-be*tt)/qe,v=(be*Ge-ge*Ie)/qe,o=vt(o-g,-Math.PI,Math.PI),a=vt(a-v,-V1,V1)}while((Math.abs(g)>d||Math.abs(v)>d)&&--l>0);return new $e(lt(o),lt(a))}}class U1 extends Mc{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Oe(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){const{scale:o,cosPhi:a}=this;return{x:Oe(e)*a*o+.5,y:-Math.sin(Oe(n))/a*o+.5,z:0}}unproject(e,n){const{scale:o,cosPhi:a}=this,l=-(n-.5)/o,d=vt(lt((e-.5)/o)/a,-180,180),g=Math.asin(vt(l*a,-1,1)),v=vt(lt(g),-ir,ir);return new $e(d,v)}}class mC extends N1{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,n,o){const a=If(e,n,o),l=Mm(ll(o));return i.N.transformMat4(a,a,l),{x:a[0],y:a[1],z:a[2]}}locationPoint(e,n){const o=dt(n.lat,n.lng),a=i.N.normalize([],o),l=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(n),e._centerAltitude):e._centerAltitude,d=Nn(1,0)*Jt*l;i.N.scaleAndAdd(o,o,a,d);const g=i.a6.identity(new Float64Array(16));return i.a6.multiply(g,e.pixelMatrix,e.globeMatrix),i.N.transformMat4(o,o,g),new ve(o[0],o[1])}pixelsPerMeter(e,n){return Nn(1,0)*n}pixelSpaceConversion(e,n,o){const a=Nn(1,e)*n,l=Zn(Nn(1,45)*n,a,o);return this.pixelsPerMeter(e,n)/l}createTileMatrix(e,n,o){const a=ry(ll(o.canonical));return i.a6.multiply(new Float64Array(16),e.globeMatrix,a)}createInversionMatrix(e,n){const{center:o}=e,a=Mm(ll(n));return i.a6.rotateY(a,a,Oe(o.lng)),i.a6.rotateX(a,a,Oe(o.lat)),i.a6.scale(a,a,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(a)}pointCoordinate(e,n,o,a){return ob(e,n,o,!0)||new Sr(0,0)}pointCoordinate3D(e,n,o){const a=this.pointCoordinate(e,n,o,0);return[a.x,a.y,a.z]}isPointAboveHorizon(e,n){return!ob(e,n.x,n.y,!1)}farthestPixelDistance(e){const n=function(a,l){const d=a.cameraToCenterDistance,g=a._centerAltitude*l,v=a._camera,b=a._camera.forward(),S=i.N.add([],i.N.scale([],b,-d),[0,0,g]),I=a.worldSize/(2*Math.PI),D=[0,0,-I],F=a.width/a.height,N=Math.tan(a.fovAboveCenter),V=i.N.scale([],v.up(),N),q=i.N.scale([],v.right(),N*F),Y=i.N.normalize([],i.N.add([],i.N.add([],b,V),q)),oe=[];let le;if(new Jg(S,Y).closestPointOnSphere(D,I,oe)){const ae=i.N.add([],oe,D),be=i.N.sub([],ae,S);le=Math.cos(a.fovAboveCenter)*i.N.length(be)}else{const ae=i.N.sub([],S,D),be=i.N.sub([],D,S);i.N.normalize(be,be);const ge=i.N.length(ae)-I;le=Math.sqrt(ge*(ge+2*I));const Ie=Math.acos(le/(I+ge))-Math.acos(i.N.dot(b,be));le*=Math.cos(Ie)}return 1.01*le}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),o=xc(e.zoom);if(o>0){const a=F1(e,Nn(1,e.center.lat)*e.worldSize),l=e.worldSize/(2*Math.PI),d=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Zn(n,a+l*(1-Math.cos(d)),Math.pow(o,10))}return n}upVector(e,n,o){return If(n,o,e,1)}upVectorScale(e){return{metersToTile:Tm(Sm(ll(e)))}}}function $1(t){const e=t.parallels,n=!!e&&Math.abs(e[0]+e[1])<.01;switch(t.name){case"mercator":return new N1(t);case"equirectangular":return new hC(t);case"naturalEarth":return new fC(t);case"equalEarth":return new uC(t);case"winkelTripel":return new pC(t);case"albers":return n?new U1(t):new cC(t);case"lambertConformalConic":return n?new U1(t):new dC(t);case"globe":return new mC(t)}throw new Error(`Invalid projection name: ${t.name}`)}const _C=Om.types,gC=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ym(t,e,n,o,a,l,d,g,v,b,S,I,D){const F=g?Math.min(Sc,Math.round(g[0])):0,N=g?Math.min(Sc,Math.round(g[1])):0;t.emplaceBack(e,n,Math.round(32*o),Math.round(32*a),l,d,(F<<1)+(v?1:0),N,16*b,16*S,256*I,256*D)}function Xm(t,e,n){t.emplaceBack(e,n)}function Km(t,e,n,o,a,l,d){t.emplaceBack(e,n,o,a,l,d)}function Jm(t,e,n,o,a){t.emplaceBack(e,n,o,a),t.emplaceBack(e,n,o,a),t.emplaceBack(e,n,o,a),t.emplaceBack(e,n,o,a)}function yC(t){for(const e of t.sections)if(Kd(e.text))return!0;return!1}class Iy{constructor(e){this.layoutVertexArray=new ku,this.indexArray=new eo,this.programConfigurations=e,this.segments=new Ii,this.dynamicLayoutVertexArray=new tl,this.opacityVertexArray=new mf,this.placedSymbolArray=new im,this.iconTransitioningVertexArray=new ta,this.globeExtVertexArray=new pf,this.zOffsetVertexArray=new Ru}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(e,n,o,a,l){this.isEmpty()||(o&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,MI.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,II.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,gC,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=e.createVertexBuffer(this.iconTransitioningVertexArray,PI.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,AI.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||l)&&(this.zOffsetVertexBuffer=e.createVertexBuffer(this.zOffsetVertexArray,CI.members,!0)),this.opacityVertexBuffer.itemSize=1),(o||a)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}sn(Iy,"SymbolBuffers");class Cy{constructor(e,n,o){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new o,this.segments=new Ii,this.collisionVertexArray=new gf,this.collisionVertexArrayExt=new tl}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,DI.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,kI.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}sn(Cy,"CollisionBuffers");class Qm{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(d=>d.fqid),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=i.a6.identity([]),this.placementViewportMatrix=i.a6.identity([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=yy(this.zoom,n["text-size"]),this.iconSizeData=yy(this.zoom,n["icon-size"]);const o=this.layers[0].layout,a=o.get("symbol-sort-key"),l=o.get("symbol-z-order");this.canOverlap=o.get("text-allow-overlap")||o.get("icon-allow-overlap")||o.get("text-ignore-placement")||o.get("icon-ignore-placement"),this.sortFeaturesByKey=l!=="viewport-y"&&a.constantOr(1)!==void 0,this.sortFeaturesByY=(l==="viewport-y"||l==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=o.get("text-writing-mode").map(d=>Ns[d]),this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id),this.sourceID=e.sourceID,this.projection=e.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=o.get("symbol-z-elevate")}createArrays(){this.text=new Iy(new K(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Iy(new K(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new am,this.lineVertexArray=new Bu,this.symbolInstances=new sm}calculateGlyphDependencies(e,n,o,a,l){for(let d=0;d<e.length;d++){const g=e.codePointAt(d);if(g===void 0)break;if(n[g]=!0,a&&l&&g<=65535){const v=zf[e.charAt(d)];v&&(n[v.charCodeAt(0)]=!0)}}}populate(e,n,o,a){const l=this.layers[0],d=l.layout,g=this.projection.name==="globe",v=d.get("text-font"),b=d.get("text-field"),S=d.get("icon-image"),I=(b.value.kind!=="constant"||b.value.value instanceof Qi&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),D=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,F=d.get("symbol-sort-key");if(this.features=[],!I&&!D)return;const N=n.iconDependencies,V=n.glyphDependencies,q=n.availableImages,Y=new fi(this.zoom);for(const{feature:oe,id:le,index:ae,sourceLayerIndex:be}of e){const ge=l._featureFilter.needGeometry,Ie=qi(oe,ge);if(!l._featureFilter.filter(Y,Ie,o))continue;if(ge||(Ie.geometry=no(oe,o,a)),g&&oe.type!==1&&o.z<=5){const qe=Ie.geometry,_t=.98078528056,Et=(ct,wt)=>{const st=If(ct.x,ct.y,o,1),bt=If(wt.x,wt.y,o,1);return i.N.dot(st,bt)<_t};for(let ct=0;ct<qe.length;ct++)qe[ct]=go(qe[ct],Et)}let Ne,Ge;if(I){const qe=l.getValueAndResolveTokens("text-field",Ie,o,q),_t=Qi.factory(qe);yC(_t)&&(this.hasRTLText=!0),(!this.hasRTLText||el()==="unavailable"||this.hasRTLText&&rs.isParsed())&&(Ne=LI(_t,l,Ie))}if(D){const qe=l.getValueAndResolveTokens("icon-image",Ie,o,q);Ge=qe instanceof bn?qe:bn.fromString(qe)}if(!Ne&&!Ge)continue;const tt=this.sortFeaturesByKey?F.evaluate(Ie,{},o):void 0;if(this.features.push({id:le,text:Ne,icon:Ge,index:ae,sourceLayerIndex:be,geometry:Ie.geometry,properties:oe.properties,type:_C[oe.type],sortKey:tt}),Ge&&(N[Ge.namePrimary]=!0,Ge.nameSecondary&&(N[Ge.nameSecondary]=!0)),Ne){const qe=v.evaluate(Ie,{},o).join(","),_t=d.get("text-rotation-alignment")==="map"&&d.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ns.vertical)>=0;for(const Et of Ne.sections)if(Et.image)N[Et.image.namePrimary]=!0;else{const ct=Ja(Ne.toString()),wt=Et.fontStack||qe,st=V[wt]=V[wt]||{};this.calculateGlyphDependencies(Et.text,st,_t,this.allowVerticalPlacement,ct)}}}d.get("symbol-placement")==="line"&&(this.features=function(oe){const le={},ae={},be=[];let ge=0;function Ie(qe){be.push(oe[qe]),ge++}function Ne(qe,_t,Et){const ct=ae[qe];return delete ae[qe],ae[_t]=ct,be[ct].geometry[0].pop(),be[ct].geometry[0]=be[ct].geometry[0].concat(Et[0]),ct}function Ge(qe,_t,Et){const ct=le[_t];return delete le[_t],le[qe]=ct,be[ct].geometry[0].shift(),be[ct].geometry[0]=Et[0].concat(be[ct].geometry[0]),ct}function tt(qe,_t,Et){const ct=Et?_t[0][_t[0].length-1]:_t[0][0];return`${qe}:${ct.x}:${ct.y}`}for(let qe=0;qe<oe.length;qe++){const _t=oe[qe],Et=_t.geometry,ct=_t.text?_t.text.toString():null;if(!ct){Ie(qe);continue}const wt=tt(ct,Et),st=tt(ct,Et,!0);if(wt in ae&&st in le&&ae[wt]!==le[st]){const bt=Ge(wt,st,Et),$t=Ne(wt,st,be[bt].geometry);delete le[wt],delete ae[st],ae[tt(ct,be[$t].geometry,!0)]=$t,be[bt].geometry=null}else wt in ae?Ne(wt,st,Et):st in le?Ge(wt,st,Et):(Ie(qe),le[wt]=ge-1,ae[st]=ge-1)}return be.filter(qe=>qe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((oe,le)=>oe.sortKey-le.sortKey)}update(e,n,o,a,l){const d=Object.keys(e).length!==0;if(d&&!this.stateDependentLayers.length)return;const g=d?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(e,n,g,o,a,l),this.icon.programConfigurations.updatePaintArrays(e,n,g,o,a,l)}updateZOffset(){const e=(l,d,g)=>{o+=d,o>l.length&&l.resize(o);for(let v=-d;v<0;v++)l.emplace(v+o,g)},n=(l,d,g)=>{a+=d,a>l.length&&l.resize(a);for(let v=-d;v<0;v++)l.emplace(v+a,g)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let o=0,a=0;for(let l=0;l<this.symbolInstances.length;l++){const d=this.symbolInstances.get(l),{numHorizontalGlyphVertices:g,numVerticalGlyphVertices:v,numIconVertices:b}=d,S=d.zOffset,I=b>0;if((g>0||v>0)&&(e(this.text.zOffsetVertexArray,g,S),e(this.text.zOffsetVertexArray,v,S)),I){const{placedIconSymbolIndex:D,verticalPlacedIconSymbolIndex:F}=d;D>=0&&n(this.icon.zOffsetVertexArray,b,S),F>=0&&n(this.icon.zOffsetVertexArray,d.numVerticalIconVertices,S)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=$1(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,n){const o=this.lineVertexArray.length;if(e.segment!==void 0)for(const{x:a,y:l}of n)this.lineVertexArray.emplaceBack(a,l);return{lineStartIndex:o,lineLength:this.lineVertexArray.length-o}}addSymbols(e,n,o,a,l,d,g,v,b,S,I,D,F,N,V,q){const Y=e.indexArray,oe=e.layoutVertexArray,le=e.globeExtVertexArray,ae=e.segments.prepareSegment(4*n.length,oe,Y,this.canOverlap?d.sortKey:void 0),be=this.glyphOffsetArray.length,ge=ae.vertexLength,Ie=this.allowVerticalPlacement&&g===Ns.vertical?Math.PI/2:0,Ne=d.text&&d.text.sections;for(let tt=0;tt<n.length;tt++){const{tl:qe,tr:_t,bl:Et,br:ct,texPrimary:wt,texSecondary:st,pixelOffsetTL:bt,pixelOffsetBR:$t,minFontScaleX:St,minFontScaleY:cn,glyphOffset:rn,isSDF:Dt,sectionIndex:An}=n[tt],_n=ae.vertexLength,ln=rn[1];if(Ym(oe,b.x,b.y,qe.x,ln+qe.y,wt.x,wt.y,o,Dt,bt.x,bt.y,St,cn),Ym(oe,b.x,b.y,_t.x,ln+_t.y,wt.x+wt.w,wt.y,o,Dt,$t.x,bt.y,St,cn),Ym(oe,b.x,b.y,Et.x,ln+Et.y,wt.x,wt.y+wt.h,o,Dt,bt.x,$t.y,St,cn),Ym(oe,b.x,b.y,ct.x,ln+ct.y,wt.x+wt.w,wt.y+wt.h,o,Dt,$t.x,$t.y,St,cn),v){const{x:kt,y:Tn,z:Kn}=v.anchor,[In,Jn,On]=v.up;Km(le,kt,Tn,Kn,In,Jn,On),Km(le,kt,Tn,Kn,In,Jn,On),Km(le,kt,Tn,Kn,In,Jn,On),Km(le,kt,Tn,Kn,In,Jn,On),Jm(e.dynamicLayoutVertexArray,kt,Tn,Kn,Ie)}else Jm(e.dynamicLayoutVertexArray,b.x,b.y,b.z,Ie);if(q){const kt=st||wt;Xm(e.iconTransitioningVertexArray,kt.x,kt.y),Xm(e.iconTransitioningVertexArray,kt.x+kt.w,kt.y),Xm(e.iconTransitioningVertexArray,kt.x,kt.y+kt.h),Xm(e.iconTransitioningVertexArray,kt.x+kt.w,kt.y+kt.h)}Y.emplaceBack(_n,_n+1,_n+2),Y.emplaceBack(_n+1,_n+2,_n+3),ae.vertexLength+=4,ae.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(rn[0]),tt!==n.length-1&&An===n[tt+1].sectionIndex||e.programConfigurations.populatePaintArrays(oe.length,d,d.index,{},F,N,V,Ne&&Ne[An])}const Ge=v?v.anchor:b;e.placedSymbolArray.emplaceBack(Ge.x,Ge.y,Ge.z,b.x,b.y,be,this.glyphOffsetArray.length-be,ge,S,I,b.segment,o?o[0]:0,o?o[1]:0,a[0],a[1],g,0,!1,0,D,0)}_commitLayoutVertex(e,n,o,a,l,d,g){e.emplaceBack(n,o,a,l,d,Math.round(g.x),Math.round(g.y))}_addCollisionDebugVertices(e,n,o,a,l,d,g){const v=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray),b=v.vertexLength,S=g.tileAnchorX,I=g.tileAnchorY;for(let F=0;F<4;F++)o.collisionVertexArray.emplaceBack(0,0,0,0);this._commitDebugCollisionVertexUpdate(o.collisionVertexArrayExt,n,e.padding,g.zOffset),this._commitLayoutVertex(o.layoutVertexArray,a,l,d,S,I,new ve(e.x1,e.y1)),this._commitLayoutVertex(o.layoutVertexArray,a,l,d,S,I,new ve(e.x2,e.y1)),this._commitLayoutVertex(o.layoutVertexArray,a,l,d,S,I,new ve(e.x2,e.y2)),this._commitLayoutVertex(o.layoutVertexArray,a,l,d,S,I,new ve(e.x1,e.y2)),v.vertexLength+=4;const D=o.indexArray;D.emplaceBack(b,b+1),D.emplaceBack(b+1,b+2),D.emplaceBack(b+2,b+3),D.emplaceBack(b+3,b),v.primitiveLength+=4}_addTextDebugCollisionBoxes(e,n,o,a,l,d){for(let g=a;g<l;g++){const v=o.get(g),b=this.getSymbolInstanceTextSize(e,d,n,g);this._addCollisionDebugVertices(v,b,this.textCollisionBox,v.projectedAnchorX,v.projectedAnchorY,v.projectedAnchorZ,d)}}_addIconDebugCollisionBoxes(e,n,o,a,l,d){for(let g=a;g<l;g++){const v=o.get(g),b=this.getSymbolInstanceIconSize(e,n,d.placedIconSymbolIndex);this._addCollisionDebugVertices(v,b,this.iconCollisionBox,v.projectedAnchorX,v.projectedAnchorY,v.projectedAnchorZ,d)}}generateCollisionDebugBuffers(e,n){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Cy(Ou,c1.members,ta),this.iconCollisionBox=new Cy(Ou,c1.members,ta);const o=qh(this.iconSizeData,e),a=qh(this.textSizeData,e);for(let l=0;l<this.symbolInstances.length;l++){const d=this.symbolInstances.get(l);this._addTextDebugCollisionBoxes(a,e,n,d.textBoxStartIndex,d.textBoxEndIndex,d),this._addTextDebugCollisionBoxes(a,e,n,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d),this._addIconDebugCollisionBoxes(o,e,n,d.iconBoxStartIndex,d.iconBoxEndIndex,d),this._addIconDebugCollisionBoxes(o,e,n,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex,d)}}getSymbolInstanceTextSize(e,n,o,a){const l=this.text.placedSymbolArray.get(n.rightJustifiedTextSymbolIndex>=0?n.rightJustifiedTextSymbolIndex:n.centerJustifiedTextSymbolIndex>=0?n.centerJustifiedTextSymbolIndex:n.leftJustifiedTextSymbolIndex>=0?n.leftJustifiedTextSymbolIndex:n.verticalPlacedTextSymbolIndex>=0?n.verticalPlacedTextSymbolIndex:a),d=Nm(this.textSizeData,e,l)/bo;return this.tilePixelRatio*d}getSymbolInstanceIconSize(e,n,o){const a=this.icon.placedSymbolArray.get(o),l=Nm(this.iconSizeData,e,a);return this.tilePixelRatio*l}_commitDebugCollisionVertexUpdate(e,n,o,a){e.emplaceBack(n,-o,-o,a),e.emplaceBack(n,o,-o,a),e.emplaceBack(n,o,o,a),e.emplaceBack(n,-o,o,a)}_updateTextDebugCollisionBoxes(e,n,o,a,l,d){for(let g=a;g<l;g++){const v=o.get(g),b=this.getSymbolInstanceTextSize(e,d,n,g);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,b,v.padding,d.zOffset)}}_updateIconDebugCollisionBoxes(e,n,o,a,l,d){for(let g=a;g<l;g++){const v=o.get(g),b=this.getSymbolInstanceIconSize(e,n,d.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,b,v.padding,d.zOffset)}}updateCollisionDebugBuffers(e,n){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const o=qh(this.iconSizeData,e),a=qh(this.textSizeData,e);for(let l=0;l<this.symbolInstances.length;l++){const d=this.symbolInstances.get(l);this._updateTextDebugCollisionBoxes(a,e,n,d.textBoxStartIndex,d.textBoxEndIndex,d),this._updateTextDebugCollisionBoxes(a,e,n,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d),this._updateIconDebugCollisionBoxes(o,e,n,d.iconBoxStartIndex,d.iconBoxEndIndex,d),this._updateIconDebugCollisionBoxes(o,e,n,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex,d)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,n,o,a,l,d,g,v,b){const S={};if(n<o){const{x1:I,y1:D,x2:F,y2:N,padding:V,projectedAnchorX:q,projectedAnchorY:Y,projectedAnchorZ:oe,tileAnchorX:le,tileAnchorY:ae,featureIndex:be}=e.get(n);S.textBox={x1:I,y1:D,x2:F,y2:N,padding:V,projectedAnchorX:q,projectedAnchorY:Y,projectedAnchorZ:oe,tileAnchorX:le,tileAnchorY:ae},S.textFeatureIndex=be}if(a<l){const{x1:I,y1:D,x2:F,y2:N,padding:V,projectedAnchorX:q,projectedAnchorY:Y,projectedAnchorZ:oe,tileAnchorX:le,tileAnchorY:ae,featureIndex:be}=e.get(a);S.verticalTextBox={x1:I,y1:D,x2:F,y2:N,padding:V,projectedAnchorX:q,projectedAnchorY:Y,projectedAnchorZ:oe,tileAnchorX:le,tileAnchorY:ae},S.verticalTextFeatureIndex=be}if(d<g){const{x1:I,y1:D,x2:F,y2:N,padding:V,projectedAnchorX:q,projectedAnchorY:Y,projectedAnchorZ:oe,tileAnchorX:le,tileAnchorY:ae,featureIndex:be}=e.get(d);S.iconBox={x1:I,y1:D,x2:F,y2:N,padding:V,projectedAnchorX:q,projectedAnchorY:Y,projectedAnchorZ:oe,tileAnchorX:le,tileAnchorY:ae},S.iconFeatureIndex=be}if(v<b){const{x1:I,y1:D,x2:F,y2:N,padding:V,projectedAnchorX:q,projectedAnchorY:Y,projectedAnchorZ:oe,tileAnchorX:le,tileAnchorY:ae,featureIndex:be}=e.get(v);S.verticalIconBox={x1:I,y1:D,x2:F,y2:N,padding:V,projectedAnchorX:q,projectedAnchorY:Y,projectedAnchorZ:oe,tileAnchorX:le,tileAnchorY:ae},S.verticalIconFeatureIndex=be}return S}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const o=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,o.textBoxStartIndex,o.textBoxEndIndex,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o.iconBoxStartIndex,o.iconBoxEndIndex,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(e,n){const o=e.placedSymbolArray.get(n),a=o.vertexStartIndex+4*o.numGlyphs;for(let l=o.vertexStartIndex;l<a;l+=4)e.indexArray.emplaceBack(l,l+1,l+2),e.indexArray.emplaceBack(l+1,l+2,l+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(e),o=Math.cos(e),a=[],l=[],d=[];for(let g=0;g<this.symbolInstances.length;++g){d.push(g);const v=this.symbolInstances.get(g);a.push(0|Math.round(n*v.tileAnchorX+o*v.tileAnchorY)),l.push(v.featureIndex)}return d.sort((g,v)=>a[g]-a[v]||l[v]-l[g]),d}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let e=0;e<this.symbolInstances.length;++e)this.symbolInstanceIndexesSortedZOffset.push(e)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((e,n)=>this.symbolInstances.get(n).zOffset-this.symbolInstances.get(e).zOffset)}addToSortKeyRanges(e,n){const o=this.sortKeyRanges[this.sortKeyRanges.length-1];o&&o.sortKey===n?o.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const o=this.symbolInstances.get(n);this.featureSortOrder.push(o.featureIndex);const{rightJustifiedTextSymbolIndex:a,centerJustifiedTextSymbolIndex:l,leftJustifiedTextSymbolIndex:d,verticalPlacedTextSymbolIndex:g,placedIconSymbolIndex:v,verticalPlacedIconSymbolIndex:b}=o;a>=0&&this.addIndicesForPlacedSymbol(this.text,a),l>=0&&l!==a&&this.addIndicesForPlacedSymbol(this.text,l),d>=0&&d!==l&&d!==a&&this.addIndicesForPlacedSymbol(this.text,d),g>=0&&this.addIndicesForPlacedSymbol(this.text,g),v>=0&&this.addIndicesForPlacedSymbol(this.icon,v),b>=0&&this.addIndicesForPlacedSymbol(this.icon,b)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}sn(Qm,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Qm.addDynamicAttributes=Jm;const vC=new pi({"symbol-placement":new Nt(Je.layout_symbol["symbol-placement"]),"symbol-spacing":new Nt(Je.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Nt(Je.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new wn(Je.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Nt(Je.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Nt(Je.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new Nt(Je.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Nt(Je.layout_symbol["icon-ignore-placement"]),"icon-optional":new Nt(Je.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Nt(Je.layout_symbol["icon-rotation-alignment"]),"icon-size":new wn(Je.layout_symbol["icon-size"]),"icon-text-fit":new wn(Je.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new wn(Je.layout_symbol["icon-text-fit-padding"]),"icon-image":new wn(Je.layout_symbol["icon-image"]),"icon-rotate":new wn(Je.layout_symbol["icon-rotate"]),"icon-padding":new Nt(Je.layout_symbol["icon-padding"]),"icon-keep-upright":new Nt(Je.layout_symbol["icon-keep-upright"]),"icon-offset":new wn(Je.layout_symbol["icon-offset"]),"icon-anchor":new wn(Je.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Nt(Je.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Nt(Je.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Nt(Je.layout_symbol["text-rotation-alignment"]),"text-field":new wn(Je.layout_symbol["text-field"]),"text-font":new wn(Je.layout_symbol["text-font"]),"text-size":new wn(Je.layout_symbol["text-size"]),"text-max-width":new wn(Je.layout_symbol["text-max-width"]),"text-line-height":new wn(Je.layout_symbol["text-line-height"]),"text-letter-spacing":new wn(Je.layout_symbol["text-letter-spacing"]),"text-justify":new wn(Je.layout_symbol["text-justify"]),"text-radial-offset":new wn(Je.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Nt(Je.layout_symbol["text-variable-anchor"]),"text-anchor":new wn(Je.layout_symbol["text-anchor"]),"text-max-angle":new Nt(Je.layout_symbol["text-max-angle"]),"text-writing-mode":new Nt(Je.layout_symbol["text-writing-mode"]),"text-rotate":new wn(Je.layout_symbol["text-rotate"]),"text-padding":new Nt(Je.layout_symbol["text-padding"]),"text-keep-upright":new Nt(Je.layout_symbol["text-keep-upright"]),"text-transform":new wn(Je.layout_symbol["text-transform"]),"text-offset":new wn(Je.layout_symbol["text-offset"]),"text-allow-overlap":new Nt(Je.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Nt(Je.layout_symbol["text-ignore-placement"]),"text-optional":new Nt(Je.layout_symbol["text-optional"]),visibility:new Nt(Je.layout_symbol.visibility)});var Py={paint:new pi({"icon-opacity":new wn(Je.paint_symbol["icon-opacity"]),"icon-emissive-strength":new wn(Je.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new wn(Je.paint_symbol["text-emissive-strength"]),"icon-color":new wn(Je.paint_symbol["icon-color"]),"icon-halo-color":new wn(Je.paint_symbol["icon-halo-color"]),"icon-halo-width":new wn(Je.paint_symbol["icon-halo-width"]),"icon-halo-blur":new wn(Je.paint_symbol["icon-halo-blur"]),"icon-translate":new Nt(Je.paint_symbol["icon-translate"]),"icon-translate-anchor":new Nt(Je.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new wn(Je.paint_symbol["icon-image-cross-fade"]),"text-opacity":new wn(Je.paint_symbol["text-opacity"]),"text-color":new wn(Je.paint_symbol["text-color"],{runtimeType:ko,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new wn(Je.paint_symbol["text-halo-color"]),"text-halo-width":new wn(Je.paint_symbol["text-halo-width"]),"text-halo-blur":new wn(Je.paint_symbol["text-halo-blur"]),"text-translate":new Nt(Je.paint_symbol["text-translate"]),"text-translate-anchor":new Nt(Je.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Nt(Je.paint_symbol["icon-color-saturation"])}),layout:vC};class G1{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Ts,this.defaultValue=e}evaluate(e){if(e.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}sn(G1,"FormatSectionOverride",{omit:["defaultValue"]});class e_ extends qo{constructor(e,n,o){super(e,Py,n,o)}recalculate(e,n){super.recalculate(e,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const o=this.layout.get("text-writing-mode");if(o){const a=[];for(const l of o)a.indexOf(l)<0&&a.push(l);this.layout._values["text-writing-mode"]=a}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,n,o,a){const l=this.layout.get(e).evaluate(n,{},o,a),d=this._unevaluatedLayout._values[e];return d.isDataDriven()||vu(d.value)||!l?l:function(g,v){return v.replace(/{([^{}]+)}/g,(b,S)=>S in g?String(g[S]):"")}(n.properties,l)}createBucket(e){return new Qm(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of Py.paint.overridableProperties){if(!e_.hasPaintOverride(this.layout,e))continue;const n=this.paint.get(e),o=new G1(n),a=new Mh(o,n.property.specification,this.scope,this.options);let l=null;l=n.value.kind==="constant"||n.value.kind==="source"?new Yd("source",a):new xu("composite",a,n.value.zoomStops,n.value._interpolationType),this.paint._values[e]=new pc(n.property,l,n.parameters)}}_handleOverridablePaintPropertyUpdate(e,n,o){return!(!this.layout||n.isDataDriven()||o.isDataDriven())&&e_.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,n){const o=e.get("text-field"),a=Py.paint.properties[n];let l=!1;const d=g=>{for(const v of g)if(a.overrides&&a.overrides.hasOverride(v))return void(l=!0)};if(o.value.kind==="constant"&&o.value.value instanceof Qi)d(o.value.value.sections);else if(o.value.kind==="source"){const g=b=>{l||(b instanceof Es&&Fi(b.value)===Va?d(b.value.sections):b instanceof $a?d(b.sections):b.eachChild(g))},v=o.value;v._styleExpression&&g(v._styleExpression.expression)}return l}getProgramIds(){const e=this.paint.get("icon-opacity").constantOr(1)!==0,n=this.paint.get("text-opacity").constantOr(1)!==0,o=[];return e&&o.push("symbolIcon"),n&&o.push("symbolSDF"),o}getDefaultProgramParams(e,n){return{config:new H(this,n),overrideFog:!1}}}const xC=new pi({visibility:new Nt(Je.layout_background.visibility)});var bC={paint:new pi({"background-color":new Nt(Je.paint_background["background-color"]),"background-pattern":new Nt(Je.paint_background["background-pattern"]),"background-opacity":new Nt(Je.paint_background["background-opacity"]),"background-emissive-strength":new Nt(Je.paint_background["background-emissive-strength"])}),layout:xC};const wC=new pi({visibility:new Nt(Je.layout_raster.visibility)});var TC={paint:new pi({"raster-opacity":new Nt(Je.paint_raster["raster-opacity"]),"raster-color":new Dl(Je.paint_raster["raster-color"]),"raster-color-mix":new Nt(Je.paint_raster["raster-color-mix"]),"raster-color-range":new Nt(Je.paint_raster["raster-color-range"]),"raster-hue-rotate":new Nt(Je.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Nt(Je.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Nt(Je.paint_raster["raster-brightness-max"]),"raster-saturation":new Nt(Je.paint_raster["raster-saturation"]),"raster-contrast":new Nt(Je.paint_raster["raster-contrast"]),"raster-resampling":new Nt(Je.paint_raster["raster-resampling"]),"raster-fade-duration":new Nt(Je.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Nt(Je.paint_raster["raster-emissive-strength"]),"raster-array-band":new Nt(Je.paint_raster["raster-array-band"]),"raster-elevation":new Nt(Je.paint_raster["raster-elevation"])}),layout:wC},Dy=jr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class ky{constructor(e,n,o,a){this.context=e,this.format=o,this.texture=e.gl.createTexture(),this.update(n,a)}update(e,n,o){const{width:a,height:l}=e,{context:d}=this,{gl:g}=d;if(g.bindTexture(g.TEXTURE_2D,this.texture),d.pixelStoreUnpackFlipY.set(!1),d.pixelStoreUnpack.set(1),d.pixelStoreUnpackPremultiplyAlpha.set(this.format===g.RGBA&&(!n||n.premultiply!==!1)),o||this.size&&this.size[0]===a&&this.size[1]===l){const{x:v,y:b}=o||{x:0,y:0};if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||ImageBitmap&&e instanceof ImageBitmap)g.texSubImage2D(g.TEXTURE_2D,0,v,b,g.RGBA,g.UNSIGNED_BYTE,e);else{let S=this.format,I=g.UNSIGNED_BYTE;this.format===g.R32F&&(S=g.RED,I=g.FLOAT),g.texSubImage2D(g.TEXTURE_2D,0,v,b,a,l,S,I,e.data)}}else if(this.size=[a,l],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||ImageBitmap&&e instanceof ImageBitmap){let v=this.format;this.format===g.R8&&(v=g.RED),g.texImage2D(g.TEXTURE_2D,0,this.format,v,g.UNSIGNED_BYTE,e)}else{let v=this.format,b=this.format,S=g.UNSIGNED_BYTE;this.format===g.DEPTH_COMPONENT&&(v=g.DEPTH_COMPONENT16,S=g.UNSIGNED_SHORT),this.format===g.R8&&(b=g.RED),this.format===g.R32F&&(S=g.FLOAT,b=g.RED),g.texImage2D(g.TEXTURE_2D,0,v,a,l,0,b,S,e.data)}this.useMipmap=!!(n&&n.useMipmap),this.useMipmap&&g.generateMipmap(g.TEXTURE_2D)}bind(e,n,o=!1){const{context:a}=this,{gl:l}=a;l.bindTexture(l.TEXTURE_2D,this.texture),e!==this.minFilter&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,this.useMipmap&&!o?e===l.NEAREST?l.NEAREST_MIPMAP_NEAREST:l.LINEAR_MIPMAP_LINEAR:e),this.minFilter=e),n!==this.wrapS&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,n),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,n),this.wrapS=n)}bindExtraParam(e,n,o,a){const{context:l}=this,{gl:d}=l;d.bindTexture(d.TEXTURE_2D,this.texture),n!==this.magFilter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,n),this.magFilter=n),e!==this.minFilter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,this.useMipmap?e===d.NEAREST?d.NEAREST_MIPMAP_NEAREST:d.LINEAR_MIPMAP_LINEAR:e),this.minFilter=e),o!==this.wrapS&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,o),this.wrapS=o),a!==this.wrapT&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,a),this.wrapT=a)}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class t_{constructor(e,n){this.context=e,this.texture=n}bind(e,n){const{context:o}=this,{gl:a}=o;a.bindTexture(a.TEXTURE_2D,this.texture),e!==this.minFilter&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,e),this.minFilter=e),n!==this.wrapS&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,n),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,n),this.wrapS=n)}}function n_(t,e,n,o,a,l,d,g){const v=[t,e,1,n,o,1,a,l,1],b=[d,g,1],S=i.co.adjoint([],v),[I,D,F]=i.N.transformMat3(b,b,S);return i.co.multiply(v,v,[I,0,0,0,D,0,0,0,F])}function H1(t,e,n,o,a,l,d,g){const v=function(b,S,I,D,F,N,V,q){const Y=n_(0,0,1,0,1,1,0,1),oe=n_(b,S,I,D,F,N,V,q),le=i.co.adjoint([],Y);return i.co.multiply(oe,oe,le)}(t,e,n,o,a,l,d,g);return[v[2]/v[8]/Jt,v[5]/v[8]/Jt]}function r_(t){return[t[0],Math.min(Math.max(t[1],-ir),ir)]}class q1 extends qs{constructor(e,n,o,a){super(),this.id=e,this.dispatcher=o,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(a),this.options=n,this._dirty=!1}load(e,n){if(this._loaded=n||!1,this.fire(new bs("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return e&&(this.coordinates=e),this._loaded=!0,void this._finishLoading();this._imageRequest=Ue(this.map._requestManager.transformRequest(this.url,oo.Image),(o,a)=>{this._imageRequest=null,this._loaded=!0,o?this.fire(new ml(o)):a&&(this.image=a instanceof HTMLImageElement?Mt.getImageData(a):a,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,e&&(this.coordinates=e),this._finishLoading())})}loaded(){return this._loaded}updateImage(e){return e.url?(this._imageRequest&&e.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=e.url,this.load(e.coordinates,this._loaded),this):this}setTexture(e){if(!(e.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new t_(this.map.painter.context,e.handle),this.width=e.dimensions[0],this.height=e.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new bs("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof t_||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(e){if(this.coordinates=e,this._boundsArray=void 0,this._unsupportedCoords=!1,!e.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let n=e[0][1],o=e[0][1];for(const l of e)l[1]>o&&(o=l[1]),l[1]<n&&(n=l[1]);const a=(o+n)/2;if(a>ir?this.onNorthPole=!0:a<-ir&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const l=e.map(Sr.fromLngLat);this.tileID=function(d){let g=1/0,v=1/0,b=-1/0,S=-1/0;for(const V of d)g=Math.min(g,V.x),v=Math.min(v,V.y),b=Math.max(b,V.x),S=Math.max(S,V.y);const I=Math.max(b-g,S-v),D=Math.max(0,Math.floor(-Math.log(I)/Math.LN2)),F=Math.pow(2,D);let N=Math.floor((g+b)/2*F);return N>1&&(N-=1),new Pt(D,N,Math.floor((v+S)/2*F))}(l),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new bs("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(e){for(const Y in this.tiles){const oe=this.tiles[Y];oe.state!=="loaded"&&(oe.state="loaded",oe.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const n=jf(new Pt(0,0,0),this.map.transform.projection),o=[n.projection.project(this.coordinates[0][0],this.coordinates[0][1]),n.projection.project(this.coordinates[1][0],this.coordinates[1][1]),n.projection.project(this.coordinates[2][0],this.coordinates[2][1]),n.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(Y){const oe=Y[1].x-Y[0].x,le=Y[1].y-Y[0].y,ae=Y[2].x-Y[1].x,be=Y[2].y-Y[1].y,ge=Y[3].x-Y[2].x,Ie=Y[3].y-Y[2].y,Ne=Y[0].x-Y[3].x,Ge=Y[0].y-Y[3].y,tt=oe*be-ae*le,qe=ae*Ie-ge*be,_t=ge*Ge-Ne*Ie,Et=Ne*le-oe*Ge;return tt>0&&qe>0&&_t>0&&Et>0||tt<0&&qe<0&&_t<0&&Et<0}(o))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const a=jf(this.tileID,this.map.transform.projection),[l,d,g,v]=this.coordinates.map(Y=>{const oe=a.projection.project(Y[0],Y[1]);return B1(a,oe)._round()});this.perspectiveTransform=H1(l.x,l.y,d.x,d.y,g.x,g.y,v.x,v.y);const b=this._boundsArray=new Ta;b.emplaceBack(l.x,l.y,0,0),b.emplaceBack(d.x,d.y,Jt,0),b.emplaceBack(v.x,v.y,0,Jt),b.emplaceBack(g.x,g.y,Jt,Jt),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=e.createVertexBuffer(b,Dy.members),this.boundsSegments=Ii.simpleSegment(0,0,4,2);const S=[],I=[r_((D=this.coordinates)[0]),r_(D[1]),r_(D[2]),r_(D[3])];var D;const[F,N,V,q]=function(Y){let oe=Y[0][0],le=oe,ae=Y[0][1],be=ae;for(let ge=1;ge<Y.length;ge++)Y[ge][0]<oe?oe=Y[ge][0]:Y[ge][0]>le&&(le=Y[ge][0]),Y[ge][1]<ae?ae=Y[ge][1]:Y[ge][1]>be&&(be=Y[ge][1]);return[oe,ae,le-oe,be-ae]}(I);{const Y=new Ta,[oe,le,ae,be]=function(bt){let $t=bt[0].x,St=$t,cn=bt[0].y,rn=cn;for(let Dt=1;Dt<bt.length;Dt++)bt[Dt].x<$t?$t=bt[Dt].x:bt[Dt].x>St&&(St=bt[Dt].x),bt[Dt].y<cn?cn=bt[Dt].y:bt[Dt].y>rn&&(rn=bt[Dt].y);return[$t,cn,St-$t,rn-cn]}(o),ge=bt=>[(bt.x-oe)/ae,(bt.y-le)/be],[Ie,Ne,Ge,tt]=o.map(ge),qe=function(bt,$t,St,cn,rn,Dt,An,_n){const ln=n_(0,0,1,0,1,1,0,1),kt=n_(bt,$t,St,cn,rn,Dt,An,_n),Tn=i.co.adjoint([],kt);return i.co.multiply(ln,ln,Tn)}(Ie[0],Ie[1],Ne[0],Ne[1],Ge[0],Ge[1],tt[0],tt[1]);this.elevatedGlobePerspectiveTransform=H1(Ie[0],Ie[1],Ne[0],Ne[1],Ge[0],Ge[1],tt[0],tt[1]);const _t=(bt,$t)=>{S.push(bt.lng);const St=Math.round((bt.lng-F)/V*Jt),cn=Math.round((bt.lat-N)/q*Jt),rn=ge($t),Dt=i.N.transformMat3([],[rn[0],rn[1],1],qe),An=Math.round(Dt[0]/Dt[2]*Jt),_n=Math.round(Dt[1]/Dt[2]*Jt);Y.emplaceBack(St,cn,An,_n)},Et=o[3].x-o[0].x,ct=o[3].y-o[0].y,wt=o[2].x-o[1].x,st=o[2].y-o[1].y;for(let bt=0;bt<65;bt++){const $t=bt/64,St=[o[0].x+$t*Et,o[0].y+$t*ct],cn=[o[1].x+$t*wt,o[1].y+$t*st],rn=cn[0]-St[0],Dt=cn[1]-St[1];for(let An=0;An<65;An++){const _n=An/64,ln={x:St[0]+rn*_n,y:St[1]+Dt*_n,z:0};_t(n.projection.unproject(ln.x,ln.y),ln)}}this.elevatedGlobeVertexBuffer=e.createVertexBuffer(Y,Dy.members)}{this.maxLongitudeTriangleSize=0;let Y=[],oe=new eo;const le=(ae,be,ge)=>{oe.emplaceBack(ae,be,ge);const Ie=S[ae],Ne=S[be],Ge=S[ge],tt=Math.min(Math.min(Ie,Ne),Ge),qe=Math.max(Math.max(Ie,Ne),Ge)-tt;qe>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=qe),Y.push(tt+qe/2)};for(let ae=0;ae<64;ae++)for(let be=0;be<64;be++){const ge=65*ae+be,Ie=ge+1,Ne=ge+65,Ge=Ne+1;le(ge,Ne,Ie),le(Ie,Ne,Ge)}[Y,oe]=function(ae,be){const ge=Array.from({length:ae.length},(Ge,tt)=>tt);ge.sort((Ge,tt)=>ae[Ge]-ae[tt]);const Ie=[],Ne=new eo;for(let Ge=0;Ge<ge.length;Ge++){const tt=ge[Ge];Ie.push(ae[tt]);const qe=3*tt,_t=qe+1;Ne.emplaceBack(be.uint16[qe],be.uint16[_t],be.uint16[_t+1])}return[Ie,Ne]}(Y,oe),this.elevatedGlobeTrianglesCenterLongitudes=Y,this.elevatedGlobeIndexBuffer=e.createIndexBuffer(oe)}this.elevatedGlobeSegments=Ii.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,V/Jt,0,q/Jt,0,0,N,F,0])}prepare(){const e=Object.keys(this.tiles).length!==0;if(this.tileID&&!e)return;const n=this.map.painter.context,o=n.gl;!this._dirty||this.texture instanceof t_||(this.texture?this.texture.update(this.image):(this.texture=new ky(n,this.image,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE)),this._dirty=!1),e&&this._prepareData(n)}loadTile(e,n){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},n(null)):(e.state="errored",n(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(e){const n=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!n)return null;const o=this.elevatedGlobeTrianglesCenterLongitudes;let a=((S,I)=>S+360*Math.round((I-S)/360))(e+180,o[0]);const l=new Ii,d=(S,I)=>{l.segments.push({vertexOffset:0,primitiveOffset:S,vertexLength:n.segments[0].vertexLength,primitiveLength:I,sortKey:void 0,vaos:{}})},g=.51*this.maxLongitudeTriangleSize;if(Math.abs(o[0]-a)<=g){const S=it(o,0,o.length,a+g);return S===o.length||d(S,Ee(o,S+1,o.length,a+360-g)-S),l}a<o[0]&&(a+=360);const v=Ee(o,0,o.length,a-g);if(v===o.length)return d(0,o.length),l;d(0,v-0);const b=it(o,v+1,o.length,a+g);return b!==o.length&&d(b,o.length-b),l}}const EC=(Math.pow(256,2)-1)/16907520;class W1 extends qo{constructor(e,n,o){super(e,TC,n,o),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isLayerDraped(e){return!(e&&e._source instanceof q1&&(e._source.onNorthPole||e._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(e){e!=="raster-color"&&e!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(e){if(!this.hasColorMap()||!this._curRampRange)return;const n=this._transitionablePaint._values["raster-color"].value.expression,[o,a]=e||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(o)&&isNaN(a)||o===this._curRampRange[0]&&a===this._curRampRange[1]||(this.colorRamp=Cf({expression:n,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:o,end:a}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[o,a])}}const SC=new pi({visibility:new Nt(Je["layout_raster-particle"].visibility)});var MC={paint:new pi({"raster-particle-array-band":new Nt(Je["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Nt(Je["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Dl(Je["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Nt(Je["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Nt(Je["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Nt(Je["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Nt(Je["paint_raster-particle"]["raster-particle-reset-rate-factor"])}),layout:SC};class Z1 extends qo{constructor(e,n,o){super(e,MC,n,o),this._updateColorRamp(),this.onRemove=a=>{this.colorRampTexture&&this.colorRampTexture.destroy(),this.transformFeedbackObject&&a.painter.context.gl.deleteTransformFeedback(this.transformFeedbackObject),this.tileFramebuffer&&this.tileFramebuffer.destroy()},this.lastInvalidatedAt=Mt.now()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isLayerDraped(e){return!1}_handleSpecialPaintPropertyUpdate(e){e!=="raster-particle-color"&&e!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),e==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const e=this._transitionablePaint._values["raster-particle-color"].value.expression,n=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Cf({expression:e,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:n}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Mt.now()}}class AC extends qo{constructor(e,n){super(e,{},n),this.implementation=e,e.slot&&(this.slot=e.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(e){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}const IC=new pi({visibility:new Nt(Je.layout_sky.visibility)});var CC={paint:new pi({"sky-type":new Nt(Je.paint_sky["sky-type"]),"sky-atmosphere-sun":new Nt(Je.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Nt(Je.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Nt(Je.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Nt(Je.paint_sky["sky-gradient-radius"]),"sky-gradient":new Dl(Je.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Nt(Je.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Nt(Je.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Nt(Je.paint_sky["sky-opacity"])}),layout:IC};function Oy(t,e,n){const o=[0,0,1],a=i.bi.identity([]);return i.bi.rotateY(a,a,n?-Oe(t)+Math.PI:Oe(t)),i.bi.rotateX(a,a,-Oe(e)),i.N.transformQuat(o,o,a),i.N.normalize(o,o)}var PC={paint:new pi({})};function Y1(t,e){const n=i_(t.projection,t.zoom,t.width,t.height),o=function(l,d,g,v,b){const S=new $e(g.lng-180*Ac,g.lat),I=new $e(g.lng+180*Ac,g.lat),D=l.project(S.lng,S.lat),F=l.project(I.lng,I.lat),N=-Math.atan2(F.y-D.y,F.x-D.x),V=Sr.fromLngLat(g);V.y=vt(V.y,-1+Ac,1-Ac);const q=V.toLngLat(),Y=l.project(q.lng,q.lat),oe=Sr.fromLngLat(q);oe.x+=Ac;const le=oe.toLngLat(),ae=l.project(le.lng,le.lat),be=J1(ae.x-Y.x,ae.y-Y.y,N),ge=Sr.fromLngLat(q);ge.y+=Ac;const Ie=ge.toLngLat(),Ne=l.project(Ie.lng,Ie.lat),Ge=J1(Ne.x-Y.x,Ne.y-Y.y,N),tt=Math.abs(be.x)/Math.abs(Ge.y),qe=i.a6.identity([]);i.a6.rotateZ(qe,qe,-N*(1-(b?0:v)));const _t=i.a6.identity([]);return i.a6.scale(_t,_t,[1,1-(1-tt)*v,1]),_t[4]=-Ge.x/Ge.y*v,i.a6.rotateZ(_t,_t,N),i.a6.multiply(_t,qe,_t),_t}(t.projection,0,t.center,n,e),a=X1(t);return i.a6.scale(o,o,[a,a,1]),o}function X1(t){const e=t.projection,n=i_(t.projection,t.zoom,t.width,t.height),o=K1(e,t.center),a=K1(e,$e.convert(e.center));return Math.pow(2,o*n+(1-n)*a)}function i_(t,e,n,o,a=1/0){const l=t.range;if(!l)return 0;const d=Math.min(a,Math.max(n,o)),g=Math.log(d/1024)/Math.LN2;return wr(l[0]+g,l[1]+g,e)}const Ac=1/4e4;function K1(t,e){const n=vt(e.lat,-ir,ir),o=new $e(e.lng-180*Ac,n),a=new $e(e.lng+180*Ac,n),l=t.project(o.lng,n),d=t.project(a.lng,n),g=Sr.fromLngLat(o),v=Sr.fromLngLat(a),b=d.x-l.x,S=d.y-l.y,I=v.x-g.x,D=v.y-g.y,F=Math.sqrt((I*I+D*D)/(b*b+S*S));return Math.log(F)/Math.LN2}function J1(t,e,n){const o=Math.cos(n),a=Math.sin(n);return{x:t*o-e*a,y:t*a+e*o}}function Q1(t,e,n){i.a6.identity(t),i.a6.rotateZ(t,t,Oe(e[2])),i.a6.rotateX(t,t,Oe(e[0])),i.a6.rotateY(t,t,Oe(e[1])),i.a6.scale(t,t,n),i.a6.multiply(t,t,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function o_(t,e,n,o,a,l,d,g){const v=[n[0]-e[0],n[1]-e[1],0],b=[o[0]-e[0],o[1]-e[1],0];if(i.N.length(v)<1e-12||i.N.length(b)<1e-12)return i.bi.identity(t);const S=i.N.cross([],v,b);i.N.normalize(S,S),i.N.subtract(b,o,e),v[2]=(l-a)*g,b[2]=(d-a)*g;const I=v;return i.N.cross(I,v,b),i.N.normalize(I,I),i.bi.rotationTo(t,S,I)}function Ry(t,e,n=!1){const o=xc(e.zoom),a=function(l,d,g){const v=d.worldSize,b=[l[12],l[13],l[14]],S=_r(b[1]/v),I=Fn(b[0]/v),D=i.a6.identity([]),F=Nn(1,S)*v,N=Nn(1,0)*v*or(S,d.zoom),V=1/iy(v);let q=N*V;if(g){const ae=i_(d.projection,d.zoom,d.width,d.height,1024);q=V*d.projection.pixelSpaceConversion(d.center.lat,v,ae)}const Y=dt(S,I);i.N.add(Y,Y,i.N.scale([],i.N.normalize([],Y),F*q*b[2]));const oe=function(ae){const be=[ae[0],ae[1],ae[2]];let ge=[0,1,0];const Ie=i.N.cross([],ge,be);return i.N.cross(ge,be,Ie),i.N.squaredLength(ge)===0&&(ge=[0,1,0],i.N.cross(Ie,be,ge)),i.N.normalize(Ie,Ie),i.N.normalize(ge,ge),i.N.normalize(be,be),[Ie[0],Ie[1],Ie[2],0,ge[0],ge[1],ge[2],0,be[0],be[1],be[2],0,ae[0],ae[1],ae[2],1]}(Y);i.a6.scale(D,D,[q,q,q*F]),i.a6.translate(D,D,[-b[0],-b[1],-b[2]]);const le=i.a6.multiply([],d.globeMatrix,oe);return i.a6.multiply(le,le,D),i.a6.multiply(le,le,l),le}(t,e,n);if(o>0){const l=function(d,g){const v=g.worldSize,b=Nn(1,0)*v*or(g.center.lat,g.zoom)/iy(v),S=Nn(1,g.center.lat)*v,I=i.a6.identity([]);return i.a6.rotateY(I,I,Oe(g.center.lng)),i.a6.rotateX(I,I,Oe(g.center.lat)),i.a6.translate(I,I,[0,0,se]),i.a6.scale(I,I,[b,b,b*S]),i.a6.translate(I,I,[g.point.x-.5*v,g.point.y-.5*v,0]),i.a6.multiply(I,I,d),i.a6.multiply(I,g.globeMatrix,I)}(t,e);return function(d,g,v){const b=(N,V,q)=>{const Y=i.N.length(N),oe=i.N.length(V),le=Bl(N,V,q);return i.N.scale(le,le,1/i.N.length(le)*Zn(Y,oe,q))},S=b([d[0],d[1],d[2]],[g[0],g[1],g[2]],v),I=b([d[4],d[5],d[6]],[g[4],g[5],g[6]],v),D=b([d[8],d[9],d[10]],[g[8],g[9],g[10]],v),F=Bl([d[12],d[13],d[14]],[g[12],g[13],g[14]],v);return[S[0],S[1],S[2],0,I[0],I[1],I[2],0,D[0],D[1],D[2],0,F[0],F[1],F[2],1]}(a,l,o)}return a}function ew(t,e,n,o){const a=Ti.projectAabbCorners(o,n);let l=Number.MAX_VALUE,d=-1;for(let b=0;b<a.length;++b){const S=a[b];S[0]=(.5*S[0]+.5)*e.width,S[1]=(.5-.5*S[1])*e.height,S[2]<l&&(d=b,l=S[2])}const g=b=>new ve(a[b][0],a[b][1]);let v;switch(d){case 0:case 6:v=[g(1),g(5),g(4),g(7),g(3),g(2),g(1)];break;case 1:case 7:v=[g(0),g(4),g(5),g(6),g(2),g(3),g(0)];break;case 3:case 5:v=[g(1),g(0),g(4),g(7),g(6),g(2),g(1)];break;default:v=[g(1),g(5),g(6),g(7),g(3),g(0),g(1)]}if(ra(t,v))return l}const DC=jr([{name:"a_pos_3f",components:3,type:"Float32"}]),kC=jr([{name:"a_color_3f",components:3,type:"Float32"}]),OC=jr([{name:"a_color_4f",components:4,type:"Float32"}]),RC=jr([{name:"a_uv_2f",components:2,type:"Float32"}]),LC=jr([{name:"a_normal_3f",components:3,type:"Float32"}]),zC=jr([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),FC=jr([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class tw{constructor(e,n){this.feature=e,this.instancedDataOffset=n,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class nw{constructor(){this.instancedDataArray=new xf,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class Ly{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.fqid),this.projection=e.projection,this.index=e.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0}}populate(e,n,o,a){this.tileToMeter=sr(o);const l=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:d,id:g,index:v,sourceLayerIndex:b}of e){const S=qi(d,l);if(!this.layers[0]._featureFilter.filter(new fi(this.zoom),S,o))continue;const I={id:g,sourceLayerIndex:b,index:v,geometry:l?S.geometry:no(d,o,a),properties:d.properties,type:d.type,patterns:{}},D=this.addFeature(I,I.geometry,S);D&&n.featureIndex.insert(d,I.geometry,v,b,this.index,this.instancesPerModel[D].instancedDataArray.length,Jt/32)}this.lookup=null}update(e,n,o,a){for(const l in this.instancesPerModel){const d=this.instancesPerModel[l];for(const g in e)d.idToFeaturesIndex.hasOwnProperty(g)&&this.evaluate(d.features[d.idToFeaturesIndex[g]],e[g],d,!0)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let e=!1;for(const n in this.instancesPerModel){const o=this.instancesPerModel[n];for(const a of o.features){const l=this.layers[0],d=a.feature,g=this.canonical,v=l.paint.get("model-rotation").evaluate(d,{},g),b=l.paint.get("model-scale").evaluate(d,{},g),S=l.paint.get("model-translation").evaluate(d,{},g);i.N.exactEquals(a.rotation,v)&&i.N.exactEquals(a.scale,b)&&i.N.exactEquals(a.translation,S)||(this.evaluate(a,a.featureStates,o,!0),e=!0)}}return e}isEmpty(){for(const e in this.instancesPerModel)if(this.instancesPerModel[e].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(e){if(!this.uploaded)for(const n in this.instancesPerModel){const o=this.instancesPerModel[n];o.instancedDataArray.length<0||o.instancedDataArray.length===0||(o.instancedDataBuffer?o.instancedDataBuffer.updateData(o.instancedDataArray):o.instancedDataBuffer=e.createVertexBuffer(o.instancedDataArray,zC.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const e in this.instancesPerModel){const n=this.instancesPerModel[e];n.instancedDataArray.length!==0&&n.instancedDataBuffer&&n.instancedDataBuffer.destroy()}}addFeature(e,n,o){const a=this.layers[0],l=a.layout.get("model-id").evaluate(o,{},this.canonical);if(!l)return Re(`modelId is not evaluated for layer ${a.id} and it is not going to get rendered.`),l;this.instancesPerModel[l]||(this.instancesPerModel[l]=new nw);const d=this.instancesPerModel[l],g=d.instancedDataArray,v=new tw(o,g.length);for(const b of n)for(const S of b){if(S.x<0||S.x>=Jt||S.y<0||S.y>=Jt)continue;const I=(this.lookupDim-1)/Jt,D=this.lookupDim*(S.y*I|0)+S.x*I|0;if(this.lookup){if(this.lookup[D]!==0)continue;this.lookup[D]=1}this.instanceCount++;const F=g.length;g.resize(F+1),d.instancesEvaluatedElevation.push(0),g.float32[16*F]=S.x,g.float32[16*F+1]=S.y}return v.instancedDataCount=d.instancedDataArray.length-v.instancedDataOffset,v.instancedDataCount>0&&(e.id&&(d.idToFeaturesIndex[e.id]=d.features.length),d.features.push(v),this.evaluate(v,{},d,!1)),l}evaluate(e,n,o,a){const l=this.layers[0],d=e.feature,g=this.canonical,v=e.rotation=l.paint.get("model-rotation").evaluate(d,n,g),b=e.scale=l.paint.get("model-scale").evaluate(d,n,g),S=e.translation=l.paint.get("model-translation").evaluate(d,n,g),I=l.paint.get("model-color").evaluate(d,n,g);I.a=l.paint.get("model-color-mix-intensity").evaluate(d,n,g);const D=[];this.maxVerticalOffset<S[2]&&(this.maxVerticalOffset=S[2]),this.maxScale=Math.max(Math.max(this.maxScale,b[0]),Math.max(b[1],b[2])),Q1(D,v,b);const F=Math.round(100*I.a)+I.b/1.05;for(let N=0;N<e.instancedDataCount;++N){const V=e.instancedDataOffset+N,q=16*V,Y=o.instancedDataArray.float32;let oe=0;a&&(oe=Y[q+6]-o.instancesEvaluatedElevation[V]);const le=0|Y[q+1];Y[q]=(0|Y[q])+I.r/1.05,Y[q+1]=le+I.g/1.05,Y[q+2]=F,Y[q+3]=1/(g.z>10?this.tileToMeter:sr(g,le)),Y[q+4]=S[0],Y[q+5]=S[1],Y[q+6]=S[2]+oe,Y[q+7]=D[0],Y[q+8]=D[1],Y[q+9]=D[2],Y[q+10]=D[4],Y[q+11]=D[5],Y[q+12]=D[6],Y[q+13]=D[8],Y[q+14]=D[9],Y[q+15]=D[10],o.instancesEvaluatedElevation[V]=S[2]}}}sn(Ly,"ModelBucket",{omit:["layers"]}),sn(nw,"PerModelAttributes"),sn(tw,"ModelFeature");const BC=new pi({visibility:new Nt(Je.layout_model.visibility),"model-id":new wn(Je.layout_model["model-id"])});var NC={paint:new pi({"model-opacity":new Nt(Je.paint_model["model-opacity"]),"model-rotation":new wn(Je.paint_model["model-rotation"]),"model-scale":new wn(Je.paint_model["model-scale"]),"model-translation":new wn(Je.paint_model["model-translation"]),"model-color":new wn(Je.paint_model["model-color"]),"model-color-mix-intensity":new wn(Je.paint_model["model-color-mix-intensity"]),"model-type":new Nt(Je.paint_model["model-type"]),"model-cast-shadows":new Nt(Je.paint_model["model-cast-shadows"]),"model-receive-shadows":new Nt(Je.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Nt(Je.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new wn(Je.paint_model["model-emissive-strength"]),"model-roughness":new wn(Je.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new wn(Je.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Nt(Je.paint_model["model-cutoff-fade-range"])}),layout:BC};const Zu=64,ed={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function rw(t,e,n,o,a,l,d,g,v,b=!1){const S=n.zoom,I=n.project(o),D=or(o.lat,S),F=1/D;i.a6.identity(t),i.a6.translate(t,t,[I.x+d[0]*F,I.y+d[1]*F,d[2]]);let N=1,V=1;const q=n.worldSize;if(b){if(n.projection.name==="mercator"){let ae=0;n.elevation&&(ae=n.elevation.getAtPointOrZero(new Sr(I.x/q,I.y/q),0));const be=i.a7.transformMat4([],[I.x,I.y,ae,1],n.projMatrix)[3]/n.cameraToCenterDistance;N=be,V=be*or(n.center.lat,S)}else if(n.projection.name==="globe"){const ae=Ry(t,n),be=i.a6.multiply([],n.projMatrix,ae),ge=[0,0,0,1];i.a7.transformMat4(ge,ge,be);const Ie=ge[3]/n.cameraToCenterDistance,Ne=xc(S),Ge=n.projection.pixelsPerMeter(o.lat,q)*or(o.lat,S),tt=n.projection.pixelsPerMeter(n.center.lat,q)*or(n.center.lat,S);N=Ie/Zn(Ge,mi(n.center.lat),Ne),V=Ie*D/Ge,N*=tt,V*=tt}}else N=F;i.a6.scale(t,t,[N,N,V]);const Y=[...t],oe=e.orientation,le=[];if(Q1(le,[oe[0]+a[0],oe[1]+a[1],oe[2]+a[2]],l),i.a6.multiply(t,Y,le),g&&n.elevation){let ae=0;const be=[];if(v&&n.elevation){ae=function(Ne,Ge,tt,qe,_t){const Et=Ge.elevation;if(!Et)return 0;const ct=Ti.projectAabbCorners(tt,qe),wt=Nn(1,_t.lat)*Ge.worldSize,st=function(Tn,Kn){const In=[0,0,1],Jn=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const On of Jn){const pr=Tn[On.corners[0]],jn=Tn[On.corners[1]],Wr=Tn[On.corners[2]],Ir=[jn[0]-pr[0],jn[1]-pr[1],Kn*(jn[2]-pr[2])],kr=i.N.cross(Ir,Ir,[Wr[0]-pr[0],Wr[1]-pr[1],Kn*(Wr[2]-pr[2])]);i.N.normalize(kr,kr),On.dotProductWithUp=i.N.dot(kr,In)}return Jn.sort((On,pr)=>On.dotProductWithUp-pr.dotProductWithUp),Jn[0].corners}(ct,wt),bt=ct[st[0]],$t=ct[st[1]],St=ct[st[2]],cn=ct[st[3]],rn=Et.getAtPointOrZero(new Sr(bt[0]/Ge.worldSize,bt[1]/Ge.worldSize),0),Dt=Et.getAtPointOrZero(new Sr($t[0]/Ge.worldSize,$t[1]/Ge.worldSize),0),An=Et.getAtPointOrZero(new Sr(St[0]/Ge.worldSize,St[1]/Ge.worldSize),0),_n=Et.getAtPointOrZero(new Sr(cn[0]/Ge.worldSize,cn[1]/Ge.worldSize),0),ln=(rn+_n)/2,kt=(Dt+An)/2;return ln>kt?Dt<An?o_(Ne,$t,cn,bt,Dt,_n,rn,wt):o_(Ne,St,bt,cn,An,rn,_n,wt):rn<_n?o_(Ne,bt,$t,St,rn,Dt,An,wt):o_(Ne,cn,St,$t,_n,An,Dt,wt),Math.max(ln,kt)}(be,n,e.aabb,t,o);const ge=i.a6.fromQuat([],be),Ie=i.a6.multiply([],ge,le);i.a6.multiply(t,Y,Ie)}else ae=n.elevation.getAtPointOrZero(new Sr(I.x/q,I.y/q),0);ae!==0&&(t[14]+=ae)}}function Hf(t,e,n=!1){t.uploaded||(t.gfxTexture=new ky(e,t.image,n?e.gl.R8:e.gl.RGBA,{useMipmap:t.sampler.minFilter>=e.gl.NEAREST_MIPMAP_NEAREST}),t.uploaded=!0,t.image=null)}function jC(t,e,n){t.indexBuffer=e.createIndexBuffer(t.indexArray,!1,!0),t.vertexBuffer=e.createVertexBuffer(t.vertexArray,DC.members,!1,!0),t.normalArray&&(t.normalBuffer=e.createVertexBuffer(t.normalArray,LC.members,!1,!0)),t.texcoordArray&&(t.texcoordBuffer=e.createVertexBuffer(t.texcoordArray,RC.members,!1,!0)),t.colorArray&&(t.colorBuffer=e.createVertexBuffer(t.colorArray,(t.colorArray.bytesPerElement===12?kC:OC).members,!1,!0)),t.featureArray&&(t.pbrBuffer=e.createVertexBuffer(t.featureArray,FC.members,!0)),t.segments=Ii.simpleSegment(0,0,t.vertexArray.length,t.indexArray.length);const o=t.material;o.pbrMetallicRoughness.baseColorTexture&&Hf(o.pbrMetallicRoughness.baseColorTexture,e),o.pbrMetallicRoughness.metallicRoughnessTexture&&Hf(o.pbrMetallicRoughness.metallicRoughnessTexture,e),o.normalTexture&&Hf(o.normalTexture,e),o.occlusionTexture&&Hf(o.occlusionTexture,e,n),o.emissionTexture&&Hf(o.emissionTexture,e)}function zy(t,e,n){if(t.meshes)for(const o of t.meshes)jC(o,e,n);if(t.children)for(const o of t.children)zy(o,e,n)}function s_(t){if(t.meshes)for(const e of t.meshes)e.indexArray.destroy(),e.vertexArray.destroy(),e.colorArray&&e.colorArray.destroy(),e.normalArray&&e.normalArray.destroy(),e.texcoordArray&&e.texcoordArray.destroy(),e.featureArray&&e.featureArray.destroy();if(t.children)for(const e of t.children)s_(e)}function Fy(t){if(t.meshes)for(const n of t.meshes)n.vertexBuffer&&(n.vertexBuffer.destroy(),n.indexBuffer.destroy(),n.normalBuffer&&n.normalBuffer.destroy(),n.texcoordBuffer&&n.texcoordBuffer.destroy(),n.colorBuffer&&n.colorBuffer.destroy(),n.pbrBuffer&&n.pbrBuffer.destroy(),n.segments.destroy(),n.material&&((e=n.material).pbrMetallicRoughness.baseColorTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),e.pbrMetallicRoughness.metallicRoughnessTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),e.normalTexture&&e.normalTexture.gfxTexture&&e.normalTexture.gfxTexture.destroy(),e.emissionTexture&&e.emissionTexture.gfxTexture&&e.emissionTexture.gfxTexture.destroy(),e.occlusionTexture&&e.occlusionTexture.gfxTexture&&e.occlusionTexture.gfxTexture.destroy()));var e;if(t.children)for(const n of t.children)Fy(n)}class VC{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class UC{constructor(){this.tasks={},this.taskQueue=[],mn(["process"],this),this.invoker=new VC(this.process),this.nextId=0}add(e,n){const o=this.nextId++,a=function({type:l,isSymbolTile:d,zoom:g}){return g=g||0,l==="message"?0:l!=="maybePrepare"||d?l!=="parseTile"||d?l==="parseTile"&&d?300-g:l==="maybePrepare"&&d?400-g:500:200-g:100-g}(n);if(a===0){Kt();try{e()}finally{}return null}return this.tasks[o]={fn:e,metadata:n,priority:a,id:o},this.taskQueue.push(o),this.invoker.trigger(),{cancel:()=>{delete this.tasks[o]}}}process(){Kt();try{if(this.taskQueue=this.taskQueue.filter(o=>!!this.tasks[o]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const n=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!n)return;n.fn()}finally{}}pick(){let e=null,n=1/0;for(let a=0;a<this.taskQueue.length;a++){const l=this.tasks[this.taskQueue[a]];l.priority<n&&(n=l.priority,e=a)}if(e===null)return null;const o=this.taskQueue[e];return this.taskQueue.splice(e,1),o}remove(){this.invoker.remove()}}class iw{constructor(e,n,o){this.target=e,this.parent=n,this.mapId=o,this.callbacks={},this.cancelCallbacks={},mn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new UC}send(e,n,o,a,l=!1,d){const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);o&&(o.metadata=d,this.callbacks[g]=o);const v=new Set;return this.target.postMessage({id:g,type:e,hasCallback:!!o,targetMapId:a,mustQueue:l,sourceMapId:this.mapId,data:Ka(n,v)},v),{cancel:()=>{o&&delete this.callbacks[g],this.target.postMessage({id:g,type:"<cancel>",targetMapId:a,sourceMapId:this.mapId})}}}receive(e){const n=e.data,o=n.id;if(o&&(!n.targetMapId||this.mapId===n.targetMapId))if(n.type==="<cancel>"){const a=this.cancelCallbacks[o];delete this.cancelCallbacks[o],a&&a.cancel()}else if(n.mustQueue||Kt()){const a=this.callbacks[o],l=this.scheduler.add(()=>this.processTask(o,n),a&&a.metadata||{type:"message"});l&&(this.cancelCallbacks[o]=l)}else this.processTask(o,n)}processTask(e,n){if(delete this.cancelCallbacks[e],n.type==="<response>"){const o=this.callbacks[e];delete this.callbacks[e],o&&(n.error?o(Cl(n.error)):o(null,Cl(n.data)))}else{const o=new Set,a=n.hasCallback?(d,g)=>{this.target.postMessage({id:e,type:"<response>",sourceMapId:this.mapId,error:d?Ka(d):null,data:Ka(g,o)},o)}:d=>{},l=Cl(n.data);if(this.parent[n.type])this.parent[n.type](n.sourceMapId,l,a);else if(this.parent.getWorkerSource){const d=n.type.split(".");this.parent.getWorkerSource(n.sourceMapId,d[0],l.source,l.scope)[d[1]](l,a)}else a(new Error(`Could not find function ${n.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class td{constructor(e,n){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=Hr();const o=this.workerPool.acquire(this.id);for(let a=0;a<o.length;a++){const l=new td.Actor(o[a],n,this.id);l.name=`Worker ${a}`,this.actors.push(l)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(e,n,o){Gr(this.actors,(a,l)=>{a.send(e,n,l)},o=o||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(e=>{e.remove()}),this.actors=[],this.workerPool.release(this.id)}}td.Actor=iw;var qf={workerUrl:"",workerClass:null,workerParams:void 0};function $C(){return qf.workerClass!=null?new qf.workerClass:new self.Worker(qf.workerUrl,qf.workerParams)}const By="mapboxgl_preloaded_worker_pool";class Wf{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Wf.workerCount;)this.workers.push(new $C);return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.workers&&this.numActive()===0&&(this.workers.forEach(n=>{n.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[By]}numActive(){return Object.keys(this.active).length}}let Zf;function a_(){return Zf||(Zf=new Wf),Zf}Wf.workerCount=2;let l_,Ny,Pa,nd,jy,rd=null;function ow(){return Kt()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:Ny||L.DRACO_URL}function sw(){if(Kt()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(nd)return nd;const t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return nd=WebAssembly.validate(t)?L.MESHOPT_SIMD_URL:L.MESHOPT_URL,nd}const c_={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},GC={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Yf={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function aw(t,e,n){const o=n.json.bufferViews.length,a=n.buffers.length;e.bufferView=o,n.json.bufferViews[o]={buffer:a,byteLength:t.byteLength},n.buffers[a]=t}const Vy="KHR_draco_mesh_compression";function HC(t,e){const n=t.extensions&&t.extensions[Vy];if(!n)return;const o=new Pa.Decoder,a=hw(e,n.bufferView),l=new Pa.Mesh;if(!o.DecodeArrayToMesh(a,a.byteLength,l))throw new Error("Failed to decode Draco mesh");const d=e.json.accessors[t.indices],g=c_[d.componentType],v=d.count*g.BYTES_PER_ELEMENT,b=Pa._malloc(v);g===Uint16Array?o.GetTrianglesUInt16Array(l,v,b):o.GetTrianglesUInt32Array(l,v,b),aw(Pa.memory.buffer.slice(b,b+v),d,e),Pa._free(b);for(const S of Object.keys(n.attributes)){const I=o.GetAttributeByUniqueId(l,n.attributes[S]),D=e.json.accessors[t.attributes[S]],F=GC[D.componentType],N=D.count*Yf[D.type]*c_[D.componentType].BYTES_PER_ELEMENT,V=Pa._malloc(N);o.GetAttributeDataArrayForAllPoints(l,I,Pa[F],N,V),aw(Pa.memory.buffer.slice(V,V+N),D,e),Pa._free(V)}o.destroy(),l.destroy(),delete t.extensions[Vy]}const u_="EXT_meshopt_compression";function qC(t,e){if(!t.extensions||!t.extensions[u_])return;const n=t.extensions[u_],o=new Uint8Array(e.buffers[n.buffer],n.byteOffset||0,n.byteLength||0),a=new Uint8Array(n.count*n.byteStride);jy.decodeGltfBuffer(a,n.count,n.byteStride,o,n.mode,n.filter),t.buffer=e.buffers.length,t.byteOffset=0,e.buffers[t.buffer]=a.buffer,delete t.extensions[u_]}const lw=1179937895,cw=new TextDecoder("utf8");function uw(t,e){return new URL(t,e).href}function WC(t,e,n,o){return fetch(uw(t.uri,o)).then(a=>a.arrayBuffer()).then(a=>{e.buffers[n]=a})}function hw(t,e){const n=t.json.bufferViews[e];return new Uint8Array(t.buffers[n.buffer],n.byteOffset||0,n.byteLength)}function ZC(t,e,n,o){if(t.uri){const a=uw(t.uri,o);return fetch(a).then(l=>l.blob()).then(l=>createImageBitmap(l)).then(l=>{e.images[n]=l})}if(t.bufferView!==void 0){const a=hw(e,t.bufferView),l=new Blob([a],{type:t.mimeType});return createImageBitmap(l).then(d=>{e.images[n]=d})}}function dw(t,e=0,n){const o={json:null,images:[],buffers:[]};if(new Uint32Array(t,e,1)[0]===lw){const S=new Uint32Array(t,e);let I=2;const D=(S[I++]>>2)-3,F=S[I++]>>2;if(I++,o.json=JSON.parse(cw.decode(S.subarray(I,I+F))),I+=F,I<D){const N=S[I++];I++;const V=e+(I<<2);o.buffers[0]=t.slice(V,V+N)}}else o.json=JSON.parse(cw.decode(new Uint8Array(t,e)));const{buffers:a,images:l,meshes:d,extensionsUsed:g,bufferViews:v}=o.json;let b=Promise.resolve();if(a){const S=[];for(let I=0;I<a.length;I++){const D=a[I];D.uri?S.push(WC(D,o,I,n)):o.buffers[I]||(o.buffers[I]=null)}b=Promise.all(S)}return b.then(()=>{const S=[],I=g&&g.includes(Vy),D=g&&g.includes(u_);if(I&&S.push(function(){if(!Pa)return l_||(l_=function(F){let N,V=null;function q(){N=new Uint8Array(V.buffer)}function Y(){throw new Error("Unexpected Draco error.")}const oe={a:{a:Y,d:function(le,ae,be){return N.copyWithin(le,ae,ae+be)},c:function(le){const ae=N.length,be=Math.max(le>>>0,Math.ceil(1.2*ae)),ge=Math.ceil((be-ae)/65536);try{return V.grow(ge),q(),!0}catch{return!1}},b:Y}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(F,oe):F.then(le=>le.arrayBuffer()).then(le=>WebAssembly.instantiate(le,oe))).then(le=>{const{Rb:ae,Qb:be,P:ge,T:Ie,X:Ne,Ja:Ge,La:tt,Qa:qe,Va:_t,Wa:Et,eb:ct,jb:wt,f:st,e:bt,yb:$t,zb:St,Ab:cn,Bb:rn,Db:Dt,Gb:An}=le.instance.exports;V=bt;const _n=(()=>{let ln=0,kt=0,Tn=0,Kn=0;return In=>{Tn&&(ae(Kn),ae(ln),kt+=Tn,Tn=ln=0),ln||(kt+=128,ln=be(kt));const Jn=In.length+7&-8;let On=ln;Jn>=kt&&(Tn=Jn,On=Kn=be(Jn));for(let pr=0;pr<In.length;pr++)N[On+pr]=In[pr];return On}})();return q(),st(),{memory:bt,_free:ae,_malloc:be,Mesh:class{constructor(){this.ptr=ge()}destroy(){Ie(this.ptr)}},Decoder:class{constructor(){this.ptr=Ge()}destroy(){wt(this.ptr)}DecodeArrayToMesh(ln,kt,Tn){const Kn=_n(ln),In=tt(this.ptr,Kn,kt,Tn.ptr);return!!Ne(In)}GetAttributeByUniqueId(ln,kt){return{ptr:qe(this.ptr,ln.ptr,kt)}}GetTrianglesUInt16Array(ln,kt,Tn){_t(this.ptr,ln.ptr,kt,Tn)}GetTrianglesUInt32Array(ln,kt,Tn){Et(this.ptr,ln.ptr,kt,Tn)}GetAttributeDataArrayForAllPoints(ln,kt,Tn,Kn,In){ct(this.ptr,ln.ptr,kt.ptr,Tn,Kn,In)}},DT_INT8:$t(),DT_UINT8:St(),DT_INT16:cn(),DT_UINT16:rn(),DT_UINT32:Dt(),DT_FLOAT32:An()}})}(fetch(ow())),l_.then(F=>{Pa=F,l_=void 0}))}()),D&&S.push(function(){if(jy)return;const F=function(N){let V;const q=WebAssembly.instantiateStreaming(N,{}).then(le=>{V=le.instance,V.exports.__wasm_call_ctors()}),Y={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},oe={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:q,supported:!0,decodeGltfBuffer(le,ae,be,ge,Ie,Ne){(function(Ge,tt,qe,_t,Et,ct,wt){const st=Ge.exports.sbrk,bt=_t+3&-4,$t=st(bt*Et),St=st(ct.length),cn=new Uint8Array(Ge.exports.memory.buffer);cn.set(ct,St);const rn=tt($t,_t,Et,St,ct.length);if(rn===0&&wt&&wt($t,bt,Et),qe.set(cn.subarray($t,$t+_t*Et)),st($t-st(0)),rn!==0)throw new Error(`Malformed buffer data: ${rn}`)})(V,V.exports[oe[Ie]],le,ae,be,ge,V.exports[Y[Ne]])}}}(fetch(sw()));return F.ready.then(()=>{jy=F})}()),l)for(let F=0;F<l.length;F++)S.push(ZC(l[F],o,F,n));return(S.length?Promise.all(S):Promise.resolve()).then(()=>{if(I&&d)for(const{primitives:F}of d)for(const N of F)HC(N,o);if(D&&d&&v)for(const F of v)qC(F,o);return o})})}class fw{constructor(e,n,o){if(this.triangleCount=n.length/3,this.min=new ve(0,0),this.max=new ve(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||e.length===0||o===0)return;const a=e.map(S=>S.x),l=e.map(S=>S.y);this.min=new ve(Math.min(...a),Math.min(...l)),this.max=new ve(Math.max(...a),Math.max(...l));const d=this.max.sub(this.min);d.x=Math.max(d.x,1),d.y=Math.max(d.y,1);const g=Math.max(d.x,d.y)/o;this.cellsX=Math.max(1,Math.ceil(d.x/g)),this.cellsY=Math.max(1,Math.ceil(d.y/g)),this.xScale=1/g,this.yScale=1/g;const v=[];for(let S=0;S<this.triangleCount;S++){const I=e[n[3*S+0]].sub(this.min),D=e[n[3*S+1]].sub(this.min),F=e[n[3*S+2]].sub(this.min),N=Ic(Math.floor(Math.min(I.x,D.x,F.x)),this.xScale,this.cellsX),V=Ic(Math.floor(Math.max(I.x,D.x,F.x)),this.xScale,this.cellsX),q=Ic(Math.floor(Math.min(I.y,D.y,F.y)),this.yScale,this.cellsY),Y=Ic(Math.floor(Math.max(I.y,D.y,F.y)),this.yScale,this.cellsY),oe=new ve(0,0),le=new ve(0,0),ae=new ve(0,0),be=new ve(0,0);for(let ge=q;ge<=Y;++ge){oe.y=le.y=ge*g,ae.y=be.y=(ge+1)*g;for(let Ie=N;Ie<=V;++Ie)oe.x=ae.x=Ie*g,le.x=be.x=(Ie+1)*g,(zg(I,D,F,oe,le,be)||zg(I,D,F,oe,be,ae))&&v.push({cellIdx:ge*this.cellsX+Ie,triIdx:S})}}if(v.length===0)return;v.sort((S,I)=>S.cellIdx-I.cellIdx||S.triIdx-I.triIdx);let b=0;for(;b<v.length;){const S=v[b].cellIdx,I={start:this.payload.length,len:0};for(;b<v.length&&v[b].cellIdx===S;)++I.len,this.payload.push(v[b++].triIdx);this.cells[S]=I}}query(e,n,o){if(this.triangleCount===0||this.cells.length===0||e.x>this.max.x||this.min.x>n.x||e.y>this.max.y||this.min.y>n.y)return;this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8)));for(let v=0;v<this.lookup.length;v++)this.lookup[v]=0;const a=Ic(e.x-this.min.x,this.xScale,this.cellsX),l=Ic(n.x-this.min.x,this.xScale,this.cellsX),d=Ic(e.y-this.min.y,this.yScale,this.cellsY),g=Ic(n.y-this.min.y,this.yScale,this.cellsY);for(let v=d;v<=g;v++)for(let b=a;b<=l;b++){const S=this.cells[v*this.cellsX+b];if(S)for(let I=0;I<S.len;I++){const D=this.payload[S.start+I],F=Math.floor(D/8),N=1<<D%8;if(!(this.lookup[F]&N)&&(this.lookup[F]|=N,o.push(D),o.length===this.triangleCount))return}}}}function Ic(t,e,n){return Math.max(0,Math.min(n-1,Math.floor(t*e)))}function Yu(t,e){const n=t.json.bufferViews[e.bufferView],o=c_[e.componentType];return new o(t.buffers[n.buffer],(e.byteOffset||0)+(n.byteOffset||0),e.count*(n.byteStride&&n.byteStride!==Yf[e.type]*o.BYTES_PER_ELEMENT?n.byteStride/o.BYTES_PER_ELEMENT:Yf[e.type]))}function Uy(t,e,n,o){const a=c_[e.componentType],l=function(S){switch(S){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(a),d=t.json.bufferViews[e.bufferView],g=d.byteStride?d.byteStride/a.BYTES_PER_ELEMENT:Yf[e.type],v=n.float32,b=v.length/n.capacity;for(let S=0,I=0;S<e.count*g;S+=g,I+=b)for(let D=0;D<b;D++)v[I+D]=o[S+D]*l;n._trim()}function YC(t,e,n){const o=t.indices,a=t.attributes,l={};l.indexArray=new eo;const d=e.json.accessors[o],g=d.count/3;l.indexArray.reserve(g);const v=Yu(e,d);for(let D=0;D<g;D++)l.indexArray.emplaceBack(v[3*D],v[3*D+1],v[3*D+2]);l.indexArray._trim(),l.vertexArray=new kl;const b=e.json.accessors[a.POSITION];l.vertexArray.reserve(b.count);const S=Yu(e,b);for(let D=0;D<b.count;D++)l.vertexArray.emplaceBack(S[3*D],S[3*D+1],S[3*D+2]);if(l.vertexArray._trim(),l.aabb=new Ti(b.min,b.max),l.centroid=function(D,F){const N=[0,0,0],V=D.length;if(V>0){for(let q=0;q<V;q++){const Y=3*D[q];N[0]+=F[Y],N[1]+=F[Y+1],N[2]+=F[Y+2]}N[0]/=V,N[1]/=V,N[2]/=V}return N}(v,S),a.COLOR_0!==void 0){const D=e.json.accessors[a.COLOR_0],F=Yf[D.type],N=Yu(e,D);l.colorArray=F===3?new kl:new tl,l.colorArray.resize(D.count),Uy(e,D,l.colorArray,N)}if(a.NORMAL!==void 0){l.normalArray=new kl;const D=e.json.accessors[a.NORMAL];l.normalArray.resize(D.count);const F=Yu(e,D);Uy(e,D,l.normalArray,F)}if(a.TEXCOORD_0!==void 0&&n.length>0){l.texcoordArray=new zu;const D=e.json.accessors[a.TEXCOORD_0];l.texcoordArray.resize(D.count);const F=Yu(e,D);Uy(e,D,l.texcoordArray,F)}if(a._FEATURE_ID_RGBA4444!==void 0){const D=e.json.accessors[a._FEATURE_ID_RGBA4444];e.json.extensionsUsed&&e.json.extensionsUsed.includes("EXT_meshopt_compression")&&(l.featureData=Yu(e,D))}a._FEATURE_RGBA4444!==void 0&&(l.featureData=new Uint32Array(Yu(e,e.json.accessors[a._FEATURE_RGBA4444]).buffer));const I=t.material;return l.material=function(D,F){const{emissiveFactor:N=[0,0,0],alphaMode:V="OPAQUE",alphaCutoff:q=.5,normalTexture:Y,occlusionTexture:oe,emissiveTexture:le,doubleSided:ae}=D,{baseColorFactor:be=[1,1,1,1],metallicFactor:ge=1,roughnessFactor:Ie=1,baseColorTexture:Ne,metallicRoughnessTexture:Ge}=D.pbrMetallicRoughness||{},tt=oe?F[oe.index]:void 0;if(oe&&oe.extensions&&oe.extensions.KHR_texture_transform&&tt){const qe=oe.extensions.KHR_texture_transform;tt.offsetScale=[qe.offset[0],qe.offset[1],qe.scale[0],qe.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new li(...be),metallicFactor:ge,roughnessFactor:Ie,baseColorTexture:Ne?F[Ne.index]:void 0,metallicRoughnessTexture:Ge?F[Ge.index]:void 0},doubleSided:ae,emissiveFactor:N,alphaMode:V,alphaCutoff:q,normalTexture:Y?F[Y.index]:void 0,occlusionTexture:tt,emissionTexture:le?F[le.index]:void 0,defined:D.defined===void 0}}(I!==void 0?e.json.materials[I]:{defined:!1},n),l}function pw(t,e,n){const{matrix:o,rotation:a,translation:l,scale:d,mesh:g,extras:v,children:b}=t,S={};if(S.matrix=o||i.a6.fromRotationTranslationScale([],a||[0,0,0,1],l||[0,0,0],d||[1,1,1]),g!==void 0){S.meshes=n[g];const I=S.anchor=[0,0];for(const D of S.meshes){const{min:F,max:N}=D.aabb;I[0]+=F[0]+N[0],I[1]+=F[1]+N[1]}I[0]=Math.floor(I[0]/S.meshes.length/2),I[1]=Math.floor(I[1]/S.meshes.length/2)}if(v&&(v.id&&(S.id=v.id),v.lights&&(S.lights=function(I){if(!I.length)return[];const D=function(Y){const oe=atob(Y),le=new Uint8Array(oe.length);for(let ae=0;ae<oe.length;ae++)le[ae]=oe.codePointAt(ae);return le}(I),F=[],N=D.length/24,V=new Uint16Array(D.buffer),q=new Float32Array(D.buffer);for(let Y=0;Y<N;Y++){const oe=V[2*Y*6]/30,le=V[2*Y*6+1]/30,ae=V[2*Y*6+10]/100,be=q[6*Y+1],ge=q[6*Y+2],Ie=q[6*Y+3],Ne=q[6*Y+4],Ge=Ie-be,tt=Ne-ge,qe=Math.hypot(Ge,tt);F.push({pos:[be+.5*Ge,ge+.5*tt,le],normal:[tt/qe,-Ge/qe,0],width:qe,height:oe,depth:ae,points:[be,ge,Ie,Ne]})}return F}(v.lights))),b){const I=[];for(const D of b)I.push(pw(e.json.nodes[D],e,n));S.children=I}return S}function XC(t){if(t.vertices.length===0||t.indices.length===0)return null;const[e,n]=[t.vertices[0].clone(),t.vertices[0].clone()];for(let d=1;d<t.vertices.length;++d){const g=t.vertices[d];e.x=Math.min(e.x,g.x),e.y=Math.min(e.y,g.y),n.x=Math.max(n.x,g.x),n.y=Math.max(n.y,g.y)}const o=Math.ceil(Math.max(n.x-e.x,n.y-e.y)/256),a=Math.max(8,o),l=new fw(t.vertices,t.indices,a);return{vertices:t.vertices,indices:t.indices,grid:l,min:e,max:n}}function KC(t){if(!t.extras||!t.extras.ground)return null;const e=t.extras.ground;if(!e||!Array.isArray(e)||e.length===0)return null;const n=e[0];if(!n||!Array.isArray(n)||n.length===0)return null;const o=[];for(const d of n){if(!Array.isArray(d)||d.length!==2)continue;const g=d[0],v=d[1];typeof g=="number"&&typeof v=="number"&&o.push(new ve(g,v))}if(o.length<3)return null;o.length>1&&o[o.length-1].equals(o[0])&&o.pop();let a=0;for(let d=0;d<o.length;d++){const g=o[d],v=o[(d+1)%o.length],b=o[(d+2)%o.length];a+=(g.x-v.x)*(b.y-v.y)-(b.x-v.x)*(g.y-v.y)}a>0&&o.reverse();const l=Dm(o.flatMap(d=>[d.x,d.y]),[]);return l.length===0?null:{vertices:o,indices:l}}function JC(t){const e=[],n=[];let o=0;for(const a of t){o=e.length;const l=a.vertexArray.float32,d=a.indexArray.uint16;for(let g=0;g<a.vertexArray.length;g++)e.push(new ve(l[3*g+0],l[3*g+1]));for(let g=0;g<3*a.indexArray.length;g++)n.push(d[g]+o)}if(n.length%3!=0)return null;for(let a=0;a<n.length;a+=3){const l=e[n[a+0]],d=e[n[a+1]],g=e[n[a+2]];(l.x-d.x)*(g.y-d.y)-(g.x-d.x)*(l.y-d.y)>0&&([n[a+1],n[a+2]]=[n[a+2],n[a+1]])}return{vertices:e,indices:n}}function mw(t){const e=function(v,b){const S=[],I=WebGL2RenderingContext;if(v.json.textures)for(const D of v.json.textures){const F={magFilter:I.LINEAR,minFilter:I.NEAREST,wrapS:I.REPEAT,wrapT:I.REPEAT};D.sampler!==void 0&&Object.assign(F,v.json.samplers[D.sampler]),S.push({image:b[D.source],sampler:F,uploaded:!1})}return S}(t,t.images),n=function(v,b){const S=[];for(const I of v.json.meshes){const D=[];for(const F of I.primitives)D.push(YC(F,v,b));S.push(D)}return S}(t,e),{scenes:o,scene:a,nodes:l}=t.json,d=o?o[a||0].nodes:l,g=[];for(const v of d)g.push(pw(l[v],t,n));return function(v,b,S){const I={},D=new Set;for(let F=0;F<v.length;F++){const N=S[b[F]];if(!N.extras)continue;const V=N.extras["mapbox:footprint:version"],q=N.extras["mapbox:footprint:id"];(V||q)&&D.add(F),V==="1.0.0"&&q&&(I[q]=F)}for(let F=0;F<v.length;F++){if(D.has(F))continue;const N=v[F],V=S[b[F]];if(!V.extras)continue;let q=null;N.id in I&&(q=JC(v[I[N.id]].meshes)),q||(q=KC(V)),q&&(N.footprint=XC(q))}if(D.size>0){const F=Array.from(D.values()).sort((N,V)=>N-V);for(let N=F.length-1;N>=0;N--)v.splice(F[N],1)}}(g,d,t.json.nodes),g}function QC(t){t.heightmap=new Float32Array(4096),t.heightmap.fill(-1);const e=t.vertexArray.float32,n=t.aabb.min[0]-1,o=t.aabb.min[1]-1,a=Zu/(t.aabb.max[0]-n+2),l=Zu/(t.aabb.max[1]-o+2);for(let d=0;d<e.length;d+=3){const g=e[d+2],v=(e[d+0]-n)*a|0,b=(e[d+1]-o)*l|0;g>t.heightmap[b*Zu+v]&&(t.heightmap[b*Zu+v]=g)}}function eP(t,e){const n={};n.indexArray=new eo,n.indexArray.reserve(4*t.length),n.vertexArray=new kl,n.vertexArray.reserve(10*t.length),n.colorArray=new tl,n.vertexArray.reserve(10*t.length);let o=0;for(const d of t){const g=Math.min(10,Math.max(4,1.3*d.height))*e,v=[-d.normal[1],d.normal[0],0],b=Math.min(.29,.1*d.width/d.depth),S=d.width-2*d.depth*e*(b+.01),I=i.N.scaleAndAdd([],d.pos,v,S/2),D=i.N.scaleAndAdd([],d.pos,v,-S/2),F=[I[0],I[1],I[2]+d.height],N=[D[0],D[1],D[2]+d.height],V=i.N.scaleAndAdd([],d.normal,v,b);i.N.scale(V,V,g);const q=i.N.scaleAndAdd([],d.normal,v,-b);i.N.scale(q,q,g),i.N.add(V,I,V),i.N.add(q,D,q),I[2]+=.1,D[2]+=.1,n.vertexArray.emplaceBack(V[0],V[1],V[2]),n.vertexArray.emplaceBack(q[0],q[1],q[2]),n.vertexArray.emplaceBack(I[0],I[1],I[2]),n.vertexArray.emplaceBack(D[0],D[1],D[2]),n.vertexArray.emplaceBack(F[0],F[1],F[2]),n.vertexArray.emplaceBack(N[0],N[1],N[2]),n.vertexArray.emplaceBack(I[0],I[1],I[2]),n.vertexArray.emplaceBack(D[0],D[1],D[2]),n.vertexArray.emplaceBack(V[0],V[1],V[2]),n.vertexArray.emplaceBack(q[0],q[1],q[2]);const Y=S/g/2;n.colorArray.emplaceBack(-Y-b,-1,Y,.8),n.colorArray.emplaceBack(Y+b,-1,Y,.8),n.colorArray.emplaceBack(-Y,0,Y,1.3),n.colorArray.emplaceBack(Y,0,Y,1.3),n.colorArray.emplaceBack(Y+b,-.8,Y,.7),n.colorArray.emplaceBack(Y+b,-.8,Y,.7),n.colorArray.emplaceBack(0,0,Y,1.3),n.colorArray.emplaceBack(0,0,Y,1.3),n.colorArray.emplaceBack(Y+b,-1.2,Y,.8),n.colorArray.emplaceBack(Y+b,-1.2,Y,.8),n.indexArray.emplaceBack(6+o,4+o,8+o),n.indexArray.emplaceBack(7+o,9+o,5+o),n.indexArray.emplaceBack(0+o,1+o,2+o),n.indexArray.emplaceBack(1+o,3+o,2+o),o+=10}const a={defined:!0,emissiveFactor:[0,0,0]},l={};return l.baseColorFactor=li.white,a.pbrMetallicRoughness=l,n.material=a,n.aabb=new Ti([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),n}sn(fw,"TriangleGridIndex");class _w{constructor(e){this._stringToNumber={},this._numberToString=[];for(let n=0;n<e.length;n++){const o=e[n];this._stringToNumber[o]=n,this._numberToString[n]=o}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const tP=["tile","layer","source","sourceLayer","state"];class gw{constructor(e,n,o,a,l){this.type="Feature",this._vectorTileFeature=e,this._z=n,this._x=o,this._y=a,this.properties=e.properties,this.id=l}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(e.id=this.id);for(const n of tP)this[n]!==void 0&&(e[n]=this[n]);return e}}class yw{constructor(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new ba(Jt,16,0),this.featureIndexArray=new cm,this.promoteId=n,this.is3DTile=!1}insert(e,n,o,a,l,d=0,g=0){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(o,a,l,d);const b=this.grid;for(let S=0;S<n.length;S++){const I=n[S],D=[1/0,1/0,-1/0,-1/0];for(let F=0;F<I.length;F++){const N=I[F];D[0]=Math.min(D[0],N.x),D[1]=Math.min(D[1],N.y),D[2]=Math.max(D[2],N.x),D[3]=Math.max(D[3],N.y)}g!==0&&(D[0]-=g,D[1]-=g,D[2]+=g,D[3]+=g),D[0]<Jt&&D[1]<Jt&&D[2]>=0&&D[3]>=0&&b.insert(v,D[0],D[1],D[2],D[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new my(new Yh(this.rawTileData)).layers,this.sourceLayerCoder=new _w(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,n,o,a){this.loadVTLayers();const l=e.params||{},d=is(l.filter),g=e.tileResult,v=e.transform,b=g.bufferedTilespaceBounds,S=this.grid.query(b.min.x,b.min.y,b.max.x,b.max.y,(N,V,q,Y)=>Nv(g.bufferedTilespaceGeometry,N,V,q,Y));S.sort(nP);let I=null;v.elevation&&S.length>0&&(I=Gh.create(v.elevation,this.tileID));const D={};let F;for(let N=0;N<S.length;N++){const V=S[N];if(V===F)continue;F=V;const q=this.featureIndexArray.get(V);let Y=null;if(this.is3DTile){const oe=this.bucketLayerIDs[0][0],le=n[oe];if(le.type!=="model")continue;const{queryFeature:ae,intersectionZ:be}=le.queryIntersectsMatchingFeature(g,q.featureIndex,d,v);ae&&this.appendToResult(D,oe,q.featureIndex,ae,be)}else this.loadMatchingFeature(D,q,d,l.layers,l.availableImages,n,o,a,(oe,le,ae,be=0)=>(Y||(Y=no(oe,this.tileID.canonical,e.tileTransform)),le.queryIntersectsFeature(g,oe,ae,Y,this.z,e.transform,e.pixelPosMatrix,I,be)))}return D}loadMatchingFeature(e,n,o,a,l,d,g,v,b){const{featureIndex:S,bucketIndex:I,sourceLayerIndex:D,layoutVertexArrayOffset:F}=n,N=this.bucketLayerIDs[I];if(a&&!function(oe,le){for(let ae=0;ae<oe.length;ae++)if(le.indexOf(oe[ae])>=0)return!0;return!1}(a,N))return;const V=this.sourceLayerCoder.decode(D),q=this.vtLayers[V].feature(S);if(o.needGeometry){const oe=qi(q,!0);if(!o.filter(new fi(this.tileID.overscaledZ),oe,this.tileID.canonical))return}else if(!o.filter(new fi(this.tileID.overscaledZ),q))return;const Y=this.getId(q,V);for(let oe=0;oe<N.length;oe++){const le=N[oe];if(a&&a.indexOf(le)<0)continue;const ae=d[le];if(!ae)continue;let be={};Y!==void 0&&v&&(be=v.getState(ae.sourceLayer||"_geojsonTileLayer",Y));const ge=!b||b(q,ae,be,F);if(!ge)continue;const Ie=new gw(q,this.z,this.x,this.y,Y),Ne=Or({},g[le]);Ne.paint=vw(Ne.paint,ae.paint,q,be,l),Ne.layout=vw(Ne.layout,ae.layout,q,be,l),Ie.layer=Ne,this.appendToResult(e,le,S,Ie,ge)}}appendToResult(e,n,o,a,l){let d=e[n];d===void 0&&(d=e[n]=[]),d.push({featureIndex:o,feature:a,intersectionZ:l})}lookupSymbolFeatures(e,n,o,a,l,d,g,v){const b={};this.loadVTLayers();const S=is(l);for(const I of e)this.loadMatchingFeature(b,{bucketIndex:o,sourceLayerIndex:a,featureIndex:I,layoutVertexArrayOffset:0},S,d,g,v,n);return b}loadFeature(e){const{featureIndex:n,sourceLayerIndex:o}=e;this.loadVTLayers();const a=this.sourceLayerCoder.decode(o),l=this.vtFeatures[a];if(l[n])return l[n];const d=this.vtLayers[a].feature(n);return l[n]=d,d}hasLayer(e){for(const n of this.bucketLayerIDs)for(const o of n)if(e===o)return!0;return!1}getId(e,n){let o=e.id;if(this.promoteId){const a=typeof this.promoteId=="string"?this.promoteId:this.promoteId[n];a!=null&&(o=e.properties[a]),typeof o=="boolean"&&(o=Number(o))}return o}}function vw(t,e,n,o,a){return an(t,(l,d)=>{const g=e instanceof Eu?e.get(d):null;return g&&g.evaluate?g.evaluate(n,o,a):g})}function nP(t,e){return e-t}sn(yw,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const $y=new Float32Array(262144),Xu=new Uint8Array(262144);function xw(t){let e=0;if(t.meshes)for(const n of t.meshes)e=Math.max(e,n.aabb.max[2]);if(t.children)for(const n of t.children)e=Math.max(e,xw(n));return e}function bw(t,e,n){if(t.meshes)for(const o of t.meshes)o.aabb.min[0]!==1/0&&n.insert(e,o.aabb.min[0],o.aabb.min[1],o.aabb.max[0],o.aabb.max[1]);if(t.children)for(const o of t.children)bw(o,e,n)}const ww=["","wall","door","roof","window","lamp","logo"];class Tw{constructor(e){this.node=e,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:e.id,geometry:[],properties:{height:xw(e)}}}getLocalBounds(){if(!this.node.meshes)return new Ti([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let e=0;const n=new Ti([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const o of this.node.meshes)this.node.lightMeshIndex!==e&&n.encapsulate(o.aabb),e++;this.aabb=n}return this.aabb}}class h_{constructor(e,n,o,a,l,d){this.id=n,this.modelTraits|=ed.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,o&&(this.modelTraits|=ed.HasMapboxMeshFeatures),a&&(this.modelTraits|=ed.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=l,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const g of e)this.nodesInfo.push(new Tw(g)),bw(g,d.featureIndexArray.length,d.grid),d.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,d.bucketLayerIDs.length-1,0)}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(e){if(!this.needsUpload)return;const n=this.getNodesInfo();for(const o of n){const a=o.node;this.uploaded?this.updatePbrBuffer(a):zy(a,e,!0)}for(const o of n)s_(o.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(e){let n=!1;if(!e.meshes)return n;for(const o of e.meshes)o.pbrBuffer&&(o.pbrBuffer.updateData(o.featureArray),n=!0);return n}needsReEvaluation(e,n,o){const a=e.transform.projectionOptions,l=e.style.getBrightness(),d=this.brightness!==l;return!!(!this.uploaded||this.dirty||a.name!==this.projection.name||Xf(o.paint.get("model-color").value,d)||Xf(o.paint.get("model-color-mix-intensity").value,d)||Xf(o.paint.get("model-roughness").value,d)||Xf(o.paint.get("model-emissive-strength").value,d)||Xf(o.paint.get("model-height-based-emissive-strength-multiplier").value,d))&&(this.projection=a,this.brightness=l,!0)}evaluateScale(e,n){if(e.transform.zoom===this.zoom)return;this.zoom=e.transform.zoom;const o=this.getNodesInfo(),a=this.id.canonical;for(const l of o){const d=l.feature;l.evaluatedScale=n.paint.get("model-scale").evaluate(d,{},a)}}evaluate(e){const n=this.getNodesInfo();for(const o of n){if(!o.node.meshes)continue;const a=o.feature,l=o.node.meshes&&o.node.meshes[0].featureData,d=o.evaluatedColor[2],g=o.evaluatedRMEA[2],v=this.id.canonical;if(o.hasTranslucentParts=!1,l){for(let b=0;b<ww.length;b++){const S=ww[b];S.length&&(a.properties.part=S);const I=e.paint.get("model-color").evaluate(a,{},v),D=e.paint.get("model-color-mix-intensity").evaluate(a,{},v);o.evaluatedColor[b]=[I.r,I.g,I.b,D],o.evaluatedRMEA[b][0]=e.paint.get("model-roughness").evaluate(a,{},v),o.evaluatedRMEA[b][2]=e.paint.get("model-emissive-strength").evaluate(a,{},v),o.evaluatedRMEA[b][3]=I.a,o.emissionHeightBasedParams[b]=e.paint.get("model-height-based-emissive-strength-multiplier").evaluate(a,{},v),!o.hasTranslucentParts&&I.a<1&&(o.hasTranslucentParts=!0)}delete a.properties.part,iP(o,d!==o.evaluatedColor[2]||g!==o.evaluatedRMEA[2],this.modelTraits)}else o.evaluatedRMEA[0][2]=e.paint.get("model-emissive-strength").evaluate(a,{},v);o.evaluatedScale=e.paint.get("model-scale").evaluate(a,{},v),this.updatePbrBuffer(o.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(e,n,o,a){const l=e.findDEMTileFor(o);if(l&&(l.tileID.canonical!==this.terrainTile||n!==this.terrainExaggeration)){if(l.dem&&l.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=l.tileID.overscaledZ;const d=Gh.create(e,o,l);if(!d)return;this.modelTraits&ed.HasMapboxMeshFeatures&&this.updateDEM(e,d,o,a);for(const g of this.getNodesInfo()){const v=g.node;if(!v.footprint||!v.footprint.vertices||!v.footprint.vertices.length)continue;const b=v.footprint.vertices;let S=d.getElevationAt(b[0].x,b[0].y,!0,!0);for(let I=1;I<b.length;I++)S=Math.min(S,d.getElevationAt(b[I].x,b[I].y,!0,!0));v.elevation=S}}this.terrainTile=l.tileID.canonical,this.terrainExaggeration=n}}updateDEM(e,n,o,a){let l=n._dem._modifiedForSources[a];if(l===void 0&&(n._dem._modifiedForSources[a]=[],l=n._dem._modifiedForSources[a]),l.includes(o.canonical))return;const d=n._dem.dim;l.push(o.canonical);let g=!1;for(const v of this.getNodesInfo()){const b=v.node;if(!b.footprint||!b.footprint.grid)continue;const S=b.footprint.grid,I=n.tileCoordToPixel(S.min.x,S.min.y),D=n.tileCoordToPixel(S.max.x,S.max.y),F=Math.min(Math.min(d-D.y,I.x),Math.min(I.y,d-D.x));if(F<0)continue;const N=vt(F,2,5);let V=Math.max(0,I.x-N),q=Math.max(0,I.y-N),Y=Math.min(D.x+N,d-1),oe=Math.min(D.y+N,d-1);for(let ge=q;ge<=oe;++ge)for(let Ie=V;Ie<=Y;++Ie)Xu[ge*d+Ie]=255;let le=0,ae=0;for(let ge=0;ge<S.cellsY;++ge)for(let Ie=0;Ie<S.cellsX;++Ie){if(!S.cells[ge*S.cellsX+Ie])continue;const Ne=n.tileCoordToPixel(S.min.x+Ie/S.xScale,S.min.y+ge/S.yScale),Ge=n.tileCoordToPixel(S.min.x+(Ie+1)/S.xScale,S.min.y+(ge+1)/S.yScale);for(let tt=Ne.y;tt<=Math.min(Ge.y+1,d-1);++tt)for(let qe=Ne.x;qe<=Math.min(Ge.x+1,d-1);++qe)Xu[tt*d+qe]===255&&(Xu[tt*d+qe]=0,le+=n.getElevationAtPixel(qe,tt),ae++)}const be=le/ae;V=Math.max(1,I.x-N),q=Math.max(1,I.y-N),Y=Math.min(D.x+N,d-2),oe=Math.min(D.y+N,d-2),g=!0;for(let ge=q;ge<=oe;++ge)for(let Ie=V;Ie<=Y;++Ie)Xu[ge*d+Ie]===0&&($y[ge*d+Ie]=n._dem.set(Ie,ge,be));for(let ge=1;ge<N;++ge){V=Math.max(1,I.x-ge),q=Math.max(1,I.y-ge),Y=Math.min(D.x+ge,d-2),oe=Math.min(D.y+ge,d-2);for(let Ie=q;Ie<=oe;++Ie)for(let Ne=V;Ne<=Y;++Ne){const Ge=Ie*d+Ne;if(Xu[Ge]===255){let tt=0,qe=0,_t=-1,Et=-1;for(let ct=-1;ct<=1;++ct)for(let wt=-1;wt<=1;++wt){const st=(Ie+ct)*d+Ne+wt;if(Xu[st]>=ge)continue;const bt=$y[st],$t=Math.abs(bt);$t>qe&&(tt=bt,qe=$t,_t=wt,Et=ct)}if(qe>.1){const ct=1-(ge+.5*Math.abs(_t*Et))/N;let wt=n._dem.get(Ne,Ie)+tt*ct;const st=n._dem.get(Ne+_t,Ie+Et),bt=n._dem.get(Ne-_t,Ie-Et,!0);(wt-st)*(wt-bt)>0&&(wt=(st+bt)/2),$y[Ge]=n._dem.set(Ne,Ie,wt),Xu[Ge]=ge}}}}}g&&(n._demTile.needsDEMTextureUpload=!0,n._dem._timestamp=Mt.now())}getNodesInfo(){return this.nodesInfo}destroy(){const e=this.getNodesInfo();for(const n of e)s_(n.node),Fy(n.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(e,n){if(n.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=n.updateTime;const o=n.getReplacementRegionsForTile(e.toUnwrapped()),a=this.getNodesInfo();for(let l=0;l<this.nodesInfo.length;l++){const d=a[l].node;a[l].hiddenByReplacement=!!d.footprint&&!o.find(g=>g.footprint===d.footprint)}}getHeightAtTileCoord(e,n){const o=this.getNodesInfo(),a=[];for(let l=0;l<this.nodesInfo.length;l++){const d=o[l],g=d.node.meshes[0];if(e<g.aabb.min[0]||n<g.aabb.min[1]||e>g.aabb.max[0]||n>g.aabb.max[1])continue;const v=(e-g.aabb.min[0])/(g.aabb.max[0]-g.aabb.min[0])*Zu|0,b=Math.min(63,(n-g.aabb.min[1])/(g.aabb.max[1]-g.aabb.min[1])*Zu|0)*Zu+Math.min(63,v);if(!(g.heightmap[b]<0&&d.node.footprint))return d.hiddenByReplacement?void 0:{height:g.heightmap[b],maxHeight:d.feature.properties.height,hidden:!1,verticalScale:d.evaluatedScale[2]};if(d.node.footprint.grid.query(new ve(e,n),new ve(e,n),a),a.length>0)return{height:void 0,maxHeight:d.feature.properties.height,hidden:d.hiddenByReplacement,verticalScale:d.evaluatedScale[2]}}}}function Xf(t,e){return!t.isLightConstant&&e}function rP(t,e,n,o,a,l,d,g){let v=(61440&e|(61440&e)>>4)>>8,b=(3840&e|(3840&e)>>4)>>4,S=240&e|(240&e)>>4;n[3]>0&&(v=Zn(v,255*n[0],n[3]),b=Zn(b,255*n[1],n[3]),S=Zn(S,255*n[2],n[3]));const I=v<<8|b,D=S<<8|Math.floor(255*o[3]),F=function(ge){const Ie=vt(ge,0,2);return Math.min(Math.round(.5*Ie*255),255)}(o[2])<<8|15*o[0]<<4|15*o[1],N=vt(a[0],0,1),V=vt(a[1],0,1),q=vt(a[2],0,1),Y=vt(a[3],0,1);let oe,le,ae,be;if(N!==V&&d!==l&&V!==N){const ge=d-l;le=1/(ge*(V-N)),ae=-(l+ge*N)/(ge*(V-N));const Ie=vt(a[4],-1,1);be=Math.pow(10,Ie),oe=255*q<<8|255*Y}else oe=65535,le=0,ae=1,be=1;if(t.emplaceBack(I,D,F,oe,le,ae,be),g){const ge=g.length;g.clear();for(let Ie=0;Ie<ge;Ie++)g.emplaceBack(I,D,F,oe,le,ae,be)}}function iP(t,e,n){const o=t.node;let a=0;const l=n&ed.HasMeshoptCompression;for(const d of o.meshes){if(o.lights&&o.lightMeshIndex===a||!d.featureData)continue;d.featureArray=new Fu,d.featureArray.reserve(d.featureData.length);let g=e;for(const v of d.featureData){const b=l?65535&v:v>>16&65535,S=l?v>>16&65535:65535&v,I=(15&S)<8?15&S:0,D=t.evaluatedRMEA[I],F=t.evaluatedColor[I],N=t.emissionHeightBasedParams[I];let V;if(g&&I===2&&o.lights&&(V=new Fu,V.resize(10*o.lights.length)),rP(d.featureArray,b,F,D,N,d.aabb.min[2],d.aabb.max[2],V),V&&g){g=!1;const q=o.meshes[o.lightMeshIndex];q.featureArray=V,q.featureArray._trim()}}d.featureArray._trim(),a++}}function Ew(t,e,n,o){const a=1<<t.z;e.lat=_r((o/Jt+t.y)/a),e.lng=Fn((n/Jt+t.x)/a)}sn(h_,"Tiled3dModelBucket",{omit:["layers"]}),sn(Tw,"Tiled3dModelFeature");const oP={circle:class extends qo{constructor(t,e,n){super(t,KM,e,n)}createBucket(t){return new Yo(t)}queryRadius(t){const e=t;return Vh("circle-radius",this,e)+Vh("circle-stroke-width",this,e)+ym(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,n,o,a,l,d,g){const v=Vv(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),l.angle,t.pixelToTileUnitsFactor),b=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n);return pb(t,o,l,d,g,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",v,b)}getProgramIds(){return["circle"]}getDefaultProgramParams(t,e){const n=fb(this);return{config:new H(this,e),defines:n,overrideFog:!1}}},heatmap:class extends qo{createBucket(t){return new _b(t)}constructor(t,e,n){super(t,IA,e,n),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Cf({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(t){return Vh("heatmap-radius",this,t)}queryIntersectsFeature(t,e,n,o,a,l,d,g){const v=this.paint.get("heatmap-radius").evaluate(e,n);return pb(t,o,l,d,g,!0,!0,new ve(0,0),v)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(t,e){return t==="heatmap"?{config:new H(this,e),overrideFog:!1}:{}}},hillshade:class extends qo{constructor(t,e,n){super(t,PA,e,n)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(t,e){return{overrideFog:!1}}},fill:class extends qo{constructor(t,e,n){super(t,GA,e,n)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),n=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getDefaultProgramParams(t,e){return{config:new H(this,e),overrideFog:!1}}recalculate(t,e){super.recalculate(t,e);const n=this.paint._values["fill-outline-color"];n.value.kind==="constant"&&n.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new py(t)}queryRadius(){return ym(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,n,o,a,l){return!t.queryGeometry.isAboveHorizon&&Ol(jv(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),l.angle,t.pixelToTileUnitsFactor),o)}isTileClipped(){return!0}},"fill-extrusion":class extends qo{constructor(t,e,n){super(t,yI,e,n),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(t){return new Bm(t)}queryRadius(){return ym(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(t,e,n,o,a,l,d,g,v){const b=Vv(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),l.angle,t.pixelToTileUnitsFactor),S=this.paint.get("fill-extrusion-height").evaluate(e,n),I=this.paint.get("fill-extrusion-base").evaluate(e,n),D=[0,0],F=g&&l.elevation,N=l.elevation?l.elevation.exaggeration():1,V=t.tile.getBucket(this);if(F&&V instanceof Bm){const ae=V.centroidVertexArray,be=v+1;be<ae.length&&(D[0]=ae.geta_centroid_pos0(be),D[1]=ae.geta_centroid_pos1(be))}if(D[0]===0&&D[1]===1)return!1;l.projection.name==="globe"&&(o=Kb([o],[new ve(0,0),new ve(Jt,Jt)],t.tileID.canonical).map(ae=>ae.polygon).flat());const q=F?g:null,[Y,oe]=function(ae,be,ge,Ie,Ne,Ge,tt,qe,_t,Et,ct){return ae.projection.name==="globe"?function(wt,st,bt,$t,St,cn,rn,Dt,An,_n,ln){const kt=[],Tn=[],Kn=wt.projection.upVectorScale(ln,wt.center.lat,wt.worldSize).metersToTile,In=[0,0,0,1],Jn=[0,0,0,1],On=(jn,Wr,Ir,kr)=>{jn[0]=Wr,jn[1]=Ir,jn[2]=kr,jn[3]=1},pr=Xb();bt>0&&(bt+=pr),$t+=pr;for(const jn of st){const Wr=[],Ir=[];for(const kr of jn){const Br=kr.x+St.x,Cr=kr.y+St.y,hi=wt.projection.projectTilePoint(Br,Cr,ln),Ur=wt.projection.upVector(ln,kr.x,kr.y);let Ci=bt,Ki=$t;if(rn){const yo=Qb(Br,Cr,bt,$t,rn,Dt,An,_n);Ci+=yo.base,Ki+=yo.top}bt!==0?On(In,hi.x+Ur[0]*Kn*Ci,hi.y+Ur[1]*Kn*Ci,hi.z+Ur[2]*Kn*Ci):On(In,hi.x,hi.y,hi.z),On(Jn,hi.x+Ur[0]*Kn*Ki,hi.y+Ur[1]*Kn*Ki,hi.z+Ur[2]*Kn*Ki),i.N.transformMat4(In,In,cn),i.N.transformMat4(Jn,Jn,cn),Wr.push(new Hh(In[0],In[1],In[2])),Ir.push(new Hh(Jn[0],Jn[1],Jn[2]))}kt.push(Wr),Tn.push(Ir)}return[kt,Tn]}(ae,be,ge,Ie,Ne,Ge,tt,qe,_t,Et,ct):tt?function(wt,st,bt,$t,St,cn,rn,Dt,An){const _n=[],ln=[],kt=[0,0,0,1];for(const Tn of wt){const Kn=[],In=[];for(const Jn of Tn){const On=Jn.x+$t.x,pr=Jn.y+$t.y,jn=Qb(On,pr,st,bt,cn,rn,Dt,An);kt[0]=On,kt[1]=pr,kt[2]=jn.base,kt[3]=1,i.a7.transformMat4(kt,kt,St),kt[3]=Math.max(kt[3],1e-5);const Wr=new Hh(kt[0]/kt[3],kt[1]/kt[3],kt[2]/kt[3]);kt[0]=On,kt[1]=pr,kt[2]=jn.top,kt[3]=1,i.a7.transformMat4(kt,kt,St),kt[3]=Math.max(kt[3],1e-5);const Ir=new Hh(kt[0]/kt[3],kt[1]/kt[3],kt[2]/kt[3]);Kn.push(Wr),In.push(Ir)}_n.push(Kn),ln.push(In)}return[_n,ln]}(be,ge,Ie,Ne,Ge,tt,qe,_t,Et):function(wt,st,bt,$t,St){const cn=[],rn=[],Dt=St[8]*st,An=St[9]*st,_n=St[10]*st,ln=St[11]*st,kt=St[8]*bt,Tn=St[9]*bt,Kn=St[10]*bt,In=St[11]*bt;for(const Jn of wt){const On=[],pr=[];for(const jn of Jn){const Wr=jn.x+$t.x,Ir=jn.y+$t.y,kr=St[0]*Wr+St[4]*Ir+St[12],Br=St[1]*Wr+St[5]*Ir+St[13],Cr=St[2]*Wr+St[6]*Ir+St[14],hi=St[3]*Wr+St[7]*Ir+St[15],Ur=kr+Dt,Ci=Br+An,Ki=Cr+_n,yo=Math.max(hi+ln,1e-5),ai=kr+kt,gi=Br+Tn,ho=Cr+Kn,fo=Math.max(hi+In,1e-5);On.push(new Hh(Ur/yo,Ci/yo,Ki/yo)),pr.push(new Hh(ai/fo,gi/fo,ho/fo))}cn.push(On),rn.push(pr)}return[cn,rn]}(be,ge,Ie,Ne,Ge)}(l,o,I,S,b,d,q,D,N,l.center.lat,t.tileID.canonical),le=t.queryGeometry;return function(ae,be,ge){let Ie=1/0;Ol(ge,be)&&(Ie=Jb(ge,be[0]));for(let Ne=0;Ne<be.length;Ne++){const Ge=be[Ne],tt=ae[Ne];for(let qe=0;qe<Ge.length-1;qe++){const _t=Ge[qe],Et=[_t,Ge[qe+1],tt[qe+1],tt[qe],_t];ra(ge,Et)&&(Ie=Math.min(Ie,Jb(ge,Et)))}}return Ie!==1/0&&Ie}(Y,oe,le.isPointQuery()?le.screenBounds:le.screenGeometry)}},line:class extends qo{constructor(t,e,n){super(t,t1,e,n),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof ri,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=a1.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new gy(t)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(t,e){const n=o1(this);return{config:new H(this,e),defines:n,overrideFog:!1}}queryRadius(t){const e=t,n=l1(Vh("line-width",this,e),Vh("line-gap-width",this,e)),o=Vh("line-offset",this,e);return n/2+Math.abs(o)+ym(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,n,o,a,l){if(t.queryGeometry.isAboveHorizon)return!1;const d=jv(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),l.angle,t.pixelToTileUnitsFactor),g=t.pixelToTileUnitsFactor/2*l1(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),v=this.paint.get("line-offset").evaluate(e,n);return v&&(o=function(b,S){const I=[],D=new ve(0,0);for(let F=0;F<b.length;F++){const N=b[F],V=[];for(let q=0;q<N.length;q++){const Y=N[q],oe=N[q+1],le=q===0?D:Y.sub(N[q-1])._unit()._perp(),ae=q===N.length-1?D:oe.sub(Y)._unit()._perp(),be=le._add(ae)._unit();be._mult(1/(be.x*ae.x+be.y*ae.y)),V.push(be._mult(S)._add(Y))}I.push(V)}return I}(o,v*t.pixelToTileUnitsFactor)),function(b,S,I){for(let D=0;D<S.length;D++){const F=S[D];if(b.length>=3){for(let N=0;N<F.length;N++)if(Sa(b,F[N]))return!0}if(Uu(b,F,I))return!0}return!1}(d,o,g)}isTileClipped(){return!0}},symbol:e_,background:class extends qo{constructor(t,e,n){super(t,bC,e,n)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(t,e){return{overrideFog:!1}}},raster:W1,"raster-particle":Z1,sky:class extends qo{constructor(t,e,n){super(t,CC,e,n),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="sky-gradient"?this._updateColorRamp():t!=="sky-atmosphere-sun"&&t!=="sky-atmosphere-halo-color"&&t!=="sky-atmosphere-color"&&t!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Cf({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(t,e){if(this.paint.get("sky-type")==="atmosphere"){const o=this.paint.get("sky-atmosphere-sun"),a=!o,l=t.style.light,d=l.properties.get("position");return a&&l.properties.get("anchor")==="viewport"&&Re("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),a?Oy(d.azimuthal,90-d.polar,e):Oy(o[0],90-o[1],e)}const n=this.paint.get("sky-gradient-center");return Oy(n[0],90-n[1],e)}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return t==="atmosphere"?["skyboxCapture","skybox"]:t==="gradient"?["skyboxGradient"]:null}},slot:class extends qo{constructor(t,e,n){super(t,PC,e)}},model:class extends qo{constructor(t,e,n){super(t,NC,e,n),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(t){return new Ly(t)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(t){return t instanceof h_?Jt-1:0}queryIntersectsFeature(t,e,n,o,a,l){if(!this.modelManager)return!1;const d=this.modelManager,g=t.tile.getBucket(this);if(!(g&&g instanceof Ly))return!1;const v=g;for(const b in v.instancesPerModel){const S=v.instancesPerModel[b];if(S.idToFeaturesIndex.hasOwnProperty(e.id)){const I=S.features[S.idToFeaturesIndex[e.id]],D=d.getModel(b,this.scope);if(!D)return!1;let F=i.a6.create();const N=new $e(0,0),V=v.canonical;let q=Number.MAX_VALUE;for(let Y=0;Y<I.instancedDataCount;++Y){const oe=16*(I.instancedDataOffset+Y),le=S.instancedDataArray.float32,ae=[le[oe+4],le[oe+5],le[oe+6]];Ew(V,N,le[oe],0|le[oe+1]),rw(F,D,l,N,I.rotation,I.scale,ae,!1,!1,!1),l.projection.name==="globe"&&(F=Ry(F,l));const be=i.a6.multiply([],l.projMatrix,F),ge=t.queryGeometry,Ie=ew(ge.isPointQuery()?ge.screenBounds:ge.screenGeometry,l,be,D.aabb);Ie!=null&&(q=Math.min(Ie,q))}return q!==Number.MAX_VALUE&&q}}return!1}_handleOverridablePaintPropertyUpdate(t,e,n){return!(!this.layout||e.isDataDriven()||n.isDataDriven()||t!=="model-color"&&t!=="model-color-mix-intensity"&&t!=="model-rotation"&&t!=="model-scale"&&t!=="model-translation"&&t!=="model-emissive-strength")}_isPropertyZoomDependent(t){const e=this._transitionablePaint._values[t];return e!=null&&e.value!=null&&e.value.expression!=null&&e.value.expression instanceof xu}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(t,e,n,o){const a=t.tile,l=a.getBucket(this);let d=null,g=Number.MAX_VALUE;if(!(l&&l instanceof h_))return{queryFeature:d,intersectionZ:g};const v=l.getNodesInfo()[e];if(v.hiddenByReplacement||!v.node.meshes||!n.filter(new fi(a.tileID.overscaledZ),v.feature,a.tileID.canonical))return{queryFeature:d,intersectionZ:g};const b=v.node,S=o.calculatePosMatrix(a.tileID.toUnwrapped(),o.worldSize),I=v.evaluatedScale;let D=0;o.elevation&&b.elevation&&(D=b.elevation*o.elevation.exaggeration()),i.a6.translate(S,S,[(b.anchor?b.anchor[0]:0)*(I[0]-1),(b.anchor?b.anchor[1]:0)*(I[1]-1),D]),i.a6.scale(S,S,I),i.a6.multiply(S,S,b.matrix);const F=t.queryGeometry,N=F.isPointQuery()?F.screenBounds:F.screenGeometry,V=function(Y){const oe=i.a6.multiply([],S,Y.matrix),le=i.a6.multiply(oe,o.expandedFarZProjMatrix,oe);for(let ae=0;ae<Y.meshes.length;++ae){const be=Y.meshes[ae];if(ae===Y.lightMeshIndex)continue;const ge=ew(N,o,le,be.aabb);ge!=null&&(g=Math.min(ge,g))}if(Y.children)for(const ae of Y.children)V(ae)};if(V(b),g===Number.MAX_VALUE)return{queryFeature:d,intersectionZ:g};const q=new $e(0,0);return Ew(a.tileID.canonical,q,v.node.anchor[0],v.node.anchor[1]),d={type:"Feature",geometry:{type:"Point",coordinates:[q.lng,q.lat]},properties:v.feature.properties,id:v.feature.id,state:{},layer:this.serialize()},{queryFeature:d,intersectionZ:g}}}},Un={read:function(t,e){return t.readFields(Un._readField,{header_length:0,x:0,y:0,z:0,layers:[]},e)},_readField:function(t,e,n){t===1?e.header_length=n.readFixed32():t===2?e.x=n.readVarint():t===3?e.y=n.readVarint():t===4?e.z=n.readVarint():t===5&&e.layers.push(Un.Layer.read(n,n.readVarint()+n.pos))},PixelFormat:{PIXEL_FORMAT_UNKNOWN:{value:0,options:{}},PIXEL_FORMAT_UINT32:{value:1,options:{}},PIXEL_FORMAT_UINT16:{value:2,options:{}},PIXEL_FORMAT_UINT8:{value:3,options:{}}},Filter:{}};Un.Filter.read=function(t,e){return t.readFields(Un.Filter._readField,{delta_filter:null,filter:null,zigzag_filter:null,bitshuffle_filter:null,byteshuffle_filter:null},e)},Un.Filter._readField=function(t,e,n){t===1?(e.delta_filter=Un.Filter.Delta.read(n,n.readVarint()+n.pos),e.filter="delta_filter"):t===2?(e.zigzag_filter=Un.Filter.Zigzag.read(n,n.readVarint()+n.pos),e.filter="zigzag_filter"):t===3?(e.bitshuffle_filter=Un.Filter.BitShuffle.read(n,n.readVarint()+n.pos),e.filter="bitshuffle_filter"):t===4&&(e.byteshuffle_filter=Un.Filter.ByteShuffle.read(n,n.readVarint()+n.pos),e.filter="byteshuffle_filter")},Un.Filter.Delta={},Un.Filter.Delta.read=function(t,e){return t.readFields(Un.Filter.Delta._readField,{block_size:0},e)},Un.Filter.Delta._readField=function(t,e,n){t===1&&(e.block_size=n.readVarint())},Un.Filter.Zigzag={},Un.Filter.Zigzag.read=function(t,e){return t.readFields(Un.Filter.Zigzag._readField,{},e)},Un.Filter.Zigzag._readField=function(t,e,n){},Un.Filter.BitShuffle={},Un.Filter.BitShuffle.read=function(t,e){return t.readFields(Un.Filter.BitShuffle._readField,{},e)},Un.Filter.BitShuffle._readField=function(t,e,n){},Un.Filter.ByteShuffle={},Un.Filter.ByteShuffle.read=function(t,e){return t.readFields(Un.Filter.ByteShuffle._readField,{},e)},Un.Filter.ByteShuffle._readField=function(t,e,n){},Un.Codec={},Un.Codec.read=function(t,e){return t.readFields(Un.Codec._readField,{gzip_data:null,codec:null,jpeg_image:null,webp_image:null,png_image:null},e)},Un.Codec._readField=function(t,e,n){t===1?(e.gzip_data=Un.Codec.GzipData.read(n,n.readVarint()+n.pos),e.codec="gzip_data"):t===2?(e.jpeg_image=Un.Codec.JpegImage.read(n,n.readVarint()+n.pos),e.codec="jpeg_image"):t===3?(e.webp_image=Un.Codec.WebpImage.read(n,n.readVarint()+n.pos),e.codec="webp_image"):t===4&&(e.png_image=Un.Codec.PngImage.read(n,n.readVarint()+n.pos),e.codec="png_image")},Un.Codec.GzipData={},Un.Codec.GzipData.read=function(t,e){return t.readFields(Un.Codec.GzipData._readField,{},e)},Un.Codec.GzipData._readField=function(t,e,n){},Un.Codec.JpegImage={},Un.Codec.JpegImage.read=function(t,e){return t.readFields(Un.Codec.JpegImage._readField,{},e)},Un.Codec.JpegImage._readField=function(t,e,n){},Un.Codec.WebpImage={},Un.Codec.WebpImage.read=function(t,e){return t.readFields(Un.Codec.WebpImage._readField,{},e)},Un.Codec.WebpImage._readField=function(t,e,n){},Un.Codec.PngImage={},Un.Codec.PngImage.read=function(t,e){return t.readFields(Un.Codec.PngImage._readField,{},e)},Un.Codec.PngImage._readField=function(t,e,n){},Un.DataIndexEntry={},Un.DataIndexEntry.read=function(t,e){return t.readFields(Un.DataIndexEntry._readField,{first_byte:0,last_byte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},e)},Un.DataIndexEntry._readField=function(t,e,n){t===1?e.first_byte=n.readFixed64():t===2?e.last_byte=n.readFixed64():t===3?e.filters.push(Un.Filter.read(n,n.readVarint()+n.pos)):t===4?e.codec=Un.Codec.read(n,n.readVarint()+n.pos):t===5?e.offset=n.readFloat():t===6?e.scale=n.readFloat():t===7&&e.bands.push(n.readString())},Un.Layer={},Un.Layer.read=function(t,e){return t.readFields(Un.Layer._readField,{version:0,name:"",units:"",tilesize:0,buffer:0,pixel_format:0,data_index:[]},e)},Un.Layer._readField=function(t,e,n){t===1?e.version=n.readVarint():t===2?e.name=n.readString():t===3?e.units=n.readString():t===4?e.tilesize=n.readVarint():t===5?e.buffer=n.readVarint():t===6?e.pixel_format=n.readVarint():t===7&&e.data_index.push(Un.DataIndexEntry.read(n,n.readVarint()+n.pos))};const Da={read:function(t,e){return t.readFields(Da._readField,{uint32_values:null,values:null,fixed32_values:null},e)},_readField:function(t,e,n){t===2?(e.uint32_values=Da.Uint32Values.read(n,n.readVarint()+n.pos),e.values="uint32_values"):t===3&&(e.fixed32_values=Da.Fixed32Values.read(n,n.readVarint()+n.pos),e.values="fixed32_values")},Uint32Values:{}};Da.Uint32Values.read=function(t,e){return t.readFields(Da.Uint32Values._readField,{values:[]},e)},Da.Uint32Values._readField=function(t,e,n){t===1&&(e.readValuesInto=function(o){if(o.type!==2)throw new Error(`Unsupported pbf type "${o.type}"`);const a=function(d){return d.type===2?d.readVarint()+d.pos:d.pos+1}(o),l=o.pos;return o.pos=a,function(d){o.pos=l;let g=0;for(;o.pos<a;){const v=o.readVarint();d[g++]=v}return d}}(n))},Da.Fixed32Values={},Da.Fixed32Values.read=function(t,e){return t.readFields(Da.Fixed32Values._readField,{values:[]},e)},Da.Fixed32Values._readField=function(t,e,n){throw new Error("Not implemented")};/**
 * tiny-lru
 *
 * @copyright 2023 Jason Mulligan <jason.mulligan@avoidwork.com>
 * @license BSD-3-Clause
 * @version 11.2.5
 */class sP{constructor(e=0,n=0,o=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=e,this.resetTtl=o,this.size=0,this.ttl=n}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(e){if(this.has(e)){const n=this.items[e];delete this.items[e],this.size--,n.prev!==null&&(n.prev.next=n.next),n.next!==null&&(n.next.prev=n.prev),this.first===n&&(this.first=n.next),this.last===n&&(this.last=n.prev)}return this}entries(e=this.keys()){return e.map(n=>[n,this.get(n)])}evict(e=!1){if(e||this.size>0){const n=this.first;delete this.items[n.key],--this.size==0?(this.first=null,this.last=null):(this.first=n.next,this.first.prev=null)}return this}expiresAt(e){let n;return this.has(e)&&(n=this.items[e].expiry),n}get(e){let n;if(this.has(e)){const o=this.items[e];this.ttl>0&&o.expiry<=Date.now()?this.delete(e):(n=o.value,this.set(e,n,!0))}return n}has(e){return e in this.items}keys(){const e=[];let n=this.first;for(;n!==null;)e.push(n.key),n=n.next;return e}set(e,n,o=!1,a=this.resetTtl){let l;if(o||this.has(e)){if(l=this.items[e],l.value=n,o===!1&&a&&(l.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.last!==l){const d=this.last,g=l.next,v=l.prev;this.first===l&&(this.first=l.next),l.next=null,l.prev=this.last,d.next=l,v!==null&&(v.next=g),g!==null&&(g.prev=v)}}else this.max>0&&this.size===this.max&&this.evict(!0),l=this.items[e]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:n},++this.size==1?this.first=l:this.last.next=l;return this.last=l,this}values(e=this.keys()){return e.map(n=>this.get(n))}}function aP(t,e){if(e.length!==4)throw new Error(`Expected data of dimension 4 but got ${e.length}.`);let n=e[3];for(let o=2;o>=1;o--){const a=o===1?1:0,l=o===2?1:0;for(let d=0;d<e[0];d++){const g=e[1]*d;for(let v=a;v<e[1];v++){const b=e[2]*(v+g);for(let S=l;S<e[2];S++){const I=e[3]*(S+b);for(let D=0;D<e[3];D++){const F=I+D;t[F]+=t[F-n]}}}}n*=e[o]}return t}function lP(t){for(let e=0,n=t.length;e<n;e++)t[e]=t[e]>>>1^-(1&t[e]);return t}function cP(t,e){switch(e){case"uint32":return t;case"uint16":for(let n=0;n<t.length;n+=2){const o=t[n],a=t[n+1];t[n]=(240&o)>>4|(61440&o)>>8|(240&a)<<4|61440&a,t[n+1]=15&o|(3840&o)>>4|(15&a)<<8|(3840&a)<<4}return t;case"uint8":for(let n=0;n<t.length;n+=4){const o=t[n],a=t[n+1],l=t[n+2],d=t[n+3];t[n+0]=(192&o)>>6|(192&a)>>4|(192&l)>>2|192&d,t[n+1]=(48&o)>>4|(48&a)>>2|48&l|(48&d)<<2,t[n+2]=(12&o)>>2|12&a|(12&l)<<2|(12&d)<<4,t[n+3]=3&o|(3&a)<<2|(3&l)<<4|(3&d)<<6}return t;default:throw new Error(`Invalid pixel format, "${e}"`)}}class Cc extends Error{constructor(e){super(e),this.name="MRTError"}}var js=Uint8Array,id=Uint16Array,uP=Int32Array,Sw=new js([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Mw=new js([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),hP=new js([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Aw=function(t,e){for(var n=new id(31),o=0;o<31;++o)n[o]=e+=1<<t[o-1];var a=new uP(n[30]);for(o=1;o<30;++o)for(var l=n[o];l<n[o+1];++l)a[l]=l-n[o]<<5|o;return{b:n,r:a}},Iw=Aw(Sw,2),Cw=Iw.b,dP=Iw.r;Cw[28]=258,dP[258]=28;for(var fP=Aw(Mw,0).b,Gy=new id(32768),Ui=0;Ui<32768;++Ui){var od=(43690&Ui)>>1|(21845&Ui)<<1;Gy[Ui]=((65280&(od=(61680&(od=(52428&od)>>2|(13107&od)<<2))>>4|(3855&od)<<4))>>8|(255&od)<<8)>>1}var Kf=function(t,e,n){for(var o=t.length,a=0,l=new id(e);a<o;++a)t[a]&&++l[t[a]-1];var d,g=new id(e);for(a=1;a<e;++a)g[a]=g[a-1]+l[a-1]<<1;if(n){d=new id(1<<e);var v=15-e;for(a=0;a<o;++a)if(t[a])for(var b=a<<4|t[a],S=e-t[a],I=g[t[a]-1]++<<S,D=I|(1<<S)-1;I<=D;++I)d[Gy[I]>>v]=b}else for(d=new id(o),a=0;a<o;++a)t[a]&&(d[a]=Gy[g[t[a]-1]++]>>15-t[a]);return d},Jf=new js(288);for(Ui=0;Ui<144;++Ui)Jf[Ui]=8;for(Ui=144;Ui<256;++Ui)Jf[Ui]=9;for(Ui=256;Ui<280;++Ui)Jf[Ui]=7;for(Ui=280;Ui<288;++Ui)Jf[Ui]=8;var Pw=new js(32);for(Ui=0;Ui<32;++Ui)Pw[Ui]=5;var pP=Kf(Jf,9,1),mP=Kf(Pw,5,1),Hy=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},ka=function(t,e,n){var o=e/8|0;return(t[o]|t[o+1]<<8)>>(7&e)&n},qy=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(7&e)},_P=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Oa=function(t,e,n){var o=new Error(e||_P[t]);if(o.code=t,Error.captureStackTrace&&Error.captureStackTrace(o,Oa),!n)throw o;return o},gP=new js(0),yP=typeof TextDecoder<"u"&&new TextDecoder;try{yP.decode(gP,{stream:!0})}catch{}const vP={gzip_data:"gzip"},xP={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},bP={uint32:1,uint16:2,uint8:4},wP={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};class Dw{constructor(e=1){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=e}getLayer(e){return this.layers[e]}getHeaderLength(e){const n=new Uint8Array(e),o=new DataView(e);if(n[0]!==13)throw new Cc("File is not a valid MRT.");return o.getUint32(1,!0)}parseHeader(e){const n=new Uint8Array(e),o=this.getHeaderLength(e);if(n.length<o)throw new Cc(`Expected header with length >= ${o} but got buffer of length ${n.length}`);const a=new Yh(n.subarray(0,o)),l=Un.read(a);if(!isNaN(this.x)&&(this.x!==l.x||this.y!==l.y||this.z!==l.z))throw new Cc(`Invalid attempt to parse header ${l.z}/${l.x}/${l.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=l.x,this.y=l.y,this.z=l.z;for(const d of l.layers)this.layers[d.name]=new TP(d,{cacheSize:this._cacheSize});return this}createDecodingTask(e){const n=[],o=this.getLayer(e.layerName);for(let a=0;a<o.dataIndex.length;a++){const l=o.dataIndex[a],d=l.first_byte-e.firstByte,g=l.last_byte+1-e.firstByte;if(a<e.firstBlock||a>e.lastBlock||o._blocksInProgress.has(a))continue;const v={layerName:o.name,firstByte:d,lastByte:g,pixelFormat:o.pixelFormat,blockIndex:a,blockShape:[l.bands.length].concat(o.bandShape),buffer:o.buffer,codec:l.codec.codec,filters:l.filters.map(b=>b.filter)};o._blocksInProgress.add(a),n.push(v)}return new kw(n,()=>{n.forEach(a=>o._blocksInProgress.delete(a.blockIndex))},(a,l)=>{if(n.forEach(d=>o._blocksInProgress.delete(d.blockIndex)),a)throw a;l.forEach(d=>{this.getLayer(d.layerName).processDecodedData(d)})})}}class TP{constructor({version:e,name:n,units:o,tilesize:a,pixel_format:l,buffer:d,data_index:g},v){if(this.version=e,this.version!==1)throw new Cc(`Cannot parse raster layer encoded with MRT version ${e}`);this.name=n,this.units=o,this.tileSize=a,this.buffer=d,this.pixelFormat=xP[l],this.dataIndex=g,this.bandShape=[a+2*d,a+2*d,bP[this.pixelFormat]],this._decodedBlocks=function(b=1e3,S=0,I=!1){if(isNaN(b)||b<0)throw new TypeError("Invalid max value");if(isNaN(S)||S<0)throw new TypeError("Invalid ttl value");if(typeof I!="boolean")throw new TypeError("Invalid resetTtl value");return new sP(b,S,I)}(v?v.cacheSize:5),this._blocksInProgress=new Set}processDecodedData(e){const n=e.blockIndex.toString();this._decodedBlocks.get(n)||this._decodedBlocks.set(n,e.data)}getBlockForBand(e){let n=0;switch(typeof e){case"string":for(const[o,a]of this.dataIndex.entries()){for(const[l,d]of a.bands.entries())if(d===e)return{bandIndex:n+l,blockIndex:o,blockBandIndex:l};n+=a.bands.length}break;case"number":for(const[o,a]of this.dataIndex.entries()){if(e>=n&&e<n+a.bands.length)return{bandIndex:e,blockIndex:o,blockBandIndex:e-n};n+=a.bands.length}break;default:throw new Cc(`Invalid band \`${JSON.stringify(e)}\`. Expected string or integer.`)}throw new Cc(`Band not found: ${JSON.stringify(e)}`)}getDataRange(e){let n=1/0,o=-1/0,a=1/0,l=-1/0;for(const d of e){const{blockIndex:g}=this.getBlockForBand(d);if(g<0)throw new Cc(`Invalid band: ${JSON.stringify(d)}`);const v=this.dataIndex[g];a=Math.min(a,g),l=Math.max(l,g),n=Math.min(n,v.first_byte),o=Math.max(o,v.last_byte)}return{layerName:this.name,firstByte:n,lastByte:o,firstBlock:a,lastBlock:l}}hasBand(e){const{blockIndex:n}=this.getBlockForBand(e);return n>=0}hasDataForBand(e){const{blockIndex:n}=this.getBlockForBand(e);return n>=0&&!!this._decodedBlocks.get(n.toString())}getBandView(e){const{blockIndex:n,blockBandIndex:o}=this.getBlockForBand(e),a=this._decodedBlocks.get(n.toString());if(!a)throw new Cc(`Data for band ${JSON.stringify(e)} of layer "${this.name}" not decoded.`);const l=this.dataIndex[n],d=this.bandShape.reduce((b,S)=>b*S,1),g=o*d,v=a.subarray(g,g+d);return{data:v,bytes:new Uint8Array(v.buffer).subarray(v.byteOffset,v.byteOffset+v.byteLength),tileSize:this.tileSize,buffer:this.buffer,offset:l.offset,scale:l.scale}}}class kw{constructor(e,n,o){this.tasks=e,this._onCancel=n,this._onComplete=o,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(e,n){this._finalized||(this._onComplete(e,n),this._finalized=!0)}}Dw.performDecoding=function(t,e){return Promise.all(e.tasks.map(n=>{const{layerName:o,firstByte:a,lastByte:l,pixelFormat:d,blockShape:g,blockIndex:v,filters:b,codec:S}=n,I=new Uint8Array(t).subarray(a,l+1),D=new Uint32Array(g[0]*g[1]*g[2]);let F;if(S!=="gzip_data")throw new Error(`Unhandled codec: ${S}`);return F=function(N,V){if(!globalThis.DecompressionStream&&V==="gzip_data")return Promise.resolve(((le=function(ge){ge[0]==31&&ge[1]==139&&ge[2]==8||Oa(6,"invalid gzip data");var Ie=ge[3],Ne=10;4&Ie&&(Ne+=2+(ge[10]|ge[11]<<8));for(var Ge=(Ie>>3&1)+(Ie>>4&1);Ge>0;Ge-=!ge[Ne++]);return Ne+(2&Ie)}(oe=N))+8>oe.length&&Oa(6,"invalid gzip data"),function(ge,Ie,Ne,Ge){var tt=ge.length;if(!tt||Ie.f&&!Ie.l)return Ne||new js(0);var qe=!Ne,_t=qe||Ie.i!=2,Et=Ie.i;qe&&(Ne=new js(3*tt));var ct=function(Xo){var Bo=Ne.length;if(Xo>Bo){var Vs=new js(Math.max(2*Bo,Xo));Vs.set(Ne),Ne=Vs}},wt=Ie.f||0,st=Ie.p||0,bt=Ie.b||0,$t=Ie.l,St=Ie.d,cn=Ie.m,rn=Ie.n,Dt=8*tt;do{if(!$t){wt=ka(ge,st,1);var An=ka(ge,st+1,3);if(st+=3,!An){var _n=ge[(Ir=4+((st+7)/8|0))-4]|ge[Ir-3]<<8,ln=Ir+_n;if(ln>tt){Et&&Oa(0);break}_t&&ct(bt+_n),Ne.set(ge.subarray(Ir,ln),bt),Ie.b=bt+=_n,Ie.p=st=8*ln,Ie.f=wt;continue}if(An==1)$t=pP,St=mP,cn=9,rn=5;else if(An==2){var kt=ka(ge,st,31)+257,Tn=ka(ge,st+10,15)+4,Kn=kt+ka(ge,st+5,31)+1;st+=14;for(var In=new js(Kn),Jn=new js(19),On=0;On<Tn;++On)Jn[hP[On]]=ka(ge,st+3*On,7);st+=3*Tn;var pr=Hy(Jn),jn=(1<<pr)-1,Wr=Kf(Jn,pr,1);for(On=0;On<Kn;){var Ir,kr=Wr[ka(ge,st,jn)];if(st+=15&kr,(Ir=kr>>4)<16)In[On++]=Ir;else{var Br=0,Cr=0;for(Ir==16?(Cr=3+ka(ge,st,3),st+=2,Br=In[On-1]):Ir==17?(Cr=3+ka(ge,st,7),st+=3):Ir==18&&(Cr=11+ka(ge,st,127),st+=7);Cr--;)In[On++]=Br}}var hi=In.subarray(0,kt),Ur=In.subarray(kt);cn=Hy(hi),rn=Hy(Ur),$t=Kf(hi,cn,1),St=Kf(Ur,rn,1)}else Oa(1);if(st>Dt){Et&&Oa(0);break}}_t&&ct(bt+131072);for(var Ci=(1<<cn)-1,Ki=(1<<rn)-1,yo=st;;yo=st){var ai=(Br=$t[qy(ge,st)&Ci])>>4;if((st+=15&Br)>Dt){Et&&Oa(0);break}if(Br||Oa(2),ai<256)Ne[bt++]=ai;else{if(ai==256){yo=st,$t=null;break}var gi=ai-254;ai>264&&(gi=ka(ge,st,(1<<(po=Sw[On=ai-257]))-1)+Cw[On],st+=po);var ho=St[qy(ge,st)&Ki],fo=ho>>4;if(ho||Oa(3),st+=15&ho,Ur=fP[fo],fo>3){var po=Mw[fo];Ur+=qy(ge,st)&(1<<po)-1,st+=po}if(st>Dt){Et&&Oa(0);break}_t&&ct(bt+131072);var ei=bt+gi;if(bt<Ur){var fs=0-Ur,Pc=Math.min(Ur,ei);for(fs+bt<0&&Oa(3);bt<Pc;++bt)Ne[bt]=Ge[fs+bt]}for(;bt<ei;++bt)Ne[bt]=Ne[bt-Ur]}}Ie.l=$t,Ie.p=yo,Ie.b=bt,Ie.f=wt,$t&&(wt=1,Ie.m=cn,Ie.d=St,Ie.n=rn)}while(!wt);return bt!=Ne.length&&qe?function(Xo,Bo,Vs){return(Bo==null||Bo<0)&&(Bo=0),(Vs==null||Vs>Xo.length)&&(Vs=Xo.length),new js(Xo.subarray(Bo,Vs))}(Ne,0,bt):Ne.subarray(0,bt)}(oe.subarray(le,-8),{i:2},new js(((q=oe)[(Y=q.length)-4]|q[Y-3]<<8|q[Y-2]<<16|q[Y-1]<<24)>>>0),void 0)));var q,Y,oe,le;const ae=vP[V];if(!ae)throw new Error(`Unhandled codec: ${V}`);const be=new globalThis.DecompressionStream(ae);return new Response(new Blob([N]).stream().pipeThrough(be)).arrayBuffer().then(ge=>new Uint8Array(ge))}(I,S).then(N=>{const V=Da.read(new Yh(N));if(V.values==="uint32_values")return V.uint32_values.readValuesInto(D),new wP[d](D.buffer);throw new Error(`Unhandled numeric data "${V.values}"`)}),F.then(N=>{for(let V=b.length-1;V>=0;V--)switch(b[V]){case"delta_filter":aP(N,g);break;case"zigzag_filter":lP(N);break;case"bitshuffle_filter":cP(N,d);break;default:throw new Error(`Unhandled filter "${b[V]}"`)}return{layerName:o,blockIndex:v,data:N}}).catch(N=>{throw N})}))},sn(kw,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});const Ow=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Wy{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,o]=new Uint8Array(e,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const a=o>>4;if(a!==1)throw new Error(`Got v${a} data when expected v1.`);const l=Ow[15&o];if(!l)throw new Error("Unrecognized array type.");const[d]=new Uint16Array(e,2,1),[g]=new Uint32Array(e,4,1);return new Wy(g,d,l,e)}constructor(e,n=64,o=Float64Array,a){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=o,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const l=Ow.indexOf(this.ArrayType),d=2*e*this.ArrayType.BYTES_PER_ELEMENT,g=e*this.IndexArrayType.BYTES_PER_ELEMENT,v=(8-g%8)%8;if(l<0)throw new Error(`Unexpected typed array class: ${o}.`);a&&a instanceof ArrayBuffer?(this.data=a,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+g+v,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+d+g+v),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+g+v,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+l]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=e)}add(e,n){const o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=e,this.coords[this._pos++]=n,o}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Zy(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,n,o,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:l,coords:d,nodeSize:g}=this,v=[0,l.length-1,0],b=[];for(;v.length;){const S=v.pop()||0,I=v.pop()||0,D=v.pop()||0;if(I-D<=g){for(let q=D;q<=I;q++){const Y=d[2*q],oe=d[2*q+1];Y>=e&&Y<=o&&oe>=n&&oe<=a&&b.push(l[q])}continue}const F=D+I>>1,N=d[2*F],V=d[2*F+1];N>=e&&N<=o&&V>=n&&V<=a&&b.push(l[F]),(S===0?e<=N:n<=V)&&(v.push(D),v.push(F-1),v.push(1-S)),(S===0?o>=N:a>=V)&&(v.push(F+1),v.push(I),v.push(1-S))}return b}within(e,n,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:a,coords:l,nodeSize:d}=this,g=[0,a.length-1,0],v=[],b=o*o;for(;g.length;){const S=g.pop()||0,I=g.pop()||0,D=g.pop()||0;if(I-D<=d){for(let q=D;q<=I;q++)Lw(l[2*q],l[2*q+1],e,n)<=b&&v.push(a[q]);continue}const F=D+I>>1,N=l[2*F],V=l[2*F+1];Lw(N,V,e,n)<=b&&v.push(a[F]),(S===0?e-o<=N:n-o<=V)&&(g.push(D),g.push(F-1),g.push(1-S)),(S===0?e+o>=N:n+o>=V)&&(g.push(F+1),g.push(I),g.push(1-S))}return v}}function Zy(t,e,n,o,a,l){if(a-o<=n)return;const d=o+a>>1;Rw(t,e,d,o,a,l),Zy(t,e,n,o,d-1,1-l),Zy(t,e,n,d+1,a,1-l)}function Rw(t,e,n,o,a,l){for(;a>o;){if(a-o>600){const b=a-o+1,S=n-o+1,I=Math.log(b),D=.5*Math.exp(2*I/3),F=.5*Math.sqrt(I*D*(b-D)/b)*(S-b/2<0?-1:1);Rw(t,e,n,Math.max(o,Math.floor(n-S*D/b+F)),Math.min(a,Math.floor(n+(b-S)*D/b+F)),l)}const d=e[2*n+l];let g=o,v=a;for(Qf(t,e,o,n),e[2*a+l]>d&&Qf(t,e,o,a);g<v;){for(Qf(t,e,g,v),g++,v--;e[2*g+l]<d;)g++;for(;e[2*v+l]>d;)v--}e[2*o+l]===d?Qf(t,e,o,v):(v++,Qf(t,e,v,a)),v<=n&&(o=v+1),n<=v&&(a=v-1)}}function Qf(t,e,n,o){Yy(t,n,o),Yy(e,2*n,2*o),Yy(e,2*n+1,2*o+1)}function Yy(t,e,n){const o=t[e];t[e]=t[n],t[n]=o}function Lw(t,e,n,o){const a=t-n,l=e-o;return a*a+l*l}i.$=B1,i.A=Sh,i.B=qd,i.C=lr,i.D=Je,i.E=qs,i.F=pi,i.G=Nt,i.H=class{constructor(t){this.specification=t}possiblyEvaluate(t,e){return Ot(t.expression.evaluate(e))}interpolate(t,e,n){return{x:Zn(t.x,e.x,n),y:Zn(t.y,e.y,n),z:Zn(t.z,e.z,n),azimuthal:Zn(t.azimuthal,e.azimuthal,n),polar:Zn(t.polar,e.polar,n)}}},i.I=Ty,i.J=wa,i.K=fi,i.L=Sr,i.M=class{constructor(t,e,n,o){this.id=t,this.position=e!=null?new $e(e[0],e[1]):new $e(0,0),this.orientation=n??[0,0,0],this.nodes=o,this.uploaded=!1,this.aabb=new Ti([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(t,e){if(i.a6.multiply(t.matrix,e,t.matrix),t.meshes)for(const n of t.meshes){const o=Ti.applyTransform(n.aabb,t.matrix);this.aabb.encapsulate(o)}if(t.children)for(const n of t.children)this._applyTransformations(n,t.matrix)}computeBoundsAndApplyParent(){const t=i.a6.identity([]);for(const e of this.nodes)this._applyTransformations(e,t)}computeModelMatrix(t,e,n,o,a,l,d=!1){rw(this.matrix,this,t.transform,this.position,e,n,o,a,l,d)}upload(t){if(!this.uploaded){for(const e of this.nodes)zy(e,t);for(const e of this.nodes)s_(e);this.uploaded=!0}}destroy(){for(const t of this.nodes)Fy(t)}},i.O=wr,i.P=ve,i.Q=Eu,i.R=oo,i.S=xc,i.T=ky,i.U=Zn,i.V=Jt,i.W=_l,i.X=class{constructor(t){this.specification=t}possiblyEvaluate(t,e){return function([n,o]){const a=Ot([1,n,o]);return{x:a.x,y:a.y,z:a.z}}(t.expression.evaluate(e))}interpolate(t,e,n){return{x:Zn(t.x,e.x,n),y:Zn(t.y,e.y,n),z:Zn(t.z,e.z,n)}}},i.Y=function(t,e,n=0,o=!0){const a=new ve(n,n),l=t.sub(a),d=e.add(a),g=[l,new ve(d.x,l.y),d,new ve(l.x,d.y)];return o&&g.push(l.clone()),g},i.Z=xu,i._=function(t,e){const n=[];for(let o=0;o<t.length;o++){const a=Kr(o-1,-1,t.length-1),l=Kr(o+1,-1,t.length-1),d=t[o],g=t[l],v=t[a].sub(d).unit(),b=g.sub(d).unit(),S=b.angleWithSep(v.x,v.y),I=v.add(b).unit().mult(-1*e/Math.sin(S/2));n.push(d.add(I))}return n},i.a=ml,i.a$=function(t){const e=[];for(const n in t)e.push(t[n]);return e},i.a0=Nv,i.a1=function(t,e,n=0){return i.N.fromValues(((e.x-n)*t.scale-t.x)*Jt,(e.y*t.scale-t.y)*Jt,Zr(e.z,e.y))},i.a2=Jg,i.a3=n1,i.a4=function(t){let e=1/0,n=1/0,o=-1/0,a=-1/0;for(const l of t)e=Math.min(e,l.x),n=Math.min(n,l.y),o=Math.max(o,l.x),a=Math.max(a,l.y);return{min:new ve(e,n),max:new ve(o,a)}},i.a5=qn,i.a8=Sa,i.a9=Lr,i.aA=jp,i.aB=Ii,i.aC=Hr,i.aD=nm,i.aE=Qm,i.aF=function(){rs.isLoading()||rs.isLoaded()||el()!=="deferred"||of()},i.aG=is,i.aH=qi,i.aI=gw,i.aJ=dn,i.aK=gy,i.aL=py,i.aM=no,i.aN=Ls,i.aO=vf,i.aP=ib,i.aQ=Dm,i.aR=Dy,i.aS=function(t,e){const n=xc(e.zoom);if(n===0)return ll(t);const o=Em(t),a=ny(o),l=qn(o.getWest())*e.worldSize,d=qn(o.getEast())*e.worldSize,g=kn(o.getNorth())*e.worldSize,v=kn(o.getSouth())*e.worldSize,b=[l,g,0],S=[d,g,0],I=[l,v,0],D=[d,v,0],F=i.a6.invert([],e.globeMatrix);return i.N.transformMat4(b,b,F),i.N.transformMat4(S,S,F),i.N.transformMat4(I,I,F),i.N.transformMat4(D,D,F),a[0]=Bl(a[0],I,n),a[1]=Bl(a[1],D,n),a[2]=Bl(a[2],S,n),a[3]=Bl(a[3],b,n),Ti.fromPoints(a)},i.aT=Mm,i.aU=If,i.aV=Bl,i.aW=zo,i.aX=yA,i.aY=mn,i.aZ=Dw,i.a_=ce,i.aa=vt,i.ab=se,i.ac=function(t,e){const n={};for(let o=0;o<e.length;o++){const a=e[o];a in t&&(n[a]=t[a])}return n},i.ad=ot,i.ae=kn,i.af=class{constructor(t){this.entries={},this.scheduler=t}request(t,e,n,o){const a=this.entries[t]=this.entries[t]||{callbacks:[]};if(a.result){const[l,d]=a.result;return this.scheduler?this.scheduler.add(()=>{o(l,d)},e):o(l,d),()=>{}}return a.callbacks.push(o),a.cancel||(a.cancel=n((l,d)=>{a.result=[l,d];for(const g of a.callbacks)this.scheduler?this.scheduler.add(()=>{g(l,d)},e):g(l,d);setTimeout(()=>delete this.entries[t],3e3)})),()=>{a.result||(a.callbacks=a.callbacks.filter(l=>l!==o),a.callbacks.length||(a.cancel(),delete this.entries[t]))}}},i.ag=hf,i.ah=function(t,e,n){const o=JSON.stringify(t.request);return t.data&&(this.deduped.entries[o]={result:[null,t.data]}),this.deduped.request(o,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},a=>{const l=ce(t.request,(d,g,v,b)=>{d?a(d):g&&a(null,{vectorTile:n?void 0:new my(new Yh(g)),rawData:g,cacheControl:v,expires:b})});return()=>{l.cancel(),a()}},e)},i.ai=function(t){hr++,hr>jt&&(t.getActor().send("enforceCacheSizeLimit",Ke),hr=0)},i.aj=ni,i.ak=pt,i.al=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},i.am=Ft,i.an=W1,i.ao=Z1,i.ap=q1,i.aq=function(t,e){const n=document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(let o=0;o<t.length;o++){const a=document.createElement("source");ee(t[o])||(n.crossOrigin="Anonymous"),a.src=t[o],n.appendChild(a)}return{cancel:()=>{}}},i.ar=t_,i.as=jf,i.at=Fn,i.au=_r,i.av=Ta,i.aw=eo,i.ax=li,i.ay=jr,i.az=kl,i.b=bs,i.b$=Kp,i.b0=function(t,e){const n=[];for(const o in t)o in e||n.push(o);return n},i.b1=Gr,i.b2=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.b3=function(t,e){const{x:n,y:o}=t.point,a=ub(n,o,t.worldSize/t._pixelsPerMercatorPixel,0,0);return i.a6.multiply(a,a,ry(ll(e)))},i.b5=qh,i.b6=Ns,i.b7=Nm,i.b8=function(t,e,n,o,a){const l=5*e+2;t.float32[l+0]=n,t.float32[l+1]=o,t.float32[l+2]=a},i.b9=Jm,i.bA=i_,i.bB=Y1,i.bC=function(t){const e=Y1(t,!0);return i.b4.invert([],[e[0],e[1],e[4],e[5]])},i.bD=Qg,i.bE=function(t){const{x:e,y:n}=t.point,{lng:o,lat:a}=t._center;return ub(e,n,t.worldSize,o,a)},i.bF=lt,i.bG=de,i.bH=function(t){const e=Math.round((t+45+360)%360/90)%4;return Ht[e]},i.bI=45,i.bJ=gn,i.bK=h,i.bL=il,i.bM=gm,i.bN=So,i.bO=Bh,i.bP=c,i.bQ=function(t,e,n){const o=Math.sqrt(t*t+e*e+n*n),a=o>0?Math.acos(n/o)*Ye:0;let l=t!==0||e!==0?Math.atan2(-e,-t)*Ye+90:0;return l<0&&(l+=360),[o,l,a]},i.bR=sr,i.bS=Ti,i.bT=Ot,i.bU=function(t){return[Math.pow(t[0],1/2.2),Math.pow(t[1],1/2.2),Math.pow(t[2],1/2.2)]},i.bV=function(t){return t({pluginStatus:Ho,pluginURL:Qa}),rf.on("pluginStateChange",t),t},i.bW=td,i.bX=a_,i.bY=Kh,i.bZ=Ey,i.b_=vi,i.ba=A1,i.bb=ra,i.bc=bo,i.bd=R1,i.be=My,i.bf=wy,i.bg=Wy,i.bh=Kr,i.bj=Oe,i.bk=ue,i.bl=Nn,i.bm=function(t,e,n){t[4*e+0]=n[0],t[4*e+1]=n[1],t[4*e+2]=n[2],t[4*e+3]=n[3]},i.bn=$e,i.bo=$1,i.bp=Bt,i.bq=ey,i.br=X1,i.bs=Pt,i.bt=ab,i.bu=function(t,e,n,o,a,l,d,g,v){if(v.name==="globe")return ab(t,e,new Pt(n,o,a),!1);const b=jf({z:n,x:o,y:a},v);return new Ti([(l+b.x/b.scale)*e,e*(b.y/b.scale),d],[(l+b.x2/b.scale)*e,e*(b.y2/b.scale),g])},i.bv=function(t,e,n){let o=0;for(let a=0;a<2;++a){const l=n?n[a]:0;t[a]>l&&(o+=(t[a]-l)*(t[a]-l)),e[a]<l&&(o+=(l-e[a])*(l-e[a]))}return o},i.bw=ir,i.bx=ne,i.by=function(t){const e=i.a6.identity(new Float64Array(16));i.a6.multiply(e,t.pixelMatrix,t.globeMatrix);const n=[0,Le,0],o=[0,et,0];return i.N.transformMat4(n,n,e),i.N.transformMat4(o,o,e),[n[0]>0&&n[0]<=t.width&&n[1]>0&&n[1]<=t.height&&!oy(t,new $e(t.center.lat,90)),o[0]>0&&o[0]<=t.width&&o[1]>0&&o[1]<=t.height&&!oy(t,new $e(t.center.lat,-90))]},i.bz=function(t,e){const{scale:n}=t.tileTransform,o=n*Jt/(t.tileSize*Math.pow(2,e.zoom-t.tileID.overscaledZ+t.tileID.canonical.z));return i.b4.scale(new Float32Array(4),e.inverseAdjustmentMatrix,[o,o])},i.c=mw,i.c$=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},i.c0=j,i.c1=Gn,i.c2=function(t,e,n){return t.type==="custom"?new AC(t,e):new oP[t.type](t,e,n)},i.c3=function(t){const e=t.indexOf(Dh);return e>=0?t.slice(0,e):t},i.c4=function(t){return t.indexOf(Dh)>=0},i.c5=function(t){const e=t.indexOf(Dh);return e>=0?t.slice(e+1):""},i.c6=function(t){const e=[],n=t.id;return n===void 0&&e.push({message:`layers.${n}: missing required property "id"`}),t.render===void 0&&e.push({message:`layers.${n}: missing required method "render"`}),t.renderingMode&&t.renderingMode!=="2d"&&t.renderingMode!=="3d"&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},i.c7=$n,i.c8=rf,i.c9=mt,i.cA=o1,i.cB=(t,e,n,o,a,l)=>{const d=t.transform;return{u_matrix:i1(t,e,n,o),u_texsize:e.imageAtlasTexture?e.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:d.calculatePixelsToTileUnitsMatrix(e),u_device_pixel_ratio:a,u_image:0,u_tile_units_to_pixels:r1(e,d),u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:l}},i.cC=(t,e,n,o,a,l,d)=>{const g=t.transform,v=g.calculatePixelsToTileUnitsMatrix(e);return{u_matrix:i1(t,e,n,o),u_pixels_to_tile_units:v,u_device_pixel_ratio:l,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:a,u_texsize:s1(n)&&e.lineAtlasTexture?e.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:r1(e,t.transform),u_alpha_discard_threshold:0,u_trim_offset:d,u_emissive_strength:n.paint.get("line-emissive-strength")}},i.cD=zr,i.cE=Cf,i.cF=Xb,i.cG=un,i.cH=Bm,i.cI=Tc,i.cJ=450,i.cK=7,i.cL=EC,i.cM=256,i.cN=ry,i.cO=rl,i.cP=yf,i.cQ=function(t,e,n,o,a){return vt((t-e)/(n-e)*(a-o)+o,o,a)},i.cR=or,i.cS=Ry,i.cT=[1,1,1],i.cU=Gh,i.cV=ed,i.cW=ta,i.cX=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[]}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(t){const e=Cb(new ve(0,0),new ve(Jt,Jt),t),n=[];for(const o of this._activeRegions){if(o.hiddenByOverlap||!Ib(e,o))continue;const a=iI(o.min,o.max,t);n.push({min:a.min,max:a.max,sourceId:this._sourceIds[o.priority],footprint:o.footprint,footprintTileId:o.tileId})}return n}setSources(t){this._setSources(t.map(e=>({getSourceId:()=>e.cache.id,getFootprints:()=>{const n=[];for(const o of e.cache.getVisibleCoordinates()){const a=e.cache.getTile(o).buckets[e.layer];if(a)for(const l of a.getNodesInfo()){const d=l.node;d.footprint&&n.push({footprint:d.footprint,id:o.toUnwrapped()})}}return n}})))}_addSource(t){const e=t.getFootprints();if(e.length!==0){for(const n of e){if(!n.footprint)continue;const o=Cb(n.footprint.min,n.footprint.max,n.id);this._activeRegions.push({min:o.min,max:o.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:n.id,footprint:n.footprint})}this._sourceIds.push(t.getSourceId())}}_computeReplacement(){this._activeRegions.sort((e,n)=>e.priority-n.priority||Lm(e.min,n.min)||Lm(e.max,n.max));let t=this._activeRegions.length!==this._prevRegions.length;if(!t){let e=0,n=0;for(;!t&&e!==this._activeRegions.length;){const o=this._activeRegions[e],a=this._prevRegions[n];t=o.priority!==a.priority||!Ab(o,a),++e,++n}}if(t){++this._updateTime;const e=n=>{const o=this._activeRegions;if(n>=o.length)return n;const a=o[n].priority;for(;n<o.length&&o[n].priority===a;)++n;return n};if(this._sourceIds.length>1){let n=0,o=e(n);for(;n!==o;){let a=n;const l=n;for(;a!==o;){const d=this._activeRegions[a];d.hiddenByOverlap=!1;for(let g=0;g<l;g++){const v=this._activeRegions[g];if(!v.hiddenByOverlap&&Ib(d,v)&&(d.hiddenByOverlap=Db(d.footprint,d.tileId,v.footprint,v.tileId),d.hiddenByOverlap))break}++a}n=o,o=e(n)}}}}_setSources(t){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let e=t.length-1;e>=0;e--)this._addSource(t[e]);this._computeReplacement()}},i.cY=class{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const t of this._poleSegments)t.destroy();for(const t of this._gridSegments)t.withSkirts.destroy(),t.withoutSkirts.destroy()}_fillGridMeshWithLods(t,e){const n=new Ls,o=new eo,a=[],l=t+1+2,d=e[0]+1,g=e[0]+1+(1+e.length),v=(b,S,I)=>{let D=b===l-1?b-2:b===0?b:b-1;return D+=I?24575:0,[D,S]};for(let b=0;b<l;++b)n.emplaceBack(...v(b,0,!0));for(let b=0;b<d;++b)for(let S=0;S<l;++S)n.emplaceBack(...v(S,b,(S===0||S===l-1)&&!0));for(let b=0;b<e.length;++b){const S=e[b];for(let I=0;I<l;++I)n.emplaceBack(...v(I,S,!0))}for(let b=0;b<e.length;++b){const S=o.length,I=e[b]+1+2,D=new eo;for(let V=0;V<I-1;V++){const q=V===I-2,Y=q?l*(g-e.length+b-V):l;for(let oe=0;oe<l-1;oe++){const le=V*l+oe;V===0||q||oe===0||oe===l-2?(D.emplaceBack(le+1,le,le+Y),D.emplaceBack(le+Y,le+Y+1,le+1)):(o.emplaceBack(le+1,le,le+Y),o.emplaceBack(le+Y,le+Y+1,le+1))}}const F=Ii.simpleSegment(0,S,n.length,o.length-S);for(let V=0;V<D.uint16.length;V+=3)o.emplaceBack(D.uint16[V],D.uint16[V+1],D.uint16[V+2]);const N=Ii.simpleSegment(0,S,n.length,o.length-S);a.push({withoutSkirts:F,withSkirts:N})}return{vertices:n,indices:o,segments:a}}_createGrid(t){const e=this._fillGridMeshWithLods(Se,Ae);this._gridSegments=e.segments,this._gridBuffer=t.createVertexBuffer(e.vertices,ib.members),this._gridIndexBuffer=t.createIndexBuffer(e.indices,!0)}_createPoles(t){const e=new eo;for(let d=0;d<=Se;d++)e.emplaceBack(0,d+1,d+2);this._poleIndexBuffer=t.createIndexBuffer(e,!0);const n=new rl,o=new rl,a=new rl,l=new rl;this._poleSegments=[];for(let d=0,g=0;d<de;d++){const v=360/(1<<d);n.emplaceBack(0,-se,0,.5,0),o.emplaceBack(0,-se,0,.5,1),a.emplaceBack(0,-se,0,.5,.5),l.emplaceBack(0,-se,0,.5,.5);for(let b=0;b<=Se;b++){let S=b/Se,I=0;const D=Zn(0,v,S),[F,N,V]=je(bA,wA,D,se);n.emplaceBack(F,N,V,S,I),o.emplaceBack(F,N,V,S,1-I);const q=Oe(D);S=.5+.5*Math.sin(q),I=.5+.5*Math.cos(q),a.emplaceBack(F,N,V,S,I),l.emplaceBack(F,N,V,S,1-I)}this._poleSegments.push(Ii.simpleSegment(g,0,66,64)),g+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(n,wm,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(o,wm,!1),this._texturedPoleNorthVertexBuffer=t.createVertexBuffer(a,wm,!1),this._texturedPoleSouthVertexBuffer=t.createVertexBuffer(l,wm,!1)}getGridBuffers(t,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[t].withSkirts:this._gridSegments[t].withoutSkirts]}getPoleBuffers(t,e){return[e?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,e?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}},i.cZ=function(t){return Hi.has(t)},i.c_=Tt,i.ca=r,i.cb=class extends Ea{constructor(t){super(t),this.current=p}set(t,e,n){if(this.fetchUniformLocation(t,e)){for(let o=0;o<9;o++)if(n[o]!==this.current[o]){this.current=n,this.gl.uniformMatrix3fv(this.location,!1,n);break}}}},i.cc=nt,i.cd=function(t,e,n){const o=xc(n.zoom),a=t.style.map._antialias,l=e.options.extStandardDerivativesForceOff||t.terrain&&t.terrain.exaggeration()>0;return o===0&&!a&&!l},i.ce=function(t){const e=t.pixelsPerMeter,n=e/Nn(1,t.center.lat),o=i.a6.identity(new Float64Array(16));return i.a6.translate(o,o,[t.point.x,t.point.y,0]),i.a6.scale(o,o,[n,n,e]),Float32Array.from(o)},i.cf=Em,i.cg=function(t){const e=ir-5;t=vt(t,-e,e)/e*90;const n=Math.pow(Math.abs(Math.sin(Oe(t))),3);return Math.round(n*(Ae.length-1))},i.ch=function(t,e,n,o){const a=e.getNorth(),l=e.getSouth(),d=e.getWest(),g=e.getEast(),v=1<<t.z,b=g-d,S=a-l,I=b/Se,D=-S/Ae[n],F=[0,I,0,D,0,0,a,d,0];if(t.z>0){const N=180/o;i.co.multiply(F,F,[N/b+1,0,0,0,N/S+1,0,-.5*N/I,.5*N/D,1])}return F[2]=v,F[5]=t.x,F[8]=t.y,F},i.ci=ll,i.cj=function(t,e,n){const o=i.a6.identity(new Float64Array(16)),a=(e/(1<<t)-.5)*Math.PI*2;return i.a6.rotateY(o,n.globeMatrix,a),Float32Array.from(o)},i.ck=class{isDataAvailableAtPoint(t){const e=this._source();if(this.isUsingMockSource()||!e||t.y<0||t.y>1)return!1;const n=e.getSource().maxzoom,o=1<<n,a=Math.floor(t.x),l=Math.floor((t.x-a)*o),d=Math.floor(t.y*o),g=this.findDEMTileFor(new Ft(n,a,n,l,d));return!(!g||!g.dem)}getAtPointOrZero(t,e=0){return this.getAtPoint(t,e)||0}getAtPoint(t,e,n=!0){if(this.isUsingMockSource())return null;e==null&&(e=null);const o=this._source();if(!o||t.y<0||t.y>1)return e;const a=o.getSource().maxzoom,l=1<<a,d=Math.floor(t.x),g=t.x-d,v=new Ft(a,d,a,Math.floor(g*l),Math.floor(t.y*l)),b=this.findDEMTileFor(v);if(!b||!b.dem)return e;const S=b.dem,I=1<<b.tileID.canonical.z,D=(g*I-b.tileID.canonical.x)*S.dim,F=(t.y*I-b.tileID.canonical.y)*S.dim,N=Math.floor(D),V=Math.floor(F);return(n?this.exaggeration():1)*Zn(Zn(S.get(N,V),S.get(N,V+1),F-V),Zn(S.get(N+1,V),S.get(N+1,V+1),F-V),D-N)}getAtTileOffset(t,e,n){const o=1<<t.canonical.z;return this.getAtPointOrZero(new Sr(t.wrap+(t.canonical.x+e/Jt)/o,(t.canonical.y+n/Jt)/o))}getAtTileOffsetFunc(t,e,n,o){return a=>{const l=this.getAtTileOffset(t,a.x,a.y),d=o.upVector(t.canonical,a.x,a.y),g=o.upVectorScale(t.canonical,e,n).metersToTile;return i.N.scale(d,d,l*g),d}}getForTilePoints(t,e,n,o){if(this.isUsingMockSource())return!1;const a=Gh.create(this,t,o);return!!a&&(e.forEach(l=>{l[2]=this.exaggeration()*a.getElevationAt(l[0],l[1],n)}),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(t);if(!e||!e.dem)return null;const n=e.dem.tree,o=e.tileID,a=1<<t.canonical.z-o.canonical.z;let l=t.canonical.x/a-o.canonical.x,d=t.canonical.y/a-o.canonical.y,g=0;for(let v=0;v<t.canonical.z-o.canonical.z&&!n.leaves[g];v++){l*=2,d*=2;const b=2*Math.floor(d)+Math.floor(l);g=n.childOffsets[g]+b,l%=1,d%=1}return{min:this.exaggeration()*n.minimums[g],max:this.exaggeration()*n.maximums[g]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,n){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const t=this.visibleDemTiles;if(t.length===0)return null;let e=!1,n=Number.MAX_VALUE,o=Number.MIN_VALUE;for(const a of t){const l=this.getMinMaxForTile(a.tileID);l&&(n=Math.min(n,l.min),o=Math.max(o,l.max),e=!0)}return e?{min:n,max:o}:null}},i.cl=Tm,i.cm=vb,i.cn=function(t,e){return[Math.pow(t[0],2.2)*e,Math.pow(t[1],2.2)*e,Math.pow(t[2],2.2)*e]},i.cp=cb,i.cq=256,i.cr=function(t,e){const n=[0,0,0],o=Mm(ll(e.canonical));return i.N.transformMat4(n,n,o),i.N.transformMat4(n,n,t),n},i.cs=t=>({u_camera_to_center_distance:new So(t),u_extrude_scale:new w(t),u_device_pixel_ratio:new So(t),u_matrix:new h(t),u_inv_rot_matrix:new h(t),u_merc_center:new il(t),u_tile_id:new gm(t),u_zoom_transition:new So(t),u_up_dir:new gm(t),u_emissive_strength:new So(t)}),i.ct=t=>({u_matrix:new h(t),u_pixels_to_tile_units:new w(t),u_device_pixel_ratio:new So(t),u_units_to_pixels:new il(t),u_dash_image:new Bh(t),u_gradient_image:new Bh(t),u_image_height:new So(t),u_texsize:new il(t),u_tile_units_to_pixels:new So(t),u_alpha_discard_threshold:new So(t),u_trim_offset:new il(t),u_emissive_strength:new So(t)}),i.cu=t=>({u_matrix:new h(t),u_texsize:new il(t),u_pixels_to_tile_units:new w(t),u_device_pixel_ratio:new So(t),u_image:new Bh(t),u_units_to_pixels:new il(t),u_tile_units_to_pixels:new So(t),u_alpha_discard_threshold:new So(t),u_trim_offset:new il(t)}),i.cv=Rh,i.cw=OI,i.cx=RI,i.cy=fb,i.cz=(t,e,n,o,a,l)=>{const d=t.transform,g=d.projection.name==="globe";let v;if(l.paint.get("circle-pitch-alignment")==="map")if(g){const S=cb(d.zoom,e.canonical)*d._pixelsPerMercatorPixel;v=Float32Array.from([S,0,0,S])}else v=d.calculatePixelsToTileUnitsMatrix(n);else v=new Float32Array([d.pixelsToGLUnits[0],0,0,d.pixelsToGLUnits[1]]);const b={u_camera_to_center_distance:t.transform.getCameraToCenterDistance(d.projection),u_matrix:t.translatePosMatrix(e.projMatrix,n,l.paint.get("circle-translate"),l.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Mt.devicePixelRatio,u_extrude_scale:v,u_inv_rot_matrix:TA,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:l.paint.get("circle-emissive-strength")};if(g){b.u_inv_rot_matrix=o,b.u_merc_center=a,b.u_tile_id=[e.canonical.x,e.canonical.y,1<<e.canonical.z],b.u_zoom_transition=xc(d.zoom);const S=a[0]*Jt,I=a[1]*Jt;b.u_up_dir=d.projection.upVector(new Pt(0,0,0),S,I)}return b},i.d=Ue,i.d0=Rt,i.d1=Ar,i.d2=dt,i.d3=function([t,e,n]){const o=Math.hypot(t,e,n),a=Math.atan2(t,n),l=.5*Math.PI-Math.acos(-e/o);return new $e(lt(a),lt(l))},i.d4=at,i.d5=L,i.d6=oy,i.d7=hb,i.d8=function(t){const e=[0,0,0],n=i.a6.identity(new Float64Array(16));return i.a6.multiply(n,t.pixelMatrix,t.globeMatrix),i.N.transformMat4(e,e,n),new ve(e[0],e[1])},i.d9=function(t){const e=t.navigator?t.navigator.userAgent:null;return!!function(n){if(Qe==null){const o=n.navigator?n.navigator.userAgent:null;Qe=!!n.safari||!(!o||!(/\b(iPad|iPhone|iPod)\b/.test(o)||o.match("Safari")&&!o.match("Chrome")))}return Qe}(t)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},i.dA=Ca,i.dB=_w,i.dC=yw,i.dD=e1,i.dE=an,i.dF=C1,i.dG=function(t,e,n,o,a,l,d,g,v,b,S){t.createArrays(),t.tilePixelRatio=Jt/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const I=t.layers[0].layout,D=t.layers[0]._unevaluatedLayout._values,F={};if(t.textSizeData.kind==="composite"){const{minZoom:Y,maxZoom:oe}=t.textSizeData;F.compositeTextSizes=[D["text-size"].possiblyEvaluate(new fi(Y),g),D["text-size"].possiblyEvaluate(new fi(oe),g)]}if(t.iconSizeData.kind==="composite"){const{minZoom:Y,maxZoom:oe}=t.iconSizeData;F.compositeIconSizes=[D["icon-size"].possiblyEvaluate(new fi(Y),g),D["icon-size"].possiblyEvaluate(new fi(oe),g)]}F.layoutTextSize=D["text-size"].possiblyEvaluate(new fi(v+1),g),F.layoutIconSize=D["icon-size"].possiblyEvaluate(new fi(v+1),g),F.textMaxSize=D["text-size"].possiblyEvaluate(new fi(18),g);const N=I.get("text-rotation-alignment")==="map"&&I.get("symbol-placement")!=="point",V=I.get("text-size");let q=!1;for(const Y of t.features)if(Y.icon&&Y.icon.nameSecondary){q=!0;break}for(const Y of t.features){const oe=I.get("text-font").evaluate(Y,{},g).join(","),le=V.evaluate(Y,{},g),ae=F.layoutTextSize.evaluate(Y,{},g),be=(F.layoutIconSize.evaluate(Y,{},g),{horizontal:{},vertical:void 0}),ge=Y.text;let Ie,Ne=[0,0];if(ge){const qe=ge.toString(),_t=I.get("text-letter-spacing").evaluate(Y,{},g)*bo,Et=I.get("text-line-height").evaluate(Y,{},g)*bo,ct=Cg(qe)?_t:0,wt=I.get("text-anchor").evaluate(Y,{},g),st=I.get("text-variable-anchor");if(!st){const rn=I.get("text-radial-offset").evaluate(Y,{},g);Ne=rn?R1(wt,[rn*bo,Sy]):I.get("text-offset").evaluate(Y,{},g).map(Dt=>Dt*bo)}let bt=N?"center":I.get("text-justify").evaluate(Y,{},g);const $t=I.get("symbol-placement")==="point",St=$t?I.get("text-max-width").evaluate(Y,{},g)*bo:1/0,cn=rn=>{t.allowVerticalPlacement&&Ja(qe)&&(be.vertical=by(ge,e,n,a,oe,St,Et,wt,rn,ct,Ne,Ns.vertical,!0,ae,le))};if(!N&&st){const rn=bt==="auto"?st.map(An=>My(An)):[bt];let Dt=!1;for(let An=0;An<rn.length;An++){const _n=rn[An];if(!be.horizontal[_n])if(Dt)be.horizontal[_n]=be.horizontal[0];else{const ln=by(ge,e,n,a,oe,St,Et,"center",_n,ct,Ne,Ns.horizontal,!1,ae,le);ln&&(be.horizontal[_n]=ln,Dt=ln.positionedLines.length===1)}}cn("left")}else{if(bt==="auto"&&(bt=My(wt)),$t||I.get("text-writing-mode").indexOf("horizontal")>=0||!Ja(qe)){const rn=by(ge,e,n,a,oe,St,Et,wt,bt,ct,Ne,Ns.horizontal,!1,ae,le);rn&&(be.horizontal[bt]=rn)}cn($t?"left":bt)}}let Ge=!1;if(Y.icon&&Y.icon.namePrimary){const qe=o[Y.icon.namePrimary];qe&&(Ie=QI(a[Y.icon.namePrimary],Y.icon.nameSecondary?a[Y.icon.nameSecondary]:void 0,I.get("icon-offset").evaluate(Y,{},g),I.get("icon-anchor").evaluate(Y,{},g)),Ge=qe.sdf,t.sdfIcons===void 0?t.sdfIcons=qe.sdf:t.sdfIcons!==qe.sdf&&Re("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(qe.pixelRatio!==t.pixelRatio||I.get("icon-rotate").constantOr(1)!==0)&&(t.iconsNeedLinear=!0))}const tt=z1(be.horizontal)||be.vertical;t.iconsInText||(t.iconsInText=!!tt&&tt.iconsInText),(tt||Ie)&&sC(t,Y,be,Ie,o,F,ae,0,Ne,Ge,d,g,b,S,q)}l&&t.generateCollisionDebugBuffers(v,t.collisionBoxArray)},i.dH=my,i.dI=Yh,i.dJ=zm,i.dK=ye,i.dL=Om,i.dM=km,i.dN=He,i.dO=u1,i.dP=function(t){let e=0;if(new Uint32Array(t,0,1)[0]!==lw){const n=new Uint32Array(t,0,7),[,,o,a,l,d]=n;e=n.byteLength+a+l+d+l,(o!==t.byteLength||e>=t.byteLength)&&Re("Invalid b3dm header information.")}return dw(t,e)},i.dQ=function(t,e){const n=mw(t);for(const o of n){for(const a of o.meshes)QC(a);o.lights&&(o.lightMeshIndex=o.meshes.length,o.meshes.push(eP(o.lights,e)))}return n},i.dR=h_,i.dS=iw,i.dT=rs,i.dU=function(t){Ln(),Ut&&Ut.then(e=>{e.keys().then(n=>{for(let o=0;o<n.length-t;o++)e.delete(n[o])})})},i.da=class{constructor(t,e,n){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!n,this._createSkuToken()}_createSkuToken(){const t=function(){let e="";for(let n=0;n<10;n++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Xe,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,e){if(!j(t))return t;const n=Zt(t);return n.params.push(`sdk=js-${P}`),n.path=`/styles/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeGlyphsURL(t,e){if(!j(t))return t;const n=Zt(t);return n.path=`/fonts/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeModelURL(t,e){if(!j(t))return t;const n=Zt(t);return n.path=`/models/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeSourceURL(t,e,n,o){if(!j(t))return t;const a=Zt(t);return a.path=`/v4/${a.authority}.json`,a.params.push("secure"),n&&a.params.push(`language=${n}`),o&&a.params.push(`worldview=${o}`),this._makeAPIURL(a,this._customAccessToken||e)}normalizeSpriteURL(t,e,n,o){const a=Zt(t);return j(t)?(a.path=`/styles/v1${a.path}/sprite${e}${n}`,this._makeAPIURL(a,this._customAccessToken||o)):(a.path+=`${e}${n}`,fn(a))}normalizeTileURL(t,e,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!j(t))return t;const o=Zt(t);o.path=o.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||n&&o.authority!=="raster"&&n===512?"@2x":""}${Tr.supported?".webp":"$1"}`),o.authority==="raster"?o.path=`/${L.RASTER_URL_PREFIX}${o.path}`:o.authority==="rasterarrays"?o.path=`/${L.RASTERARRAYS_URL_PREFIX}${o.path}`:(o.path=o.path.replace(/^.+\/v4\//,"/"),o.path=`/${L.TILE_URL_VERSION}${o.path}`);const a=this._customAccessToken||function(l){for(const d of l){const g=d.match(/^access_token=(.*)$/);if(g)return g[1]}return null}(o.params)||L.ACCESS_TOKEN;return L.REQUIRE_ACCESS_TOKEN&&a&&this._skuToken&&o.params.push(`sku=${this._skuToken}`),this._makeAPIURL(o,a)}canonicalizeTileURL(t,e){const n=Zt(t);if(!n.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!n.path.match(/\.[\w]+$/))return t;let o="mapbox://";n.path.match(/^\/raster\/v1\//)?o+=`raster/${n.path.replace(`/${L.RASTER_URL_PREFIX}/`,"")}`:n.path.match(/^\/rasterarrays\/v1\//)?o+=`rasterarrays/${n.path.replace(`/${L.RASTERARRAYS_URL_PREFIX}/`,"")}`:o+=`tiles/${n.path.replace(`/${L.TILE_URL_VERSION}/`,"")}`;let a=n.params;return e&&(a=a.filter(l=>!l.match(/^access_token=/))),a.length&&(o+=`?${a.join("&")}`),o}canonicalizeTileset(t,e){const n=!!e&&j(e),o=[];for(const a of t.tiles||[])U(a)?o.push(this.canonicalizeTileURL(a,n)):o.push(a);return o}_makeAPIURL(t,e){const n="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",o=Zt(L.API_URL);if(t.protocol=o.protocol,t.authority=o.authority,t.protocol==="http"){const a=t.params.indexOf("secure");a>=0&&t.params.splice(a,1)}if(o.path!=="/"&&(t.path=`${o.path}${t.path}`),!L.REQUIRE_ACCESS_TOKEN)return fn(t);if(e=e||L.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${n}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${n}`)}return t.params=t.params.filter(a=>a.indexOf("access_token")===-1),t.params.push(`access_token=${e||""}`),fn(t)}},i.db=function(t,e){e?Hi.add(t):Hi.delete(t)},i.dc=Tr,i.dd=Gi,i.de=Qo,i.df=yt,i.dg=Qn,i.dh=function(t){Hi.delete(t)},i.di=di,i.dj=ar,i.dk=P,i.dl=function(t,e){Ke=t,jt=e},i.dm=function(t,e,n=!1){if(Ho===Jd||Ho===Qd||Ho===ef)throw new Error("setRTLTextPlugin cannot be called multiple times.");Qa=Mt.resolveURL(t),Ho=Jd,tf=e,nf(),n||of()},i.dn=el,i.dp=function(){a_().acquire(By)},i.dq=function(){const t=Zf;t&&(t.isPreloaded()&&t.numActive()===1?(t.release(By),Zf=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},i.dr=Wf,i.ds=function(t){const e=Sn();if(!e)return;const n=e.delete(nn);t&&n.catch(t).then(()=>t())},i.dt=qf,i.du=ow,i.dv=function(t){Ny=Mt.resolveURL(t),rd||(rd=new td(a_(),new qs)),rd.broadcast("setDracoUrl",Ny)},i.dw=sw,i.dx=function(t){nd=Mt.resolveURL(t),rd||(rd=new td(a_(),new qs)),rd.broadcast("setMeshoptUrl",nd)},i.dy=sn,i.dz=bc,i.e=Or,i.f=Mt,i.g=function(t,e){return mt(Or(t,{type:"json"}),e)},i.h=Bs,i.i=ma,i.j=yn,i.k=Eh,i.l=function(t){return fetch(t).then(e=>e.arrayBuffer()).then(e=>dw(e,0,t))},i.m=$p,i.n=vu,i.o=Mu,i.p=I1,i.q=Ih,i.r=Ah,i.s=Wd,i.t=Pn,i.u=Su,i.v=Er,i.w=Re,i.x=Cn,i.z=lf}),x(["./shared"],function(i){function P(Qe){const re=Qe?Qe.url.toString():void 0;return re?performance.getEntriesByName(re):[]}function O(Qe){if(typeof Qe=="number"||typeof Qe=="boolean"||typeof Qe=="string"||Qe==null)return JSON.stringify(Qe);if(Array.isArray(Qe)){let ue="[";for(const Ee of Qe)ue+=`${O(Ee)},`;return`${ue}]`}let re="{";for(const ue of Object.keys(Qe).sort())re+=`${ue}:${O(Qe[ue])},`;return`${re}}`}function L(Qe){let re="";for(const ue of i.b2)re+=`/${O(Qe[ue])}`;return re}class U{constructor(re){this.keyCache={},this._layers={},this._layerConfigs={},re&&this.replace(re)}replace(re,ue){this._layerConfigs={},this._layers={},this.update(re,[],ue)}update(re,ue,Ee){this._options=Ee;for(const pt of re)this._layerConfigs[pt.id]=pt,(this._layers[pt.id]=i.c2(pt,this.scope,this._options)).compileFilter(),this.keyCache[pt.id]&&delete this.keyCache[pt.id];for(const pt of ue)delete this.keyCache[pt],delete this._layerConfigs[pt],delete this._layers[pt];this.familiesBySource={};const it=function(pt,Mt){const nn={};for(let jt=0;jt<pt.length;jt++){const Ut=Mt&&Mt[pt[jt].id]||L(pt[jt]);Mt&&(Mt[pt[jt].id]=Ut);let tn=nn[Ut];tn||(tn=nn[Ut]=[]),tn.push(pt[jt])}const Ke=[];for(const jt in nn)Ke.push(nn[jt]);return Ke}(i.a$(this._layerConfigs),this.keyCache);for(const pt of it){const Mt=pt.map(Sn=>this._layers[Sn.id]),nn=Mt[0];if(nn.visibility==="none")continue;const Ke=nn.source||"";let jt=this.familiesBySource[Ke];jt||(jt=this.familiesBySource[Ke]={});const Ut=nn.sourceLayer||"_geojsonTileLayer";let tn=jt[Ut];tn||(tn=jt[Ut]=[]),tn.push(Mt)}}}const j=1*i.dA;class W{constructor(re){const ue={},Ee=[];for(const nn in re){const Ke=re[nn],jt=ue[nn]={};for(const Ut in Ke.glyphs){const tn=Ke.glyphs[+Ut];if(!tn||tn.bitmap.width===0||tn.bitmap.height===0)continue;const Sn=tn.metrics.localGlyph?j:1,Ln={x:0,y:0,w:tn.bitmap.width+2*Sn,h:tn.bitmap.height+2*Sn};Ee.push(Ln),jt[Ut]=Ln}}const{w:it,h:pt}=i.p(Ee),Mt=new i.dz({width:it||1,height:pt||1});for(const nn in re){const Ke=re[nn];for(const jt in Ke.glyphs){const Ut=Ke.glyphs[+jt];if(!Ut||Ut.bitmap.width===0||Ut.bitmap.height===0)continue;const tn=ue[nn][jt],Sn=Ut.metrics.localGlyph?j:1;i.dz.copy(Ut.bitmap,Mt,{x:0,y:0},{x:tn.x+Sn,y:tn.y+Sn},Ut.bitmap)}}this.image=Mt,this.positions=ue}}i.dy(W,"GlyphAtlas");class J{constructor(re){this.tileID=new i.am(re.tileID.overscaledZ,re.tileID.wrap,re.tileID.canonical.z,re.tileID.canonical.x,re.tileID.canonical.y),this.tileZoom=re.tileZoom,this.uid=re.uid,this.zoom=re.zoom,this.canonical=re.tileID.canonical,this.pixelRatio=re.pixelRatio,this.tileSize=re.tileSize,this.source=re.source,this.scope=re.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=re.showCollisionBoxes,this.collectResourceTiming=!!re.collectResourceTiming,this.promoteId=re.promoteId,this.isSymbolTile=re.isSymbolTile,this.tileTransform=i.as(re.tileID.canonical,re.projection),this.projection=re.projection,this.brightness=re.brightness,this.extraShadowCaster=!!re.extraShadowCaster}parse(re,ue,Ee,it,pt){this.status="parsing",this.data=re,this.collisionBoxArray=new i.aD;const Mt=new i.dB(Object.keys(re.layers).sort()),nn=new i.dC(this.tileID,this.promoteId);nn.bucketLayerIDs=[];const Ke={},jt=new i.dD(256,256),Ut={featureIndex:nn,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:jt,availableImages:Ee,brightness:this.brightness},tn=ue.familiesBySource[this.source];for(const Rr in tn){const $r=re.layers[Rr];if(!$r)continue;let Di=!1,dr=!1,io=!1;for(const rr of tn[Rr])rr[0].type==="symbol"?Di=!0:dr=!0,rr[0].is3D()&&rr[0].type!=="model"&&(io=!0);if(this.extraShadowCaster&&!io||this.isSymbolTile===!0&&!Di||this.isSymbolTile===!1&&!dr)continue;$r.version===1&&i.w(`Vector tile source "${this.source}" layer "${Rr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ji=Mt.encode(Rr),oo=[];for(let rr=0;rr<$r.length;rr++){const vi=$r.feature(rr),mt=nn.getId(vi,Rr);oo.push({feature:vi,id:mt,index:rr,sourceLayerIndex:Ji})}for(const rr of tn[Rr]){const vi=rr[0];(!this.extraShadowCaster||vi.is3D()&&vi.type!=="model")&&(this.isSymbolTile!==void 0&&vi.type==="symbol"!==this.isSymbolTile||vi.minzoom&&this.zoom<Math.floor(vi.minzoom)||vi.maxzoom&&this.zoom>=vi.maxzoom||vi.visibility!=="none"&&(fe(rr,this.zoom,Ut.brightness,Ee),(Ke[vi.id]=vi.createBucket({index:nn.bucketLayerIDs.length,layers:rr,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ji,sourceID:this.source,projection:this.projection.spec})).populate(oo,Ut,this.tileID.canonical,this.tileTransform),nn.bucketLayerIDs.push(rr.map(mt=>mt.id))))}}let Sn,Ln,Dr,Nr;jt.trim();const hr={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Tr=()=>{if(Sn)return this.status="done",pt(Sn);if(this.extraShadowCaster)this.status="done",pt(null,{buckets:i.a$(Ke).filter(Rr=>!Rr.isEmpty()),featureIndex:nn,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Ut.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Ln&&Dr&&Nr){const Rr=new W(Ln),$r=new i.dF(Dr,Nr);for(const Di in Ke){const dr=Ke[Di];dr instanceof i.aE?(fe(dr.layers,this.zoom,Ut.brightness,Ee),i.dG(dr,Ln,Rr.positions,Dr,$r.iconPositions,this.showCollisionBoxes,Ee,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):dr.hasPattern&&(dr instanceof i.aK||dr instanceof i.aL||dr instanceof i.cH)&&(fe(dr.layers,this.zoom,Ut.brightness,Ee),dr.addFeatures(Ut,this.tileID.canonical,$r.patternPositions,Ee,this.tileTransform,this.brightness))}this.status="done",pt(null,{buckets:i.a$(Ke).filter(Di=>!Di.isEmpty()),featureIndex:nn,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Rr.image,lineAtlas:jt,imageAtlas:$r,brightness:Ut.brightness})}};if(!this.extraShadowCaster){const Rr=i.dE(Ut.glyphDependencies,dr=>Object.keys(dr).map(Number));Object.keys(Rr).length?it.send("getGlyphs",{uid:this.uid,stacks:Rr,scope:this.scope},(dr,io)=>{Sn||(Sn=dr,Ln=io,Tr())},void 0,!1,hr):Ln={};const $r=Object.keys(Ut.iconDependencies);$r.length?it.send("getImages",{icons:$r,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(dr,io)=>{Sn||(Sn=dr,Dr=io,Tr())},void 0,!1,hr):Dr={};const Di=Object.keys(Ut.patternDependencies);Di.length?it.send("getImages",{icons:Di,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(dr,io)=>{Sn||(Sn=dr,Nr=io,Tr())},void 0,!1,hr):Nr={}}Tr()}}function fe(Qe,re,ue,Ee){const it=new i.K(re,{brightness:ue});for(const pt of Qe)pt.recalculate(it,Ee)}class _e extends i.E{constructor(re,ue,Ee,it,pt,Mt){super(),this.actor=re,this.layerIndex=ue,this.availableImages=Ee,this.loadVectorData=pt||i.ah,this.loading={},this.loaded={},this.deduped=new i.af(re.scheduler),this.isSpriteLoaded=it,this.scheduler=re.scheduler,this.brightness=Mt}loadTile(re,ue){const Ee=re.uid,it=re&&re.request,pt=it&&it.collectResourceTiming,Mt=this.loading[Ee]=new J(re);Mt.abort=this.loadVectorData(re,(nn,Ke)=>{const jt=!this.loading[Ee];if(delete this.loading[Ee],jt||nn||!Ke)return Mt.status="done",jt||(this.loaded[Ee]=Mt),ue(nn);const Ut=Ke.rawData,tn={};Ke.expires&&(tn.expires=Ke.expires),Ke.cacheControl&&(tn.cacheControl=Ke.cacheControl),Mt.vectorTile=Ke.vectorTile||new i.dH(new i.dI(Ut));const Sn=()=>{Mt.parse(Mt.vectorTile,this.layerIndex,this.availableImages,this.actor,(Ln,Dr)=>{if(Ln||!Dr)return ue(Ln);const Nr={};if(pt){const hr=P(it);hr.length>0&&(Nr.resourceTiming=JSON.parse(JSON.stringify(hr)))}ue(null,i.e({rawTileData:Ut.slice(0)},Dr,tn,Nr))})};this.isSpriteLoaded?Sn():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Sn,{type:"parseTile",isSymbolTile:re.isSymbolTile,zoom:re.tileZoom}):Sn()}),this.loaded=this.loaded||{},this.loaded[Ee]=Mt})}reloadTile(re,ue){const Ee=this.loaded,it=re.uid,pt=this;if(Ee&&Ee[it]){const Mt=Ee[it];Mt.showCollisionBoxes=re.showCollisionBoxes,Mt.projection=re.projection,Mt.brightness=re.brightness,Mt.tileTransform=i.as(re.tileID.canonical,re.projection),Mt.extraShadowCaster=re.extraShadowCaster;const nn=(Ke,jt)=>{const Ut=Mt.reloadCallback;Ut&&(delete Mt.reloadCallback,Mt.parse(Mt.vectorTile,pt.layerIndex,this.availableImages,pt.actor,Ut)),ue(Ke,jt)};Mt.status==="parsing"?Mt.reloadCallback=nn:Mt.status==="done"&&(Mt.vectorTile?Mt.parse(Mt.vectorTile,this.layerIndex,this.availableImages,this.actor,nn):nn())}else ue(null,void 0)}abortTile(re,ue){const Ee=re.uid,it=this.loading[Ee];it&&(it.abort&&it.abort(),delete this.loading[Ee]),ue()}removeTile(re,ue){const Ee=this.loaded,it=re.uid;Ee&&Ee[it]&&delete Ee[it],ue()}}class we{loadTile(re,ue){const{uid:Ee,encoding:it,rawImageData:pt,padding:Mt}=re,nn=ImageBitmap&&pt instanceof ImageBitmap?this.getImageData(pt,Mt):pt;ue(null,new i.dJ(Ee,nn,it,Mt<1))}getImageData(re,ue){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(re.width,re.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=re.width,this.offscreenCanvas.height=re.height,this.offscreenCanvasContext.drawImage(re,0,0,re.width,re.height);const Ee=this.offscreenCanvasContext.getImageData(-ue,-ue,re.width+2*ue,re.height+2*ue);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Ee}}class ye{decodeRasterArray({task:re,buffer:ue},Ee){i.aZ.performDecoding(ue,re).then(it=>{Ee(null,it)},it=>{Ee(it)})}}function Pe(Qe,re){if(Qe.length!==0){Fe(Qe[0],re);for(var ue=1;ue<Qe.length;ue++)Fe(Qe[ue],!re)}}function Fe(Qe,re){for(var ue=0,Ee=0,it=0,pt=Qe.length,Mt=pt-1;it<pt;Mt=it++){var nn=(Qe[it][0]-Qe[Mt][0])*(Qe[Mt][1]+Qe[it][1]),Ke=ue+nn;Ee+=Math.abs(ue)>=Math.abs(nn)?ue-Ke+nn:nn-Ke+ue,ue=Ke}ue+Ee>=0!=!!re&&Qe.reverse()}var Be=i.dK(function Qe(re,ue){var Ee,it=re&&re.type;if(it==="FeatureCollection")for(Ee=0;Ee<re.features.length;Ee++)Qe(re.features[Ee],ue);else if(it==="GeometryCollection")for(Ee=0;Ee<re.geometries.length;Ee++)Qe(re.geometries[Ee],ue);else if(it==="Feature")Qe(re.geometry,ue);else if(it==="Polygon")Pe(re.coordinates,ue);else if(it==="MultiPolygon")for(Ee=0;Ee<re.coordinates.length;Ee++)Pe(re.coordinates[Ee],ue);return re});const He=i.dL.prototype.toGeoJSON;let Ce=class{constructor(Qe){this._feature=Qe,this.extent=i.V,this.type=Qe.type,this.properties=Qe.tags,"id"in Qe&&!isNaN(Qe.id)&&(this.id=parseInt(Qe.id,10))}loadGeometry(){if(this._feature.type===1){const Qe=[];for(const re of this._feature.geometry)Qe.push([new i.P(re[0],re[1])]);return Qe}{const Qe=[];for(const re of this._feature.geometry){const ue=[];for(const Ee of re)ue.push(new i.P(Ee[0],Ee[1]));Qe.push(ue)}return Qe}}toGeoJSON(Qe,re,ue){return He.call(this,Qe,re,ue)}},ve=class{constructor(Qe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.V,this.length=Qe.length,this._features=Qe}feature(Qe){return new Ce(this._features[Qe])}};var Te={exports:{}},Ye=i.dN,Oe=i.dM.VectorTileFeature,lt=Ht;function Ht(Qe,re){this.options=re||{},this.features=Qe,this.length=Qe.length}function nt(Qe,re){this.id=typeof Qe.id=="number"?Qe.id:void 0,this.type=Qe.type,this.rawGeometry=Qe.type===1?[Qe.geometry]:Qe.geometry,this.properties=Qe.tags,this.extent=re||4096}Ht.prototype.feature=function(Qe){return new nt(this.features[Qe],this.options.extent)},nt.prototype.loadGeometry=function(){var Qe=this.rawGeometry;this.geometry=[];for(var re=0;re<Qe.length;re++){for(var ue=Qe[re],Ee=[],it=0;it<ue.length;it++)Ee.push(new Ye(ue[it][0],ue[it][1]));this.geometry.push(Ee)}return this.geometry},nt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Qe=this.geometry,re=1/0,ue=-1/0,Ee=1/0,it=-1/0,pt=0;pt<Qe.length;pt++)for(var Mt=Qe[pt],nn=0;nn<Mt.length;nn++){var Ke=Mt[nn];re=Math.min(re,Ke.x),ue=Math.max(ue,Ke.x),Ee=Math.min(Ee,Ke.y),it=Math.max(it,Ke.y)}return[re,Ee,ue,it]},nt.prototype.toGeoJSON=Oe.prototype.toGeoJSON;var Tt=i.dO,Rt=lt;function vt(Qe){var re=new Tt;return function(ue,Ee){for(var it in ue.layers)Ee.writeMessage(3,wr,ue.layers[it])}(Qe,re),re.finish()}function wr(Qe,re){var ue;re.writeVarintField(15,Qe.version||1),re.writeStringField(1,Qe.name||""),re.writeVarintField(5,Qe.extent||4096);var Ee={keys:[],values:[],keycache:{},valuecache:{}};for(ue=0;ue<Qe.length;ue++)Ee.feature=Qe.feature(ue),re.writeMessage(2,Kr,Ee);var it=Ee.keys;for(ue=0;ue<it.length;ue++)re.writeStringField(3,it[ue]);var pt=Ee.values;for(ue=0;ue<pt.length;ue++)re.writeMessage(4,oi,pt[ue])}function Kr(Qe,re){var ue=Qe.feature;ue.id!==void 0&&re.writeVarintField(1,ue.id),re.writeMessage(2,Gr,Qe),re.writeVarintField(3,ue.type),re.writeMessage(4,Hr,ue)}function Gr(Qe,re){var ue=Qe.feature,Ee=Qe.keys,it=Qe.values,pt=Qe.keycache,Mt=Qe.valuecache;for(var nn in ue.properties){var Ke=ue.properties[nn],jt=pt[nn];if(Ke!==null){jt===void 0&&(Ee.push(nn),pt[nn]=jt=Ee.length-1),re.writeVarint(jt);var Ut=typeof Ke;Ut!=="string"&&Ut!=="boolean"&&Ut!=="number"&&(Ke=JSON.stringify(Ke));var tn=Ut+":"+Ke,Sn=Mt[tn];Sn===void 0&&(it.push(Ke),Mt[tn]=Sn=it.length-1),re.writeVarint(Sn)}}}function Or(Qe,re){return(re<<3)+(7&Qe)}function yi(Qe){return Qe<<1^Qe>>31}function Hr(Qe,re){for(var ue=Qe.loadGeometry(),Ee=Qe.type,it=0,pt=0,Mt=ue.length,nn=0;nn<Mt;nn++){var Ke=ue[nn],jt=1;Ee===1&&(jt=Ke.length),re.writeVarint(Or(1,jt));for(var Ut=Ee===3?Ke.length-1:Ke.length,tn=0;tn<Ut;tn++){tn===1&&Ee!==1&&re.writeVarint(Or(2,Ut-1));var Sn=Ke[tn].x-it,Ln=Ke[tn].y-pt;re.writeVarint(yi(Sn)),re.writeVarint(yi(Ln)),it+=Sn,pt+=Ln}Ee===3&&re.writeVarint(Or(7,1))}}function oi(Qe,re){var ue=typeof Qe;ue==="string"?re.writeStringField(1,Qe):ue==="boolean"?re.writeBooleanField(7,Qe):ue==="number"&&(Qe%1!=0?re.writeDoubleField(3,Qe):Qe<0?re.writeSVarintField(6,Qe):re.writeVarintField(5,Qe))}Te.exports=vt,Te.exports.fromVectorTileJs=vt,Te.exports.fromGeojsonVt=function(Qe,re){re=re||{};var ue={};for(var Ee in Qe)ue[Ee]=new Rt(Qe[Ee].features,re),ue[Ee].name=Ee,ue[Ee].version=re.version,ue[Ee].extent=re.extent;return vt({layers:ue})},Te.exports.GeoJSONWrapper=Rt;var zr=i.dK(Te.exports);const It={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Qe=>Qe},mn=Math.fround||(on=new Float32Array(1),Qe=>(on[0]=+Qe,on[0]));var on;const an=3,$n=5,Gn=6;class De{constructor(re){this.options=Object.assign(Object.create(It),re),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(re){const{log:ue,minZoom:Ee,maxZoom:it}=this.options;ue&&console.time("total time");const pt=`prepare ${re.length} points`;ue&&console.time(pt),this.points=re;const Mt=[];for(let Ke=0;Ke<re.length;Ke++){const jt=re[Ke];if(!jt.geometry)continue;const[Ut,tn]=jt.geometry.coordinates,Sn=mn(Lt(Ut)),Ln=mn(Ot(tn));Mt.push(Sn,Ln,1/0,Ke,-1,1),this.options.reduce&&Mt.push(0)}let nn=this.trees[it+1]=this._createTree(Mt);ue&&console.timeEnd(pt);for(let Ke=it;Ke>=Ee;Ke--){const jt=+Date.now();nn=this.trees[Ke]=this._createTree(this._cluster(nn,Ke)),ue&&console.log("z%d: %d clusters in %dms",Ke,nn.numItems,+Date.now()-jt)}return ue&&console.timeEnd("total time"),this}getClusters(re,ue){let Ee=((re[0]+180)%360+360)%360-180;const it=Math.max(-90,Math.min(90,re[1]));let pt=re[2]===180?180:((re[2]+180)%360+360)%360-180;const Mt=Math.max(-90,Math.min(90,re[3]));if(re[2]-re[0]>=360)Ee=-180,pt=180;else if(Ee>pt){const tn=this.getClusters([Ee,it,180,Mt],ue),Sn=this.getClusters([-180,it,pt,Mt],ue);return tn.concat(Sn)}const nn=this.trees[this._limitZoom(ue)],Ke=nn.range(Lt(Ee),Ot(Mt),Lt(pt),Ot(it)),jt=nn.data,Ut=[];for(const tn of Ke){const Sn=this.stride*tn;Ut.push(jt[Sn+$n]>1?Re(jt,Sn,this.clusterProps):this.points[jt[Sn+an]])}return Ut}getChildren(re){const ue=this._getOriginId(re),Ee=this._getOriginZoom(re),it="No cluster with the specified id.",pt=this.trees[Ee];if(!pt)throw new Error(it);const Mt=pt.data;if(ue*this.stride>=Mt.length)throw new Error(it);const nn=this.options.radius/(this.options.extent*Math.pow(2,Ee-1)),Ke=pt.within(Mt[ue*this.stride],Mt[ue*this.stride+1],nn),jt=[];for(const Ut of Ke){const tn=Ut*this.stride;Mt[tn+4]===re&&jt.push(Mt[tn+$n]>1?Re(Mt,tn,this.clusterProps):this.points[Mt[tn+an]])}if(jt.length===0)throw new Error(it);return jt}getLeaves(re,ue,Ee){const it=[];return this._appendLeaves(it,re,ue=ue||10,Ee=Ee||0,0),it}getTile(re,ue,Ee){const it=this.trees[this._limitZoom(re)],pt=Math.pow(2,re),{extent:Mt,radius:nn}=this.options,Ke=nn/Mt,jt=(Ee-Ke)/pt,Ut=(Ee+1+Ke)/pt,tn={features:[]};return this._addTileFeatures(it.range((ue-Ke)/pt,jt,(ue+1+Ke)/pt,Ut),it.data,ue,Ee,pt,tn),ue===0&&this._addTileFeatures(it.range(1-Ke/pt,jt,1,Ut),it.data,pt,Ee,pt,tn),ue===pt-1&&this._addTileFeatures(it.range(0,jt,Ke/pt,Ut),it.data,-1,Ee,pt,tn),tn.features.length?tn:null}getClusterExpansionZoom(re){let ue=this._getOriginZoom(re)-1;for(;ue<=this.options.maxZoom;){const Ee=this.getChildren(re);if(ue++,Ee.length!==1)break;re=Ee[0].properties.cluster_id}return ue}_appendLeaves(re,ue,Ee,it,pt){const Mt=this.getChildren(ue);for(const nn of Mt){const Ke=nn.properties;if(Ke&&Ke.cluster?pt+Ke.point_count<=it?pt+=Ke.point_count:pt=this._appendLeaves(re,Ke.cluster_id,Ee,it,pt):pt<it?pt++:re.push(nn),re.length===Ee)break}return pt}_createTree(re){const ue=new i.bg(re.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Ee=0;Ee<re.length;Ee+=this.stride)ue.add(re[Ee],re[Ee+1]);return ue.finish(),ue.data=re,ue}_addTileFeatures(re,ue,Ee,it,pt,Mt){for(const nn of re){const Ke=nn*this.stride,jt=ue[Ke+$n]>1;let Ut,tn,Sn;if(jt)Ut=ft(ue,Ke,this.clusterProps),tn=ue[Ke],Sn=ue[Ke+1];else{const Nr=this.points[ue[Ke+an]];Ut=Nr.properties;const[hr,Tr]=Nr.geometry.coordinates;tn=Lt(hr),Sn=Ot(Tr)}const Ln={type:1,geometry:[[Math.round(this.options.extent*(tn*pt-Ee)),Math.round(this.options.extent*(Sn*pt-it))]],tags:Ut};let Dr;Dr=jt||this.options.generateId?ue[Ke+an]:this.points[ue[Ke+an]].id,Dr!==void 0&&(Ln.id=Dr),Mt.features.push(Ln)}}_limitZoom(re){return Math.max(this.options.minZoom,Math.min(Math.floor(+re),this.options.maxZoom+1))}_cluster(re,ue){const{radius:Ee,extent:it,reduce:pt,minPoints:Mt}=this.options,nn=Ee/(it*Math.pow(2,ue)),Ke=re.data,jt=[],Ut=this.stride;for(let tn=0;tn<Ke.length;tn+=Ut){if(Ke[tn+2]<=ue)continue;Ke[tn+2]=ue;const Sn=Ke[tn],Ln=Ke[tn+1],Dr=re.within(Ke[tn],Ke[tn+1],nn),Nr=Ke[tn+$n];let hr=Nr;for(const Tr of Dr){const Rr=Tr*Ut;Ke[Rr+2]>ue&&(hr+=Ke[Rr+$n])}if(hr>Nr&&hr>=Mt){let Tr,Rr=Sn*Nr,$r=Ln*Nr,Di=-1;const dr=(tn/Ut<<5)+(ue+1)+this.points.length;for(const io of Dr){const Ji=io*Ut;if(Ke[Ji+2]<=ue)continue;Ke[Ji+2]=ue;const oo=Ke[Ji+$n];Rr+=Ke[Ji]*oo,$r+=Ke[Ji+1]*oo,Ke[Ji+4]=dr,pt&&(Tr||(Tr=this._map(Ke,tn,!0),Di=this.clusterProps.length,this.clusterProps.push(Tr)),pt(Tr,this._map(Ke,Ji)))}Ke[tn+4]=dr,jt.push(Rr/hr,$r/hr,1/0,dr,-1,hr),pt&&jt.push(Di)}else{for(let Tr=0;Tr<Ut;Tr++)jt.push(Ke[tn+Tr]);if(hr>1)for(const Tr of Dr){const Rr=Tr*Ut;if(!(Ke[Rr+2]<=ue)){Ke[Rr+2]=ue;for(let $r=0;$r<Ut;$r++)jt.push(Ke[Rr+$r])}}}}return jt}_getOriginId(re){return re-this.points.length>>5}_getOriginZoom(re){return(re-this.points.length)%32}_map(re,ue,Ee){if(re[ue+$n]>1){const Mt=this.clusterProps[re[ue+Gn]];return Ee?Object.assign({},Mt):Mt}const it=this.points[re[ue+an]].properties,pt=this.options.map(it);return Ee&&pt===it?Object.assign({},pt):pt}}function Re(Qe,re,ue){return{type:"Feature",id:Qe[re+an],properties:ft(Qe,re,ue),geometry:{type:"Point",coordinates:[(Ee=Qe[re],360*(Ee-.5)),Kt(Qe[re+1])]}};var Ee}function ft(Qe,re,ue){const Ee=Qe[re+$n],it=Ee>=1e4?`${Math.round(Ee/1e3)}k`:Ee>=1e3?Math.round(Ee/100)/10+"k":Ee,pt=Qe[re+Gn],Mt=pt===-1?{}:Object.assign({},ue[pt]);return Object.assign(Mt,{cluster:!0,cluster_id:Qe[re+an],point_count:Ee,point_count_abbreviated:it})}function Lt(Qe){return Qe/360+.5}function Ot(Qe){const re=Math.sin(Qe*Math.PI/180),ue=.5-.25*Math.log((1+re)/(1-re))/Math.PI;return ue<0?0:ue>1?1:ue}function Kt(Qe){const re=(180-360*Qe)*Math.PI/180;return 360*Math.atan(Math.exp(re))/Math.PI-90}var dn={exports:{}};dn.exports=function(){function Qe(mt,ce,ee,me){for(var xe,Ve=me,Ue=ee-ce>>1,Xe=ee-ce,yt=mt[ce],rt=mt[ce+1],Zt=mt[ee],fn=mt[ee+1],zt=ce+3;zt<ee;zt+=3){var Rn=re(mt[zt],mt[zt+1],yt,rt,Zt,fn);if(Rn>Ve)xe=zt,Ve=Rn;else if(Rn===Ve){var zn=Math.abs(zt-Ue);zn<Xe&&(xe=zt,Xe=zn)}}Ve>me&&(xe-ce>3&&Qe(mt,ce,xe,me),mt[xe+2]=Ve,ee-xe>3&&Qe(mt,xe,ee,me))}function re(mt,ce,ee,me,xe,Ve){var Ue=xe-ee,Xe=Ve-me;if(Ue!==0||Xe!==0){var yt=((mt-ee)*Ue+(ce-me)*Xe)/(Ue*Ue+Xe*Xe);yt>1?(ee=xe,me=Ve):yt>0&&(ee+=Ue*yt,me+=Xe*yt)}return(Ue=mt-ee)*Ue+(Xe=ce-me)*Xe}function ue(mt,ce,ee,me){var xe={id:mt===void 0?null:mt,type:ce,geometry:ee,tags:me,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ve){var Ue=Ve.geometry,Xe=Ve.type;if(Xe==="Point"||Xe==="MultiPoint"||Xe==="LineString")Ee(Ve,Ue);else if(Xe==="Polygon"||Xe==="MultiLineString")for(var yt=0;yt<Ue.length;yt++)Ee(Ve,Ue[yt]);else if(Xe==="MultiPolygon")for(yt=0;yt<Ue.length;yt++)for(var rt=0;rt<Ue[yt].length;rt++)Ee(Ve,Ue[yt][rt])}(xe),xe}function Ee(mt,ce){for(var ee=0;ee<ce.length;ee+=3)mt.minX=Math.min(mt.minX,ce[ee]),mt.minY=Math.min(mt.minY,ce[ee+1]),mt.maxX=Math.max(mt.maxX,ce[ee]),mt.maxY=Math.max(mt.maxY,ce[ee+1])}function it(mt,ce,ee,me){if(ce.geometry){var xe=ce.geometry.coordinates,Ve=ce.geometry.type,Ue=Math.pow(ee.tolerance/((1<<ee.maxZoom)*ee.extent),2),Xe=[],yt=ce.id;if(ee.promoteId?yt=ce.properties[ee.promoteId]:ee.generateId&&(yt=me||0),Ve==="Point")pt(xe,Xe);else if(Ve==="MultiPoint")for(var rt=0;rt<xe.length;rt++)pt(xe[rt],Xe);else if(Ve==="LineString")Mt(xe,Xe,Ue,!1);else if(Ve==="MultiLineString"){if(ee.lineMetrics){for(rt=0;rt<xe.length;rt++)Mt(xe[rt],Xe=[],Ue,!1),mt.push(ue(yt,"LineString",Xe,ce.properties));return}nn(xe,Xe,Ue,!1)}else if(Ve==="Polygon")nn(xe,Xe,Ue,!0);else{if(Ve!=="MultiPolygon"){if(Ve==="GeometryCollection"){for(rt=0;rt<ce.geometry.geometries.length;rt++)it(mt,{id:yt,geometry:ce.geometry.geometries[rt],properties:ce.properties},ee,me);return}throw new Error("Input data is not a valid GeoJSON object.")}for(rt=0;rt<xe.length;rt++){var Zt=[];nn(xe[rt],Zt,Ue,!0),Xe.push(Zt)}}mt.push(ue(yt,Ve,Xe,ce.properties))}}function pt(mt,ce){ce.push(Ke(mt[0])),ce.push(jt(mt[1])),ce.push(0)}function Mt(mt,ce,ee,me){for(var xe,Ve,Ue=0,Xe=0;Xe<mt.length;Xe++){var yt=Ke(mt[Xe][0]),rt=jt(mt[Xe][1]);ce.push(yt),ce.push(rt),ce.push(0),Xe>0&&(Ue+=me?(xe*rt-yt*Ve)/2:Math.sqrt(Math.pow(yt-xe,2)+Math.pow(rt-Ve,2))),xe=yt,Ve=rt}var Zt=ce.length-3;ce[2]=1,Qe(ce,0,Zt,ee),ce[Zt+2]=1,ce.size=Math.abs(Ue),ce.start=0,ce.end=ce.size}function nn(mt,ce,ee,me){for(var xe=0;xe<mt.length;xe++){var Ve=[];Mt(mt[xe],Ve,ee,me),ce.push(Ve)}}function Ke(mt){return mt/360+.5}function jt(mt){var ce=Math.sin(mt*Math.PI/180),ee=.5-.25*Math.log((1+ce)/(1-ce))/Math.PI;return ee<0?0:ee>1?1:ee}function Ut(mt,ce,ee,me,xe,Ve,Ue,Xe){if(me/=ce,Ve>=(ee/=ce)&&Ue<me)return mt;if(Ue<ee||Ve>=me)return null;for(var yt=[],rt=0;rt<mt.length;rt++){var Zt=mt[rt],fn=Zt.geometry,zt=Zt.type,Rn=xe===0?Zt.minX:Zt.minY,zn=xe===0?Zt.maxX:Zt.maxY;if(Rn>=ee&&zn<me)yt.push(Zt);else if(!(zn<ee||Rn>=me)){var Hn=[];if(zt==="Point"||zt==="MultiPoint")tn(fn,Hn,ee,me,xe);else if(zt==="LineString")Sn(fn,Hn,ee,me,xe,!1,Xe.lineMetrics);else if(zt==="MultiLineString")Dr(fn,Hn,ee,me,xe,!1);else if(zt==="Polygon")Dr(fn,Hn,ee,me,xe,!0);else if(zt==="MultiPolygon")for(var ni=0;ni<fn.length;ni++){var ar=[];Dr(fn[ni],ar,ee,me,xe,!0),ar.length&&Hn.push(ar)}if(Hn.length){if(Xe.lineMetrics&&zt==="LineString"){for(ni=0;ni<Hn.length;ni++)yt.push(ue(Zt.id,zt,Hn[ni],Zt.tags));continue}zt!=="LineString"&&zt!=="MultiLineString"||(Hn.length===1?(zt="LineString",Hn=Hn[0]):zt="MultiLineString"),zt!=="Point"&&zt!=="MultiPoint"||(zt=Hn.length===3?"Point":"MultiPoint"),yt.push(ue(Zt.id,zt,Hn,Zt.tags))}}}return yt.length?yt:null}function tn(mt,ce,ee,me,xe){for(var Ve=0;Ve<mt.length;Ve+=3){var Ue=mt[Ve+xe];Ue>=ee&&Ue<=me&&(ce.push(mt[Ve]),ce.push(mt[Ve+1]),ce.push(mt[Ve+2]))}}function Sn(mt,ce,ee,me,xe,Ve,Ue){for(var Xe,yt,rt=Ln(mt),Zt=xe===0?hr:Tr,fn=mt.start,zt=0;zt<mt.length-3;zt+=3){var Rn=mt[zt],zn=mt[zt+1],Hn=mt[zt+2],ni=mt[zt+3],ar=mt[zt+4],Qn=xe===0?Rn:zn,ki=xe===0?ni:ar,Gi=!1;Ue&&(Xe=Math.sqrt(Math.pow(Rn-ni,2)+Math.pow(zn-ar,2))),Qn<ee?ki>ee&&(yt=Zt(rt,Rn,zn,ni,ar,ee),Ue&&(rt.start=fn+Xe*yt)):Qn>me?ki<me&&(yt=Zt(rt,Rn,zn,ni,ar,me),Ue&&(rt.start=fn+Xe*yt)):Nr(rt,Rn,zn,Hn),ki<ee&&Qn>=ee&&(yt=Zt(rt,Rn,zn,ni,ar,ee),Gi=!0),ki>me&&Qn<=me&&(yt=Zt(rt,Rn,zn,ni,ar,me),Gi=!0),!Ve&&Gi&&(Ue&&(rt.end=fn+Xe*yt),ce.push(rt),rt=Ln(mt)),Ue&&(fn+=Xe)}var di=mt.length-3;Rn=mt[di],zn=mt[di+1],Hn=mt[di+2],(Qn=xe===0?Rn:zn)>=ee&&Qn<=me&&Nr(rt,Rn,zn,Hn),di=rt.length-3,Ve&&di>=3&&(rt[di]!==rt[0]||rt[di+1]!==rt[1])&&Nr(rt,rt[0],rt[1],rt[2]),rt.length&&ce.push(rt)}function Ln(mt){var ce=[];return ce.size=mt.size,ce.start=mt.start,ce.end=mt.end,ce}function Dr(mt,ce,ee,me,xe,Ve){for(var Ue=0;Ue<mt.length;Ue++)Sn(mt[Ue],ce,ee,me,xe,Ve,!1)}function Nr(mt,ce,ee,me){mt.push(ce),mt.push(ee),mt.push(me)}function hr(mt,ce,ee,me,xe,Ve){var Ue=(Ve-ce)/(me-ce);return mt.push(Ve),mt.push(ee+(xe-ee)*Ue),mt.push(1),Ue}function Tr(mt,ce,ee,me,xe,Ve){var Ue=(Ve-ee)/(xe-ee);return mt.push(ce+(me-ce)*Ue),mt.push(Ve),mt.push(1),Ue}function Rr(mt,ce){for(var ee=[],me=0;me<mt.length;me++){var xe,Ve=mt[me],Ue=Ve.type;if(Ue==="Point"||Ue==="MultiPoint"||Ue==="LineString")xe=$r(Ve.geometry,ce);else if(Ue==="MultiLineString"||Ue==="Polygon"){xe=[];for(var Xe=0;Xe<Ve.geometry.length;Xe++)xe.push($r(Ve.geometry[Xe],ce))}else if(Ue==="MultiPolygon")for(xe=[],Xe=0;Xe<Ve.geometry.length;Xe++){for(var yt=[],rt=0;rt<Ve.geometry[Xe].length;rt++)yt.push($r(Ve.geometry[Xe][rt],ce));xe.push(yt)}ee.push(ue(Ve.id,Ue,xe,Ve.tags))}return ee}function $r(mt,ce){var ee=[];ee.size=mt.size,mt.start!==void 0&&(ee.start=mt.start,ee.end=mt.end);for(var me=0;me<mt.length;me+=3)ee.push(mt[me]+ce,mt[me+1],mt[me+2]);return ee}function Di(mt,ce){if(mt.transformed)return mt;var ee,me,xe,Ve=1<<mt.z,Ue=mt.x,Xe=mt.y;for(ee=0;ee<mt.features.length;ee++){var yt=mt.features[ee],rt=yt.geometry,Zt=yt.type;if(yt.geometry=[],Zt===1)for(me=0;me<rt.length;me+=2)yt.geometry.push(dr(rt[me],rt[me+1],ce,Ve,Ue,Xe));else for(me=0;me<rt.length;me++){var fn=[];for(xe=0;xe<rt[me].length;xe+=2)fn.push(dr(rt[me][xe],rt[me][xe+1],ce,Ve,Ue,Xe));yt.geometry.push(fn)}}return mt.transformed=!0,mt}function dr(mt,ce,ee,me,xe,Ve){return[Math.round(ee*(mt*me-xe)),Math.round(ee*(ce*me-Ve))]}function io(mt,ce,ee,me,xe){for(var Ve=ce===xe.maxZoom?0:xe.tolerance/((1<<ce)*xe.extent),Ue={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ee,y:me,z:ce,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Xe=0;Xe<mt.length;Xe++){Ue.numFeatures++,Ji(Ue,mt[Xe],Ve,xe);var yt=mt[Xe].minX,rt=mt[Xe].minY,Zt=mt[Xe].maxX,fn=mt[Xe].maxY;yt<Ue.minX&&(Ue.minX=yt),rt<Ue.minY&&(Ue.minY=rt),Zt>Ue.maxX&&(Ue.maxX=Zt),fn>Ue.maxY&&(Ue.maxY=fn)}return Ue}function Ji(mt,ce,ee,me){var xe=ce.geometry,Ve=ce.type,Ue=[];if(Ve==="Point"||Ve==="MultiPoint")for(var Xe=0;Xe<xe.length;Xe+=3)Ue.push(xe[Xe]),Ue.push(xe[Xe+1]),mt.numPoints++,mt.numSimplified++;else if(Ve==="LineString")oo(Ue,xe,mt,ee,!1,!1);else if(Ve==="MultiLineString"||Ve==="Polygon")for(Xe=0;Xe<xe.length;Xe++)oo(Ue,xe[Xe],mt,ee,Ve==="Polygon",Xe===0);else if(Ve==="MultiPolygon")for(var yt=0;yt<xe.length;yt++){var rt=xe[yt];for(Xe=0;Xe<rt.length;Xe++)oo(Ue,rt[Xe],mt,ee,!0,Xe===0)}if(Ue.length){var Zt=ce.tags||null;if(Ve==="LineString"&&me.lineMetrics){for(var fn in Zt={},ce.tags)Zt[fn]=ce.tags[fn];Zt.mapbox_clip_start=xe.start/xe.size,Zt.mapbox_clip_end=xe.end/xe.size}var zt={geometry:Ue,type:Ve==="Polygon"||Ve==="MultiPolygon"?3:Ve==="LineString"||Ve==="MultiLineString"?2:1,tags:Zt};ce.id!==null&&(zt.id=ce.id),mt.features.push(zt)}}function oo(mt,ce,ee,me,xe,Ve){var Ue=me*me;if(me>0&&ce.size<(xe?Ue:me))ee.numPoints+=ce.length/3;else{for(var Xe=[],yt=0;yt<ce.length;yt+=3)(me===0||ce[yt+2]>Ue)&&(ee.numSimplified++,Xe.push(ce[yt]),Xe.push(ce[yt+1])),ee.numPoints++;xe&&function(rt,Zt){for(var fn=0,zt=0,Rn=rt.length,zn=Rn-2;zt<Rn;zn=zt,zt+=2)fn+=(rt[zt]-rt[zn])*(rt[zt+1]+rt[zn+1]);if(fn>0===Zt)for(zt=0,Rn=rt.length;zt<Rn/2;zt+=2){var Hn=rt[zt],ni=rt[zt+1];rt[zt]=rt[Rn-2-zt],rt[zt+1]=rt[Rn-1-zt],rt[Rn-2-zt]=Hn,rt[Rn-1-zt]=ni}}(Xe,Ve),mt.push(Xe)}}function rr(mt,ce){var ee=(ce=this.options=function(xe,Ve){for(var Ue in Ve)xe[Ue]=Ve[Ue];return xe}(Object.create(this.options),ce)).debug;if(ee&&console.time("preprocess data"),ce.maxZoom<0||ce.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ce.promoteId&&ce.generateId)throw new Error("promoteId and generateId cannot be used together.");var me=function(xe,Ve){var Ue=[];if(xe.type==="FeatureCollection")for(var Xe=0;Xe<xe.features.length;Xe++)it(Ue,xe.features[Xe],Ve,Xe);else it(Ue,xe.type==="Feature"?xe:{geometry:xe},Ve);return Ue}(mt,ce);this.tiles={},this.tileCoords=[],ee&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ce.indexMaxZoom,ce.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(me=function(xe,Ve){var Ue=Ve.buffer/Ve.extent,Xe=xe,yt=Ut(xe,1,-1-Ue,Ue,0,-1,2,Ve),rt=Ut(xe,1,1-Ue,2+Ue,0,-1,2,Ve);return(yt||rt)&&(Xe=Ut(xe,1,-Ue,1+Ue,0,-1,2,Ve)||[],yt&&(Xe=Rr(yt,1).concat(Xe)),rt&&(Xe=Xe.concat(Rr(rt,-1)))),Xe}(me,ce)).length&&this.splitTile(me,0,0,0),ee&&(me.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function vi(mt,ce,ee){return 32*((1<<mt)*ee+ce)+mt}return rr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},rr.prototype.splitTile=function(mt,ce,ee,me,xe,Ve,Ue){for(var Xe=[mt,ce,ee,me],yt=this.options,rt=yt.debug;Xe.length;){me=Xe.pop(),ee=Xe.pop(),ce=Xe.pop(),mt=Xe.pop();var Zt=1<<ce,fn=vi(ce,ee,me),zt=this.tiles[fn];if(!zt&&(rt>1&&console.time("creation"),zt=this.tiles[fn]=io(mt,ce,ee,me,yt),this.tileCoords.push({z:ce,x:ee,y:me}),rt)){rt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ce,ee,me,zt.numFeatures,zt.numPoints,zt.numSimplified),console.timeEnd("creation"));var Rn="z"+ce;this.stats[Rn]=(this.stats[Rn]||0)+1,this.total++}if(zt.source=mt,xe){if(ce===yt.maxZoom||ce===xe)continue;var zn=1<<xe-ce;if(ee!==Math.floor(Ve/zn)||me!==Math.floor(Ue/zn))continue}else if(ce===yt.indexMaxZoom||zt.numPoints<=yt.indexMaxPoints)continue;if(zt.source=null,mt.length!==0){rt>1&&console.time("clipping");var Hn,ni,ar,Qn,ki,Gi,di=.5*yt.buffer/yt.extent,Qo=.5-di,Hi=.5+di,To=1+di;Hn=ni=ar=Qn=null,ki=Ut(mt,Zt,ee-di,ee+Hi,0,zt.minX,zt.maxX,yt),Gi=Ut(mt,Zt,ee+Qo,ee+To,0,zt.minX,zt.maxX,yt),mt=null,ki&&(Hn=Ut(ki,Zt,me-di,me+Hi,1,zt.minY,zt.maxY,yt),ni=Ut(ki,Zt,me+Qo,me+To,1,zt.minY,zt.maxY,yt),ki=null),Gi&&(ar=Ut(Gi,Zt,me-di,me+Hi,1,zt.minY,zt.maxY,yt),Qn=Ut(Gi,Zt,me+Qo,me+To,1,zt.minY,zt.maxY,yt),Gi=null),rt>1&&console.timeEnd("clipping"),Xe.push(Hn||[],ce+1,2*ee,2*me),Xe.push(ni||[],ce+1,2*ee,2*me+1),Xe.push(ar||[],ce+1,2*ee+1,2*me),Xe.push(Qn||[],ce+1,2*ee+1,2*me+1)}}},rr.prototype.getTile=function(mt,ce,ee){var me=this.options,xe=me.extent,Ve=me.debug;if(mt<0||mt>24)return null;var Ue=1<<mt,Xe=vi(mt,ce=(ce%Ue+Ue)%Ue,ee);if(this.tiles[Xe])return Di(this.tiles[Xe],xe);Ve>1&&console.log("drilling down to z%d-%d-%d",mt,ce,ee);for(var yt,rt=mt,Zt=ce,fn=ee;!yt&&rt>0;)rt--,Zt=Math.floor(Zt/2),fn=Math.floor(fn/2),yt=this.tiles[vi(rt,Zt,fn)];return yt&&yt.source?(Ve>1&&console.log("found parent tile z%d-%d-%d",rt,Zt,fn),Ve>1&&console.time("drilling down"),this.splitTile(yt.source,rt,Zt,fn,mt,ce,ee),Ve>1&&console.timeEnd("drilling down"),this.tiles[Xe]?Di(this.tiles[Xe],xe):null):null},function(mt,ce){return new rr(mt,ce)}}();var Vt=i.dK(dn.exports);function Gt(Qe,re){const ue=Qe.tileID.canonical;if(!this._geoJSONIndex)return re(null,null);const Ee=this._geoJSONIndex.getTile(ue.z,ue.x,ue.y);if(!Ee)return re(null,null);const it=new ve(Ee.features);let pt=zr(it);pt.byteOffset===0&&pt.byteLength===pt.buffer.byteLength||(pt=new Uint8Array(pt)),re(null,{vectorTile:it,rawData:pt.buffer})}class Yt extends _e{constructor(re,ue,Ee,it,pt,Mt){super(re,ue,Ee,it,Gt,Mt),pt&&(this.loadGeoJSON=pt)}loadData(re,ue){const Ee=re&&re.request,it=Ee&&Ee.collectResourceTiming;this.loadGeoJSON(re,(pt,Mt)=>{if(pt||!Mt)return ue(pt);if(typeof Mt!="object")return ue(new Error(`Input data given to '${re.source}' is not a valid GeoJSON object.`));{Be(Mt,!0);try{if(re.filter){const Ke=i.r(re.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ke.result==="error")throw new Error(Ke.value.map(Ut=>`${Ut.key}: ${Ut.message}`).join(", "));Mt={type:"FeatureCollection",features:Mt.features.filter(Ut=>Ke.value.evaluate({zoom:0},Ut))}}this._geoJSONIndex=re.cluster?new De(function({superclusterOptions:Ke,clusterProperties:jt}){if(!jt||!Ke)return Ke;const Ut={},tn={},Sn={accumulated:null,zoom:0},Ln={properties:null},Dr=Object.keys(jt);for(const Nr of Dr){const[hr,Tr]=jt[Nr],Rr=i.r(Tr),$r=i.r(typeof hr=="string"?[hr,["accumulated"],["get",Nr]]:hr);Ut[Nr]=Rr.value,tn[Nr]=$r.value}return Ke.map=Nr=>{Ln.properties=Nr;const hr={};for(const Tr of Dr)hr[Tr]=Ut[Tr].evaluate(Sn,Ln);return hr},Ke.reduce=(Nr,hr)=>{Ln.properties=hr;for(const Tr of Dr)Sn.accumulated=Nr[Tr],Nr[Tr]=tn[Tr].evaluate(Sn,Ln)},Ke}(re)).load(Mt.features):Vt(Mt,re.geojsonVtOptions)}catch(Ke){return ue(Ke)}this.loaded={};const nn={};if(it){const Ke=P(Ee);Ke&&(nn.resourceTiming={},nn.resourceTiming[re.source]=JSON.parse(JSON.stringify(Ke)))}ue(null,nn)}})}reloadTile(re,ue){const Ee=this.loaded;return Ee&&Ee[re.uid]?super.reloadTile(re,ue):this.loadTile(re,ue)}loadGeoJSON(re,ue){if(re.request)i.g(re.request,ue);else{if(typeof re.data!="string")return ue(new Error(`Input data given to '${re.source}' is not a valid GeoJSON object.`));try{return ue(null,JSON.parse(re.data))}catch{return ue(new Error(`Input data given to '${re.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(re,ue){try{ue(null,this._geoJSONIndex.getClusterExpansionZoom(re.clusterId))}catch(Ee){ue(Ee)}}getClusterChildren(re,ue){try{ue(null,this._geoJSONIndex.getChildren(re.clusterId))}catch(Ee){ue(Ee)}}getClusterLeaves(re,ue){try{ue(null,this._geoJSONIndex.getLeaves(re.clusterId,re.limit,re.offset))}catch(Ee){ue(Ee)}}}class qt{constructor(re,ue){this.tileID=new i.am(re.tileID.overscaledZ,re.tileID.wrap,re.tileID.canonical.z,re.tileID.canonical.x,re.tileID.canonical.y),this.tileZoom=re.tileZoom,this.uid=re.uid,this.zoom=re.zoom,this.canonical=re.tileID.canonical,this.pixelRatio=re.pixelRatio,this.tileSize=re.tileSize,this.source=re.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=re.projection,this.brightness=ue}parse(re,ue,Ee,it){this.status="parsing";const pt=new i.am(Ee.tileID.overscaledZ,Ee.tileID.wrap,Ee.tileID.canonical.z,Ee.tileID.canonical.x,Ee.tileID.canonical.y),Mt={},nn=ue.familiesBySource[Ee.source],Ke=new i.dC(pt,Ee.promoteId);return Ke.bucketLayerIDs=[],Ke.is3DTile=!0,i.dP(re).then(jt=>{if(!jt)return it(new Error("Could not parse tile"));const Ut=i.dQ(jt,1/i.bR(Ee.tileID.canonical)),tn=jt.json.extensionsUsed&&jt.json.extensionsUsed.includes("MAPBOX_mesh_features")||jt.json.asset.extras&&jt.json.asset.extras.MAPBOX_mesh_features,Sn=jt.json.extensionsUsed&&jt.json.extensionsUsed.includes("EXT_meshopt_compression"),Ln=new i.K(this.zoom,{brightness:this.brightness});for(const Dr in nn)for(const Nr of nn[Dr]){const hr=Nr[0];Ke.bucketLayerIDs.push(Nr.map(Rr=>Rr.id)),hr.recalculate(Ln,[]);const Tr=new i.dR(Ut,pt,tn,Sn,this.brightness,Ke);tn||(Tr.needsUpload=!0),Mt[hr.fqid]=Tr,Tr.evaluate(hr)}this.status="done",it(null,{buckets:Mt,featureIndex:Ke})}).catch(jt=>it(new Error(jt.message)))}}class Mn{constructor(re,ue,Ee,it,pt,Mt){this.actor=re,this.layerIndex=ue,this.brightness=Mt,this.loading={},this.loaded={}}loadTile(re,ue){const Ee=re.uid,it=this.loading[Ee]=new qt(re,this.brightness);i.a_(re.request,(pt,Mt)=>{const nn=!this.loading[Ee];return delete this.loading[Ee],nn||pt?(it.status="done",nn||(this.loaded[Ee]=it),ue(pt)):Mt&&Mt.byteLength!==0?void it.parse(Mt,this.layerIndex,re,(Ke,jt)=>{it.status="done",this.loaded=this.loaded||{},this.loaded[Ee]=it,Ke||!jt?ue(Ke):ue(null,jt)}):(it.status="done",this.loaded[Ee]=it,ue())})}reloadTile(re,ue){const Ee=this.loaded,it=re.uid;if(Ee&&Ee[it]){const pt=Ee[it];pt.projection=re.projection,pt.brightness=re.brightness;const Mt=(nn,Ke)=>{pt.reloadCallback&&(delete pt.reloadCallback,this.loadTile(re,ue)),ue(nn,Ke)};pt.status==="parsing"?pt.reloadCallback=Mt:pt.status==="done"&&this.loadTile(re,ue)}}abortTile(re,ue){const Ee=re.uid;this.loading[Ee]&&delete this.loading[Ee],ue()}removeTile(re,ue){const Ee=this.loaded,it=re.uid;Ee&&Ee[it]&&delete Ee[it],ue()}}class En{constructor(re){this.self=re,this.actor=new i.dS(re,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=i.bo({name:"mercator"}),this.workerSourceTypes={vector:_e,geojson:Yt,"batched-model":Mn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ue,Ee)=>{if(this.workerSourceTypes[ue])throw new Error(`Worker source with name "${ue}" already registered.`);this.workerSourceTypes[ue]=Ee},this.self.registerRTLTextPlugin=ue=>{if(i.dT.isParsed())throw new Error("RTL text plugin already registered.");i.dT.applyArabicShaping=ue.applyArabicShaping,i.dT.processBidirectionalText=ue.processBidirectionalText,i.dT.processStyledBidirectionalText=ue.processStyledBidirectionalText}}clearCaches(re,ue,Ee){delete this.layerIndexes[re],delete this.availableImages[re],delete this.workerSources[re],delete this.demWorkerSources[re],delete this.rasterArrayWorkerSource,Ee()}checkIfReady(re,ue,Ee){Ee()}setReferrer(re,ue){this.referrer=ue}spriteLoaded(re,{scope:ue,isLoaded:Ee}){if(this.isSpriteLoaded[re]||(this.isSpriteLoaded[re]={}),this.isSpriteLoaded[re][ue]=Ee,this.workerSources[re]&&this.workerSources[re][ue])for(const it in this.workerSources[re][ue]){const pt=this.workerSources[re][ue][it];for(const Mt in pt)pt[Mt]instanceof _e&&(pt[Mt].isSpriteLoaded=Ee,pt[Mt].fire(new i.b("isSpriteLoaded")))}}setImages(re,{scope:ue,images:Ee},it){if(this.availableImages[re]||(this.availableImages[re]={}),this.availableImages[re][ue]=Ee,this.workerSources[re]&&this.workerSources[re][ue]){for(const pt in this.workerSources[re][ue]){const Mt=this.workerSources[re][ue][pt];for(const nn in Mt)Mt[nn].availableImages=Ee}it()}else it()}setProjection(re,ue){this.projections[re]=i.bo(ue)}setBrightness(re,ue,Ee){this.brightness=ue,Ee()}setLayers(re,ue,Ee){this.getLayerIndex(re,ue.scope).replace(ue.layers,ue.options),Ee()}updateLayers(re,ue,Ee){this.getLayerIndex(re,ue.scope).update(ue.layers,ue.removedIds,ue.options),Ee()}loadTile(re,ue,Ee){ue.projection=this.projections[re]||this.defaultProjection,this.getWorkerSource(re,ue.type,ue.source,ue.scope).loadTile(ue,Ee)}loadDEMTile(re,ue,Ee){this.getDEMWorkerSource(re,ue.source,ue.scope).loadTile(ue,Ee)}decodeRasterArray(re,ue,Ee){this.getRasterArrayWorkerSource().decodeRasterArray(ue,Ee)}reloadTile(re,ue,Ee){ue.projection=this.projections[re]||this.defaultProjection,this.getWorkerSource(re,ue.type,ue.source,ue.scope).reloadTile(ue,Ee)}abortTile(re,ue,Ee){this.getWorkerSource(re,ue.type,ue.source,ue.scope).abortTile(ue,Ee)}removeTile(re,ue,Ee){this.getWorkerSource(re,ue.type,ue.source,ue.scope).removeTile(ue,Ee)}removeSource(re,ue,Ee){if(!(this.workerSources[re]&&this.workerSources[re][ue.scope]&&this.workerSources[re][ue.scope][ue.type]&&this.workerSources[re][ue.scope][ue.type][ue.source]))return;const it=this.workerSources[re][ue.scope][ue.type][ue.source];delete this.workerSources[re][ue.scope][ue.type][ue.source],it.removeSource!==void 0?it.removeSource(ue,Ee):Ee()}loadWorkerSource(re,ue,Ee){try{this.self.importScripts(ue.url),Ee()}catch(it){Ee(it.toString())}}syncRTLPluginState(re,ue,Ee){try{i.dT.setState(ue);const it=i.dT.getPluginURL();if(i.dT.isLoaded()&&!i.dT.isParsed()&&it!=null){this.self.importScripts(it);const pt=i.dT.isParsed();Ee(pt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${it}`),pt)}}catch(it){Ee(it.toString())}}setDracoUrl(re,ue){this.dracoUrl=ue}getAvailableImages(re,ue){this.availableImages[re]||(this.availableImages[re]={});let Ee=this.availableImages[re][ue];return Ee||(Ee=[]),Ee}getLayerIndex(re,ue){this.layerIndexes[re]||(this.layerIndexes[re]={});let Ee=this.layerIndexes[re][ue];return Ee||(Ee=this.layerIndexes[re][ue]=new U,Ee.scope=ue),Ee}getWorkerSource(re,ue,Ee,it){if(this.workerSources[re]||(this.workerSources[re]={}),this.workerSources[re][it]||(this.workerSources[re][it]={}),this.workerSources[re][it][ue]||(this.workerSources[re][it][ue]={}),this.isSpriteLoaded[re]||(this.isSpriteLoaded[re]={}),!this.workerSources[re][it][ue][Ee]){const pt={send:(Mt,nn,Ke,jt,Ut,tn)=>{this.actor.send(Mt,nn,Ke,re,Ut,tn)},scheduler:this.actor.scheduler};this.workerSources[re][it][ue][Ee]=new this.workerSourceTypes[ue](pt,this.getLayerIndex(re,it),this.getAvailableImages(re,it),this.isSpriteLoaded[re][it],void 0,this.brightness)}return this.workerSources[re][it][ue][Ee]}getDEMWorkerSource(re,ue,Ee){return this.demWorkerSources[re]||(this.demWorkerSources[re]={}),this.demWorkerSources[re][Ee]||(this.demWorkerSources[re][Ee]={}),this.demWorkerSources[re][Ee][ue]||(this.demWorkerSources[re][Ee][ue]=new we),this.demWorkerSources[re][Ee][ue]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new ye),this.rasterArrayWorkerSource}enforceCacheSizeLimit(re,ue){i.dU(ue)}getWorkerPerformanceMetrics(re,ue,Ee){Ee(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new En(self)),En}),x(["./shared"],function(i){function P(c,r){if(Array.isArray(c)){if(!Array.isArray(r)||c.length!==r.length)return!1;for(let s=0;s<c.length;s++)if(!P(c[s],r[s]))return!1;return!0}if(typeof c=="object"&&c!==null&&r!==null){if(typeof r!="object"||Object.keys(c).length!==Object.keys(r).length)return!1;for(const s in c)if(!P(c[s],r[s]))return!1;return!0}return c===r}var O=L;function L(c){return!function(r){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var h,p,y=new Blob([""],{type:"text/javascript"}),w=URL.createObjectURL(y);try{p=new Worker(w),h=!0}catch{h=!1}return p&&p.terminate(),URL.revokeObjectURL(w),h}()?function(){var h=document.createElement("canvas");h.width=h.height=1;var p=h.getContext("2d");if(!p)return!1;var y=p.getImageData(0,0,1,1);return y&&y.width===h.width}()?(U[s=r&&r.failIfMajorPerformanceCaveat]===void 0&&(U[s]=function(h){var p,y=function(w){var M=document.createElement("canvas"),C=Object.create(L.webGLContextAttributes);return C.failIfMajorPerformanceCaveat=w,M.getContext("webgl2",C)}(h);if(!y)return!1;try{p=y.createShader(y.VERTEX_SHADER)}catch{return!1}return!(!p||y.isContextLost())&&(y.shaderSource(p,"void main() {}"),y.compileShader(p),y.getShaderParameter(p,y.COMPILE_STATUS)===!0)}(s)),U[s]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var s}(c)}var U={};function j(c,r,s){const h=document.createElement(c);return r!=null&&(h.className=r),s&&s.appendChild(h),h}function W(c,r,s){const h=document.createElementNS("http://www.w3.org/2000/svg",c);for(const p of Object.keys(r))h.setAttributeNS(null,p,String(r[p]));return s&&s.appendChild(h),h}L.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const J=typeof document<"u"?document.documentElement&&document.documentElement.style:null,fe=J&&J.userSelect!==void 0?"userSelect":"WebkitUserSelect";let _e;function we(){J&&fe&&(_e=J[fe],J[fe]="none")}function ye(){J&&fe&&(J[fe]=_e)}function Pe(c){c.preventDefault(),c.stopPropagation(),window.removeEventListener("click",Pe,!0)}function Fe(){window.addEventListener("click",Pe,!0),window.setTimeout(()=>{window.removeEventListener("click",Pe,!0)},0)}function Be(c,r){const s=c.getBoundingClientRect();return ve(c,s,r)}function He(c,r){const s=c.getBoundingClientRect(),h=[];for(let p=0;p<r.length;p++)h.push(ve(c,s,r[p]));return h}function Ce(c){return window.InstallTrigger!==void 0&&c.button===2&&c.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:c.button}function ve(c,r,s){const h=c.offsetWidth===r.width?1:c.offsetWidth/r.width;return new i.P((s.clientX-r.left)*h,(s.clientY-r.top)*h)}class Te{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(r,s){this._updatedSourceCaches[r]=s,this.setDirty()}discardSourceCacheUpdate(r){delete this._updatedSourceCaches[r]}updateLayer(r){const s=r.scope;this._updatedLayers[s]=this._updatedLayers[s]||new Set,this._updatedLayers[s].add(r.id),this.setDirty()}removeLayer(r){const s=r.scope;this._removedLayers[s]=this._removedLayers[s]||{},this._updatedLayers[s]=this._updatedLayers[s]||new Set,this._removedLayers[s][r.id]=r,this._updatedLayers[s].delete(r.id),this._updatedPaintProps.delete(r.fqid),this.setDirty()}getRemovedLayer(r){return this._removedLayers[r.scope]?this._removedLayers[r.scope][r.id]:null}discardLayerRemoval(r){this._removedLayers[r.scope]&&delete this._removedLayers[r.scope][r.id]}getLayerUpdatesByScope(){const r={};for(const s in this._updatedLayers)r[s]=r[s]||{},r[s].updatedIds=Array.from(this._updatedLayers[s].values());for(const s in this._removedLayers)r[s]=r[s]||{},r[s].removedIds=Object.keys(this._removedLayers[s]);return r}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(r){this._updatedPaintProps.add(r.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(r){this._updatedImages.add(r),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}class Ye extends i.E{constructor(r){super(),this.requestManager=r,this.models={"":{}},this.numModelsLoading={}}loadModel(r,s){return i.l(this.requestManager.transformRequest(s,i.R.Model).url).then(h=>{if(!h)return;const p=i.c(h),y=new i.M(r,void 0,void 0,p);return y.computeBoundsAndApplyParent(),y}).catch(h=>{this.fire(new i.a(new Error(`Could not load model ${r} from ${s}: ${h.message}`)))})}load(r,s){this.models[s]||(this.models[s]={});const h=Object.keys(r);this.numModelsLoading[s]=(this.numModelsLoading[s]||0)+h.length;const p=[];for(const y of h)p.push(this.loadModel(y,r[y]));Promise.allSettled(p).then(y=>{for(let w=0;w<y.length;w++){const{status:M,value:C}=y[w];M==="fulfilled"&&C&&(this.models[s][h[w]]=C)}this.numModelsLoading[s]-=h.length,this.fire(new i.b("data",{dataType:"style"}))}).catch(y=>{this.fire(new i.a(new Error(`Could not load models: ${y.message}`)))})}isLoaded(){for(const r in this.numModelsLoading)if(this.numModelsLoading[r]>0)return!1;return!0}hasModel(r,s){return!!this.getModel(r,s)}getModel(r,s){return this.models[s]||(this.models[s]={}),this.models[s][r]}addModel(r,s,h){this.models[h]||(this.models[h]={}),this.hasModel(r,h)&&this.removeModel(r,h),this.load({[r]:this.requestManager.normalizeModelURL(s)},h)}addModels(r,s){const h={};for(const p in r)h[p]=this.requestManager.normalizeModelURL(r[p]);this.load(h,s)}removeModel(r,s){this.models[s]||(this.models[s]={});const h=this.models[s][r];delete this.models[s][r],h.destroy()}listModels(r){return this.models[r]||(this.models[r]={}),Object.keys(this.models[r])}upload(r,s){this.models[s]||(this.models[s]={});for(const h in this.models[s])this.models[s][h].upload(r.context)}}class Oe{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,s,h){const p=String(s);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][p]=this.stateChanges[r][p]||{},i.e(this.stateChanges[r][p],h),this.deletedStates[r]===null){this.deletedStates[r]={};for(const y in this.state[r])y!==p&&(this.deletedStates[r][y]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][p]===null){this.deletedStates[r][p]={};for(const y in this.state[r][p])h[y]||(this.deletedStates[r][p][y]=null)}else for(const y in h)this.deletedStates[r]&&this.deletedStates[r][p]&&this.deletedStates[r][p][y]===null&&delete this.deletedStates[r][p][y]}removeFeatureState(r,s,h){if(this.deletedStates[r]===null)return;const p=String(s);if(this.deletedStates[r]=this.deletedStates[r]||{},h&&s!==void 0)this.deletedStates[r][p]!==null&&(this.deletedStates[r][p]=this.deletedStates[r][p]||{},this.deletedStates[r][p][h]=null);else if(s!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][p])for(h in this.deletedStates[r][p]={},this.stateChanges[r][p])this.deletedStates[r][p][h]=null;else this.deletedStates[r][p]=null;else this.deletedStates[r]=null}getState(r,s){const h=String(s),p=i.e({},(this.state[r]||{})[h],(this.stateChanges[r]||{})[h]);if(this.deletedStates[r]===null)return{};if(this.deletedStates[r]){const y=this.deletedStates[r][s];if(y===null)return{};for(const w in y)delete p[w]}return p}initializeTileState(r,s){r.setFeatureState(this.state,s)}coalesceChanges(r,s){const h={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const y={};for(const w in this.stateChanges[p])this.state[p][w]||(this.state[p][w]={}),i.e(this.state[p][w],this.stateChanges[p][w]),y[w]=this.state[p][w];h[p]=y}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const y={};if(this.deletedStates[p]===null)for(const w in this.state[p])y[w]={},this.state[p][w]={};else for(const w in this.deletedStates[p]){if(this.deletedStates[p][w]===null)this.state[p][w]={};else if(this.state[p][w])for(const M of Object.keys(this.deletedStates[p][w]))delete this.state[p][w][M];y[w]=this.state[p][w]}h[p]=h[p]||{},i.e(h[p],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(h).length!==0)for(const p in r)r[p].setFeatureState(h,s)}}function lt(c){const{userImage:r}=c;return!!(r&&r.render&&r.render())&&(c.data.replace(new Uint8Array(r.data.buffer)),!0)}class Ht extends i.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(r){this.images[r]={},this.loaded[r]=!1,this.updatedImages[r]={},this.patterns[r]={},this.callbackDispatchedThisFrame[r]={},this.atlasImage[r]=new i.h({width:1,height:1})}isLoaded(){for(const r in this.loaded)if(!this.loaded[r])return!1;return!0}setLoaded(r,s){if(this.loaded[s]!==r&&(this.loaded[s]=r,r)){for(const{ids:h,callback:p}of this.requestors)this._notify(h,s,p);this.requestors=[]}}hasImage(r,s){return!!this.getImage(r,s)}getImage(r,s){return this.images[s][r]}addImage(r,s,h){this._validate(r,h)&&(this.images[s][r]=h)}_validate(r,s){let h=!0;return this._validateStretch(s.stretchX,s.data&&s.data.width)||(this.fire(new i.a(new Error(`Image "${r}" has invalid "stretchX" value`))),h=!1),this._validateStretch(s.stretchY,s.data&&s.data.height)||(this.fire(new i.a(new Error(`Image "${r}" has invalid "stretchY" value`))),h=!1),this._validateContent(s.content,s)||(this.fire(new i.a(new Error(`Image "${r}" has invalid "content" value`))),h=!1),h}_validateStretch(r,s){if(!r)return!0;let h=0;for(const p of r){if(p[0]<h||p[1]<p[0]||s<p[1])return!1;h=p[1]}return!0}_validateContent(r,s){return!(r&&(r.length!==4||r[0]<0||s.data.width<r[0]||r[1]<0||s.data.height<r[1]||r[2]<0||s.data.width<r[2]||r[3]<0||s.data.height<r[3]||r[2]<r[0]||r[3]<r[1]))}updateImage(r,s,h){h.version=this.images[s][r].version+1,this.images[s][r]=h,this.updatedImages[s][r]=!0}removeImage(r,s){const h=this.images[s][r];delete this.images[s][r],delete this.patterns[s][r],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()}listImages(r){return Object.keys(this.images[r])}getImages(r,s,h){let p=!0;const y=!!this.loaded[s];if(!y)for(const w of r)this.images[s][w]||(p=!1);y||p?this._notify(r,s,h):this.requestors.push({ids:r,scope:s,callback:h})}getUpdatedImages(r){return this.updatedImages[r]}_notify(r,s,h){const p={};for(const y of r){this.images[s][y]||this.fire(new i.b("styleimagemissing",{id:y}));const w=this.images[s][y];w?p[y]={data:w.data.clone(),pixelRatio:w.pixelRatio,sdf:w.sdf,version:w.version,stretchX:w.stretchX,stretchY:w.stretchY,content:w.content,hasRenderCallback:!!(w.userImage&&w.userImage.render)}:i.w(`Image "${y}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}h(null,p)}getPixelSize(r){const{width:s,height:h}=this.atlasImage[r];return{width:s,height:h}}getPattern(r,s){const h=this.patterns[s][r],p=this.getImage(r,s);if(!p)return null;if(h&&h.position.version===p.version)return h.position;if(h)h.position.version=p.version;else{const y={w:p.data.width+2,h:p.data.height+2,x:0,y:0},w=new i.I(y,p);this.patterns[s][r]={bin:y,position:w}}return this._updatePatternAtlas(s),this.patterns[s][r].position}bind(r,s){const h=r.gl;let p=this.atlasTexture[s];p?this.dirty&&(p.update(this.atlasImage[s]),this.dirty=!1):(p=new i.T(r,this.atlasImage[s],h.RGBA),this.atlasTexture[s]=p),p.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(r){const s=[];for(const w in this.patterns[r])s.push(this.patterns[r][w].bin);const{w:h,h:p}=i.p(s),y=this.atlasImage[r];y.resize({width:h||1,height:p||1});for(const w in this.patterns[r]){const{bin:M}=this.patterns[r][w],C=M.x+1,k=M.y+1,z=this.images[r][w].data,B=z.width,$=z.height;i.h.copy(z,y,{x:0,y:0},{x:C,y:k},{width:B,height:$}),i.h.copy(z,y,{x:0,y:$-1},{x:C,y:k-1},{width:B,height:1}),i.h.copy(z,y,{x:0,y:0},{x:C,y:k+$},{width:B,height:1}),i.h.copy(z,y,{x:B-1,y:0},{x:C-1,y:k},{width:1,height:$}),i.h.copy(z,y,{x:0,y:0},{x:C+B,y:k},{width:1,height:$})}this.dirty=!0}beginFrame(){for(const r in this.images)this.callbackDispatchedThisFrame[r]={}}dispatchRenderCallbacks(r,s){for(const h of r){if(this.callbackDispatchedThisFrame[s][h])continue;this.callbackDispatchedThisFrame[s][h]=!0;const p=this.images[s][h];lt(p)&&this.updateImage(h,s,p)}}}class nt{constructor(r,s,h,p){this.message=(r?`${r}: `:"")+h,p&&(this.identifier=p),s!=null&&s.__line__&&(this.line=s.__line__)}}class Tt extends nt{}function Rt(c){const r=c.key,s=c.value,h=c.valueSpec||{},p=c.objectElementValidators||{},y=c.style,w=c.styleSpec;let M=[];const C=i.i(s);if(C!=="object")return[new nt(r,s,`object expected, ${C} found`)];for(const k in s){const z=k.split(".")[0];let B;p[z]?B=p[z]:h[z]?B=Vt:p["*"]?B=p["*"]:h["*"]&&(B=Vt),B?M=M.concat(B({key:(r&&`${r}.`)+k,value:s[k],valueSpec:h[z]||h["*"],style:y,styleSpec:w,object:s,objectKey:k},s)):M.push(new Tt(r,s[k],`unknown property "${k}"`))}for(const k in h)p[k]||h[k].required&&h[k].default===void 0&&s[k]===void 0&&M.push(new nt(r,s,`missing required property "${k}"`));return M}function vt(c){const r=c.value,s=c.valueSpec,h=c.style,p=c.styleSpec,y=c.key,w=c.arrayElementValidator||Vt;if(i.i(r)!=="array")return[new nt(y,r,`array expected, ${i.i(r)} found`)];if(s.length&&r.length!==s.length)return[new nt(y,r,`array length ${s.length} expected, length ${r.length} found`)];if(s["min-length"]&&r.length<s["min-length"])return[new nt(y,r,`array length at least ${s["min-length"]} expected, length ${r.length} found`)];let M={type:s.value,values:s.values,minimum:s.minimum,maximum:s.maximum,function:void 0};p.$version<7&&(M.function=s.function),i.i(s.value)==="object"&&(M=s.value);let C=[];for(let k=0;k<r.length;k++)C=C.concat(w({array:r,arrayIndex:k,value:r[k],valueSpec:M,style:h,styleSpec:p,key:`${y}[${k}]`},!0));return C}function wr(c){const r=c.key,s=c.value,h=c.valueSpec;let p=i.i(s);if(p==="number"&&s!=s&&(p="NaN"),p!=="number")return[new nt(r,s,`number expected, ${p} found`)];if("minimum"in h){let y=h.minimum;if(i.i(h.minimum)==="array"&&(y=h.minimum[c.arrayIndex]),s<y)return[new nt(r,s,`${s} is less than the minimum value ${y}`)]}if("maximum"in h){let y=h.maximum;if(i.i(h.maximum)==="array"&&(y=h.maximum[c.arrayIndex]),s>y)return[new nt(r,s,`${s} is greater than the maximum value ${y}`)]}return[]}function Kr(c){const r=c.valueSpec,s=i.u(c.value.type);let h,p,y,w={};const M=s!=="categorical"&&c.value.property===void 0,C=!M,k=i.i(c.value.stops)==="array"&&i.i(c.value.stops[0])==="array"&&i.i(c.value.stops[0][0])==="object",z=Rt({key:c.key,value:c.value,valueSpec:c.styleSpec.function,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(H){if(s==="identity")return[new nt(H.key,H.value,'identity function may not have a "stops" property')];let K=[];const X=H.value;return K=K.concat(vt({key:H.key,value:X,valueSpec:H.valueSpec,style:H.style,styleSpec:H.styleSpec,arrayElementValidator:B})),i.i(X)==="array"&&X.length===0&&K.push(new nt(H.key,X,"array must have at least one stop")),K},default:function(H){return Vt({key:H.key,value:H.value,valueSpec:r,style:H.style,styleSpec:H.styleSpec})}}});return s==="identity"&&M&&z.push(new nt(c.key,c.value,'missing required property "property"')),s==="identity"||c.value.stops||z.push(new nt(c.key,c.value,'missing required property "stops"')),s==="exponential"&&c.valueSpec.expression&&!i.s(c.valueSpec)&&z.push(new nt(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(C&&!i.k(c.valueSpec)?z.push(new nt(c.key,c.value,"property functions not supported")):M&&!i.m(c.valueSpec)&&z.push(new nt(c.key,c.value,"zoom functions not supported"))),s!=="categorical"&&!k||c.value.property!==void 0||z.push(new nt(c.key,c.value,'"property" property is required')),z;function B(H){let K=[];const X=H.value,Q=H.key;if(i.i(X)!=="array")return[new nt(Q,X,`array expected, ${i.i(X)} found`)];if(X.length!==2)return[new nt(Q,X,`array length 2 expected, length ${X.length} found`)];if(k){if(i.i(X[0])!=="object")return[new nt(Q,X,`object expected, ${i.i(X[0])} found`)];if(X[0].zoom===void 0)return[new nt(Q,X,"object stop key must have zoom")];if(X[0].value===void 0)return[new nt(Q,X,"object stop key must have value")];const Z=i.u(X[0].zoom);if(typeof Z!="number")return[new nt(Q,X[0].zoom,"stop zoom values must be numbers")];if(y&&y>Z)return[new nt(Q,X[0].zoom,"stop zoom values must appear in ascending order")];Z!==y&&(y=Z,p=void 0,w={}),K=K.concat(Rt({key:`${Q}[0]`,value:X[0],valueSpec:{zoom:{}},style:H.style,styleSpec:H.styleSpec,objectElementValidators:{zoom:wr,value:$}}))}else K=K.concat($({key:`${Q}[0]`,value:X[0],valueSpec:{},style:H.style,styleSpec:H.styleSpec},X));return i.n(i.o(X[1]))?K.concat([new nt(`${Q}[1]`,X[1],"expressions are not allowed in function stops.")]):K.concat(Vt({key:`${Q}[1]`,value:X[1],valueSpec:r,style:H.style,styleSpec:H.styleSpec}))}function $(H,K){const X=i.i(H.value),Q=i.u(H.value),Z=H.value!==null?H.value:K;if(h){if(X!==h)return[new nt(H.key,Z,`${X} stop domain type must match previous stop domain type ${h}`)]}else h=X;if(X!=="number"&&X!=="string"&&X!=="boolean"&&typeof Q!="number"&&typeof Q!="string"&&typeof Q!="boolean")return[new nt(H.key,Z,"stop domain value must be a number, string, or boolean")];if(X!=="number"&&s!=="categorical"){let ie=`number expected, ${X} found`;return i.k(r)&&s===void 0&&(ie+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new nt(H.key,Z,ie)]}return s!=="categorical"||X!=="number"||typeof Q=="number"&&isFinite(Q)&&Math.floor(Q)===Q?s!=="categorical"&&X==="number"&&typeof Q=="number"&&typeof p=="number"&&p!==void 0&&Q<p?[new nt(H.key,Z,"stop domain values must appear in ascending order")]:(p=Q,s==="categorical"&&Q in w?[new nt(H.key,Z,"stop domain values must be unique")]:(w[Q]=!0,[])):[new nt(H.key,Z,`integer expected, found ${String(Q)}`)]}}function Gr(c){const r=(c.expressionContext==="property"?i.q:i.r)(i.o(c.value),c.valueSpec);if(r.result==="error")return r.value.map(h=>new nt(`${c.key}${h.key}`,c.value,h.message));const s=r.value.expression||r.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!s.outputDefined())return[new nt(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!i.t(s))return[new nt(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter")return Or(s,c);if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!i.v(s,["zoom","feature-state"]))return[new nt(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!i.x(s))return[new nt(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Or(c,r){const s=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(r.valueSpec&&r.valueSpec.expression)for(const p of r.valueSpec.expression.parameters)s.delete(p);if(s.size===0)return[];const h=[];return c instanceof i.C&&s.has(c.name)?[new nt(r.key,r.value,`["${c.name}"] expression is not supported in a filter for a ${r.object.type} layer with id: ${r.object.id}`)]:(c.eachChild(p=>{h.push(...Or(p,r))}),h)}function yi(c){const r=c.key,s=c.value,h=c.valueSpec,p=[];return Array.isArray(h.values)?h.values.indexOf(i.u(s))===-1&&p.push(new nt(r,s,`expected one of [${h.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(h.values).indexOf(i.u(s))===-1&&p.push(new nt(r,s,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(s)} found`)),p}function Hr(c){return i.z(i.o(c.value))?Gr(i.j({},c,{expressionContext:"filter",valueSpec:c.styleSpec[`filter_${c.layerType||"fill"}`]})):oi(c)}function oi(c){const r=c.value,s=c.key;if(i.i(r)!=="array")return[new nt(s,r,`array expected, ${i.i(r)} found`)];const h=c.styleSpec;let p,y=[];if(r.length<1)return[new nt(s,r,"filter array must have at least 1 element")];switch(y=y.concat(yi({key:`${s}[0]`,value:r[0],valueSpec:h.filter_operator,style:c.style,styleSpec:c.styleSpec})),i.u(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&i.u(r[1])==="$type"&&y.push(new nt(s,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&y.push(new nt(s,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(p=i.i(r[1]),p!=="string"&&y.push(new nt(`${s}[1]`,r[1],`string expected, ${p} found`)));for(let w=2;w<r.length;w++)p=i.i(r[w]),i.u(r[1])==="$type"?y=y.concat(yi({key:`${s}[${w}]`,value:r[w],valueSpec:h.geometry_type,style:c.style,styleSpec:c.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&y.push(new nt(`${s}[${w}]`,r[w],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let w=1;w<r.length;w++)y=y.concat(oi({key:`${s}[${w}]`,value:r[w],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":p=i.i(r[1]),r.length!==2?y.push(new nt(s,r,`filter array for "${r[0]}" operator must have 2 elements`)):p!=="string"&&y.push(new nt(`${s}[1]`,r[1],`string expected, ${p} found`))}return y}function zr(c,r){const s=c.key,h=c.style,p=c.layer,y=c.styleSpec,w=c.value,M=c.objectKey,C=y[`${r}_${c.layerType}`];if(!C)return[];const k=M.match(/^(.*)-transition$/);if(r==="paint"&&k&&C[k[1]]&&C[k[1]].transition)return Vt({key:s,value:w,valueSpec:y.transition,style:h,styleSpec:y});const z=c.valueSpec||C[M];if(!z)return[new Tt(s,w,`unknown property "${M}"`)];let B;if(i.i(w)==="string"&&i.k(z)&&!z.tokens&&(B=/^{([^}]+)}$/.exec(w))){const H=`\`{ "type": "identity", "property": ${B?JSON.stringify(B[1]):'"_"'} }\``;return[new nt(s,w,`"${M}" does not support interpolation syntax
Use an identity property function instead: ${H}.`)]}const $=[];if(c.layerType==="symbol")M!=="text-field"||!h||h.glyphs||h.imports||$.push(new nt(s,w,'use of "text-field" requires a style "glyphs" property')),M==="text-font"&&i.A(i.o(w))&&i.u(w.type)==="identity"&&$.push(new nt(s,w,'"text-font" does not support identity functions'));else if(c.layerType==="model"&&r==="paint"&&p&&p.layout&&p.layout.hasOwnProperty("model-id")&&i.k(z)&&(i.B(z)||i.m(z))){const H=i.q(i.o(w),z),K=H.value.expression||H.value._styleExpression.expression;K&&!i.v(K,["measure-light"])&&(M==="model-emissive-strength"&&i.x(K)&&i.t(K)||$.push(new nt(s,w,`${M} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return $.concat(Vt({key:c.key,value:w,valueSpec:z,style:h,styleSpec:y,expressionContext:"property",propertyType:r,propertyKey:M}))}function It(c){return zr(c,"paint")}function mn(c){return zr(c,"layout")}function on(c){let r=[];const s=c.value,h=c.key,p=c.style,y=c.styleSpec;s.type||s.ref||r.push(new nt(h,s,'either "type" or "ref" is required'));let w=i.u(s.type);const M=i.u(s.ref);if(s.id){const C=i.u(s.id);for(let k=0;k<c.arrayIndex;k++){const z=p.layers[k];i.u(z.id)===C&&r.push(new nt(h,s.id,`duplicate layer id "${s.id}", previously used at line ${z.id.__line__}`))}}if("ref"in s){let C;["type","source","source-layer","filter","layout"].forEach(k=>{k in s&&r.push(new nt(h,s[k],`"${k}" is prohibited for ref layers`))}),p.layers.forEach(k=>{i.u(k.id)===M&&(C=k)}),C?C.ref?r.push(new nt(h,s.ref,"ref cannot reference another ref layer")):w=i.u(C.type):typeof M=="string"&&r.push(new nt(h,s.ref,`ref layer "${M}" not found`))}else if(w!=="background"&&w!=="sky"&&w!=="slot")if(s.source){const C=p.sources&&p.sources[s.source],k=C&&i.u(C.type);C?k==="vector"&&w==="raster"?r.push(new nt(h,s.source,`layer "${s.id}" requires a raster source`)):k==="raster"&&w!=="raster"?r.push(new nt(h,s.source,`layer "${s.id}" requires a vector source`)):k!=="vector"||s["source-layer"]?k==="raster-dem"&&w!=="hillshade"?r.push(new nt(h,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):k!=="raster-array"||["raster","raster-particle"].includes(w)?w!=="line"||!s.paint||!s.paint["line-gradient"]&&!s.paint["line-trim-offset"]||k==="geojson"&&C.lineMetrics?w==="raster-particle"&&k!=="raster-array"&&r.push(new nt(h,s.source,`layer "${s.id}" requires a 'raster-array' source.`)):r.push(new nt(h,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new nt(h,s.source,"raster-array source can only be used with layer type 'raster'.")):r.push(new nt(h,s,`layer "${s.id}" must specify a "source-layer"`)):r.push(new nt(h,s.source,`source "${s.source}" not found`))}else r.push(new nt(h,s,'missing required property "source"'));return r=r.concat(Rt({key:h,value:s,valueSpec:y.layer,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Vt({key:`${h}.type`,value:s.type,valueSpec:y.layer.type,style:c.style,styleSpec:c.styleSpec,object:s,objectKey:"type"}),filter:C=>Hr(i.j({layerType:w},C)),layout:C=>Rt({layer:s,key:C.key,value:C.value,valueSpec:{},style:C.style,styleSpec:C.styleSpec,objectElementValidators:{"*":k=>mn(i.j({layerType:w},k))}}),paint:C=>Rt({layer:s,key:C.key,value:C.value,valueSpec:{},style:C.style,styleSpec:C.styleSpec,objectElementValidators:{"*":k=>It(i.j({layerType:w,layer:s},k))}})}})),r}function an(c){const r=c.value,s=c.key,h=i.i(r);return h!=="string"?[new nt(s,r,`string expected, ${h} found`)]:[]}const $n={promoteId:function({key:c,value:r}){if(i.i(r)==="string")return an({key:c,value:r});{const s=[];for(const h in r)s.push(...an({key:`${c}.${h}`,value:r[h]}));return s}}};function Gn(c){const r=c.value,s=c.key,h=c.styleSpec,p=c.style;if(!r.type)return[new nt(s,r,'"type" is required')];const y=i.u(r.type);let w=[];switch(["vector","raster","raster-dem","raster-array"].includes(y)&&(r.url||r.tiles||w.push(new Tt(s,r,'Either "url" or "tiles" is required.'))),y){case"vector":case"raster":case"raster-dem":case"raster-array":return w=w.concat(Rt({key:s,value:r,valueSpec:h[`source_${y.replace("-","_")}`],style:c.style,styleSpec:h,objectElementValidators:$n})),w;case"geojson":if(w=Rt({key:s,value:r,valueSpec:h.source_geojson,style:p,styleSpec:h,objectElementValidators:$n}),r.cluster)for(const M in r.clusterProperties){const[C,k]=r.clusterProperties[M],z=typeof C=="string"?[C,["accumulated"],["get",M]]:C;w.push(...Gr({key:`${s}.${M}.map`,value:k,expressionContext:"cluster-map"})),w.push(...Gr({key:`${s}.${M}.reduce`,value:z,expressionContext:"cluster-reduce"}))}return w;case"video":return Rt({key:s,value:r,valueSpec:h.source_video,style:p,styleSpec:h});case"image":return Rt({key:s,value:r,valueSpec:h.source_image,style:p,styleSpec:h});case"canvas":return[new nt(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return yi({key:`${s}.type`,value:r.type,valueSpec:{values:De(h)},style:p,styleSpec:h})}}function De(c){return c.source.reduce((r,s)=>{const h=c[s];return h.type.type==="enum"&&(r=r.concat(Object.keys(h.type.values))),r},[])}function Re(c){const r=c.value;let s=[];if(!r)return s;const h=i.i(r);return h!=="string"?(s=s.concat([new nt(c.key,r,`string expected, "${h}" found`)]),s):(function(p){const y=p.indexOf("://")===-1;try{return new URL(p,y?"http://example.com":void 0),!0}catch{return!1}}(r)||(s=s.concat([new nt(c.key,r,`invalid url "${r}"`)])),s)}function ft(c){const r=c.value,s=c.styleSpec,h=s.light,p=c.style;let y=[];const w=i.i(r);if(r===void 0)return y;if(w!=="object")return y=y.concat([new nt("light",r,`object expected, ${w} found`)]),y;for(const M in r){const C=M.match(/^(.*)-transition$/);y=y.concat(C&&h[C[1]]&&h[C[1]].transition?Vt({key:M,value:r[M],valueSpec:s.transition,style:p,styleSpec:s}):h[M]?Vt({key:M,value:r[M],valueSpec:h[M],style:p,styleSpec:s}):[new nt(M,r[M],`unknown property "${M}"`)])}return y}function Lt(c){const r=c.value;let s=[];if(!r)return s;const h=i.i(r);if(h!=="object")return s=s.concat([new nt("light-3d",r,`object expected, ${h} found`)]),s;const p=c.styleSpec,y=p["light-3d"],w=c.key,M=c.style,C=c.style.lights;for(const B of["type","id"])if(!(B in r))return s=s.concat([new nt("light-3d",r,`missing property ${B} on light`)]),s;if(r.type&&C)for(let B=0;B<c.arrayIndex;B++){const $=i.u(r.type),H=C[B];i.u(H.type)===$&&s.push(new nt(w,r.id,`duplicate light type "${r.type}", previously defined at line ${H.id.__line__}`))}const k=`properties_light_${r.type}`;if(!(k in p))return s=s.concat([new nt("light-3d",r,`Invalid light type ${r.type}`)]),s;const z=p[k];for(const B in r)if(B==="properties"){const $=r[B],H=i.i($);if(H!=="object")return s=s.concat([new nt("properties",$,`object expected, ${H} found`)]),s;for(const K in $)s=s.concat(z[K]?Vt({key:K,value:$[K],valueSpec:z[K],style:M,styleSpec:p}):[new Tt(c.key,$[K],`unknown property "${K}"`)])}else{const $=B.match(/^(.*)-transition$/);s=s.concat($&&y[$[1]]&&y[$[1]].transition?Vt({key:B,value:r[B],valueSpec:p.transition,style:M,styleSpec:p}):y[B]?Vt({key:B,value:r[B],valueSpec:y[B],style:M,styleSpec:p}):[new Tt(B,r[B],`unknown property "${B}"`)])}return s}function Ot(c){const r=c.value,s=c.key,h=c.style,p=c.styleSpec,y=p.terrain;let w=[];const M=i.i(r);if(r===void 0||M==="null")return w;if(M!=="object")return w=w.concat([new nt("terrain",r,`object expected, ${M} found`)]),w;for(const C in r){const k=C.match(/^(.*)-transition$/);w=w.concat(k&&y[k[1]]&&y[k[1]].transition?Vt({key:C,value:r[C],valueSpec:p.transition,style:h,styleSpec:p}):y[C]?Vt({key:C,value:r[C],valueSpec:y[C],style:h,styleSpec:p}):[new Tt(C,r[C],`unknown property "${C}"`)])}if(r.source){const C=h.sources&&h.sources[r.source],k=C&&i.u(C.type);C?k!=="raster-dem"&&w.push(new nt(s,r.source,`terrain cannot be used with a source of type ${String(k)}, it only be used with a "raster-dem" source type`)):w.push(new nt(s,r.source,`source "${r.source}" not found`))}else w.push(new nt(s,r,'terrain is missing required property "source"'));return w}function Kt(c){const r=c.value,s=c.style,h=c.styleSpec,p=h.fog;let y=[];const w=i.i(r);if(r===void 0)return y;if(w!=="object")return y=y.concat([new nt("fog",r,`object expected, ${w} found`)]),y;for(const M in r){const C=M.match(/^(.*)-transition$/);y=y.concat(C&&p[C[1]]&&p[C[1]].transition?Vt({key:M,value:r[M],valueSpec:h.transition,style:s,styleSpec:h}):p[M]?Vt({key:M,value:r[M],valueSpec:p[M],style:s,styleSpec:h}):[new Tt(M,r[M],`unknown property "${M}"`)])}return y}const dn={"*":()=>[],array:vt,boolean:function(c){const r=c.value,s=c.key,h=i.i(r);return h!=="boolean"?[new nt(s,r,`boolean expected, ${h} found`)]:[]},number:wr,color:function(c){const r=c.key,s=c.value,h=i.i(s);return h!=="string"?[new nt(r,s,`color expected, ${h} found`)]:i.y(s)===null?[new nt(r,s,`color expected, "${s}" found`)]:[]},enum:yi,filter:Hr,function:Kr,layer:on,object:Rt,source:Gn,model:Re,light:ft,"light-3d":Lt,terrain:Ot,fog:Kt,string:an,formatted:function(c){return an(c).length===0?[]:Gr(c)},resolvedImage:function(c){return an(c).length===0?[]:Gr(c)},projection:function(c){const r=c.value,s=c.styleSpec,h=s.projection,p=c.style;let y=[];const w=i.i(r);if(w==="object")for(const M in r)y=y.concat(Vt({key:M,value:r[M],valueSpec:h[M],style:p,styleSpec:s}));else w!=="string"&&(y=y.concat([new nt("projection",r,`object or string expected, ${w} found`)]));return y},import:function(c){const{value:r,styleSpec:s}=c,{data:h,...p}=r;Object.defineProperty(p,"__line__",{value:r.__line__,enumerable:!1});let y=Rt(i.j({},c,{value:p,valueSpec:s.import}));return i.u(p.id)===""&&y.push(new nt(`${c.key}.id`,p,"import id can't be an empty string")),h&&(y=y.concat(Yt(h,s,{key:`${c.key}.data`}))),y}};function Vt(c,r=!1){const s=c.value,h=c.valueSpec,p=c.styleSpec;if(h.expression&&i.A(i.u(s)))return Kr(c);if(h.expression&&i.n(i.o(s)))return Gr(c);if(h.type&&dn[h.type]){const y=dn[h.type](c);return r===!0&&y.length>0&&i.i(c.value)==="array"?Gr(c):y}return Rt(i.j({},c,{valueSpec:h.type?p[h.type]:h}))}function Gt(c){const r=c.value,s=c.key,h=an(c);return h.length||(r.indexOf("{fontstack}")===-1&&h.push(new nt(s,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&h.push(new nt(s,r,'"glyphs" url must include a "{range}" token'))),h}function Yt(c,r=i.D,s={}){return Vt({key:s.key||"",value:c,valueSpec:r.$root,styleSpec:r,style:c,objectElementValidators:{glyphs:Gt,"*":()=>[]}})}function qt(c,r=i.D){return Ke(Yt(c,r))}const Mn=c=>Ke(Gn(c)),En=c=>Ke(ft(c)),Qe=c=>Ke(Lt(c)),re=c=>Ke(Ot(c)),ue=c=>Ke(Kt(c)),Ee=c=>Ke(on(c)),it=c=>Ke(Hr(c)),pt=c=>Ke(It(c)),Mt=c=>Ke(mn(c)),nn=c=>Ke(Re(c));function Ke(c){return c.slice().sort((r,s)=>r.line&&s.line?r.line-s.line:0)}function jt(c,r){let s=!1;if(r&&r.length)for(const h of r)h instanceof Tt?i.w(h.message):(c.fire(new i.a(new Error(h.message))),s=!0);return s}const Ut=new i.F({anchor:new i.G(i.D.light.anchor),position:new i.H(i.D.light.position),color:new i.G(i.D.light.color),intensity:new i.G(i.D.light.intensity)});class tn extends i.E{constructor(r,s="flat"){super(),this._transitionable=new i.J(Ut),this.setLight(r,s),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,s,h={}){this._validate(En,r,h)||(this._transitionable.setTransitionOrValue(r),this.id=s)}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,s,h){return(!h||h.validate!==!1)&&jt(this,r.call(qt,i.e({value:s,style:{glyphs:!0,sprite:!0},styleSpec:i.D})))}}const Sn=new i.F({source:new i.G(i.D.terrain.source),exaggeration:new i.G(i.D.terrain.exaggeration)});let Ln=class extends i.E{constructor(c,r,s,h){super(),this.scope=s,this._transitionable=new i.J(Sn,s,h),this._transitionable.setTransitionOrValue(c,h),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=r}get(){return this._transitionable.serialize()}set(c,r){this._transitionable.setTransitionOrValue(c,r)}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}getExaggeration(c){return this._transitioning.possiblyEvaluate(new i.K(c)).get("exaggeration")}isZoomDependent(){const c=this._transitionable._values.exaggeration;return c!=null&&c.value!=null&&c.value.expression!=null&&c.value.expression instanceof i.Z}};const Dr=45,Nr=65,hr=.05;function Tr(c,r,s,h){const p=i.O(Dr,Nr,s),[y,w]=Rr(c,h);let M=1-Math.min(1,Math.exp((r-y)/(w-y)*-6));return M*=M*M,M=Math.min(1,1.00747*M),M*p*c.alpha}function Rr(c,r){const s=.5/Math.tan(.5*r);return[c.range[0]+s,c.range[1]+s]}function $r(c,r,s,h,p){const y=i.N.transformMat4([],[r,s,h],p.mercatorFogMatrix);return Tr(c,i.N.length(y),p.pitch,p._fov)}function Di(c,r,s,h,p,y,w){const M=[[s,h,0],[p,h,0],[p,y,0],[s,y,0]];let C=Number.MAX_VALUE,k=-Number.MAX_VALUE;for(const z of M){const B=i.N.transformMat4([],z,r),$=i.N.length(B);C=Math.min(C,$),k=Math.max(k,$)}return[Tr(c,C,w.pitch,w._fov),Tr(c,k,w.pitch,w._fov)]}const dr=new i.F({range:new i.G(i.D.fog.range),color:new i.G(i.D.fog.color),"high-color":new i.G(i.D.fog["high-color"]),"space-color":new i.G(i.D.fog["space-color"]),"horizon-blend":new i.G(i.D.fog["horizon-blend"]),"star-intensity":new i.G(i.D.fog["star-intensity"]),"vertical-range":new i.G(i.D.fog["vertical-range"])});class io extends i.E{constructor(r,s,h,p){super(),this._transitionable=new i.J(dr,h,new Map(p)),this.set(r,p),this._transitioning=this._transitionable.untransitioned(),this._transform=s,this.properties=new i.Q(dr)}get state(){const r=this._transform,s=r.projection.name==="globe",h=i.S(r.zoom),p=this.properties.get("range"),y=[.5,3];return{range:s?[i.U(y[0],p[0],h),i.U(y[1],p[1],h)]:p,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,s,h={}){if(this._validate(ue,r,h))return;const p=i.e({},r);for(const y of Object.keys(i.D.fog))p[y]===void 0&&(p[y]=i.D.fog[y].default);this._options=p,this._transitionable.setTransitionOrValue(this._options,s)}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const s=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.O(Dr,Nr,r))*s.a}getOpacityAtLatLng(r,s){return this._transform.projection.supportsFog?function(h,p,y){const w=i.L.fromLngLat(p),M=y.elevation?y.elevation.getAtPointOrZero(w):0;return $r(h,w.x,w.y,M,y)}(this.state,r,s):0}getOpacityForTile(r){if(!this._transform.projection.supportsFog)return[1,1];const s=this._transform.calculateFogTileMatrix(r.toUnwrapped());return Di(this.state,s,0,0,i.V,i.V,this._transform)}getOpacityForBounds(r,s,h,p,y){return this._transform.projection.supportsFog?Di(this.state,r,s,h,p,y,this._transform):[1,1]}getFovAdjustedRange(r){return this._transform.projection.supportsFog?Rr(this.state,r):[0,1]}isVisibleOnFrustum(r){if(!this._transform.projection.supportsFog)return!1;const s=[4,5,6,7];for(const h of s){const p=r.points[h];let y;if(p[2]>=0)y=p;else{const w=r.points[h-4];y=i.W(w,p,w[2]/(w[2]-p[2]))}if($r(this.state,y[0],y[1],0,this._transform)>=hr)return!0}return!1}updateConfig(r){this._transitionable.setTransitionOrValue(this._options,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,s,h){return(!h||h.validate!==!1)&&jt(this,r.call(qt,i.e({value:s,style:{glyphs:!0,sprite:!0},styleSpec:i.D})))}}class Ji extends i.E{constructor(r,s,h,p){super(),this.scope=h,this._options=r,this.properties=new i.Q(s),this._transitionable=new i.J(s,h,new Map(p)),this._transitionable.setTransitionOrValue(r.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(r){this._transitionable.setTransitionOrValue(this._options.properties,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(r,s){this._options=r,this._transitionable.setTransitionOrValue(r.properties,s)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}const oo=new i.F({color:new i.G(i.D.properties_light_ambient.color),intensity:new i.G(i.D.properties_light_ambient.intensity)}),rr=new i.F({direction:new i.X(i.D.properties_light_directional.direction),color:new i.G(i.D.properties_light_directional.color),intensity:new i.G(i.D.properties_light_directional.intensity),"cast-shadows":new i.G(i.D.properties_light_directional["cast-shadows"]),"shadow-intensity":new i.G(i.D.properties_light_directional["shadow-intensity"])});class vi{constructor(r,s,h,p){this.screenBounds=r,this.cameraPoint=s,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=h,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,p)}static createFromScreenPoints(r,s){let h,p;if(r instanceof i.P||typeof r[0]=="number"){const y=i.P.convert(r);h=[y],p=s.isPointAboveHorizon(y)}else{const y=i.P.convert(r[0]),w=i.P.convert(r[1]);h=[y,w],p=i.Y(y,w).every(M=>s.isPointAboveHorizon(M))}return new vi(h,s.getCameraPoint(),p,s)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return i.Y(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const s=this.screenBounds[0],h=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],p=i.Y(s,h,0,!1);return this.cameraPoint.y>h.y&&(this.cameraPoint.x>s.x&&this.cameraPoint.x<h.x?p.splice(3,0,this.cameraPoint):this.cameraPoint.x>=h.x?p[2]=this.cameraPoint:this.cameraPoint.x<=s.x&&(p[3]=this.cameraPoint)),i._(p,r)}bufferedCameraGeometryGlobe(r){const s=this.screenBounds[0],h=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],p=i.Y(s,h,r),y=this.cameraPoint.clone();switch(3*((y.y>s.y)+(y.y>h.y))+((y.x>s.x)+(y.x>h.x))){case 0:p[0]=y,p[4]=y.clone();break;case 1:p.splice(1,0,y);break;case 2:p[1]=y;break;case 3:p.splice(4,0,y);break;case 5:p.splice(2,0,y);break;case 6:p[3]=y;break;case 7:p.splice(3,0,y);break;case 8:p[2]=y}return p}containsTile(r,s,h,p=0){const y=r.queryPadding/s._pixelsPerMercatorPixel+1,w=h?this._bufferedCameraMercator(y,s):this._bufferedScreenMercator(y,s);let M=r.tileID.wrap+(w.unwrapped?p:0);const C=w.polygon.map(Q=>i.$(r.tileTransform,Q,M));if(!i.a0(C,0,0,i.V,i.V))return;M=r.tileID.wrap+(this.screenGeometryMercator.unwrapped?p:0);const k=this.screenGeometryMercator.polygon.map(Q=>i.a1(r.tileTransform,Q,M)),z=k.map(Q=>new i.P(Q[0],Q[1])),B=s.getFreeCameraOptions().position||new i.L(0,0,0),$=i.a1(r.tileTransform,B,M),H=k.map(Q=>{const Z=i.N.sub(Q,Q,$);return i.N.normalize(Z,Z),new i.a2($,Z)}),K=i.a3(r,1,s.zoom)*s._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:z,tilespaceRays:H,bufferedTilespaceGeometry:C,bufferedTilespaceBounds:(X=i.a4(C),X.min.x=i.aa(X.min.x,0,i.V),X.min.y=i.aa(X.min.y,0,i.V),X.max.x=i.aa(X.max.x,0,i.V),X.max.y=i.aa(X.max.y,0,i.V),X),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:K};var X}_bufferedScreenMercator(r,s){const h=ee(r);if(this._screenRaycastCache[h])return this._screenRaycastCache[h];{let p;return p=s.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(r),s):{polygon:this.bufferedScreenGeometry(r).map(y=>s.pointCoordinate3D(y)),unwrapped:!0},this._screenRaycastCache[h]=p,p}}_bufferedCameraMercator(r,s){const h=ee(r);if(this._cameraRaycastCache[h])return this._cameraRaycastCache[h];{let p;return p=s.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(r),s):{polygon:this.bufferedCameraGeometry(r).map(y=>s.pointCoordinate3D(y)),unwrapped:!0},this._cameraRaycastCache[h]=p,p}}_projectAndResample(r,s){const h=function(y,w){const M=i.a6.multiply([],w.pixelMatrix,w.globeMatrix),C=[0,-i.ab,0,1],k=[0,i.ab,0,1],z=[0,0,0,1];i.a7.transformMat4(C,C,M),i.a7.transformMat4(k,k,M),i.a7.transformMat4(z,z,M);const B=new i.P(C[0]/C[3],C[1]/C[3]),$=new i.P(k[0]/k[3],k[1]/k[3]),H=i.a8(y,B)&&C[3]<z[3],K=i.a8(y,$)&&k[3]<z[3];if(!H&&!K)return null;const X=function(pe,Se,Ae){for(let Le=1;Le<pe.length;Le++){const et=ce(Se.pointCoordinate3D(pe[Le-1]).x),je=ce(Se.pointCoordinate3D(pe[Le]).x);if(Ae<0){if(et<je)return{idx:Le,t:-et/(je-1-et)}}else if(je<et)return{idx:Le,t:(1-et)/(je+1-et)}}return null}(y,w,H?-1:1);if(!X)return null;const{idx:Q,t:Z}=X;let ie=Q>1?mt(y.slice(0,Q),w):[],he=Q<y.length?mt(y.slice(Q),w):[];ie=ie.map(pe=>new i.P(ce(pe.x),pe.y)),he=he.map(pe=>new i.P(ce(pe.x),pe.y));const se=[...ie];se.length===0&&se.push(he[he.length-1]);const de=i.U(se[se.length-1].y,(he.length===0?ie[0]:he[0]).y,Z);let ne;return ne=H?[new i.P(0,de),new i.P(0,0),new i.P(1,0),new i.P(1,de)]:[new i.P(1,de),new i.P(1,1),new i.P(0,1),new i.P(0,de)],se.push(...ne),he.length===0?se.push(ie[0]):se.push(...he),{polygon:se.map(pe=>new i.L(pe.x,pe.y)),unwrapped:!1}}(r,s);if(h)return h;const p=function(y,w){let M=!1,C=-1/0,k=0;for(let B=0;B<y.length-1;B++)y[B].x>C&&(C=y[B].x,k=B);for(let B=0;B<y.length-1;B++){const $=(k+B)%(y.length-1),H=y[$],K=y[$+1];Math.abs(H.x-K.x)>.5&&(H.x<K.x?(H.x+=1,$===0&&(y[y.length-1].x+=1)):(K.x+=1,$+1===y.length-1&&(y[0].x+=1)),M=!0)}const z=i.a5(w.center.lng);return M&&z<Math.abs(z-1)&&y.forEach(B=>{B.x-=1}),{polygon:y,unwrapped:M}}(mt(r,s).map(y=>new i.P(ce(y.x),y.y)),s);return{polygon:p.polygon.map(y=>new i.L(y.x,y.y)),unwrapped:p.unwrapped}}}function mt(c,r){return i.a9(c,s=>{const h=r.pointCoordinate3D(s);s.x=h.x,s.y=h.y},1/256)}function ce(c){return c<0?1+c%1:c%1}function ee(c){return 100*c|0}function me(c,r,s,h,p){const y=function(w,M){if(w)return p(w);if(M){c.url&&M.tiles&&c.tiles&&delete c.tiles;const C=i.ac(i.e(M,c),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);M.vector_layers&&(C.vectorLayers=M.vector_layers,C.vectorLayerIds=C.vectorLayers.map(k=>k.id)),M.raster_layers&&(C.rasterLayers=M.raster_layers,C.rasterLayerIds=C.rasterLayers.map(k=>k.id)),C.tiles=r.canonicalizeTileset(C,c.url),p(null,C)}};return c.url?i.g(r.transformRequest(r.normalizeSourceURL(c.url,null,s,h),i.R.Source),y):i.f.frame(()=>y(null,c))}class xe{constructor(r,s,h){this.bounds=i.ad.convert(this.validateBounds(r)),this.minzoom=s||0,this.maxzoom=h||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const s=Math.pow(2,r.z),h=Math.floor(i.a5(this.bounds.getWest())*s),p=Math.floor(i.ae(this.bounds.getNorth())*s),y=Math.ceil(i.a5(this.bounds.getEast())*s),w=Math.ceil(i.ae(this.bounds.getSouth())*s);return r.x>=h&&r.x<y&&r.y>=p&&r.y<w}}class Ve extends i.E{constructor(r,s,h,p){if(super(),this.id=r,this.dispatcher=h,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.e(this,i.ac(s,["url","scheme","tileSize","promoteId"])),this._options=i.e({type:"vector"},s),this._collectResourceTiming=!!s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p),this._tileWorkers={},this._deduped=new i.af}load(r){this._loaded=!1,this.fire(new i.b("dataloading",{dataType:"source"}));const s=Array.isArray(this.map._language)?this.map._language.join():this.map._language,h=this.map._worldview;this._tileJSONRequest=me(this._options,this.map._requestManager,s,h,(p,y)=>{this._tileJSONRequest=null,this._loaded=!0,p?(s&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${s}`),h&&h.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${h}`),this.fire(new i.a(p))):y&&(i.e(this,y),y.bounds&&(this.tileBounds=new xe(y.bounds,this.minzoom,this.maxzoom)),i.aj(y.tiles,this.map._requestManager._customAccessToken),this.fire(new i.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.b("data",{dataType:"source",sourceDataType:"content"}))),r&&r(p)})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=i.ag(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return i.e({},this._options)}loadTile(r,s){const h=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme)),p={request:this.map._requestManager.transformRequest(h,i.R.Tile),data:void 0,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:i.f.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:r.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:r.isExtraShadowCaster};if(p.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired")r.state==="loading"?r.reloadCallback=s:r.request=r.actor.send("reloadTile",p,y.bind(this));else if(r.actor=this._tileWorkers[h]=this._tileWorkers[h]||this.dispatcher.getActor(),this.dispatcher.ready)r.request=r.actor.send("loadTile",p,y.bind(this),void 0,!0);else{const w=i.ah.call({deduped:this._deduped},p,(M,C)=>{M||!C?y.call(this,M):(p.data={cacheControl:C.cacheControl,expires:C.expires,rawData:C.rawData.slice(0)},r.actor&&r.actor.send("loadTile",p,y.bind(this),void 0,!0))},!0);r.request={cancel:w}}function y(w,M){return delete r.request,r.aborted?s(null):w&&w.status!==404?s(w):(M&&M.resourceTiming&&(r.resourceTiming=M.resourceTiming),this.map._refreshExpiredTiles&&M&&r.setExpiryData(M),r.loadVectorData(M,this.map.painter),i.ai(this.dispatcher),s(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(r){r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope}),r.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ue extends i.E{constructor(r,s,h,p){super(),this.id=r,this.dispatcher=h,this.setEventedParent(p),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.e({type:"raster"},s),i.e(this,i.ac(s,["url","scheme","tileSize"]))}load(r){this._loaded=!1,this.fire(new i.b("dataloading",{dataType:"source"})),this._tileJSONRequest=me(this._options,this.map._requestManager,null,null,(s,h)=>{this._tileJSONRequest=null,this._loaded=!0,s?this.fire(new i.a(s)):h&&(i.e(this,h),h.bounds&&(this.tileBounds=new xe(h.bounds,this.minzoom,this.maxzoom)),i.aj(h.tiles),this.fire(new i.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.b("data",{dataType:"source",sourceDataType:"content"}))),r&&r(s)})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=i.ag(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return i.e({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,s){const h=i.f.devicePixelRatio>=2,p=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),h,this.tileSize);r.request=i.d(this.map._requestManager.transformRequest(p,i.R.Tile),(y,w,M,C)=>(delete r.request,r.aborted?(r.state="unloaded",s(null)):y?(r.state="errored",s(y)):w?(this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:M,expires:C}),r.setTexture(w,this.map.painter),r.state="loaded",i.ai(this.dispatcher),void s(null)):s(null)))}abortTile(r,s){r.request&&(r.request.cancel(),delete r.request),s()}unloadTile(r,s){r.texture&&r.texture instanceof i.T?(r.destroy(!0),r.texture&&r.texture instanceof i.T&&this.map.painter.saveTileTexture(r.texture)):r.destroy(),s()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Xe extends Ue{constructor(r,s,h,p){super(r,s,h,p),this.type="raster-array",this.maxzoom=22,this._options=i.e({type:"raster-array"},s)}triggerRepaint(r){const s=this.map.painter._terrain,h=this.map.style.getSourceCache(this.id);s&&s.enabled&&h&&s._clearRenderCacheForTile(h.id,r.tileID),this.map.triggerRepaint()}loadTile(r,s){const h=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),p=this.map._requestManager.transformRequest(h,i.R.Tile);r.requestParams=p,r.actor||(r.actor=this.dispatcher.getActor()),r.request=r.fetchHeader(void 0,(y,w,M,C)=>{if(delete r.request,r.aborted)return r.state="unloaded",s(null);if(y)return y.code===20?void 0:(r.state="errored",s(y));this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:M,expires:C}),r.state="empty",s(null)})}unloadTile(r){const s=r.texture;s&&s instanceof i.T?(r.destroy(!0),this.map.painter.saveTileTexture(s)):(r.destroy(),r.flushQueues(),r._isHeaderLoaded=!1,delete r._mrt,delete r.textureDescriptor),r.fbo&&(r.fbo.destroy(),delete r.fbo),delete r.request,delete r.requestParams,delete r.neighboringTiles,r.state="unloaded"}prepareTile(r,s,h){r._isHeaderLoaded&&(r.state!=="empty"&&(r.state="reloading"),r.fetchBand(s,h,(p,y)=>{if(p)return r.state="errored",this.fire(new i.a(p)),void this.triggerRepaint(r);y&&(r.setTexture(y,this.map.painter),r.state="loaded",this.triggerRepaint(r))}))}getInitialBand(r){if(!this.rasterLayers)return 0;const s=this.rasterLayers.find(({id:y})=>y===r),h=s&&s.fields,p=h&&h.bands&&h.bands;return p?p[0]:0}getTextureDescriptor(r,s,h){if(!r)return;const p=s.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!p)return;let y=null;s instanceof i.an?y=s.paint.get("raster-array-band"):s instanceof i.ao&&(y=s.paint.get("raster-particle-array-band"));const w=y||this.getInitialBand(p);if(w!=null)if(r.textureDescriptor){if(!r.updateNeeded(p,w)||h)return Object.assign({},r.textureDescriptor,{texture:r.texture})}else this.prepareTile(r,p,w)}}const yt=32,rt=33,Zt=new Uint16Array(8184);for(let c=0;c<2046;c++){let r=c+2,s=0,h=0,p=0,y=0,w=0,M=0;for(1&r?p=y=w=yt:s=h=M=yt;(r>>=1)>1;){const k=s+p>>1,z=h+y>>1;1&r?(p=s,y=h,s=w,h=M):(s=p,h=y,p=w,y=M),w=k,M=z}const C=4*c;Zt[C+0]=s,Zt[C+1]=h,Zt[C+2]=p,Zt[C+3]=y}const fn=new Uint16Array(2178),zt=new Uint8Array(1089),Rn=new Uint16Array(1089);function zn(c){return c===0?-.03125:c===32?.03125:0}class Hn{constructor(r,s,h,p){this.id=Hn.uniqueIdxCounter,Hn.uniqueIdxCounter++,this.context=r;const y=r.gl;this.buffer=y.createBuffer(),this.dynamicDraw=!!h,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||p||s.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){this.id=Hn.uniqueIdxCounter,Hn.uniqueIdxCounter++;const s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Hn.uniqueIdxCounter=0;const ni={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ar{constructor(r,s,h,p,y,w){this.length=s.length,this.attributes=h,this.itemSize=s.bytesPerElement,this.dynamicDraw=p,this.instanceCount=w,this.context=r;const M=r.gl;this.buffer=M.createBuffer(),r.bindVertexBuffer.set(this.buffer),M.bufferData(M.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?M.DYNAMIC_DRAW:M.STATIC_DRAW),this.dynamicDraw||y||s.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,s){for(let h=0;h<this.attributes.length;h++){const p=s.attributes[this.attributes[h].name];p!==void 0&&r.enableVertexAttribArray(p)}}setVertexAttribPointers(r,s,h){for(let p=0;p<this.attributes.length;p++){const y=this.attributes[p],w=s.attributes[y.name];w!==void 0&&r.vertexAttribPointer(w,y.components,r[ni[y.type]],!1,this.itemSize,y.offset+this.itemSize*(h||0))}}setVertexAttribDivisor(r,s,h){for(let p=0;p<this.attributes.length;p++){const y=s.attributes[this.attributes[p].name];y!==void 0&&this.instanceCount&&this.instanceCount>0&&r.vertexAttribDivisor(y,h)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Qn{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ki extends Qn{getDefault(){return i.ax.transparent}set(r){const s=this.current;(r.r!==s.r||r.g!==s.g||r.b!==s.b||r.a!==s.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Gi extends Qn{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class di extends Qn{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class Qo extends Qn{getDefault(){return[!0,!0,!0,!0]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||r[2]!==s[2]||r[3]!==s[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Hi extends Qn{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class To extends Qn{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class ha extends Qn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const s=this.current;(r.func!==s.func||r.ref!==s.ref||r.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class bs extends Qn{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||r[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class ml extends Qn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=r,this.dirty=!1}}class qs extends Qn{getDefault(){return[0,1]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class Ql extends Qn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=r,this.dirty=!1}}class Io extends Qn{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class Co extends Qn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.BLEND):s.disable(s.BLEND),this.current=r,this.dirty=!1}}class Po extends Qn{getDefault(){const r=this.gl;return[r.ONE,r.ZERO,r.ONE,r.ZERO]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||r[2]!==s[2]||r[3]!==s[3]||this.dirty)&&(this.gl.blendFuncSeparate(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class ws extends Qn{getDefault(){return i.ax.transparent}set(r){const s=this.current;(r.r!==s.r||r.g!==s.g||r.b!==s.b||r.a!==s.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Yi extends Qn{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(r,r),this.current=r,this.dirty=!1)}}class li extends Qn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=r,this.dirty=!1}}class Zn extends Qn{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class _l extends Qn{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}let Ba=class extends Qn{getDefault(){return null}set(c){(c!==this.current||this.dirty)&&(this.gl.useProgram(c),this.current=c,this.dirty=!1)}};class yn extends Qn{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class yr extends Qn{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||r[2]!==s[2]||r[3]!==s[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Do extends Qn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class Na extends Qn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class xo extends Qn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class Ts extends Qn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class en extends Qn{getDefault(){return null}set(r){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class vr extends Qn{getDefault(){return null}set(r){this.gl&&(r!==this.current||this.dirty)&&(this.gl.bindVertexArray(r),this.current=r,this.dirty=!1)}}class xr extends Qn{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class ko extends Qn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class ja extends Qn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class mr extends Qn{constructor(r,s){super(r),this.context=r,this.parent=s}getDefault(){return null}}class ec extends mr{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Va extends mr{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,this.attachment(),s.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Ua extends mr{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,this.attachment(),s.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Oi extends Va{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Ai{constructor(r,s,h,p,y){this.context=r,this.width=s,this.height=h;const w=this.framebuffer=r.gl.createFramebuffer();p&&(this.colorAttachment=new ec(r,w)),y&&(this.depthAttachmentType=y,this.depthAttachment=y==="renderbuffer"?new Va(r,w):new Ua(r,w))}destroy(){const r=this.context.gl;if(this.colorAttachment){const s=this.colorAttachment.get();s&&r.deleteTexture(s)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const s=this.depthAttachment.get();s&&r.deleteRenderbuffer(s)}else{const s=this.depthAttachment.get();s&&r.deleteTexture(s)}r.deleteFramebuffer(this.framebuffer)}}class xn{constructor(r,s,h){this.func=r,this.mask=s,this.range=h}}xn.ReadOnly=!1,xn.ReadWrite=!0,xn.disabled=new xn(519,xn.ReadOnly,[0,1]);const da=7680;class Dn{constructor(r,s,h,p,y,w){this.test=r,this.ref=s,this.mask=h,this.fail=p,this.depthFail=y,this.pass=w}}Dn.disabled=new Dn({func:519,mask:0},0,0,da,da,da);const es=771;class Yn{constructor(r,s,h,p){this.blendFunction=r,this.blendColor=s,this.mask=h,this.blendEquation=p}}Yn.Replace=[1,0,1,0],Yn.disabled=new Yn(Yn.Replace,i.ax.transparent,[!1,!1,!1,!1]),Yn.unblended=new Yn(Yn.Replace,i.ax.transparent,[!0,!0,!0,!0]),Yn.alphaBlended=new Yn([1,es,1,es],i.ax.transparent,[!0,!0,!0,!0]),Yn.multiply=new Yn([774,0,774,0],i.ax.transparent,[!0,!0,!0,!0]);const Ws=1029,Qi=2305;class bn{constructor(r,s,h){this.enable=r,this.mode=s,this.frontFace=h}}bn.disabled=new bn(!1,Ws,Qi),bn.backCCW=new bn(!0,Ws,Qi),bn.backCW=new bn(!0,Ws,2304),bn.frontCW=new bn(!0,1028,2304),bn.frontCCW=new bn(!0,1028,Qi);class vh{constructor(r,s){this.gl=r,this.clearColor=new ki(this),this.clearDepth=new Gi(this),this.clearStencil=new di(this),this.colorMask=new Qo(this),this.depthMask=new Hi(this),this.stencilMask=new To(this),this.stencilFunc=new ha(this),this.stencilOp=new bs(this),this.stencilTest=new ml(this),this.depthRange=new qs(this),this.depthTest=new Ql(this),this.depthFunc=new Io(this),this.blend=new Co(this),this.blendFunc=new Po(this),this.blendColor=new ws(this),this.blendEquation=new Yi(this),this.cullFace=new li(this),this.cullFaceSide=new Zn(this),this.frontFace=new _l(this),this.program=new Ba(this),this.activeTexture=new yn(this),this.viewport=new yr(this),this.bindFramebuffer=new Do(this),this.bindRenderbuffer=new Na(this),this.bindTexture=new xo(this),this.bindVertexBuffer=new Ts(this),this.bindElementBuffer=new en(this),this.bindVertexArrayOES=new vr(this),this.pixelStoreUnpack=new xr(this),this.pixelStoreUnpackPremultiplyAlpha=new ko(this),this.pixelStoreUnpackFlipY=new ja(this),this.options=s?{...s}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=r.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=r.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=r.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=r.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),this.maxPointSize=r.getParameter(r.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,s,h){return new Hn(this,r,s,h)}createVertexBuffer(r,s,h,p,y){return new ar(this,r,s,h,p,y)}createRenderbuffer(r,s,h){const p=this.gl,y=p.createRenderbuffer();return this.bindRenderbuffer.set(y),p.renderbufferStorage(p.RENDERBUFFER,r,s,h),this.bindRenderbuffer.set(null),y}createFramebuffer(r,s,h,p){return new Ai(this,r,s,h,p)}clear({color:r,depth:s,stencil:h,colorMask:p}){const y=this.gl;let w=0;r&&(w|=y.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set(p||[!0,!0,!0,!0])),s!==void 0&&(w|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),h!==void 0&&(w|=y.STENCIL_BUFFER_BIT,this.clearStencil.set(h),this.stencilMask.set(255)),y.clear(w)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){P(r.blendFunction,Yn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor),r.blendEquation?this.blendEquation.set(r.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(r.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}var fa=i.ay([{name:"a_pos",type:"Float32",components:3}]);class Fi{constructor(r,s,h,p){const y={width:h[0],height:h[1],data:null},w=r.gl;this.targetColorTexture=new i.T(r,y,w.RGBA,{useMipmap:!1}),this.backgroundColorTexture=new i.T(r,y,w.RGBA,{useMipmap:!1}),this.context=r,this.setNumParticles(s,p),this.lastInvalidatedAt=0}setNumParticles(r,s){if(this.numParticles===s)return;(this.particleVertices0||this.particleVertices1||this.particleSegment)&&(this.particleVertices0.destroy(),this.particleVertices1.destroy(),this.particleSegment.destroy());const h=new i.az;h.reserve(Math.round(s));const p=i.aA(r.key);for(let y=0;y<s;y++)h.emplaceBack(p(),p(),p());this.particleVertices0=this.context.createVertexBuffer(h,fa.members,!0),this.particleVertices1=this.context.createVertexBuffer(h,fa.members,!0),this.particleSegment=i.aB.simpleSegment(0,0,this.particleVertices0.length,0),this.numParticles=s}update(r){return!(this.lastInvalidatedAt<r&&(this.lastInvalidatedAt=i.f.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleVertices0.destroy(),this.particleVertices1.destroy(),this.particleSegment.destroy()}}const jo={type:2,extent:i.V,loadGeometry:()=>[[new i.P(0,0),new i.P(i.V+1,0),new i.P(i.V+1,i.V+1),new i.P(0,i.V+1),new i.P(0,0)]]};class Zs{constructor(r,s,h,p,y){this.tileID=r,this.uid=i.aC(),this.uses=0,this.tileSize=s,this.tileZoom=h,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=y,p&&p.style&&(this._lastUpdatedBrightness=p.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",p&&p.transform&&(this.projection=p.transform.projection)}registerFadeDuration(r){const s=r+this.timeAdded;s<i.f.now()||this.fadeEndTime&&s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=i.as(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(r,s,h){if(this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(p,y){const w={};if(!y)return w;for(const M of p){const C=M.layerIds.map(k=>y.getLayer(k)).filter(Boolean);if(C.length!==0){M.layers=C,M.stateDependentLayerIds&&(M.stateDependentLayers=M.stateDependentLayerIds.map(k=>C.filter(z=>z.id===k)[0]));for(const k of C)w[k.fqid]=M}}return w}(r.buckets,s.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const y=this.buckets[p];if(y instanceof i.aE){if(this.hasSymbolBuckets=!0,!h)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const y=this.buckets[p];if(y instanceof i.aE&&y.hasRTLText){this.hasRTLText=!0,i.aF();break}}this.queryPadding=0;for(const p in this.buckets){const y=this.buckets[p],w=s.style.getOwnLayer(p);if(!w)continue;const M=w.queryRadius(y);this.queryPadding=Math.max(this.queryPadding,M)}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage),r.lineAtlas&&(this.lineAtlas=r.lineAtlas),this._lastUpdatedBrightness=r.brightness}else this.collisionBoxArray=new i.aD}unloadVectorData(){if(this.hasData()){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(r){return this.buckets[r.fqid]}upload(r){for(const p in this.buckets){const y=this.buckets[p];y.uploadPending()&&y.upload(r)}const s=r.gl,h=this.imageAtlas;if(h&&!h.uploaded){const p=!!Object.keys(h.patternPositions).length;this.imageAtlasTexture=new i.T(r,h.image,s.RGBA,{useMipmap:p}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new i.T(r,this.glyphAtlasImage,s.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new i.T(r,this.lineAtlas.image,s.R8),this.lineAtlas.uploaded=!0)}prepare(r,s,h){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture,h),!s||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const p=s.style.getBrightness();(this._lastUpdatedBrightness||p)&&(this._lastUpdatedBrightness&&p&&Math.abs(this._lastUpdatedBrightness-p)<.001||(this._lastUpdatedBrightness=p,this.updateBuckets(void 0,s)))}queryRenderedFeatures(r,s,h,p,y,w,M,C){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:p,pixelPosMatrix:M,transform:w,params:y,tileTransform:this.tileTransform},r,s,h):{}}querySourceFeatures(r,s){const h=this.latestFeatureIndex;if(!h||!h.rawTileData)return;const p=h.loadVTLayers(),y=s?s.sourceLayer:"",w=p._geojsonTileLayer||p[y];if(!w)return;const M=i.aG(s&&s.filter),{z:C,x:k,y:z}=this.tileID.canonical,B={z:C,x:k,y:z};for(let $=0;$<w.length;$++){const H=w.feature($);if(M.needGeometry){const Q=i.aH(H,!0);if(!M.filter(new i.K(this.tileID.overscaledZ),Q,this.tileID.canonical))continue}else if(!M.filter(new i.K(this.tileID.overscaledZ),H))continue;const K=h.getId(H,y),X=new i.aI(H,C,k,z,K);X.tile=B,r.push(X)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}bucketsLoaded(){for(const r in this.buckets)if(this.buckets[r].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const s=this.expirationTime;if(r.cacheControl){const h=i.aJ(r.cacheControl);h["max-age"]&&(this.expirationTime=Date.now()+1e3*h["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const h=Date.now();let p=!1;if(this.expirationTime>h)p=!1;else if(s)if(this.expirationTime<s)p=!0;else{const y=this.expirationTime-s;y?this.expirationTime=h+Math.max(y,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(r,s){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(r).length!==0&&s&&this.updateBuckets(r,s)}updateBuckets(r,s){if(!this.latestFeatureIndex)return;const h=this.latestFeatureIndex.loadVTLayers(),p=s.style.listImages(),y=s.style.getBrightness();for(const w in this.buckets){if(!s.style.hasLayer(w))continue;const M=this.buckets[w],C=M.layers[0].sourceLayer||"_geojsonTileLayer",k=h[C];let z={};if(r&&(z=r[C],!k||!z||Object.keys(z).length===0))continue;if(M.update(z,k,p,this.imageAtlas&&this.imageAtlas.patternPositions||{},y),M instanceof i.aK||M instanceof i.aL){const $=s.style.getOwnSourceCache(M.layers[0].source);s._terrain&&s._terrain.enabled&&$&&M.programConfigurations.needsUpload&&s._terrain._clearRenderCacheForTile($.id,this.tileID)}const B=s&&s.style&&s.style.getOwnLayer(w);B&&(this.queryPadding=Math.max(this.queryPadding,B.queryRadius(M)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<i.f.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=i.f.now()+r}setTexture(r,s){const h=s.context,p=h.gl;this.texture=this.texture||s.getTileTexture(r.width),this.texture&&this.texture instanceof i.T?this.texture.update(r,{useMipmap:!0}):(this.texture=new i.T(h,r,p.RGBA,{useMipmap:!0}),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE))}setDependencies(r,s){const h={};for(const p of s)h[p]=!0;this.dependencies[r]=h}hasDependency(r,s){for(const h of r){const p=this.dependencies[h];if(p){for(const y of s)if(p[y])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(r,s){if(!s||s.name==="mercator"||this._tileDebugBuffer)return;const h=i.aM(jo,this.tileID.canonical,this.tileTransform)[0],p=new i.aN,y=new i.aO;for(let w=0;w<h.length;w++){const{x:M,y:C}=h[w];p.emplaceBack(M,C),y.emplaceBack(w)}y.emplaceBack(0),this._tileDebugIndexBuffer=r.createIndexBuffer(y),this._tileDebugBuffer=r.createVertexBuffer(p,i.aP.members),this._tileDebugSegments=i.aB.simpleSegment(0,0,p.length,y.length)}_makeTileBoundsBuffers(r,s){if(this._tileBoundsBuffer||!s||s.name==="mercator")return;const h=i.aM(jo,this.tileID.canonical,this.tileTransform)[0];let p,y;if(this.isRaster){const w=function(M,C){const k=i.as(M,C),z=Math.pow(2,M.z);for(let Q=0;Q<rt;Q++)for(let Z=0;Z<rt;Z++){const ie=i.at((M.x+(Z+zn(Z))/yt)/z),he=i.au((M.y+(Q+zn(Q))/yt)/z),se=C.project(ie,he),de=Q*rt+Z;fn[2*de+0]=Math.round((se.x*k.scale-k.x)*i.V),fn[2*de+1]=Math.round((se.y*k.scale-k.y)*i.V)}zt.fill(0),Rn.fill(0);for(let Q=2045;Q>=0;Q--){const Z=4*Q,ie=Zt[Z+0],he=Zt[Z+1],se=Zt[Z+2],de=Zt[Z+3],ne=ie+se>>1,pe=he+de>>1,Se=ne+pe-he,Ae=pe+ie-ne,Le=he*rt+ie,et=de*rt+se,je=pe*rt+ne,dt=Math.hypot((fn[2*Le+0]+fn[2*et+0])/2-fn[2*je+0],(fn[2*Le+1]+fn[2*et+1])/2-fn[2*je+1])>=16;zt[je]=zt[je]||(dt?1:0),Q<1022&&(zt[je]=zt[je]||zt[(he+Ae>>1)*rt+(ie+Se>>1)]||zt[(de+Ae>>1)*rt+(se+Se>>1)])}const B=new i.av,$=new i.aw;let H=0;function K(Q,Z){const ie=Z*rt+Q;return Rn[ie]===0&&(B.emplaceBack(fn[2*ie+0],fn[2*ie+1],Q*i.V/yt,Z*i.V/yt),Rn[ie]=++H),Rn[ie]-1}function X(Q,Z,ie,he,se,de){const ne=Q+ie>>1,pe=Z+he>>1;if(Math.abs(Q-se)+Math.abs(Z-de)>1&&zt[pe*rt+ne])X(se,de,Q,Z,ne,pe),X(ie,he,se,de,ne,pe);else{const Se=K(Q,Z),Ae=K(ie,he),Le=K(se,de);$.emplaceBack(Se,Ae,Le)}}return X(0,0,yt,yt,yt,0),X(yt,yt,0,0,0,yt),{vertices:B,indices:$}}(this.tileID.canonical,s);p=w.vertices,y=w.indices}else{p=new i.av,y=new i.aw;for(const{x:M,y:C}of h)p.emplaceBack(M,C,0,0);const w=i.aQ(p.int16,void 0,4);for(let M=0;M<w.length;M+=3)y.emplaceBack(w[M],w[M+1],w[M+2])}this._tileBoundsBuffer=r.createVertexBuffer(p,i.aR.members),this._tileBoundsIndexBuffer=r.createIndexBuffer(y),this._tileBoundsSegments=i.aB.simpleSegment(0,0,p.length,y.length)}_makeGlobeTileDebugBuffers(r,s){const h=s.projection;if(!h||h.name!=="globe"||s.freezeTileCoverage)return;const p=this.tileID.canonical,y=i.aS(p,s),w=i.aT(y),M=i.S(s.zoom);let C;M>0&&(C=i.a6.invert(new Float64Array(16),s.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(r,p,s,w,C,M),this._makeGlobeTileDebugTextBuffer(r,p,s,w,C,M)}_globePoint(r,s,h,p,y,w,M){let C=i.aU(r,s,h);if(w){const k=1<<h.z,z=i.a5(p.center.lng),B=i.ae(p.center.lat),$=(h.x+.5)/k-z;let H=0;$>.5?H=-1:$<-.5&&(H=1);let K=(r/i.V+h.x)/k+H,X=(s/i.V+h.y)/k;K=(K-z)*p._pixelsPerMercatorPixel+z,X=(X-B)*p._pixelsPerMercatorPixel+B;const Q=[K*p.worldSize,X*p.worldSize,0];i.N.transformMat4(Q,Q,w),C=i.aV(C,Q,M)}return i.N.transformMat4(C,C,y)}_makeGlobeTileDebugBorderBuffer(r,s,h,p,y,w){const M=new i.aN,C=new i.aO,k=new i.aW,z=($,H,K,X,Q)=>{const Z=(K-$)/(Q-1),ie=(X-H)/(Q-1),he=M.length;for(let se=0;se<Q;se++){const de=$+se*Z,ne=H+se*ie;M.emplaceBack(de,ne);const pe=this._globePoint(de,ne,s,h,p,y,w);k.emplaceBack(pe[0],pe[1],pe[2]),C.emplaceBack(he+se)}},B=i.V;z(0,0,B,0,16),z(B,0,B,B,16),z(B,B,0,B,16),z(0,B,0,0,16),this._tileDebugIndexBuffer=r.createIndexBuffer(C),this._tileDebugBuffer=r.createVertexBuffer(M,i.aP.members),this._globeTileDebugBorderBuffer=r.createVertexBuffer(k,i.aX.members),this._tileDebugSegments=i.aB.simpleSegment(0,0,M.length,C.length)}_makeGlobeTileDebugTextBuffer(r,s,h,p,y,w){const M=i.V/4,C=new i.aN,k=new i.aw,z=new i.aW,B=25;k.reserve(32),C.reserve(B),z.reserve(B);const $=(H,K)=>B*H+K;for(let H=0;H<B;H++){const K=H*M;for(let X=0;X<B;X++){const Q=X*M;C.emplaceBack(Q,K);const Z=this._globePoint(Q,K,s,h,p,y,w);z.emplaceBack(Z[0],Z[1],Z[2])}}for(let H=0;H<4;H++)for(let K=0;K<4;K++){const X=$(H,K),Q=$(H,K+1),Z=$(H+1,K),ie=$(H+1,K+1);k.emplaceBack(X,Q,Z),k.emplaceBack(Z,Q,ie)}this._tileDebugTextIndexBuffer=r.createIndexBuffer(k),this._tileDebugTextBuffer=r.createVertexBuffer(C,i.aP.members),this._globeTileDebugTextBuffer=r.createVertexBuffer(z,i.aX.members),this._tileDebugTextSegments=i.aB.simpleSegment(0,0,B,32)}destroy(r=!1){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!r&&this.texture&&this.texture instanceof i.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}const Es={vector:Ve,raster:Ue,"raster-dem":class extends Ue{constructor(c,r,s,h){super(c,r,s,h),this.type="raster-dem",this.maxzoom=22,this._options=i.e({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(c,r){const s=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function h(p,y){p&&(c.state="errored",r(p)),y&&(c.dem=y,c.dem.onDeserialize(),c.needsHillshadePrepare=!0,c.needsDEMTextureUpload=!0,c.state="loaded",r(null))}c.request=i.d(this.map._requestManager.transformRequest(s,i.R.Tile),(function(p,y,w,M){if(delete c.request,c.aborted)c.state="unloaded",r(null);else if(p)c.state="errored",r(p);else if(y){this.map._refreshExpiredTiles&&c.setExpiryData({cacheControl:w,expires:M});const C=ImageBitmap&&y instanceof ImageBitmap&&i.ak(),k=1-(y.width-i.al(y.width))/2;k<1||c.neighboringTiles||(c.neighboringTiles=this._getNeighboringTiles(c.tileID));const z=C?y:i.f.getImageData(y,k),B={uid:c.uid,coord:c.tileID,source:this.id,scope:this.scope,rawImageData:z,encoding:this.encoding,padding:k};c.actor&&c.state!=="expired"||(c.actor=this.dispatcher.getActor(),c.actor.send("loadDEMTile",B,h.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(c){const r=c.canonical,s=Math.pow(2,r.z),h=(r.x-1+s)%s,p=r.x===0?c.wrap-1:c.wrap,y=(r.x+1+s)%s,w=r.x+1===s?c.wrap+1:c.wrap,M={};return M[new i.am(c.overscaledZ,p,r.z,h,r.y).key]={backfilled:!1},M[new i.am(c.overscaledZ,w,r.z,y,r.y).key]={backfilled:!1},r.y>0&&(M[new i.am(c.overscaledZ,p,r.z,h,r.y-1).key]={backfilled:!1},M[new i.am(c.overscaledZ,c.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},M[new i.am(c.overscaledZ,w,r.z,y,r.y-1).key]={backfilled:!1}),r.y+1<s&&(M[new i.am(c.overscaledZ,p,r.z,h,r.y+1).key]={backfilled:!1},M[new i.am(c.overscaledZ,c.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},M[new i.am(c.overscaledZ,w,r.z,y,r.y+1).key]={backfilled:!1}),M}},"raster-array":Xe,geojson:class extends i.E{constructor(c,r,s,h){super(),this.id=c,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=s.getActor(),this.setEventedParent(h),this._data=r.data,this._options=i.e({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const p=i.V/this.tileSize;this.workerOptions=i.e({source:this.id,scope:this.scope,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*p,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*p,extent:i.V,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:i.V,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*p,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions)}onAdd(c){this.map=c,this.setData(this._data)}setData(c){return this._data=c,this._updateWorkerData(),this}getClusterExpansionZoom(c,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:c,source:this.id,scope:this.scope},r),this}getClusterChildren(c,r){return this.actor.send("geojson.getClusterChildren",{clusterId:c,source:this.id,scope:this.scope},r),this}getClusterLeaves(c,r,s,h){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:c,limit:r,offset:s},h),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.b("dataloading",{dataType:"source"})),this._loaded=!1;const c=i.e({},this.workerOptions);c.scope=this.scope;const r=this._data;typeof r=="string"?(c.request=this.map._requestManager.transformRequest(i.f.resolveURL(r),i.R.Source),c.request.collectResourceTiming=this._collectResourceTiming):c.data=JSON.stringify(r),this._pendingLoad=this.actor.send(`${this.type}.loadData`,c,(s,h)=>{if(this._loaded=!0,this._pendingLoad=null,s)this.fire(new i.a(s));else{const p={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&h&&h.resourceTiming&&h.resourceTiming[this.id]&&(p.resourceTiming=h.resourceTiming[this.id]),this.fire(new i.b("data",p)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(c,r){const s=c.actor?"reloadTile":"loadTile";c.actor=this.actor;const h={type:this.type,uid:c.uid,tileID:c.tileID,tileZoom:c.tileZoom,zoom:c.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,scope:this.scope,pixelRatio:i.f.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0};c.request=this.actor.send(s,h,(p,y)=>(delete c.request,c.destroy(),c.aborted?r(null):p?r(p):(c.loadVectorData(y,this.map.painter,s==="reloadTile"),r(null))),void 0,s==="loadTile")}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.aborted=!0}unloadTile(c){this.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id,scope:this.scope}),c.destroy()}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return i.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends i.ap{constructor(c,r,s,h){super(c,r,s,h),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const c=this.options;this.urls=[];for(const r of c.urls)this.urls.push(this.map._requestManager.transformRequest(r,i.R.Source).url);i.aq(this.urls,(r,s)=>{this._loaded=!0,r?this.fire(new i.a(r)):s&&(this.video=s,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(c){if(this.video){const r=this.video.seekable;c<r.start(0)||c>r.end(0)?this.fire(new i.a(new nt(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=c}}getVideo(){return this.video}onAdd(c){this.map||(this.map=c,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const c=this.map.painter.context,r=c.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(c,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(c)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:i.ap,model:class extends i.E{constructor(c,r,s,h){super(),this.id=c,this.type="model",this.models=[],this._loaded=!1,this._options=r}load(){const c=[];for(const r in this._options.models){const s=this._options.models[r],h=i.l(this.map._requestManager.transformRequest(s.uri,i.R.Model).url).then(p=>{if(!p)return;const y=i.c(p),w=new i.M(r,s.position,s.orientation,y);w.computeBoundsAndApplyParent(),this.models.push(w)}).catch(p=>{this.fire(new i.a(new Error(`Could not load model ${r} from ${s.uri}: ${p.message}`)))});c.push(h)}return Promise.allSettled(c).then(()=>{this._loaded=!0,this.fire(new i.b("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(r=>{this.fire(new i.a(new Error(`Could not load models: ${r.message}`)))})}onAdd(c){this.map=c,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(c,r){}serialize(){return{type:"model"}}},"batched-model":class extends i.E{constructor(c,r,s,h){super(),this.type="batched-model",this.id=c,this.tileSize=512,this._options=r,this.tiles=this._options.tiles,this.maxzoom=r.maxzoom||19,this.minzoom=r.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=s,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(h)}onAdd(c){this.map=c,this.load()}load(c){this._loaded=!1,this.fire(new i.b("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,s=this.map._worldview;this._tileJSONRequest=me(this._options,this.map._requestManager,r,s,(h,p)=>{this._tileJSONRequest=null,this._loaded=!0,h?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),s&&s.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${s}`),this.fire(new i.a(h))):p&&(i.e(this,p),p.bounds&&(this.tileBounds=new xe(p.bounds,this.minzoom,this.maxzoom)),i.aj(p.tiles,this.map._requestManager._customAccessToken),this.fire(new i.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.b("data",{dataType:"source",sourceDataType:"content"}))),c&&c(h)})}hasTransition(){return!1}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loaded(){return this._loaded}loadTile(c,r){const s=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme)),h={request:this.map._requestManager.transformRequest(s,i.R.Tile),data:void 0,uid:c.uid,tileID:c.tileID,tileZoom:c.tileZoom,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:c.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(c.actor&&c.state!=="expired")if(c.state==="loading")c.reloadCallback=r;else{if(c.buckets){const y=Object.values(c.buckets);for(const w of y)w.dirty=!0;return void(c.state="loaded")}c.request=c.actor.send("reloadTile",h,p.bind(this))}else c.actor=this.dispatcher.getActor(),c.request=c.actor.send("loadTile",h,p.bind(this),void 0,!0);function p(y,w){return c.aborted?r(null):y&&y.status!==404?r(y):(w&&(w.resourceTiming&&(c.resourceTiming=w.resourceTiming),this.map._refreshExpiredTiles&&c.setExpiryData(w),c.buckets={...c.buckets,...w.buckets},w.featureIndex&&(c.latestFeatureIndex=w.featureIndex)),c.state="loaded",void r(null))}}serialize(){return i.e({},this._options)}},canvas:class extends i.ap{constructor(c,r,s,h){super(c,r,s,h),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(p=>!Array.isArray(p)||p.length!==2||p.some(y=>typeof y!="number"))||this.fire(new i.a(new nt(`sources.${c}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.a(new nt(`sources.${c}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new i.a(new nt(`sources.${c}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new i.a(new nt(`sources.${c}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.a(new nt(`sources.${c}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.a(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(c){this.map=c,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let c=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,c=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,c=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context;this.texture?!c&&!this._playing||this.texture instanceof i.ar||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(r,this.canvas,r.gl.RGBA,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const c of[this.canvas.width,this.canvas.height])if(isNaN(c)||c<=0)return!0;return!1}},custom:class extends i.E{constructor(c,r,s,h){super(),this.id=c,this.type="custom",this._dataType="raster",this._dispatcher=s,this._implementation=r,this.setEventedParent(h),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.a(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.a(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new xe(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),i.e(this,i.ac(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.ac(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.b("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(c){this._map=c,this._loaded=!1,this.fire(new i.b("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(c),this.load()}onRemove(c){this._implementation.onRemove&&this._implementation.onRemove(c)}hasTile(c){if(this._implementation.hasTile){const{x:r,y:s,z:h}=c.canonical;return this._implementation.hasTile({x:r,y:s,z:h})}return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c,r){const{x:s,y:h,z:p}=c.tileID.canonical,y=new AbortController;c.request=Promise.resolve(this._implementation.loadTile({x:s,y:h,z:p},{signal:y.signal})).then((function(w){return delete c.request,c.aborted?(c.state="unloaded",r(null)):w===void 0?(c.state="errored",r(null)):w===null?(this.loadTileData(c,{width:this.tileSize,height:this.tileSize,data:null}),c.state="loaded",r(null)):function(M){return M instanceof ImageData||M instanceof HTMLCanvasElement||M instanceof ImageBitmap||M instanceof HTMLImageElement}(w)?(this.loadTileData(c,w),c.state="loaded",void r(null)):(c.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(w=>{w.code!==20&&(c.state="errored",r(w))}),c.request.cancel=()=>y.abort()}loadTileData(c,r){c.setTexture(r,this._map.painter)}unloadTile(c,r){if(c.texture&&c.texture instanceof i.T?(c.destroy(!0),c.texture&&c.texture instanceof i.T&&this._map.painter.saveTileTexture(c.texture)):c.destroy(),this._implementation.unloadTile){const{x:s,y:h,z:p}=c.tileID.canonical;this._implementation.unloadTile({x:s,y:h,z:p})}r()}abortTile(c,r){c.request&&c.request.cancel&&(c.request.cancel(),delete c.request),r()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(c=>({x:c.canonical.x,y:c.canonical.y,z:c.canonical.z}))}_clearTiles(){const c=i.ag(this.id,this.scope);this._map.style.clearSource(c)}_update(){this.fire(new i.b("data",{dataType:"source",sourceDataType:"content"}))}}},xi=function(c,r,s,h){const p=new Es[r.type](c,r,s,h);if(p.id!==c)throw new Error(`Expected Source id to be ${c} instead of ${p.id}`);return i.aY(["load","abort","unload","serialize","prepare"],p),p};function Kc(c,r){const s=i.a6.identity([]);return i.a6.scale(s,s,[.5*c.width,.5*-c.height,1]),i.a6.translate(s,s,[1,-1,0]),i.a6.multiply(s,s,c.calculateProjMatrix(r.toUnwrapped())),Float32Array.from(s)}function Jc(c,r,s,h,p,y,w,M=!1){const C=c.tilesIn(h,w,M);C.sort($a);const k=[];for(const B of C)k.push({wrappedTileID:B.tile.tileID.wrapped().key,queryResults:B.tile.queryRenderedFeatures(r,s,c._state,B,p,y,Kc(c.transform,B.tile.tileID),M)});const z=function(B){const $={},H={};for(const K of B){const X=K.queryResults,Q=K.wrappedTileID,Z=H[Q]=H[Q]||{};for(const ie in X){const he=X[ie],se=Z[ie]=Z[ie]||{},de=$[ie]=$[ie]||[];for(const ne of he)se[ne.featureIndex]||(se[ne.featureIndex]=!0,de.push(ne))}}return $}(k);for(const B in z)z[B].forEach($=>{const H=$.feature,K=H.layer;K&&K.type!=="background"&&K.type!=="sky"&&K.type!=="slot"&&(H.source=K.source,K["source-layer"]&&(H.sourceLayer=K["source-layer"]),H.state=H.id!==void 0?c.getFeatureState(K["source-layer"],H.id):{})});return z}function Ss(c,r){const s=c.getRenderableIds().map(y=>c.getTileByID(y)),h=[],p={};for(let y=0;y<s.length;y++){const w=s[y],M=w.tileID.canonical.key;p[M]||(p[M]=!0,w.querySourceFeatures(h,r))}return h}function $a(c,r){const s=c.tileID,h=r.tileID;return s.overscaledZ-h.overscaledZ||s.canonical.y-h.canonical.y||s.wrap-h.wrap||s.canonical.x-h.canonical.x}class pa extends Zs{constructor(r,s,h,p,y){super(r,s,h,p,y),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(r,s){const h=s.context,p=h.gl;this.texture=this.texture||s.getTileTexture(r.width),this.texture&&this.texture instanceof i.T?this.texture.update(r,{useMipmap:!1,premultiply:!1}):this.texture=new i.T(h,r,p.RGBA,{useMipmap:!1,premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(r=16384,s){const h=this._mrt=new i.aZ(30),p=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(r-1)}});return this.entireBuffer=null,this.request=i.a_(p,(y,w,M,C)=>{if(y)s(y);else try{const k=h.getHeaderLength(w);if(k>r)return void(this.request=this.fetchHeader(k,s));h.parseHeader(w),this._isHeaderLoaded=!0;let z=0;for(const B of Object.values(h.layers))z=Math.max(z,B.dataIndex[B.dataIndex.length-1].last_byte);w.byteLength>=z&&(this.entireBuffer=w),s(null,this.entireBuffer||w,M,C)}catch(k){s(k)}}),this.request}fetchBand(r,s,h){const p=this._mrt;if(!this._isHeaderLoaded||!p)return void h(new Error("Tile header is not ready"));const y=this.actor;if(!y)return void h(new Error("Can't fetch tile band without an actor"));let w;const M=(B,$)=>{w.complete(B,$),B?h(B):(this.updateTextureDescriptor(r,s),h(null,this.textureDescriptor&&this.textureDescriptor.img))},C=(B,$)=>{if(B)return h(B);const H=y.send("decodeRasterArray",{buffer:$,task:w},M,void 0,!0);this._workQueue.push(()=>{H&&H.cancel(),w.cancel()})},k=p.getLayer(r);if(!k)return void h(new Error(`Unknown sourceLayer "${r}"`));if(k.hasDataForBand(s))return this.updateTextureDescriptor(r,s),void h(null,this.textureDescriptor?this.textureDescriptor.img:null);const z=k.getDataRange([s]);if(w=p.createDecodingTask(z),!w||w.tasks.length)if(this.flushQueues(),this.entireBuffer)C(null,this.entireBuffer.slice(z.firstByte,z.lastByte+1));else{const B=Object.assign({},this.requestParams,{headers:{Range:`bytes=${z.firstByte}-${z.lastByte}`}}),$=i.a_(B,C);this._fetchQueue.push(()=>{$.cancel(),w.cancel()})}else h(null)}updateNeeded(r,s){return(!this.textureDescriptor||this.textureDescriptor.band!==s||this.textureDescriptor.layer!==r)&&this.state!=="errored"}updateTextureDescriptor(r,s){if(!this._mrt)return;const h=this._mrt.getLayer(r);if(!h||!h.hasBand(s)||!h.hasDataForBand(s))return;const{bytes:p,tileSize:y,buffer:w,offset:M,scale:C}=h.getBandView(s),k=y+2*w,z={data:p,width:k,height:k},B=this.texture;B&&B instanceof i.T&&B.update(z,{useMipmap:!1,premultiply:!1}),this.textureDescriptor={layer:r,band:s,img:z,buffer:w,offset:M,tileSize:y,format:h.pixelFormat,mix:[C,256*C,65536*C,16777216*C]}}}class ma{constructor(r,s){this.max=r,this.onRemove=s,this.reset()}reset(){for(const r in this.data)for(const s of this.data[r])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(r,s,h){const p=r.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);const y={value:s,timeout:void 0};if(h!==void 0&&(y.timeout=setTimeout(()=>{this.remove(r,y)},h)),this.data[p].push(y),this.order.push(p),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const s=this.data[r].shift();return s.timeout&&clearTimeout(s.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),s.value}getByKey(r){const s=this.data[r];return s?s[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,s){if(!this.has(r))return this;const h=r.wrapped().key,p=s===void 0?0:this.data[h].indexOf(s),y=this.data[h][p];return this.data[h].splice(p,1),y.timeout&&clearTimeout(y.timeout),this.data[h].length===0&&delete this.data[h],this.onRemove(y.value),this.order.splice(this.order.indexOf(h),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(r){const s=[];for(const h in this.data)for(const p of this.data[h])r(p.value)||s.push(p);for(const h of s)this.remove(h.value.tileID,h)}}class Oo extends i.E{constructor(r,s,h){super(),this.id=r,this._onlySymbols=h,s.on("data",p=>{p.dataType==="source"&&p.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&p.dataType==="source"&&p.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),s.on("error",()=>{this._sourceErrored=!0}),this._source=s,this._tiles={},this._cache=new ma(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=s.minTileCacheSize,this._maxTileCacheSize=s.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Oe,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(r){this.map=r,this._minTileCacheSize=this._minTileCacheSize===void 0&&r?r._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&r?r._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles){const s=this._tiles[r];if(s.state!=="errored"&&(s.state!=="loaded"||!s.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(r,s){return r.isSymbolTile=this._onlySymbols,r.isExtraShadowCaster=this._shadowCasterTiles[r.tileID.key],this._source.loadTile(r,s)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r,()=>{})}_abortTile(r){if(this._source.abortTile)return this._source.abortTile(r,()=>{})}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const h=this._tiles[s];h.upload(r),h.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return i.a$(this._tiles).map(r=>r.tileID).sort(tc).map(r=>r.key)}getRenderableIds(r,s){const h=[];for(const p in this._tiles)this._isIdRenderable(+p,r,s)&&h.push(this._tiles[p]);return r?h.sort((p,y)=>{const w=p.tileID,M=y.tileID,C=new i.P(w.canonical.x,w.canonical.y)._rotate(this.transform.angle),k=new i.P(M.canonical.x,M.canonical.y)._rotate(this.transform.angle);return w.overscaledZ-M.overscaledZ||k.y-C.y||k.x-C.x}).map(p=>p.tileID.key):h.map(p=>p.tileID).sort(tc).map(p=>p.key)}hasRenderableParent(r){const s=this.findLoadedParent(r,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(r,s,h){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(s||!this._tiles[r].holdingForFade())&&(h||!this._shadowCasterTiles[r])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(+r,"reloading")}}_reloadTile(r,s){const h=this._tiles[r];h&&(h.state!=="loading"&&(h.state=s),this._loadTile(h,this._tileLoaded.bind(this,h,r,s)))}_tileLoaded(r,s,h,p){if(p)if(r.state="errored",p.status!==404)this._source.fire(new i.a(p,{tile:r}));else{if(!(r.tileID.key in this._loadedParentTiles))return void this._source.fire(new i.b("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id}));if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const y=this.map.painter.terrain;this.update(this.transform,y.getScaledDemTileSize(),!0),y.resetTileLookupCache(this.id)}else this.update(this.transform)}else r.timeAdded=i.f.now(),h==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(s,r),this._source.type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),this._source.fire(new i.b("data",{dataType:"source",tile:r,coord:r.tileID,sourceCacheId:this.id}))}_backfillDEM(r){const s=this.getRenderableIds();for(let p=0;p<s.length;p++){const y=s[p];if(r.neighboringTiles&&r.neighboringTiles[y]){const w=this.getTileByID(y);h(r,w),h(w,r)}}function h(p,y){if(!p.dem||p.dem.borderReady)return;p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0;let w=y.tileID.canonical.x-p.tileID.canonical.x;const M=y.tileID.canonical.y-p.tileID.canonical.y,C=Math.pow(2,p.tileID.canonical.z),k=y.tileID.key;w===0&&M===0||Math.abs(M)>1||(Math.abs(w)>1&&(Math.abs(w+C)===1?w+=C:Math.abs(w-C)===1&&(w-=C)),y.dem&&p.dem&&(p.dem.backfillBorder(y.dem,w,M),p.neighboringTiles&&p.neighboringTiles[k]&&(p.neighboringTiles[k].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,s,h,p){for(const y in this._tiles){let w=this._tiles[y];if(p[y]||!w.hasData()||w.tileID.overscaledZ<=s||w.tileID.overscaledZ>h)continue;let M=w.tileID;for(;w&&w.tileID.overscaledZ>s+1;){const k=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[k.key],w&&w.hasData()&&(M=k)}let C=M;for(;C.overscaledZ>s;)if(C=C.scaledTo(C.overscaledZ-1),r[C.key]){p[M.key]=M;break}}}findLoadedParent(r,s){if(r.key in this._loadedParentTiles){const h=this._loadedParentTiles[r.key];return h&&h.tileID.overscaledZ>=s?h:null}for(let h=r.overscaledZ-1;h>=s;h--){const p=r.scaledTo(h),y=this._getLoadedTile(p);if(y)return y}}_getLoadedTile(r){const s=this._tiles[r.key];return s&&s.hasData()?s:this._cache.getByKey(this._source.reparseOverscaled?r.wrapped().key:r.canonical.key)}updateCacheSize(r,s){s=s||this._source.tileSize;const h=Math.ceil(r.width/s)+1,p=Math.ceil(r.height/s)+1,y=Math.floor(h*p*5),w=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,y):y,M=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(M)}handleWrapJump(r){const s=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,s){const h={};for(const p in this._tiles){const y=this._tiles[p];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+s),h[y.tileID.key]=y}this._tiles=h;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(+p,this._tiles[p])}}update(r,s,h,p){if(this.transform=r,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!h)return;let y;if(this.updateCacheSize(r,s),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain)if(this._source.tileID)y=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(C=>new i.am(C.canonical.z,C.wrap,C.canonical.z,C.canonical.x,C.canonical.y));else if(this.tileCoverLift!==0){const C=r.clone();C.tileCoverLift=this.tileCoverLift,y=C.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!h,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.minzoom<=1&&r.projection.name==="globe"&&(y.push(new i.am(1,0,1,0,0)),y.push(new i.am(1,0,1,1,0)),y.push(new i.am(1,0,1,0,1)),y.push(new i.am(1,0,1,1,1)))}else y=r.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!h,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(y=y.filter(C=>this._source.hasTile(C)));else y=[];if(y.length>0&&this.castsShadows&&p&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Ms(this._source.type)){const C=r.coveringZoomLevel({tileSize:s||this._source.tileSize,roundZoom:this._source.roundZoom&&!h}),k=Math.min(C,this._source.maxzoom),z=r.extendTileCoverForShadows(y,p,k);for(const B of z)this._shadowCasterTiles[B.key]=!0,y.push(B)}const w=this._updateRetainedTiles(y);if(Ms(this._source.type)&&y.length!==0){const C={},k={},z=Object.keys(w);for(const $ of z){const H=w[$],K=this._tiles[$];if(!K||K.fadeEndTime&&K.fadeEndTime<=i.f.now())continue;const X=this.findLoadedParent(H,Math.max(H.overscaledZ-Oo.maxOverzooming,this._source.minzoom));X&&(this._addTile(X.tileID),C[X.tileID.key]=X.tileID),k[$]=H}const B=y[y.length-1].overscaledZ;for(const $ in this._tiles){const H=this._tiles[$];if(w[$]||!H.hasData())continue;let K=H.tileID;for(;K.overscaledZ>B;){K=K.scaledTo(K.overscaledZ-1);const X=this._tiles[K.key];if(X&&X.hasData()&&k[K.key]){w[$]=H.tileID;break}}}for(const $ in C)w[$]||(this._coveredTiles[$]=!0,w[$]=C[$])}for(const C in w)this._tiles[C].clearFadeHold();const M=i.b0(this._tiles,w);for(const C of M){const k=this._tiles[C];k.hasSymbolBuckets&&!k.holdingForFade()?k.setHoldDuration(this.map._fadeDuration):k.hasSymbolBuckets&&!k.symbolFadeFinished()||this._removeTile(+C)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(+r)}_updateRetainedTiles(r){const s={};if(r.length===0)return s;const h={},p=r.reduce((k,z)=>Math.min(k,z.overscaledZ),1/0),y=r[0].overscaledZ,w=Math.max(y-Oo.maxOverzooming,this._source.minzoom),M=Math.max(y+Oo.maxUnderzooming,this._source.minzoom),C={};for(const k of r){const z=this._addTile(k);s[k.key]=k,z.hasData()||p<this._source.maxzoom&&(C[k.key]=k)}this._retainLoadedChildren(C,p,M,s);for(const k of r){let z=this._tiles[k.key];if(z.hasData())continue;if(k.canonical.z>=this._source.maxzoom){const $=k.children(this._source.maxzoom)[0],H=this.getTile($);if(H&&H.hasData()){s[$.key]=$;continue}}else{const $=k.children(this._source.maxzoom);if(s[$[0].key]&&s[$[1].key]&&s[$[2].key]&&s[$[3].key])continue}let B=z.wasRequested();for(let $=k.overscaledZ-1;$>=w;--$){const H=k.scaledTo($);if(h[H.key]||(h[H.key]=!0,z=this.getTile(H),!z&&B&&(z=this._addTile(H)),z&&(s[H.key]=H,B=z.wasRequested(),z.hasData())))break}}return s}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const s=[];let h,p=this._tiles[r].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){h=this._loadedParentTiles[p.key];break}s.push(p.key);const y=p.scaledTo(p.overscaledZ-1);if(h=this._getLoadedTile(y),h)break;p=y}for(const y of s)this._loadedParentTiles[y]=h}}_addTile(r){let s=this._tiles[r.key];if(s)return s.isExtraShadowCaster!==!0||this._shadowCasterTiles[r.key]||this._reloadTile(r.key,"reloading"),s;s=this._cache.getAndRemove(r),s&&(this._setTileReloadTimer(r.key,s),s.tileID=r,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,s)));const h=!!s;if(!h){const p=this.map?this.map.painter:null,y=this._source.tileSize*r.overscaleFactor();s=this._source.type==="raster-array"?new pa(r,y,this.transform.tileZoom,p,this._isRaster):new Zs(r,y,this.transform.tileZoom,p,this._isRaster),this._loadTile(s,this._tileLoaded.bind(this,s,r.key,s.state))}return s?(s.uses++,this._tiles[r.key]=s,h||this._source.fire(new i.b("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s):null}_setTileReloadTimer(r,s){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const h=s.getExpiryTimeout();h&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},h))}_removeTile(r){const s=this._tiles[r];s&&(s.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),s.uses>0||(s.hasData()&&s.state!=="reloading"||s.state==="empty"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(+r);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(r,s,h){const p=[],y=this.transform;if(!y)return p;const w=y.projection.name==="globe",M=i.a5(y.center.lng);for(const C in this._tiles){const k=this._tiles[C];if(h&&k.clearQueryDebugViz(),k.holdingForFade())continue;let z;if(w){const B=k.tileID.canonical;if(B.z===0){const $=[Math.abs(i.aa(M,...gl(B,-1))-M),Math.abs(i.aa(M,...gl(B,1))-M)];z=[0,2*$.indexOf(Math.min(...$))-1]}else{const $=[Math.abs(i.aa(M,...gl(B,-1))-M),Math.abs(i.aa(M,...gl(B,0))-M),Math.abs(i.aa(M,...gl(B,1))-M)];z=[$.indexOf(Math.min(...$))-1]}}else z=[0];for(const B of z){const $=r.containsTile(k,y,s,B);$&&p.push($)}}return p}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(r){return this._getRenderableCoordinates(r)}_getRenderableCoordinates(r,s){const h=this.getRenderableIds(r,s).map(y=>this._tiles[y].tileID),p=this.transform.projection.name==="globe";for(const y of h)y.projMatrix=this.transform.calculateProjMatrix(y.toUnwrapped()),y.expandedProjMatrix=p?this.transform.calculateProjMatrix(y.toUnwrapped(),!1,!0):y.projMatrix;return h}sortCoordinatesByDistance(r){const s=r.slice(),h=this.transform._camera.position,p=this.transform._camera.forward(),y={};for(const w of s){const M=1/(1<<w.canonical.z);y[w.key]=((w.canonical.x+.5)*M+w.wrap-h[0])*p[0]+((w.canonical.y+.5)*M-h[1])*p[1]-h[2]*p[2]}return s.sort((w,M)=>y[w.key]-y[M.key]),s}hasTransition(){if(this._source.hasTransition())return!0;if(Ms(this._source.type))for(const r in this._tiles){const s=this._tiles[r];if(s.fadeEndTime!==void 0&&s.fadeEndTime>=i.f.now())return!0}return!1}setFeatureState(r,s,h){this._state.updateState(r=r||"_geojsonTileLayer",s,h)}removeFeatureState(r,s,h){this._state.removeFeatureState(r=r||"_geojsonTileLayer",s,h)}getFeatureState(r,s){return this._state.getState(r=r||"_geojsonTileLayer",s)}setDependencies(r,s,h){const p=this._tiles[r];p&&p.setDependencies(s,h)}reloadTilesForDependencies(r,s){for(const h in this._tiles)this._tiles[h].hasDependency(r,s)&&this._reloadTile(+h,"reloading");this._cache.filter(h=>!h.hasDependency(r,s))}_preloadTiles(r,s){if(!this._sourceLoaded){const C=()=>{this._sourceLoaded&&(this._source.off("data",C),this._preloadTiles(r,s))};return void this._source.on("data",C)}const h=new Map,p=Array.isArray(r)?r:[r],y=this.map.painter.terrain,w=this.usedForTerrain&&y?y.getScaledDemTileSize():this._source.tileSize;for(const C of p){const k=C.coveringTiles({tileSize:w,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const z of k)h.set(z.key,z);this.usedForTerrain&&C.updateElevation(!1)}const M=Array.from(h.values());i.b1(M,(C,k)=>{const z=new Zs(C,this._source.tileSize*C.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(z,B=>{this._source.type==="raster-dem"&&z.dem&&this._backfillDEM(z),k(B,z)})},s)}}function tc(c,r){const s=Math.abs(2*c.wrap)-+(c.wrap<0),h=Math.abs(2*r.wrap)-+(r.wrap<0);return c.overscaledZ-r.overscaledZ||h-s||r.canonical.y-c.canonical.y||r.canonical.x-c.canonical.x}function Ms(c){return c==="raster"||c==="image"||c==="video"||c==="custom"}function gl(c,r){const s=1<<c.z;return[c.x/s+r,(c.x+1)/s+r]}Oo.maxOverzooming=10,Oo.maxUnderzooming=3;class Qc{constructor(r){this.style=r,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const r=!1,s=!1;for(const h in this.style._mergedLayers){const p=this.style._mergedLayers[h];if(p.type==="fill-extrusion")this.layers.push({layer:p,visible:r,visibilityChanged:s});else if(p.type==="model"){const y=this.style.getLayerSource(p);y&&y.type==="batched-model"&&this.layers.push({layer:p,visible:r,visibilityChanged:s})}}}onNewFrame(r){this.layersGotHidden=!1;for(const s of this.layers){const h=s.layer;let p=!1;h.type==="fill-extrusion"?p=!h.isHidden(r)&&h.paint.get("fill-extrusion-opacity")>0:h.type==="model"&&(p=!h.isHidden(r)&&h.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!p&&s.visible,s.visible=p}}updateZOffset(r,s){this.currentBuildingBuckets=[];for(const p of this.layers){const y=p.layer,w=this.style.getLayerSourceCache(y);let M=1;y.type==="fill-extrusion"&&(M=p.visible?y.paint.get("fill-extrusion-vertical-scale"):0);let C=w?w.getTile(s):null;if(!C&&w&&s.canonical.z>w.getSource().minzoom){let k=s.scaledTo(Math.min(w.getSource().maxzoom,s.overscaledZ-1));for(;k.overscaledZ>=w.getSource().minzoom&&(C=w.getTile(k),!C&&k.overscaledZ!==0);)k=k.scaledTo(k.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:C?C.getBucket(y):null,tileID:C?C.tileID:s,verticalScale:M})}r.hasAnyZOffset=!1;let h=!1;for(let p=0;p<r.symbolInstances.length;p++){const y=r.symbolInstances.get(p),w=y.zOffset,M=this._getHeightAtTileOffset(s,y.tileAnchorX,y.tileAnchorY);y.zOffset=M!==Number.NEGATIVE_INFINITY?M:w,h||w===y.zOffset||(h=!0),r.hasAnyZOffset||y.zOffset===0||(r.hasAnyZOffset=!0)}h&&(r.zOffsetBuffersNeedUpload=!0,r.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(r,s,h,p){let y=s,w=h;if(r.canonical.z!==p.canonical.z){const M=p.canonical,C=1/(1<<r.canonical.z-M.z);y=(s+r.canonical.x*i.V)*C-M.x*i.V|0,w=(h+r.canonical.y*i.V)*C-M.y*i.V|0}return{tileX:y,tileY:w}}_getHeightAtTileOffset(r,s,h){let p,y;for(let w=0;w<this.layers.length;++w){if(this.layers[w].layer.type!=="fill-extrusion")continue;const{bucket:M,tileID:C,verticalScale:k}=this.currentBuildingBuckets[w];if(!M)continue;const{tileX:z,tileY:B}=this._mapCoordToOverlappingTile(r,s,h,C),$=M.getHeightAtTileCoord(z,B);$&&$.height!==void 0&&($.hidden?p=$.height:y=Math.max($.height*k,y||0))}if(y!==void 0)return y;for(let w=0;w<this.layers.length;++w){const M=this.layers[w];if(M.layer.type!=="model"||!M.visible)continue;const{bucket:C,tileID:k}=this.currentBuildingBuckets[w];if(!C)continue;const{tileX:z,tileY:B}=this._mapCoordToOverlappingTile(r,s,h,k),$=C.getHeightAtTileCoord(z,B);if($&&!$.hidden)return $.height===void 0&&p!==void 0?Math.min($.maxHeight,p)*$.verticalScale:($.height||0)*$.verticalScale}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function As(c,r){const s={};for(const h in c)h!=="ref"&&(s[h]=c[h]);return i.b2.forEach(h=>{h in r&&(s[h]=r[h])}),s}function nc(c){c=c.slice();const r=Object.create(null);for(let s=0;s<c.length;s++)r[c[s].id]=c[s];for(let s=0;s<c.length;s++)"ref"in c[s]&&(c[s]=As(c[s],r[c[s].ref]));return c}const lr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function yl(c,r,s){s.push({command:lr.addSource,args:[c,r[c]]})}function Ga(c,r,s){r.push({command:lr.removeSource,args:[c]}),s[c]=!0}function Dd(c,r,s,h){Ga(c,s,h),yl(c,r,s)}function kd(c,r,s){let h;for(h in c[s])if(c[s].hasOwnProperty(h)&&h!=="data"&&!P(c[s][h],r[s][h]))return!1;for(h in r[s])if(r[s].hasOwnProperty(h)&&h!=="data"&&!P(c[s][h],r[s][h]))return!1;return!0}function Ys(c,r,s,h,p,y){let w;for(w in r=r||{},c=c||{})c.hasOwnProperty(w)&&(P(c[w],r[w])||s.push({command:y,args:[h,w,r[w],p]}));for(w in r)r.hasOwnProperty(w)&&!c.hasOwnProperty(w)&&(P(c[w],r[w])||s.push({command:y,args:[h,w,r[w],p]}))}function Xs(c){return c.id}function rc(c,r){return c[r.id]=r,c}class Ha{constructor(r,s){this.reset(r,s)}reset(r,s){this.points=r||[],this._distances=[0];for(let h=1;h<this.points.length;h++)this._distances[h]=this._distances[h-1]+this.points[h].dist(this.points[h-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=i.aa(r,0,1);let s=1,h=this._distances[s];const p=r*this.paddedLength+this.padding;for(;h<p&&s<this._distances.length;)h=this._distances[++s];const y=s-1,w=this._distances[y],M=h-w,C=M>0?(p-w)/M:0;return this.points[y].mult(1-C).add(this.points[s].mult(C))}}class eu{constructor(r,s,h){const p=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(r/h),this.yCellCount=Math.ceil(s/h);for(let w=0;w<this.xCellCount*this.yCellCount;w++)p.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=s,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,s,h,p,y){this._forEachCell(s,h,p,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(s),this.bboxes.push(h),this.bboxes.push(p),this.bboxes.push(y)}insertCircle(r,s,h,p){this._forEachCell(s-p,h-p,s+p,h+p,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(s),this.circles.push(h),this.circles.push(p)}_insertBoxCell(r,s,h,p,y,w){this.boxCells[y].push(w)}_insertCircleCell(r,s,h,p,y,w){this.circleCells[y].push(w)}_query(r,s,h,p,y,w){if(h<0||r>this.width||p<0||s>this.height)return!y&&[];const M=[];if(r<=0&&s<=0&&this.width<=h&&this.height<=p){if(y)return!0;for(let C=0;C<this.boxKeys.length;C++)M.push({key:this.boxKeys[C],x1:this.bboxes[4*C],y1:this.bboxes[4*C+1],x2:this.bboxes[4*C+2],y2:this.bboxes[4*C+3]});for(let C=0;C<this.circleKeys.length;C++){const k=this.circles[3*C],z=this.circles[3*C+1],B=this.circles[3*C+2];M.push({key:this.circleKeys[C],x1:k-B,y1:z-B,x2:k+B,y2:z+B})}return w?M.filter(w):M}return this._forEachCell(r,s,h,p,this._queryCell,M,{hitTest:y,seenUids:{box:{},circle:{}}},w),y?M.length>0:M}_queryCircle(r,s,h,p,y){const w=r-h,M=r+h,C=s-h,k=s+h;if(M<0||w>this.width||k<0||C>this.height)return!p&&[];const z=[];return this._forEachCell(w,C,M,k,this._queryCellCircle,z,{hitTest:p,circle:{x:r,y:s,radius:h},seenUids:{box:{},circle:{}}},y),p?z.length>0:z}query(r,s,h,p,y){return this._query(r,s,h,p,!1,y)}hitTest(r,s,h,p,y){return this._query(r,s,h,p,!0,y)}hitTestCircle(r,s,h,p){return this._queryCircle(r,s,h,!0,p)}_queryCell(r,s,h,p,y,w,M,C){const k=M.seenUids,z=this.boxCells[y];if(z!==null){const $=this.bboxes;for(const H of z)if(!k.box[H]){k.box[H]=!0;const K=4*H;if(r<=$[K+2]&&s<=$[K+3]&&h>=$[K+0]&&p>=$[K+1]&&(!C||C(this.boxKeys[H]))){if(M.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[H],x1:$[K],y1:$[K+1],x2:$[K+2],y2:$[K+3]})}}}const B=this.circleCells[y];if(B!==null){const $=this.circles;for(const H of B)if(!k.circle[H]){k.circle[H]=!0;const K=3*H;if(this._circleAndRectCollide($[K],$[K+1],$[K+2],r,s,h,p)&&(!C||C(this.circleKeys[H]))){if(M.hitTest)return w.push(!0),!0;{const X=$[K],Q=$[K+1],Z=$[K+2];w.push({key:this.circleKeys[H],x1:X-Z,y1:Q-Z,x2:X+Z,y2:Q+Z})}}}}}_queryCellCircle(r,s,h,p,y,w,M,C){const k=M.circle,z=M.seenUids,B=this.boxCells[y];if(B!==null){const H=this.bboxes;for(const K of B)if(!z.box[K]){z.box[K]=!0;const X=4*K;if(this._circleAndRectCollide(k.x,k.y,k.radius,H[X+0],H[X+1],H[X+2],H[X+3])&&(!C||C(this.boxKeys[K])))return w.push(!0),!0}}const $=this.circleCells[y];if($!==null){const H=this.circles;for(const K of $)if(!z.circle[K]){z.circle[K]=!0;const X=3*K;if(this._circlesCollide(H[X],H[X+1],H[X+2],k.x,k.y,k.radius)&&(!C||C(this.circleKeys[K])))return w.push(!0),!0}}}_forEachCell(r,s,h,p,y,w,M,C){const k=this._convertToXCellCoord(r),z=this._convertToYCellCoord(s),B=this._convertToXCellCoord(h),$=this._convertToYCellCoord(p);for(let H=k;H<=B;H++)for(let K=z;K<=$;K++)if(y.call(this,r,s,h,p,this.xCellCount*K+H,w,M,C))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,s,h,p,y,w){const M=p-r,C=y-s,k=h+w;return k*k>M*M+C*C}_circleAndRectCollide(r,s,h,p,y,w,M){const C=(w-p)/2,k=Math.abs(r-(p+C));if(k>C+h)return!1;const z=(M-y)/2,B=Math.abs(s-(y+z));if(B>z+h)return!1;if(k<=C||B<=z)return!0;const $=k-C,H=B-z;return $*$+H*H<=h*h}}const Is={unknown:0,flipRequired:1,flipNotRequired:2},Ks=Math.tan(85*Math.PI/180);function vl(c,r,s,h,p,y,w){const M=i.a6.create();if(s)if(y.name==="globe"){const C=i.b3(p,r);i.a6.multiply(M,M,C)}else{const C=i.b4.invert([],w);M[0]=C[0],M[1]=C[1],M[4]=C[2],M[5]=C[3],h||i.a6.rotateZ(M,M,p.angle)}else i.a6.multiply(M,p.labelPlaneMatrix,c);return M}function tu(c,r,s,h,p,y,w){const M=vl(c,r,s,h,p,y,w);return y.name==="globe"&&s||(M[2]=M[6]=M[10]=M[14]=0),M}function nu(c,r,s,h,p,y,w){if(s){if(y.name==="globe"){const M=vl(c,r,s,h,p,y,w);return i.a6.invert(M,M),i.a6.multiply(M,c,M),M}{const M=i.a6.clone(c),C=i.a6.identity([]);return C[0]=w[0],C[1]=w[1],C[4]=w[2],C[5]=w[3],i.a6.multiply(M,M,C),h||i.a6.rotateZ(M,M,-p.angle),M}}return p.glCoordMatrix}function Vo(c,r,s,h){const p=[c,r,s,1];s?i.a7.transformMat4(p,p,h):lu(p,p,h);const y=p[3];return p[0]/=y,p[1]/=y,p[2]/=y,p}function xh(c,r){return Math.min(.5+c/r*.5,1.5)}function ru(c,r){const s=c[0]/c[3],h=c[1]/c[3];return s>=-r[0]&&s<=r[0]&&h>=-r[1]&&h<=r[1]}function iu(c,r,s,h,p,y,w,M,C,k){const z=s.transform,B=h?c.textSizeData:c.iconSizeData,$=i.b5(B,s.transform.zoom),H=z.projection.name==="globe",K=[256/s.width*2+1,256/s.height*2+1],X=h?c.text.dynamicLayoutVertexArray:c.icon.dynamicLayoutVertexArray;X.clear();let Q=null;H&&(Q=h?c.text.globeExtVertexArray:c.icon.globeExtVertexArray);const Z=c.lineVertexArray,ie=h?c.text.placedSymbolArray:c.icon.placedSymbolArray,he=s.transform.width/s.transform.height;let se,de=!1;for(let ne=0;ne<ie.length;ne++){const pe=ie.get(ne),{numGlyphs:Se,writingMode:Ae}=pe;if(Ae!==i.b6.vertical||de||se===i.b6.horizontal||(de=!0),se=Ae,(pe.hidden||Ae===i.b6.vertical)&&!de){Js(Se,X);continue}de=!1;const Le=new i.P(pe.tileAnchorX,pe.tileAnchorY);let{x:et,y:je,z:dt}=z.projection.projectTilePoint(Le.x,Le.y,k.canonical);if(C){const[Xt,un,vn]=C(Le);et+=Xt,je+=un,dt+=vn}const at=[et,je,dt,1];if(i.a7.transformMat4(at,at,r),!ru(at,K)){Js(Se,X);continue}const At=at[3],$e=xh(s.transform.getCameraToCenterDistance(z.projection),At),ot=i.b7(B,$,pe),ke=w?ot/$e:ot*$e,Ze=Vo(et,je,dt,p);if(Ze[3]<=0){Js(Se,X);continue}let Pt={};const Bt=w?null:C,Ft=au(pe,ke,!1,M,r,p,y,c.glyphOffsetArray,Z,X,Q,Ze,Le,Pt,he,Bt,z.projection,k,w);de=Ft.useVertical,Bt&&Ft.needsFlipping&&(Pt={}),(Ft.notEnoughRoom||de||Ft.needsFlipping&&au(pe,ke,!0,M,r,p,y,c.glyphOffsetArray,Z,X,Q,Ze,Le,Pt,he,Bt,z.projection,k,w).notEnoughRoom)&&Js(Se,X)}h?(c.text.dynamicLayoutVertexBuffer.updateData(X),Q&&c.text.globeExtVertexBuffer&&c.text.globeExtVertexBuffer.updateData(Q)):(c.icon.dynamicLayoutVertexBuffer.updateData(X),Q&&c.icon.globeExtVertexBuffer&&c.icon.globeExtVertexBuffer.updateData(Q))}function ou(c,r,s,h,p,y,w,M,C,k,z,B,$,H,K,X){const{lineStartIndex:Q,glyphStartIndex:Z,segment:ie}=M,he=Z+M.numGlyphs,se=Q+M.lineLength,de=r.getoffsetX(Z),ne=r.getoffsetX(he-1),pe=xl(c*de,s,h,p,y,w,ie,Q,se,C,k,z,B,$,!0,H,K,X);if(!pe)return null;const Se=xl(c*ne,s,h,p,y,w,ie,Q,se,C,k,z,B,$,!0,H,K,X);return Se?{first:pe,last:Se}:null}function su(c,r,s,h){return c===i.b6.horizontal&&Math.abs(h)>Math.abs(s)?{useVertical:!0}:c===i.b6.vertical?h>0?{needsFlipping:!0}:null:r!==Is.unknown&&function(p,y){return p===0||Math.abs(y/p)>Ks}(s,h)?r===Is.flipRequired?{needsFlipping:!0}:null:s<0?{needsFlipping:!0}:null}function au(c,r,s,h,p,y,w,M,C,k,z,B,$,H,K,X,Q,Z,ie){const he=r/24,se=c.lineOffsetX*he,de=c.lineOffsetY*he,{lineStartIndex:ne,glyphStartIndex:pe,numGlyphs:Se,segment:Ae,writingMode:Le,flipState:et}=c,je=ne+c.lineLength,dt=at=>{if(z){const[ke,Ze,Pt]=at.up,Bt=k.length;i.b8(z,Bt+0,ke,Ze,Pt),i.b8(z,Bt+1,ke,Ze,Pt),i.b8(z,Bt+2,ke,Ze,Pt),i.b8(z,Bt+3,ke,Ze,Pt)}const[At,$e,ot]=at.point;i.b9(k,At,$e,ot,at.angle)};if(Se>1){const at=ou(he,M,se,de,s,B,$,c,C,y,H,X,!1,Q,Z,ie);if(!at)return{notEnoughRoom:!0};if(h&&!s){let[At,$e,ot]=at.first.point,[ke,Ze,Pt]=at.last.point;[At,$e]=Vo(At,$e,ot,w),[ke,Ze]=Vo(ke,Ze,Pt,w);const Bt=su(Le,et,(ke-At)*K,Ze-$e);if(c.flipState=Bt&&Bt.needsFlipping?Is.flipRequired:Is.flipNotRequired,Bt)return Bt}dt(at.first);for(let At=pe+1;At<pe+Se-1;At++){const $e=xl(he*M.getoffsetX(At),se,de,s,B,$,Ae,ne,je,C,y,H,X,!1,!1,Q,Z,ie);if(!$e)return k.length-=4*(At-pe),{notEnoughRoom:!0};dt($e)}dt(at.last)}else{if(h&&!s){const At=Vo($.x,$.y,0,p),$e=ne+Ae+1,ot=new i.P(C.getx($e),C.gety($e)),ke=Vo(ot.x,ot.y,0,p),Ze=ke[3]>0?ke:ic($,ot,At,1,p,void 0,Q,Z.canonical),Pt=su(Le,et,(Ze[0]-At[0])*K,Ze[1]-At[1]);if(c.flipState=Pt&&Pt.needsFlipping?Is.flipRequired:Is.flipNotRequired,Pt)return Pt}const at=xl(he*M.getoffsetX(pe),se,de,s,B,$,Ae,ne,je,C,y,H,X,!1,!1,Q,Z,ie);if(!at)return{notEnoughRoom:!0};dt(at)}return{}}function qa(c,r,s,h,p){const{x:y,y:w,z:M}=h.projectTilePoint(c.x,c.y,r);if(!p)return Vo(y,w,M,s);const[C,k,z]=p(c);return Vo(y+C,w+k,M+z,s)}function ic(c,r,s,h,p,y,w,M){const C=qa(c.sub(r)._unit()._add(c),M,p,w,y);return i.N.sub(C,s,C),i.N.normalize(C,C),i.N.scaleAndAdd(C,s,C,h)}function xl(c,r,s,h,p,y,w,M,C,k,z,B,$,H,K,X,Q,Z){const ie=h?c-r:c+r;let he=ie>0?1:-1,se=0;h&&(he*=-1,se=Math.PI),he<0&&(se+=Math.PI);let de=M+w+(he>0?0:1)|0,ne=p,pe=p,Se=0,Ae=0;const Le=Math.abs(ie),et=[],je=[];let dt=y,at=dt;const At=()=>ic(at,dt,pe,Le-Se+1,z,$,X,Q.canonical);for(;Se+Ae<=Le;){if(de+=he,de<M||de>=C)return null;if(pe=ne,at=dt,et.push(pe),H&&je.push(at),dt=new i.P(k.getx(de),k.gety(de)),ne=B[de],!ne){const un=qa(dt,Q.canonical,z,X,$);ne=un[3]>0?B[de]=un:At()}Se+=Ae,Ae=i.N.distance(pe,ne)}K&&$&&(B[de]&&(ne=At(),Ae=i.N.distance(pe,ne)),B[de]=ne);const $e=(Le-Se)/Ae,ot=dt.sub(at)._mult($e)._add(at),ke=i.N.sub([],ne,pe),Ze=i.N.scaleAndAdd([],pe,ke,$e);let Pt=[0,0,1],Bt=ke[0],Ft=ke[1];if(Z&&(Pt=X.upVector(Q.canonical,ot.x,ot.y),Pt[0]!==0||Pt[1]!==0||Pt[2]!==1)){const un=[Pt[2],0,-Pt[0]],vn=i.N.cross([],Pt,un);i.N.normalize(un,un),i.N.normalize(vn,vn),Bt=i.N.dot(ke,un),Ft=i.N.dot(ke,vn)}if(s){const un=i.N.cross([],Pt,ke);i.N.normalize(un,un),i.N.scaleAndAdd(Ze,Ze,un,s*he)}const Xt=se+Math.atan2(Ft,Bt);return et.push(Ze),H&&je.push(ot),{point:Ze,angle:Xt,path:et,tilePath:je,up:Pt}}function Js(c,r){const s=r.length,h=s+4*c;r.resize(h),r.float32.fill(-1/0,4*s,4*h)}function lu(c,r,s){const h=r[0],p=r[1];return c[0]=s[0]*h+s[4]*p+s[12],c[1]=s[1]*h+s[5]*p+s[13],c[3]=s[3]*h+s[7]*p+s[15],c}const Uo=100;class Jt{constructor(r,s,h=new eu(r.width+200,r.height+200,25),p=new eu(r.width+200,r.height+200,25)){this.transform=r,this.grid=h,this.ignoredGrid=p,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+Uo,this.screenBottomBoundary=r.height+Uo,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=s}placeCollisionBox(r,s,h,p,y,w,M,C){let k=h.projectedAnchorX,z=h.projectedAnchorY,B=h.projectedAnchorZ;const $=h.elevation,H=h.tileID,K=r.getProjection();if($&&H){const[ne,pe,Se]=K.upVector(H.canonical,h.tileAnchorX,h.tileAnchorY),Ae=K.upVectorScale(H.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;k+=ne*$*Ae,z+=pe*$*Ae,B+=Se*$*Ae}const X=this.projectAndGetPerspectiveRatio(M,k,z,B,h.tileID,K.name==="globe"||!!$||this.transform.pitch>0,K),Q=w*X.perspectiveRatio,Z=(h.x1*s+p.x-h.padding)*Q+X.point.x,ie=(h.y1*s+p.y-h.padding)*Q+X.point.y,he=(h.x2*s+p.x+h.padding)*Q+X.point.x,se=(h.y2*s+p.y+h.padding)*Q+X.point.y,de=X.perspectiveRatio<=.55||X.occluded;return!this.isInsideGrid(Z,ie,he,se)||!y&&this.grid.hitTest(Z,ie,he,se,C)||de?{box:[],offscreen:!1,occluded:X.occluded}:{box:[Z,ie,he,se],offscreen:this.isOffscreen(Z,ie,he,se),occluded:!1}}placeCollisionCircles(r,s,h,p,y,w,M,C,k,z,B,$,H,K,X){const Q=[],Z=this.transform.elevation,ie=r.getProjection(),he=Z?Z.getAtTileOffsetFunc(X,this.transform.center.lat,this.transform.worldSize,ie):null,se=new i.P(h.tileAnchorX,h.tileAnchorY);let{x:de,y:ne,z:pe}=ie.projectTilePoint(se.x,se.y,X.canonical);if(he){const[ot,ke,Ze]=he(se);de+=ot,ne+=ke,pe+=Ze}const Se=ie.name==="globe",Ae=this.projectAndGetPerspectiveRatio(M,de,ne,pe,X,Se||!!Z||this.transform.pitch>0,ie),{perspectiveRatio:Le}=Ae,et=(B?w/Le:w*Le)/i.bc,je=Vo(de,ne,pe,C),dt=Ae.signedDistanceFromCamera>0?ou(et,y,h.lineOffsetX*et,h.lineOffsetY*et,!1,je,se,h,p,C,{},Z&&!B?he:null,B&&!!Z,ie,X,B):null;let at=!1,At=!1,$e=!0;if(dt&&!Ae.occluded){const ot=.5*H*Le+K,ke=new i.P(-100,-100),Ze=new i.P(this.screenRightBoundary,this.screenBottomBoundary),Pt=new Ha,{first:Bt,last:Ft}=dt,Xt=Bt.path.length;let un=[];for(let gn=Xt-1;gn>=1;gn--)un.push(Bt.path[gn]);for(let gn=1;gn<Ft.path.length;gn++)un.push(Ft.path[gn]);const vn=2.5*ot;k&&(un=un.map(([gn,qn,kn],Nn)=>(he&&!Se&&(kn=he(Nn<Xt-1?Bt.tilePath[Xt-1-Nn]:Ft.tilePath[Nn-Xt+2])[2]),Vo(gn,qn,kn,k))),un.some(gn=>gn[3]<=0)&&(un=[]));let pn=[];if(un.length>0){let gn=1/0,qn=-1/0,kn=1/0,Nn=-1/0;for(const Fn of un)gn=Math.min(gn,Fn[0]),kn=Math.min(kn,Fn[1]),qn=Math.max(qn,Fn[0]),Nn=Math.max(Nn,Fn[1]);qn>=ke.x&&gn<=Ze.x&&Nn>=ke.y&&kn<=Ze.y&&(pn=[un.map(Fn=>new i.P(Fn[0],Fn[1]))],(gn<ke.x||qn>Ze.x||kn<ke.y||Nn>Ze.y)&&(pn=i.ba(pn,ke.x,ke.y,Ze.x,Ze.y)))}for(const gn of pn){Pt.reset(gn,.25*ot);let qn=0;qn=Pt.length<=.5*ot?1:Math.ceil(Pt.paddedLength/vn)+1;for(let kn=0;kn<qn;kn++){const Nn=kn/Math.max(qn-1,1),Fn=Pt.lerp(Nn),_r=Fn.x+Uo,Zr=Fn.y+Uo;Q.push(_r,Zr,ot,0);const ir=_r-ot,mi=Zr-ot,or=_r+ot,Ar=Zr+ot;if($e=$e&&this.isOffscreen(ir,mi,or,Ar),At=At||this.isInsideGrid(ir,mi,or,Ar),!s&&this.grid.hitTestCircle(_r,Zr,ot,$)&&(at=!0,!z))return{circles:[],offscreen:!1,collisionDetected:at,occluded:!1}}}}return{circles:!z&&at||!At?[]:Q,offscreen:$e,collisionDetected:at,occluded:Ae.occluded}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[];let h=1/0,p=1/0,y=-1/0,w=-1/0;for(const z of r){const B=new i.P(z.x+Uo,z.y+Uo);h=Math.min(h,B.x),p=Math.min(p,B.y),y=Math.max(y,B.x),w=Math.max(w,B.y),s.push(B)}const M=this.grid.query(h,p,y,w).concat(this.ignoredGrid.query(h,p,y,w)),C={},k={};for(const z of M){const B=z.key;if(C[B.bucketInstanceId]===void 0&&(C[B.bucketInstanceId]={}),C[B.bucketInstanceId][B.featureIndex])continue;const $=[new i.P(z.x1,z.y1),new i.P(z.x2,z.y1),new i.P(z.x2,z.y2),new i.P(z.x1,z.y2)];i.bb(s,$)&&(C[B.bucketInstanceId][B.featureIndex]=!0,k[B.bucketInstanceId]===void 0&&(k[B.bucketInstanceId]=[]),k[B.bucketInstanceId].push(B.featureIndex))}return k}insertCollisionBox(r,s,h,p,y){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:p,collisionGroupID:y},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,s,h,p,y){const w=s?this.ignoredGrid:this.grid,M={bucketInstanceId:h,featureIndex:p,collisionGroupID:y};for(let C=0;C<r.length;C+=4)w.insertCircle(M,r[C],r[C+1],r[C+2])}projectAndGetPerspectiveRatio(r,s,h,p,y,w,M){const C=[s,h,p,1];let k=!1;p||this.transform.pitch>0?(i.a7.transformMat4(C,C,r),this.fogState&&y&&M.name!=="globe"&&(k=function($,H,K,X,Q,Z){const ie=Z.calculateFogTileMatrix(Q),he=[H,K,X];return i.N.transformMat4(he,he,ie),Tr($,i.N.length(he),Z.pitch,Z._fov)}(this.fogState,s,h,p,y.toUnwrapped(),this.transform)>.9)):lu(C,C,r);const z=C[3];return{point:new i.P((C[0]/z+1)/2*this.transform.width+Uo,(-C[1]/z+1)/2*this.transform.height+Uo),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(M)/z*.5,1.5),signedDistanceFromCamera:z,occluded:w&&C[2]>z||k}}isOffscreen(r,s,h,p){return h<Uo||r>=this.screenRightBoundary||p<Uo||s>this.screenBottomBoundary}isInsideGrid(r,s,h,p){return h>=0&&r<this.gridRightBoundary&&p>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const r=i.a6.identity([]);return i.a6.translate(r,r,[-100,-100,0]),r}}function oc(c,r,s){const h=r.createTileMatrix(c,c.worldSize,s.toUnwrapped());return i.a6.multiply(new Float32Array(16),c.projMatrix,h)}function cu(c,r,s){if(r.projection.name===s.projection.name)return c.projMatrix;const h=s.clone();return h.setProjection(r.projection),oc(h,r.getProjection(),c)}function bl(c,r,s){return r.name===s.projection.name?c.projMatrix:oc(s,r,c)}class uu{constructor(r,s,h,p){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?s:-s))):p&&h?1:0,this.placed=h}isHidden(){return this.opacity===0&&!this.placed}}class Qs{constructor(r,s,h,p,y,w=!1){this.text=new uu(r?r.text:null,s,h,y),this.icon=new uu(r?r.icon:null,s,p,y),this.clipped=w}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ts{constructor(r,s,h,p=!1){this.text=r,this.icon=s,this.skipFade=h,this.clipped=p}}class hu{constructor(){this.invProjMatrix=i.a6.create(),this.viewportMatrix=i.a6.create(),this.circles=[]}}class _a{constructor(r,s,h,p,y){this.bucketInstanceId=r,this.featureIndex=s,this.sourceLayerIndex=h,this.bucketIndex=p,this.tileID=y}}class sc{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const s=++this.maxGroupID;this.collisionGroups[r]={ID:s,predicate:h=>h.collisionGroupID===s}}return this.collisionGroups[r]}}function ga(c,r,s,h,p){const{horizontalAlign:y,verticalAlign:w}=i.bf(c),M=-(y-.5)*r,C=-(w-.5)*s,k=i.bd(c,h);return new i.P(M+k[0]*p,C+k[1]*p)}function du(c,r,s,h,p){const y=new i.P(c,r);return s&&y._rotate(h?p:-p),y}class Od{constructor(r,s,h,p,y,w){this.transform=r.clone(),this.projection=r.projection.name,this.collisionIndex=new Jt(this.transform,y),this.buildingIndex=w,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new sc(h),this.collisionCircleArrays={},this.prevPlacement=p,p&&(p.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,s,h,p){const y=h.getBucket(s),w=h.latestFeatureIndex;if(!y||!w||s.fqid!==y.layerIds[0])return;const M=y.layers[0].layout,C=h.collisionBoxArray,k=Math.pow(2,this.transform.zoom-h.tileID.overscaledZ),z=h.tileSize/i.V,B=h.tileID.toUnwrapped();this.transform.setProjection(y.projection);const $=(H=h.tileID,K=y.getProjection(),X=this.transform,K.name===this.projection?X.calculateProjMatrix(H.toUnwrapped()):oc(X,K,H));var H,K,X;const Q=M.get("text-pitch-alignment")==="map",Z=M.get("text-rotation-alignment")==="map";s.compileFilter();const ie=s.dynamicFilter(),he=s.dynamicFilterNeedsFeature(),se=this.transform.calculatePixelsToTileUnitsMatrix(h),de=tu($,h.tileID.canonical,Q,Z,this.transform,y.getProjection(),se);let ne=null;if(Q){const Ae=nu($,h.tileID.canonical,Q,Z,this.transform,y.getProjection(),se);ne=i.a6.multiply([],this.transform.labelPlaneMatrix,Ae)}let pe=null;ie&&h.latestFeatureIndex&&(pe={unwrappedTileID:B,dynamicFilter:ie,dynamicFilterNeedsFeature:he,featureIndex:h.latestFeatureIndex}),this.retainedQueryData[y.bucketInstanceId]=new _a(y.bucketInstanceId,w,y.sourceLayerIndex,y.index,h.tileID);const Se={bucket:y,layout:M,posMatrix:$,textLabelPlaneMatrix:de,labelToScreenMatrix:ne,clippingData:pe,scale:k,textPixelRatio:z,holdingForFade:h.holdingForFade(),collisionBoxArray:C,partiallyEvaluatedTextSize:i.b5(y.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:i.b5(y.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(p)for(const Ae of y.sortKeyRanges){const{sortKey:Le,symbolInstanceStart:et,symbolInstanceEnd:je}=Ae;r.push({sortKey:Le,symbolInstanceStart:et,symbolInstanceEnd:je,parameters:Se})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:Se})}attemptAnchorPlacement(r,s,h,p,y,w,M,C,k,z,B,$,H,K,X,Q,Z,ie){const{textOffset0:he,textOffset1:se,crossTileID:de}=$,ne=[he,se],pe=ga(r,h,p,ne,y),Se=this.collisionIndex.placeCollisionBox(K,y,s,du(pe.x,pe.y,w,M,this.transform.angle),B,C,k,z.predicate);if(Q){const Ae=K.getSymbolInstanceIconSize(ie,this.transform.zoom,$.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(K,Ae,Q,du(pe.x,pe.y,w,M,this.transform.angle),B,C,k,z.predicate).box.length===0)return}if(Se.box.length>0){let Ae;return this.prevPlacement&&this.prevPlacement.variableOffsets[de]&&this.prevPlacement.placements[de]&&this.prevPlacement.placements[de].text&&(Ae=this.prevPlacement.variableOffsets[de].anchor),this.variableOffsets[de]={textOffset:ne,width:h,height:p,anchor:r,textScale:y,prevAnchor:Ae},this.markUsedJustification(K,r,$,X),K.allowVerticalPlacement&&(this.markUsedOrientation(K,X,$),this.placedOrientations[de]=X),{shift:pe,placedGlyphBoxes:Se}}}placeLayerBucketPart(r,s,h,p){const{bucket:y,layout:w,posMatrix:M,textLabelPlaneMatrix:C,labelToScreenMatrix:k,clippingData:z,textPixelRatio:B,holdingForFade:$,collisionBoxArray:H,partiallyEvaluatedTextSize:K,partiallyEvaluatedIconSize:X,collisionGroup:Q}=r.parameters,Z=w.get("text-optional"),ie=w.get("icon-optional"),he=w.get("text-allow-overlap"),se=w.get("icon-allow-overlap"),de=w.get("text-rotation-alignment")==="map",ne=w.get("text-pitch-alignment")==="map",pe=w.get("symbol-z-order")==="viewport-y",Se=w.get("symbol-z-elevate");this.transform.setProjection(y.projection);let Ae=he&&(se||!y.hasIconData()||ie),Le=se&&(he||!y.hasTextData()||Z);!y.collisionArrays&&H&&y.deserializeCollisionBoxes(H),h&&p&&y.updateCollisionDebugBuffers(this.transform.zoom,H);const et=(je,dt,at)=>{const{crossTileID:At,numVerticalGlyphVertices:$e}=je;if(z){const or={zoom:this.transform.zoom,pitch:this.transform.pitch};let Ar=null;if(z.dynamicFilterNeedsFeature){const sr=this.retainedQueryData[y.bucketInstanceId];Ar=z.featureIndex.loadFeature({featureIndex:je.featureIndex,bucketIndex:sr.bucketIndex,sourceLayerIndex:sr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,z.dynamicFilter)(or,Ar,this.retainedQueryData[y.bucketInstanceId].tileID.canonical,new i.P(je.tileAnchorX,je.tileAnchorY),this.transform.calculateDistanceTileData(z.unwrappedTileID)))return this.placements[At]=new ts(!1,!1,!1,!0),void s.add(At)}if(s.has(At))return;if($)return void(this.placements[At]=new ts(!1,!1,!1));let ot=!1,ke=!1,Ze=!0,Pt=!1,Bt=!1,Ft=null,Xt={box:null,offscreen:null,occluded:null},un={box:null,offscreen:null,occluded:null},vn=null,pn=null,gn=null,qn=0,kn=0,Nn=0;at.textFeatureIndex?qn=at.textFeatureIndex:je.useRuntimeCollisionCircles&&(qn=je.featureIndex),at.verticalTextFeatureIndex&&(kn=at.verticalTextFeatureIndex);const Fn=or=>{or.tileID=this.retainedQueryData[y.bucketInstanceId].tileID;const Ar=this.transform.elevation;or.elevation=je.zOffset+(Ar?Ar.getAtTileOffset(or.tileID,or.tileAnchorX,or.tileAnchorY):0)},_r=at.textBox;if(_r){Fn(_r);const or=sr=>{let Sr=i.b6.horizontal;if(y.allowVerticalPlacement&&!sr&&this.prevPlacement){const Qr=this.prevPlacement.placedOrientations[At];Qr&&(this.placedOrientations[At]=Qr,Sr=Qr,this.markUsedOrientation(y,Sr,je))}return Sr},Ar=(sr,Sr)=>{if(y.allowVerticalPlacement&&$e>0&&at.verticalTextBox){for(const Qr of y.writingModes)if(Qr===i.b6.vertical?(Xt=Sr(),un=Xt):Xt=sr(),Xt&&Xt.box&&Xt.box.length)break}else Xt=sr()};if(w.get("text-variable-anchor")){let sr=w.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[At]){const Lr=this.prevPlacement.variableOffsets[At];sr.indexOf(Lr.anchor)>0&&(sr=sr.filter(to=>to!==Lr.anchor),sr.unshift(Lr.anchor))}const Sr=(Lr,to,go)=>{const Wo=y.getSymbolInstanceTextSize(K,je,this.transform.zoom,dt),na=(Lr.x2-Lr.x1)*Wo+2*Lr.padding,Zo=(Lr.y2-Lr.y1)*Wo+2*Lr.padding,no=je.hasIconTextFit&&!se?to:null;no&&Fn(no);let qi={box:[],offscreen:!1,occluded:!1};const Mo=he?2*sr.length:sr.length;for(let Fo=0;Fo<Mo;++Fo){const Yo=this.attemptAnchorPlacement(sr[Fo%sr.length],Lr,na,Zo,Wo,de,ne,B,M,Q,Fo>=sr.length,je,dt,y,go,no,K,X);if(Yo&&(qi=Yo.placedGlyphBoxes,qi&&qi.box&&qi.box.length)){ot=!0,Ft=Yo.shift;break}}return qi};Ar(()=>Sr(_r,at.iconBox,i.b6.horizontal),()=>{const Lr=at.verticalTextBox;return Lr&&Fn(Lr),y.allowVerticalPlacement&&!(Xt&&Xt.box&&Xt.box.length)&&$e>0&&Lr?Sr(Lr,at.verticalIconBox,i.b6.vertical):{box:null,offscreen:null,occluded:null}}),Xt&&(ot=Xt.box,Ze=Xt.offscreen,Pt=Xt.occluded);const Qr=or(!(!Xt||!Xt.box));if(!ot&&this.prevPlacement){const Lr=this.prevPlacement.variableOffsets[At];Lr&&(this.variableOffsets[At]=Lr,this.markUsedJustification(y,Lr.anchor,je,Qr))}}else{const sr=(Sr,Qr)=>{const Lr=y.getSymbolInstanceTextSize(K,je,this.transform.zoom,dt),to=this.collisionIndex.placeCollisionBox(y,Lr,Sr,new i.P(0,0),he,B,M,Q.predicate);return to&&to.box&&to.box.length&&(this.markUsedOrientation(y,Qr,je),this.placedOrientations[At]=Qr),to};Ar(()=>sr(_r,i.b6.horizontal),()=>{const Sr=at.verticalTextBox;return y.allowVerticalPlacement&&$e>0&&Sr?(Fn(Sr),sr(Sr,i.b6.vertical)):{box:null,offscreen:null,occluded:null}}),or(!!(Xt&&Xt.box&&Xt.box.length))}}if(vn=Xt,ot=vn&&vn.box&&vn.box.length>0,Ze=vn&&vn.offscreen,Pt=vn&&vn.occluded,je.useRuntimeCollisionCircles){const or=y.text.placedSymbolArray.get(je.centerJustifiedTextSymbolIndex>=0?je.centerJustifiedTextSymbolIndex:je.verticalPlacedTextSymbolIndex),Ar=i.b7(y.textSizeData,K,or),sr=w.get("text-padding");pn=this.collisionIndex.placeCollisionCircles(y,he,or,y.lineVertexArray,y.glyphOffsetArray,Ar,M,C,k,h,ne,Q.predicate,je.collisionCircleDiameter*Ar/i.bc,sr,this.retainedQueryData[y.bucketInstanceId].tileID),ot=he||pn.circles.length>0&&!pn.collisionDetected,Ze=Ze&&pn.offscreen,Pt=pn.occluded}if(at.iconFeatureIndex&&(Nn=at.iconFeatureIndex),at.iconBox){const or=Ar=>{Fn(Ar);const sr=je.hasIconTextFit&&Ft?du(Ft.x,Ft.y,de,ne,this.transform.angle):new i.P(0,0),Sr=y.getSymbolInstanceIconSize(X,this.transform.zoom,je.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(y,Sr,Ar,sr,se,B,M,Q.predicate)};un&&un.box&&un.box.length&&at.verticalIconBox?(gn=or(at.verticalIconBox),ke=gn.box.length>0):(gn=or(at.iconBox),ke=gn.box.length>0),Ze=Ze&&gn.offscreen,Bt=gn.occluded}const Zr=Z||je.numHorizontalGlyphVertices===0&&$e===0,ir=ie||je.numIconVertices===0;if(Zr||ir?ir?Zr||(ke=ke&&ot):ot=ke&&ot:ke=ot=ke&&ot,ot&&vn&&vn.box&&this.collisionIndex.insertCollisionBox(vn.box,w.get("text-ignore-placement"),y.bucketInstanceId,un&&un.box&&kn?kn:qn,Q.ID),ke&&gn&&this.collisionIndex.insertCollisionBox(gn.box,w.get("icon-ignore-placement"),y.bucketInstanceId,Nn,Q.ID),pn&&(ot&&this.collisionIndex.insertCollisionCircles(pn.circles,w.get("text-ignore-placement"),y.bucketInstanceId,qn,Q.ID),h)){const or=y.bucketInstanceId;let Ar=this.collisionCircleArrays[or];Ar===void 0&&(Ar=this.collisionCircleArrays[or]=new hu);for(let sr=0;sr<pn.circles.length;sr+=4)Ar.circles.push(pn.circles[sr+0]),Ar.circles.push(pn.circles[sr+1]),Ar.circles.push(pn.circles[sr+2]),Ar.circles.push(pn.collisionDetected?1:0)}const mi=y.projection.name!=="globe";Ae=Ae&&(mi||!Pt),Le=Le&&(mi||!Bt),this.placements[At]=new ts(ot||Ae,ke||Le,Ze||y.justReloaded),s.add(At)};if(Se&&this.buildingIndex&&(this.buildingIndex.updateZOffset(y,this.retainedQueryData[y.bucketInstanceId].tileID),y.updateZOffset()),pe){const je=y.getSortedSymbolIndexes(this.transform.angle);for(let dt=je.length-1;dt>=0;--dt){const at=je[dt];et(y.symbolInstances.get(at),at,y.collisionArrays[at])}y.hasAnyZOffset&&i.w(`${y.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(y.hasAnyZOffset){const je=y.getSortedIndexesByZOffset();for(let dt=0;dt<je.length;++dt){const at=je[dt];et(y.symbolInstances.get(at),at,y.collisionArrays[at])}}else for(let je=r.symbolInstanceStart;je<r.symbolInstanceEnd;je++)et(y.symbolInstances.get(je),je,y.collisionArrays[je]);if(h&&y.bucketInstanceId in this.collisionCircleArrays){const je=this.collisionCircleArrays[y.bucketInstanceId];i.a6.invert(je.invProjMatrix,M),je.viewportMatrix=this.collisionIndex.getViewportMatrix()}y.justReloaded=!1}markUsedJustification(r,s,h,p){const{leftJustifiedTextSymbolIndex:y,centerJustifiedTextSymbolIndex:w,rightJustifiedTextSymbolIndex:M,verticalPlacedTextSymbolIndex:C,crossTileID:k}=h,z=i.be(s),B=p===i.b6.vertical?C:z==="left"?y:z==="center"?w:z==="right"?M:-1;y>=0&&(r.text.placedSymbolArray.get(y).crossTileID=B>=0&&y!==B?0:k),w>=0&&(r.text.placedSymbolArray.get(w).crossTileID=B>=0&&w!==B?0:k),M>=0&&(r.text.placedSymbolArray.get(M).crossTileID=B>=0&&M!==B?0:k),C>=0&&(r.text.placedSymbolArray.get(C).crossTileID=B>=0&&C!==B?0:k)}markUsedOrientation(r,s,h){const p=s===i.b6.horizontal||s===i.b6.horizontalOnly?s:0,y=s===i.b6.vertical?s:0,{leftJustifiedTextSymbolIndex:w,centerJustifiedTextSymbolIndex:M,rightJustifiedTextSymbolIndex:C,verticalPlacedTextSymbolIndex:k}=h,z=r.text.placedSymbolArray;w>=0&&(z.get(w).placedOrientation=p),M>=0&&(z.get(M).placedOrientation=p),C>=0&&(z.get(C).placedOrientation=p),k>=0&&(z.get(k).placedOrientation=y)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let h=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const p=s?s.symbolFadeChange(r):1,y=s?s.opacities:{},w=s?s.variableOffsets:{},M=s?s.placedOrientations:{};for(const C in this.placements){const k=this.placements[C],z=y[C];z?(this.opacities[C]=new Qs(z,p,k.text,k.icon,null,k.clipped),h=h||k.text!==z.text.placed||k.icon!==z.icon.placed):(this.opacities[C]=new Qs(null,p,k.text,k.icon,k.skipFade,k.clipped),h=h||k.text||k.icon)}for(const C in y){const k=y[C];if(!this.opacities[C]){const z=new Qs(k,p,!1,!1);z.isHidden()||(this.opacities[C]=z,h=h||k.text.placed||k.icon.placed)}}for(const C in w)this.variableOffsets[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.variableOffsets[C]=w[C]);for(const C in M)this.placedOrientations[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.placedOrientations[C]=M[C]);h?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:r)}updateLayerOpacities(r,s){const h=new Set;for(const p of s){const y=p.getBucket(r);y&&p.latestFeatureIndex&&r.fqid===y.layerIds[0]&&(this.updateBucketOpacities(y,h,p.collisionBoxArray),y.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(y,p.tileID),y.updateZOffset()))}}updateBucketOpacities(r,s,h){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const p=r.layers[0].layout,y=!!r.layers[0].dynamicFilter(),w=new Qs(null,0,!1,!1,!0),M=p.get("text-allow-overlap"),C=p.get("icon-allow-overlap"),k=p.get("text-variable-anchor"),z=p.get("text-rotation-alignment")==="map",B=p.get("text-pitch-alignment")==="map",$=new Qs(null,0,M&&(C||!r.hasIconData()||p.get("icon-optional")),C&&(M||!r.hasTextData()||p.get("text-optional")),!0);!r.collisionArrays&&h&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(h);const H=(X,Q,Z)=>{for(let ie=0;ie<Q/4;ie++)X.opacityVertexArray.emplaceBack(Z)};let K=0;for(let X=0;X<r.symbolInstances.length;X++){const Q=r.symbolInstances.get(X),{numHorizontalGlyphVertices:Z,numVerticalGlyphVertices:ie,crossTileID:he,numIconVertices:se}=Q,de=s.has(he);let ne=this.opacities[he];de?ne=w:ne||(ne=$,this.opacities[he]=ne),s.add(he);const pe=Z>0||ie>0,Se=se>0,Ae=this.placedOrientations[he],Le=Ae===i.b6.vertical,et=Ae===i.b6.horizontal||Ae===i.b6.horizontalOnly;if(!pe&&!Se||ne.isHidden()||K++,pe){const je=wh(ne.text);H(r.text,Z,Le?wl:je),H(r.text,ie,et?wl:je);const dt=ne.text.isHidden(),{leftJustifiedTextSymbolIndex:at,centerJustifiedTextSymbolIndex:At,rightJustifiedTextSymbolIndex:$e,verticalPlacedTextSymbolIndex:ot}=Q,ke=r.text.placedSymbolArray,Ze=dt||Le?1:0;at>=0&&(ke.get(at).hidden=Ze),At>=0&&(ke.get(At).hidden=Ze),$e>=0&&(ke.get($e).hidden=Ze),ot>=0&&(ke.get(ot).hidden=dt||et?1:0);const Pt=this.variableOffsets[he];Pt&&this.markUsedJustification(r,Pt.anchor,Q,Ae);const Bt=this.placedOrientations[he];Bt&&(this.markUsedJustification(r,"left",Q,Bt),this.markUsedOrientation(r,Bt,Q))}if(Se){const je=wh(ne.icon),{placedIconSymbolIndex:dt,verticalPlacedIconSymbolIndex:at}=Q,At=r.icon.placedSymbolArray,$e=ne.icon.isHidden()?1:0;dt>=0&&(H(r.icon,se,Le?wl:je),At.get(dt).hidden=$e),at>=0&&(H(r.icon,Q.numVerticalIconVertices,et?wl:je),At.get(at).hidden=$e)}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const je=r.collisionArrays[X];if(je){let dt=new i.P(0,0),at=!0;if(je.textBox||je.verticalTextBox){if(k){const $e=this.variableOffsets[he];$e?(dt=ga($e.anchor,$e.width,$e.height,$e.textOffset,$e.textScale),z&&dt._rotate(B?this.transform.angle:-this.transform.angle)):at=!1}y&&(at=!ne.clipped),je.textBox&&Wa(r.textCollisionBox.collisionVertexArray,ne.text.placed,!at||Le,dt.x,dt.y),je.verticalTextBox&&Wa(r.textCollisionBox.collisionVertexArray,ne.text.placed,!at||et,dt.x,dt.y)}const At=at&&!!(!et&&je.verticalIconBox);je.iconBox&&Wa(r.iconCollisionBox.collisionVertexArray,ne.icon.placed,At,Q.hasIconTextFit?dt.x:0,Q.hasIconTextFit?dt.y:0),je.verticalIconBox&&Wa(r.iconCollisionBox.collisionVertexArray,ne.icon.placed,!At,Q.hasIconTextFit?dt.x:0,Q.hasIconTextFit?dt.y:0)}}}if(r.fullyClipped=K===0,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const X=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=X.invProjMatrix,r.placementViewportMatrix=X.viewportMatrix,r.collisionCircleArray=X.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,s){const h=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*h>r}setStale(){this.stale=!0}}function Wa(c,r,s,h,p){c.emplaceBack(r?1:0,s?1:0,h||0,p||0),c.emplaceBack(r?1:0,s?1:0,h||0,p||0),c.emplaceBack(r?1:0,s?1:0,h||0,p||0),c.emplaceBack(r?1:0,s?1:0,h||0,p||0)}const Rd=Math.pow(2,25),fu=Math.pow(2,24),bh=Math.pow(2,17),Za=Math.pow(2,16),Ro=Math.pow(2,9),Ld=Math.pow(2,8),zd=Math.pow(2,1);function wh(c){if(c.opacity===0&&!c.placed)return 0;if(c.opacity===1&&c.placed)return 4294967295;const r=c.placed?1:0,s=Math.floor(127*c.opacity);return s*Rd+r*fu+s*bh+r*Za+s*Ro+r*Ld+s*zd+r}const wl=0;class Fd{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(r,s,h,p,y){const w=this._bucketParts;for(;this._currentTileIndex<r.length;)if(s.getBucketParts(w,p,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort((M,C)=>M.sortKey-C.sortKey));this._currentPartIndex<w.length;){const M=w[this._currentPartIndex];if(s.placeLayerBucketPart(M,this._seenCrossTileIDs,h,M.symbolInstanceStart===0),this._currentPartIndex++,y())return!0}return!1}}class ac{constructor(r,s,h,p,y,w,M,C,k){this.placement=new Od(r,y,w,M,C,k),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=p,this._done=!1}isDone(){return this._done}continuePlacement(r,s,h,p){const y=i.f.now(),w=()=>{const M=i.f.now()-y;return!this._forceFullPlacement&&M>2};for(;this._currentPlacementIndex>=0;){const M=s[r[this._currentPlacementIndex]],C=this.placement.collisionIndex.transform.zoom;if(M.type==="symbol"&&(!M.minzoom||M.minzoom<=C)&&(!M.maxzoom||M.maxzoom>C)){const k=M,z=k.layout.get("symbol-z-elevate"),B=this._inProgressLayer=this._inProgressLayer||new Fd(k),$=i.ag(M.source,M.scope);if(B.continuePlacement(z?p[$]:h[$],this.placement,this._showCollisionBoxes,M,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const R=512/i.V/2;class G{constructor(r,s,h){this.tileID=r,this.bucketInstanceId=h,this.index=new i.bg(s.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const p=r.canonical.x*i.V,y=r.canonical.y*i.V;for(let w=0;w<s.length;w++){const{key:M,crossTileID:C,tileAnchorX:k,tileAnchorY:z}=s.get(w),B=Math.floor((p+k)*R),$=Math.floor((y+z)*R);this.index.add(B,$),this.keys.push(M),this.crossTileIDs.push(C)}this.index.finish()}findMatches(r,s,h){const p=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z),y=R/Math.pow(2,s.canonical.z-this.tileID.canonical.z),w=s.canonical.x*i.V,M=s.canonical.y*i.V;for(let C=0;C<r.length;C++){const k=r.get(C);if(k.crossTileID)continue;const{key:z,tileAnchorX:B,tileAnchorY:$}=k,H=Math.floor((w+B)*y),K=Math.floor((M+$)*y),X=this.index.range(H-p,K-p,H+p,K+p);for(const Q of X){const Z=this.crossTileIDs[Q];if(this.keys[Q]===z&&!h.has(Z)){h.add(Z),k.crossTileID=Z;break}}}}}class te{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Me{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const s=Math.round((r-this.lng)/360);if(s!==0)for(const h in this.indexes){const p=this.indexes[h],y={};for(const w in p){const M=p[w];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+s),y[M.tileID.key]=M}this.indexes[h]=y}this.lng=r}addBucket(r,s,h){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let y=0;y<s.symbolInstances.length;y++)s.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]=new Set);const p=this.usedCrossTileIDs[r.overscaledZ];for(const y in this.indexes){const w=this.indexes[y];if(Number(y)>r.overscaledZ)for(const M in w){const C=w[M];C.tileID.isChildOf(r)&&C.findMatches(s.symbolInstances,r,p)}else{const M=w[r.scaledTo(Number(y)).key];M&&M.findMatches(s.symbolInstances,r,p)}}for(let y=0;y<s.symbolInstances.length;y++){const w=s.symbolInstances.get(y);w.crossTileID||(w.crossTileID=h.generate(),p.add(w.crossTileID))}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new G(r,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(r,s){for(const h of s.crossTileIDs)this.usedCrossTileIDs[r].delete(h)}removeStaleBuckets(r){let s=!1;for(const h in this.indexes){const p=this.indexes[h];for(const y in p)r[p[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(h,p[y]),delete p[y],s=!0)}return s}}class ze{constructor(){this.layerIndexes={},this.crossTileIDs=new te,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,s,h,p){let y=this.layerIndexes[r.fqid];y===void 0&&(y=this.layerIndexes[r.fqid]=new Me);let w=!1;const M={};p.name!=="globe"&&y.handleWrapJump(h);for(const C of s){const k=C.getBucket(r);k&&r.fqid===k.layerIds[0]&&(k.bucketInstanceId||(k.bucketInstanceId=++this.maxBucketInstanceId),y.addBucket(C.tileID,k,this.crossTileIDs)&&(w=!0),M[k.bucketInstanceId]=!0)}return y.removeStaleBuckets(M)&&(w=!0),w}pruneUnusedLayers(r){const s={};r.forEach(h=>{s[h]=!0});for(const h in this.layerIndexes)s[h]||delete this.layerIndexes[h]}}class We{constructor(r=0,s=0,h=0,p=0){if(isNaN(r)||r<0||isNaN(s)||s<0||isNaN(h)||h<0||isNaN(p)||p<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=s,this.left=h,this.right=p}interpolate(r,s,h){return s.top!=null&&r.top!=null&&(this.top=i.U(r.top,s.top,h)),s.bottom!=null&&r.bottom!=null&&(this.bottom=i.U(r.bottom,s.bottom,h)),s.left!=null&&r.left!=null&&(this.left=i.U(r.left,s.left,h)),s.right!=null&&r.right!=null&&(this.right=i.U(r.right,s.right,h)),this}getCenter(r,s){const h=i.aa((this.left+r-this.right)/2,0,r),p=i.aa((this.top+s-this.bottom)/2,0,s);return new i.P(h,p)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new We(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function ut(c,r){const s=i.bk(c,3);i.a6.fromQuat(c,r),i.bm(c,3,s)}function ht(c,r){const s=i.bi.identity([]);return i.bi.rotateZ(s,s,-r),i.bi.rotateX(s,s,-c),s}function gt(c,r){const s=[c[0],c[1],0],h=[r[0],r[1],0];if(i.N.length(s)>=1e-15){const w=i.N.normalize([],s);i.N.scale(h,w,i.N.dot(h,w)),r[0]=h[0],r[1]=h[1]}const p=i.N.cross([],r,c);if(i.N.len(p)<1e-15)return null;const y=Math.atan2(-p[1],p[0]);return ht(Math.atan2(Math.sqrt(c[0]*c[0]+c[1]*c[1]),-c[2]),y)}class xt{constructor(r,s){this.position=r,this.orientation=s}get position(){return this._position}set position(r){if(r){const s=r instanceof i.L?r:new i.L(r[0],r[1],r[2]);this._renderWorldCopies&&(s.x=i.bh(s.x,0,1)),this._position=s}else this._position=null}lookAtPoint(r,s){if(this.orientation=null,!this.position)return;const h=this.position,p=this._elevation?this._elevation.getAtPointOrZero(i.L.fromLngLat(r)):0,y=i.L.fromLngLat(r,p),w=[y.x-h.x,y.y-h.y,y.z-h.z];s||(s=[0,0,1]),s[2]=Math.abs(s[2]),this.orientation=gt(w,s)}setPitchBearing(r,s){this.orientation=ht(i.bj(r),i.bj(-s))}}class Qt{constructor(r,s){this._transform=i.a6.identity([]),this.orientation=s,this.position=r}get mercatorPosition(){const r=this.position;return new i.L(r[0],r[1],r[2])}get position(){const r=i.bk(this._transform,3);return[r[0],r[1],r[2]]}set position(r){var s;r&&i.bm(this._transform,3,[(s=r)[0],s[1],s[2],1])}get orientation(){return this._orientation}set orientation(r){this._orientation=r||i.bi.identity([]),r&&ut(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),s=this.right();return{bearing:Math.atan2(-s[1],s[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,s){this._orientation=ht(r,s),ut(this._transform,this._orientation)}forward(){const r=i.bk(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=i.bk(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=i.bk(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,s){const h=new Float64Array(16);return i.a6.invert(h,this.getWorldToCamera(r,s)),h}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(r,s,h){const p=this.position;i.N.scale(p,p,-r);const y=new Float64Array(16);return i.a6.fromScaling(y,[h,h,h]),i.a6.translate(y,y,p),y[10]*=s,y}getWorldToCamera(r,s){const h=new Float64Array(16),p=new Float64Array(4),y=this.position;return i.bi.conjugate(p,this._orientation),i.N.scale(y,y,-r),i.a6.fromQuat(h,p),i.a6.translate(h,h,y),h[1]*=-1,h[5]*=-1,h[9]*=-1,h[13]*=-1,h[8]*=s,h[9]*=s,h[10]*=s,h[11]*=s,h}getCameraToClipPerspective(r,s,h,p){const y=new Float64Array(16);return i.a6.perspective(y,r,s,h,p),y}getCameraToClipOrthographic(r,s,h,p,y,w){const M=new Float64Array(16);return i.a6.ortho(M,r,s,h,p,y,w),M}getDistanceToElevation(r,s=!1){const h=r===0?0:i.bl(r,s?i.au(this.position[1]):this.position[1]),p=this.forward();return(h-this.position[2])/p[2]}clone(){return new Qt([...this.position],[...this.orientation])}}const Cn=(c,r,s)=>(1-s)*c+s*r,Pn=c=>c*c*c*c*c;class er{constructor(r,s,h,p,y,w,M){this.tileSize=512,this._renderWorldCopies=y===void 0||y,this._minZoom=r||0,this._maxZoom=s||22,this._minPitch=h??0,this._maxPitch=p??60,this.setProjection(w),this.setMaxBounds(M),this.width=0,this.height=0,this._center=new i.bn(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new We,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Qt,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const r=new er(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,r.tileSize=this.tileSize,r.mercatorFromTransition=this.mercatorFromTransition,r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._seaLevelZoom=this._seaLevelZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.frustumCorners=this.frustumCorners,r}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(r,s=!1){const h=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||h)&&this._updateCameraOnTerrain(),(r||h)&&this._constrainCamera(s),this._calcMatrices()}getProjection(){return i.ac(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const s=this.projection?this.getProjection():void 0;this.projection=i.bo(this.projectionOptions);const h=!P(s,this.getProjection());return h&&this._calcMatrices(),this.mercatorFromTransition=!1,h}setOrthographicProjectionAtLowPitch(r){return this._orthographicProjectionAtLowPitch!==r&&(this._orthographicProjectionAtLowPitch=r,this._calcMatrices(),!0)}setMercatorFromTransition(){const r=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.bo({name:"mercator"});const s=r!==this.projection.name;return s&&this._calcMatrices(),s}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.bl(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this.width,this.height)}get bearing(){return i.bh(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const s=-r*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=i.b4.create(),i.b4.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const s=i.aa(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const r=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/r)}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=i.bj(r),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(r){const s=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._setZoom(s),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(r){this._tileCoverLift!==r&&(this._tileCoverLift=r)}_updateCameraOnTerrain(){const r=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,s=this.elevation&&r===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||r===Number.NEGATIVE_INFINITY&&(!s||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const h=this._elevation;s||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&h.exaggeration()&&this._centerAltitudeValidForExaggeration!==h.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*h.exaggeration(),this._centerAltitudeValidForExaggeration=h.exaggeration()):(this._centerAltitude=r||0,this._centerAltitudeValidForExaggeration=h.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,s=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],h=this.horizonLineFromTop();let p=0,y=0;for(let w=0;w<s.length;w++){const M=new i.P(s[w][0]*this.width,h+s[w][1]*(this.height-h)),C=r.pointCoordinate(M);if(!C)continue;const k=1/Math.hypot(C[0]-this._camera.position[0],C[1]-this._camera.position[1]);p+=C[3]*k,y+=k}return y===0?NaN:p/y}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const r=this._seaLevelZoom,s=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),h=this.pixelsPerMeter/this.worldSize*s,p=this._mercatorZfromZoom(r),y=this._mercatorZfromZoom(this._maxZoom),w=Math.max(p-h,y);this._setZoom(this._zoomFromMercatorZ(w))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const s=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let h;h=r.z<this._camera.position[2]?[s.x,s.y,s.z]:[r.x,r.y,r.z];const p=i.N.length(i.N.sub([],this._camera.position,h));return i.aa(this._zoomFromMercatorZ(p),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let s=!1;if(r.orientation&&!i.bi.exactEquals(r.orientation,this._camera.orientation)&&(s=this._setCameraOrientation(r.orientation)),r.position){const h=[r.position.x,r.position.y,r.position.z];i.N.exactEquals(h,this._camera.position)||(this._setCameraPosition(h),s=!0)}s&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,s=new xt;return s.position=new i.L(r[0],r[1],r[2]),s.orientation=this._camera.orientation,s._elevation=this.elevation,s._renderWorldCopies=this.renderWorldCopies,s}_setCameraOrientation(r){if(!i.bi.length(r))return!1;i.bi.normalize(r,r);const s=i.N.transformQuat([],[0,0,-1],r),h=i.N.transformQuat([],[0,-1,0],r);if(h[2]<0)return!1;const p=gt(s,h);return!!p&&(this._camera.orientation=p,!0)}_setCameraPosition(r){const s=this.zoomScale(this.minZoom)*this.tileSize,h=this.zoomScale(this.maxZoom)*this.tileSize,p=this.cameraToCenterDistance;r[2]=i.aa(r[2],p/h,p/s),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,s,h){this._unmodified=!1,this._edgeInsets.interpolate(r,s,h),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const s=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,s)}getVisibleUnwrappedCoordinates(r){const s=[new i.bp(0,r)];if(this.renderWorldCopies){const h=this.pointCoordinate(new i.P(0,0)),p=this.pointCoordinate(new i.P(this.width,0)),y=this.pointCoordinate(new i.P(this.width,this.height)),w=this.pointCoordinate(new i.P(0,this.height)),M=Math.floor(Math.min(h.x,p.x,y.x,w.x)),C=Math.floor(Math.max(h.x,p.x,y.x,w.x)),k=1;for(let z=M-k;z<=C+k;z++)z!==0&&s.push(new i.bp(z,r))}return s}isLODDisabled(r){return(!r||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(r,s,h){let p=[];if(s[0]===0&&s[1]===0)return p;for(const w of r){const M=w.canonical,C=w.overscaledZ,k=w.wrap,z=1<<M.z,B=M.x+1<z,$=M.x>0,H=M.y+1<z,K=M.y>0,X=w.wrap-($?0:1),Q=w.wrap+(B?0:1),Z=$?M.x-1:z-1,ie=B?M.x+1:0;s[0]<0?(p.push(new i.am(C,Q,M.z,ie,M.y)),s[1]<0&&H&&(p.push(new i.am(C,k,M.z,M.x,M.y+1)),p.push(new i.am(C,Q,M.z,ie,M.y+1))),s[1]>0&&K&&(p.push(new i.am(C,k,M.z,M.x,M.y-1)),p.push(new i.am(C,Q,M.z,ie,M.y-1)))):s[0]>0?(p.push(new i.am(C,X,M.z,Z,M.y)),s[1]<0&&H&&(p.push(new i.am(C,k,M.z,M.x,M.y+1)),p.push(new i.am(C,X,M.z,Z,M.y+1))),s[1]>0&&K&&(p.push(new i.am(C,k,M.z,M.x,M.y-1)),p.push(new i.am(C,X,M.z,Z,M.y-1)))):s[1]<0&&H?p.push(new i.am(C,k,M.z,M.x,M.y+1)):K&&p.push(new i.am(C,k,M.z,M.x,M.y-1))}if(p.length>1){p.sort((C,k)=>C.overscaledZ-k.overscaledZ||C.wrap-k.wrap||C.canonical.z-k.canonical.z||C.canonical.x-k.canonical.x||C.canonical.y-k.canonical.y);let w=0,M=0;for(;M<p.length;)p[M].equals(p[w])?++M:p[++w]=p[M++];p.length=w+1}const y=[];for(const w of p)p.some(M=>w.isChildOf(M))||y.push(w);return p=y.filter(w=>!r.some(M=>!!(w.overscaledZ<h&&M.isChildOf(w))||w.equals(M)||w.isChildOf(M))),p}coveringTiles(r){let s=this.coveringZoomLevel(r);const h=s,p=this.elevation&&this.elevation.exaggeration(),y=p&&!r.isTerrainDEM,w=this.projection.name==="mercator";if(r.minzoom!==void 0&&s<r.minzoom)return[];r.maxzoom!==void 0&&s>r.maxzoom&&(s=r.maxzoom);const M=this.locationCoordinate(this.center),C=this.center.lat,k=1<<s,z=[k*M.x,k*M.y,0],B=this.projection.name==="globe",$=!B,H=i.bq.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s,$),K=B?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),X=k*i.bl(1,this.center.lat),Q=this._camera.position[2]/i.bl(1,this.center.lat),Z=[k*K.x,k*K.y,Q*($?1:X)],ie=B||p,he=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),se=this.isLODDisabled(!0)?s:0;let de;if(this._elevation&&r.isTerrainDEM)de=1e4*this._elevation.exaggeration();else if(this._elevation){const ke=this._elevation.getMinMaxForVisibleTiles();de=ke?ke.max:this._centerAltitude}else de=this._centerAltitude;const ne=r.isTerrainDEM?-de:this._elevation?this._elevation.getMinElevationBelowMSL():0,pe=this.projection.isReprojectedInTileSpace?i.br(this):1,Se=ke=>{const Pt=new i.L(ke.x+25e-6,ke.y,ke.z),Bt=new i.L(ke.x,ke.y+25e-6,ke.z),Ft=ke.toLngLat(),Xt=Pt.toLngLat(),un=Bt.toLngLat(),vn=this.locationCoordinate(Ft),pn=this.locationCoordinate(Xt),gn=this.locationCoordinate(un),qn=Math.hypot(pn.x-vn.x,pn.y-vn.y),kn=Math.hypot(gn.x-vn.x,gn.y-vn.y);return Math.sqrt(qn*kn)*pe/25e-6},Ae=ke=>{const Ze=de,Pt=ne;return{aabb:i.bu(this,k,0,0,0,ke,Pt,Ze,this.projection),zoom:0,x:0,y:0,minZ:Pt,maxZ:Ze,wrap:ke,fullyVisible:!1}},Le=[];let et=[];const je=s,dt=r.reparseOverscaled?h:s,at=ke=>ke*ke,At=at((Q-this._centerAltitude)*X),$e=ke=>{if(!this._elevation||!ke.tileID||!w)return;const Ze=this._elevation.getMinMaxForTile(ke.tileID),Pt=ke.aabb;Ze?(Pt.min[2]=Ze.min,Pt.max[2]=Ze.max,Pt.center[2]=(Pt.min[2]+Pt.max[2])/2):(ke.shouldSplit=ot(ke),ke.shouldSplit||(Pt.min[2]=Pt.max[2]=Pt.center[2]=this._centerAltitude))},ot=ke=>{if(ke.zoom<se)return!0;if(ke.zoom===je)return!1;if(ke.shouldSplit!=null)return ke.shouldSplit;const Ze=ke.aabb.distanceX(Z),Pt=ke.aabb.distanceY(Z);let Bt=At,Ft=1;if(B){Bt=at(ke.aabb.distanceZ(Z));const vn=Math.pow(2,ke.zoom),pn=i.au((ke.y+1)/vn),gn=i.au(ke.y/vn),qn=Math.min(Math.max(C,pn),gn),kn=i.bJ(qn)/i.bJ(C);if(Ft=qn===C?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,kn/this._mercatorScaleRatio),this.zoom<=i.bG&&ke.zoom===je-1&&kn>=.9)return!0}else if(y&&(Bt=at(ke.aabb.distanceZ(Z)*X)),this.projection.isReprojectedInTileSpace&&h<=5){const vn=Math.pow(2,ke.zoom),pn=Se(new i.L((ke.x+.5)/vn,(ke.y+.5)/vn));Ft=pn>.85?1:pn}const Xt=Ze*Ze+Pt*Pt+Bt,un=at((1<<je-ke.zoom)*he*Ft*((vn,pn)=>{if(pn*at(.707)<vn)return 1;const gn=Math.sqrt(pn/vn);return gn/(1.4144271570014144+(Math.pow(1.1,gn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Bt,At),Xt));return Xt<un};if(this.renderWorldCopies)for(let ke=1;ke<=3;ke++)Le.push(Ae(-ke)),Le.push(Ae(ke));for(Le.push(Ae(0));Le.length>0;){const ke=Le.pop(),Ze=ke.x,Pt=ke.y;let Bt=ke.fullyVisible;const Ft=()=>this.projection.name==="globe"&&(ke.y===0||ke.y===(1<<ke.zoom)-1);if(!Bt){let Xt=ie?ke.aabb.intersects(H):ke.aabb.intersectsFlat(H);if(Xt===0&&Ft()){const un=new i.bs(ke.zoom,Ze,Pt);Xt=i.bt(this,k,un,!0).intersects(H)}if(Xt===0)continue;Bt=Xt===2}if(ke.zoom!==je&&ot(ke))for(let Xt=0;Xt<4;Xt++){const un=(Ze<<1)+Xt%2,vn=(Pt<<1)+(Xt>>1),pn={aabb:w?ke.aabb.quadrant(Xt):i.bu(this,k,ke.zoom+1,un,vn,ke.wrap,ke.minZ,ke.maxZ,this.projection),zoom:ke.zoom+1,x:un,y:vn,wrap:ke.wrap,fullyVisible:Bt,tileID:void 0,shouldSplit:void 0,minZ:ke.minZ,maxZ:ke.maxZ};y&&!B&&(pn.tileID=new i.am(ke.zoom+1===je?dt:ke.zoom+1,ke.wrap,ke.zoom+1,un,vn),$e(pn)),Le.push(pn)}else{const Xt=ke.zoom===je?dt:ke.zoom;if(r.minzoom&&r.minzoom>Xt)continue;if(!Bt){let gn=ie?ke.aabb.intersectsPrecise(H):ke.aabb.intersectsPreciseFlat(H);if(gn===0&&Ft()){const qn=new i.bs(ke.zoom,Ze,Pt);gn=i.bt(this,k,qn,!0).intersectsPrecise(H)}if(gn===0)continue}const un=z[0]-(.5+Ze+(ke.wrap<<ke.zoom))*(1<<s-ke.zoom),vn=z[1]-.5-Pt,pn=ke.tileID?ke.tileID:new i.am(Xt,ke.wrap,ke.zoom,Ze,Pt);et.push({tileID:pn,distanceSq:un*un+vn*vn})}}if(this.fogCullDistSq){const ke=this.fogCullDistSq,Ze=this.horizonLineFromTop();et=et.filter(Pt=>{const Bt=[0,0,0,1],Ft=[i.V,i.V,0,1],Xt=this.calculateFogTileMatrix(Pt.tileID.toUnwrapped());i.a7.transformMat4(Bt,Bt,Xt),i.a7.transformMat4(Ft,Ft,Xt);const un=i.a7.min([],Bt,Ft),vn=i.a7.max([],Bt,Ft),pn=i.bv(un,vn);if(pn===0)return!0;let gn=!1;const qn=this._elevation;if(qn&&pn>ke&&Ze!==0){const kn=this.calculateProjMatrix(Pt.tileID.toUnwrapped());let Nn;r.isTerrainDEM||(Nn=qn.getMinMaxForTile(Pt.tileID)),Nn||(Nn={min:ne,max:de});const Fn=i.bH(this.rotation),_r=[Fn[0]*i.V,Fn[1]*i.V,Nn.max];i.N.transformMat4(_r,_r,kn),gn=(1-_r[1])*this.height*.5<Ze}return pn<ke||gn})}return et.sort((ke,Ze)=>ke.distanceSq-Ze.distanceSq).map(ke=>ke.tileID)}resize(r,s){this.width=r,this.height=s,this.pixelsToGLUnits=[2/r,-2/s],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const s=i.aa(r.lat,-i.bw,i.bw),h=this.projection.project(r.lng,s);return new i.P(h.x*this.worldSize,h.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.bl(1,this.center.lat)/this.worldSize}setLocationAtPoint(r,s){let h,p;const y=this.centerPoint;if(this.projection.name==="globe"){const M=this.worldSize;h=(s.x-y.x)/M,p=(s.y-y.y)/M}else{const M=this.pointCoordinate(s),C=this.pointCoordinate(y);h=M.x-C.x,p=M.y-C.y}const w=this.locationCoordinate(r);this.setLocation(new i.L(w.x-h,w.y-p))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r){return this.projection.locationPoint(this,r)}locationPoint3D(r){return this.projection.locationPoint(this,r,!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,s){const h=s?i.bl(s,r.lat):void 0,p=this.projection.project(r.lng,r.lat);return new i.L(p.x,p.y,h)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,s){const h=s??this._centerAltitude,p=[r.x,r.y,0,1],y=[r.x,r.y,1,1];i.a7.transformMat4(p,p,this.pixelMatrixInverse),i.a7.transformMat4(y,y,this.pixelMatrixInverse);const w=y[3];i.a7.scale(p,p,1/p[3]),i.a7.scale(y,y,1/w);const M=p[2],C=y[2];return{p0:p,p1:y,t:M===C?0:(h-M)/(C-M)}}screenPointToMercatorRay(r){const s=[r.x,r.y,0,1],h=[r.x,r.y,1,1];return i.a7.transformMat4(s,s,this.pixelMatrixInverse),i.a7.transformMat4(h,h,this.pixelMatrixInverse),i.a7.scale(s,s,1/s[3]),i.a7.scale(h,h,1/h[3]),s[2]=i.bl(s[2],this._center.lat)*this.worldSize,h[2]=i.bl(h[2],this._center.lat)*this.worldSize,i.a7.scale(s,s,1/this.worldSize),i.a7.scale(h,h,1/this.worldSize),new i.a2([s[0],s[1],s[2]],i.N.normalize([],i.N.sub([],h,s)))}rayIntersectionCoordinate(r){const{p0:s,p1:h,t:p}=r,y=i.bl(s[2],this._center.lat),w=i.bl(h[2],this._center.lat);return new i.L(i.U(s[0],h[0],p)/this.worldSize,i.U(s[1],h[1],p)/this.worldSize,i.U(y,w,p))}pointCoordinate(r,s=this._centerAltitude){return this.projection.pointCoordinate(this,r.x,r.y,s)}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);let s=this.projection.pointCoordinate3D(this,r.x,r.y);if(s)return new i.L(s[0],s[1],s[2]);let h=0,p=this.horizonLineFromTop();if(r.y>p)return this.pointCoordinate(r);const y=.02*p,w=r.clone();for(let M=0;M<10&&p-h>y;M++){w.y=i.U(h,p,.66);const C=this.projection.pointCoordinate3D(this,w.x,w.y);C?(p=w.y,s=C):h=w.y}return s?new i.L(s[0],s[1],s[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){return this.projection.isPointAboveHorizon(this,r)}isPointOnSurface(r){if(r.y<0||r.y>this.height||r.x<0||r.x>this.width)return!1;if(this.elevation||this.zoom>=i.bx)return!this.isPointAboveHorizon(r);const s=this.pointCoordinate(r);return s.y>=0&&s.y<=1}_coordinatePoint(r,s){const h=s&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,p=[r.x*this.worldSize,r.y*this.worldSize,h+r.toAltitude(),1];return i.a7.transformMat4(p,p,this.pixelMatrix),p[3]>0?new i.P(p[0]/p[3],p[1]/p[3]):new i.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:r,left:s}=this._edgeInsets,h=this.height-this._edgeInsets.bottom,p=this.width-this._edgeInsets.right,y=this.pointLocation3D(new i.P(s,r)),w=this.pointLocation3D(new i.P(p,r)),M=this.pointLocation3D(new i.P(p,h)),C=this.pointLocation3D(new i.P(s,h));let k=Math.min(y.lng,w.lng,M.lng,C.lng),z=Math.max(y.lng,w.lng,M.lng,C.lng),B=Math.min(y.lat,w.lat,M.lat,C.lat),$=Math.max(y.lat,w.lat,M.lat,C.lat);const H=Math.pow(2,-this.zoom)/16*270,K=this.projection.name==="globe"?1:4,X=(Q,Z,ie,he,se)=>{const de=(Q+ie)/2,ne=(Z+he)/2,pe=new i.P(de,ne),{lng:Se,lat:Ae}=this.pointLocation3D(pe),Le=Math.max(0,k-Se,B-Ae,Se-z,Ae-$);k=Math.min(k,Se),z=Math.max(z,Se),B=Math.min(B,Ae),$=Math.max($,Ae),(se<K||Le>H)&&(X(Q,Z,de,ne,se+1),X(de,ne,ie,he,se+1))};if(X(s,r,p,r,1),X(p,r,p,h,1),X(p,h,s,h,1),X(s,h,s,r,1),this.projection.name==="globe"){const[Q,Z]=i.by(this);Q?($=90,z=180,k=-180):Z&&(B=-90,z=180,k=-180)}return new i.ad(new i.bn(k,B),new i.bn(z,$))}_getBoundsRectangular(r,s){const{top:h,left:p}=this._edgeInsets,y=this.height-this._edgeInsets.bottom,w=this.width-this._edgeInsets.right,M=new i.P(p,h),C=new i.P(w,h),k=new i.P(w,y),z=new i.P(p,y);let B=this.pointCoordinate(M,r),$=this.pointCoordinate(C,r);const H=this.pointCoordinate(k,s),K=this.pointCoordinate(z,s),X=(Q,Z)=>(Z.y-Q.y)/(Z.x-Q.x);return B.y>1&&$.y>=0?B=new i.L((1-K.y)/X(K,B)+K.x,1):B.y<0&&$.y<=1&&(B=new i.L(-K.y/X(K,B)+K.x,0)),$.y>1&&B.y>=0?$=new i.L((1-H.y)/X(H,$)+H.x,1):$.y<0&&B.y<=1&&($=new i.L(-H.y/X(H,$)+H.x,0)),new i.ad().extend(this.coordinateLocation(B)).extend(this.coordinateLocation($)).extend(this.coordinateLocation(K)).extend(this.coordinateLocation(H))}_getBoundsRectangularTerrain(){const r=this.elevation;if(!r.visibleDemTiles.length||r.isUsingMockSource())return this._getBoundsRectangular(0,0);const s=r.visibleDemTiles.reduce((h,p)=>{if(p.dem){const y=p.dem.tree;h.min=Math.min(h.min,y.minimums[0]),h.max=Math.max(h.max,y.maximums[0])}return h},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(s.min*r.exaggeration(),s.max*r.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(r=!0){const s=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,h=this.height/2-s*(1-this._horizonShift);return r?Math.max(0,h):h}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-i.bw,this.maxLat=i.bw,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.a5(this.minLng)*this.tileSize,this.worldMaxX=i.a5(this.maxLng)*this.tileSize,this.worldMinY=i.ae(this.maxLat)*this.tileSize,this.worldMaxY=i.ae(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,s){return this.projection.createTileMatrix(this,s,r)}calculateDistanceTileData(r){const s=r.key,h=this._distanceTileDataCache;if(h[s])return h[s];const p=r.canonical,y=1/this.height,w=this.cameraWorldSize,M=w/this.zoomScale(p.z),C=(p.x+Math.pow(2,p.z)*r.wrap)*M,k=p.y*M,z=this.point;z.x*=w/this.worldSize,z.y*=w/this.worldSize;const B=this.angle,$=Math.sin(-B),H=-Math.cos(-B);return h[s]={bearing:[$,H],center:[(z.x-C)*y,(z.y-k)*y],scale:M/i.V*y},h[s]}calculateFogTileMatrix(r){const s=r.key,h=this._fogTileMatrixCache;if(h[s])return h[s];const p=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,r);return i.a6.multiply(p,this.worldToFogMatrix,p),h[s]=new Float32Array(p),h[s]}calculateProjMatrix(r,s=!1,h=!1){const p=r.key;let y;if(y=h?this._expandedProjMatrixCache:s?this._alignedProjMatrixCache:this._projMatrixCache,y[p])return y[p];const w=this.calculatePosMatrix(r,this.worldSize);let M;return M=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:h?this.expandedFarZProjMatrix:s?this.alignedProjMatrix:this.projMatrix,i.a6.multiply(w,M,w),y[p]=new Float32Array(w),y[p]}calculatePixelsToTileUnitsMatrix(r){const s=r.tileID.key,h=this._pixelsToTileUnitsCache;if(h[s])return h[s];const p=i.bz(r,this);return h[s]=p,h[s]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const r=1/this.worldSize,s=i.a6.fromScaling([],[r,r,r]);return i.a6.multiply(s,s,this.globeMatrix),s}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const r=this._elevation;this._updateCameraState();const s=i.bl(1,this._center.lat)*this.worldSize,h=this._computeCameraPosition(s),p=this._camera.forward(),y=i.bl(1,this._center.lat);h[2]/=y,p[2]/=y,i.N.normalize(p,p);const w=r.raycast(h,p,r.exaggeration());if(w){const M=i.N.scaleAndAdd([],h,p,w),C=new i.L(M[0],M[1],i.bl(M[2],i.au(M[1]))),k=(C.z+i.N.length([C.x-h[0],C.y-h[1],C.z-h[2]*y]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(k),this._centerAltitude=C.toAltitude(),this._center=this.coordinateLocation(C),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(r=!1){if(!this._elevation)return;const s=this._elevation,h=i.bl(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(h),y=s.getAtPointOrZero(new i.L(...p)),w=this.pixelsPerMeter/this.worldSize*y,M=this._minimumHeightOverTerrain(),C=p[2]-w;if(C<=M)if(C<0||r){const k=this.locationCoordinate(this._center,this._centerAltitude),z=[p[0],p[1],k.z-p[2]],B=i.N.length(z);z[2]-=(M-C)/this._pixelsPerMercatorPixel;const $=i.N.length(z);if($===0)return;i.N.scale(z,z,B/$*this._pixelsPerMercatorPixel),this._camera.position=[p[0],p[1],k.z*this._pixelsPerMercatorPixel-z[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||r){const $=this.center;return $.lat=i.aa($.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!r)&&($.lng=i.aa($.lng,this.minLng,this.maxLng)),this.center=$,void(this._constraining=!1)}const s=this._unmodified,{x:h,y:p}=this.point;let y=0,w=h,M=p;const C=this.width/2,k=this.height/2,z=this.worldMinY*this.scale,B=this.worldMaxY*this.scale;if(p-k<z&&(M=z+k),p+k>B&&(M=B-k),B-z<this.height&&(y=Math.max(y,this.height/(B-z)),M=(B+z)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const $=this.worldMinX*this.scale,H=this.worldMaxX*this.scale,K=this.worldSize/2-($+H)/2;w=(h+K+this.worldSize)%this.worldSize-K,w-C<$&&(w=$+C),w+C>H&&(w=H-C),H-$<this.width&&(y=Math.max(y,this.width/(H-$)),w=(H+$)/2)}w===h&&M===p||(this.center=this.unproject(new i.P(w,M))),y&&(this.zoom+=this.scaleZoom(y)),this._constrainCamera(),this._unmodified=s,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,s=this.projection.name==="globe",h=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.bl(1,this.center.lat)/i.bl(1,i.bI));const p=i.bA(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,p),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const y=this.projection.zAxisUnit==="meters"?h:1,w=this._camera.getWorldToCamera(this.worldSize,y);let M;const C=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(C[8]=2*-r.x/this.width,C[9]=2*r.y/this.height,this.isOrthographic){let Ae=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Le=Ae*this.aspect,et=-Le,je=-Ae;Le-=r.x,et-=r.x,Ae+=r.y,je+=r.y,M=this._camera.getCameraToClipOrthographic(et,Le,je,Ae,this._nearZ,this._farZ),((dt,at,At,$e)=>{for(let ot=0;ot<16;ot++)dt[ot]=Cn(at[ot],At[ot],$e)})(M,M,C,Pn(this.pitch>=15?1:this.pitch/15))}else M=C;const k=i.a6.mul([],C,w);let z=i.a6.mul([],M,w);if(this.projection.isReprojectedInTileSpace){const Ae=this.locationCoordinate(this.center),Le=i.a6.identity([]);i.a6.translate(Le,Le,[Ae.x*this.worldSize,Ae.y*this.worldSize,0]),i.a6.multiply(Le,Le,i.bB(this)),i.a6.translate(Le,Le,[-Ae.x*this.worldSize,-Ae.y*this.worldSize,0]),i.a6.multiply(z,z,Le),i.a6.multiply(k,k,Le),this.inverseAdjustmentMatrix=i.bC(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=i.a6.scale([],z,[this.worldSize,this.worldSize,this.worldSize/y,1]),this.projMatrix=z,this.invProjMatrix=i.a6.invert(new Float64Array(16),this.projMatrix),s){const Ae=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Ae[8]=2*-r.x/this.width,Ae[9]=2*r.y/this.height,this.expandedFarZProjMatrix=i.a6.mul([],Ae,w)}else this.expandedFarZProjMatrix=this.projMatrix;const B=i.a6.invert([],M);this.frustumCorners=i.bD.fromInvProjectionMatrix(B,this.horizonLineFromTop(),this.height),this.cameraFrustum=i.bq.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!s);const $=new Float32Array(16);i.a6.identity($),i.a6.scale($,$,[1,-1,1]),i.a6.rotateX($,$,this._pitch),i.a6.rotateZ($,$,this.angle);const H=i.a6.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=i.a6.clone(H);const K=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;H[8]=2*-r.x/this.width,H[9]=2*(r.y+K)/this.height,this.skyboxMatrix=i.a6.multiply($,H,$);const X=this.point,Q=X.x,Z=X.y,ie=this.width%2/2,he=this.height%2/2,se=Math.cos(this.angle),de=Math.sin(this.angle),ne=Q-Math.round(Q)+se*ie+de*he,pe=Z-Math.round(Z)+se*he+de*ie,Se=new Float64Array(z);if(i.a6.translate(Se,Se,[ne>.5?ne-1:ne,pe>.5?pe-1:pe,0]),this.alignedProjMatrix=Se,z=i.a6.create(),i.a6.scale(z,z,[this.width/2,-this.height/2,1]),i.a6.translate(z,z,[1,-1,0]),this.labelPlaneMatrix=z,z=i.a6.create(),i.a6.scale(z,z,[1,-1,1]),i.a6.translate(z,z,[-1,-1,0]),i.a6.scale(z,z,[2/this.width,2/this.height,1]),this.glCoordMatrix=z,this.pixelMatrix=i.a6.multiply(new Float64Array(16),this.labelPlaneMatrix,k),this._calcFogMatrices(),this._distanceTileDataCache={},z=i.a6.invert(new Float64Array(16),this.pixelMatrix),!z)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=z,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.bE(this);const Ae=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.N.transformMat4(Ae,Ae,w),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=z;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSizeForFog,s=this.cameraPixelsPerMeter,h=this._camera.position,p=1/this.height/this._pixelsPerMercatorPixel,y=[r,r,s];i.N.scale(y,y,p),i.N.scale(h,h,-1),i.N.multiply(h,h,y);const w=i.a6.create();i.a6.translate(w,w,h),i.a6.scale(w,w,y),this.mercatorFogMatrix=w,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,s,p)}_computeCameraPosition(r){const s=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,h=this._camera.forward(),p=this.point,y=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*s-r/this.worldSize*this._centerAltitude;return[p.x/this.worldSize-h[0]*y,p.y/this.worldSize-h[1]*y,r/this.worldSize*this._centerAltitude-h[2]*y]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const s=this._maxCameraBoundsDistance()*Math.cos(this._pitch),h=this._camera.position[2],p=r[2];let y=1;this.projection.wrap&&(this.center=this.center.wrap()),p>0&&(y=Math.min((s-h)/p,1)),this._camera.position=i.N.scaleAndAdd([],this._camera.position,r,y),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,s=this._camera.forward(),{pitch:h,bearing:p}=this._camera.getPitchBearing(),y=i.bl(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,w=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.bj(this._maxPitch)),M=Math.max((r[2]-y)/Math.cos(h),w),C=this._zoomFromMercatorZ(M);i.N.scaleAndAdd(r,r,s,M),this._pitch=i.aa(h,i.bj(this.minPitch),i.bj(this.maxPitch)),this.angle=i.bh(p,-Math.PI,Math.PI),this._setZoom(i.aa(C,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.L(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}zoomFromMercatorZAdjusted(r){let s=0,h=i.bx,p=0,y=1/0;for(;h-s>1e-6&&h>s;){const w=s+.5*(h-s),M=this.tileSize*Math.pow(2,w),C=this.getCameraToCenterDistance(this.projection,w,M),k=this.scaleZoom(C/(r*this.tileSize)),z=Math.abs(w-k);z<y&&(y=z,p=w),w<k?s=w:h=w}return p}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(r,s){const h=Math.min(r.x,s.x),p=Math.max(r.x,s.x),y=Math.min(r.y,s.y),w=Math.max(r.y,s.y);if(y<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const M=[new i.P(h,y),new i.P(p,w),new i.P(h,w),new i.P(p,y)],C=this.renderWorldCopies?-3:0,k=this.renderWorldCopies?4:1;for(const z of M){const B=this.pointRayIntersection(z);if(B.t<0)return!0;const $=this.rayIntersectionCoordinate(B);if($.x<C||$.y<0||$.x>k||$.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.bF(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.P(0,0),new i.P(this.width,this.height))}zoomDeltaToMovement(r,s){const h=i.N.length(i.N.sub([],this._camera.position,r)),p=this._zoomFromMercatorZ(h)+s;return h-this._mercatorZfromZoom(p)}getCameraPoint(){if(this.projection.name==="globe"){const r=function([s,h,p],y){const w=[s,h,p,1];i.a7.transformMat4(w,w,y);const M=w[3]=Math.max(w[3],1e-6);return w[0]/=M,w[1]/=M,w[2]/=M,w}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.P(r[0],r[1])}{const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(0,r))}}getCameraToCenterDistance(r,s=this.zoom,h=this.worldSize){const p=i.bA(r,s,this.width,this.height,1024),y=r.pixelSpaceConversion(this.center.lat,h,p);let w=.5/Math.tan(.5*this._fov)*this.height*y;return this.isOrthographic&&(w=Cn(1,w,Pn(this.pitch>=15?1:this.pitch/15))),w}getWorldToCameraMatrix(){const r=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.a6.multiply(r,r,this.globeMatrix),r}getFrustum(r){return i.bq.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r,this.projection.zAxisUnit==="meters")}}const Er={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,ShadowMap0:10},tr=(c,r)=>{if(r>0&&c.terrain&&i.w("Cutoff is currently disabled on terrain"),r<=0||c.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const s=c.transform,h=Math.max(Math.abs(s._zoom-(c.minCutoffZoom-1)),1),p=s.isLODDisabled(!1)?i.O(60,45,s.pitch):i.O(30,15,s.pitch),y=s._farZ-s._nearZ,w=r*s.height,M=((1-(C=p))*s.cameraToCenterDistance+C*(s._farZ+w))*h;var C;return{shouldRenderCutoff:p<1,uniformValues:{u_cutoff_params:[s._nearZ,s._farZ,(M-s._nearZ)/y,(M-w-s._nearZ)/y]}}},Fr={cascadeCount:2,shadowMapResolution:2048};class ci{constructor(r,s){this.aabb=r,this.lastCascade=s}}class Ri{add(r,s){const h=this.receivers[r.key];h!==void 0?(h.aabb.min[0]=Math.min(h.aabb.min[0],s.min[0]),h.aabb.min[1]=Math.min(h.aabb.min[1],s.min[1]),h.aabb.min[2]=Math.min(h.aabb.min[2],s.min[2]),h.aabb.max[0]=Math.max(h.aabb.max[0],s.max[0]),h.aabb.max[1]=Math.max(h.aabb.max[1],s.max[1]),h.aabb.max[2]=Math.max(h.aabb.max[2],s.max[2])):this.receivers[r.key]=new ci(s,null)}clear(){this.receivers={}}get(r){return this.receivers[r.key]}computeRequiredCascades(r,s,h){const p=i.bS.fromPoints(r.points);let y=0;for(const w in this.receivers){const M=this.receivers[w];if(!M||!p.intersectsAabb(M.aabb))continue;M.aabb.min=p.closestPoint(M.aabb.min),M.aabb.max=p.closestPoint(M.aabb.max);const C=M.aabb.getCorners();for(let k=0;k<h.length;k++){let z=!0;for(const B of C){const $=[B[0]*s,B[1]*s,B[2]];if(i.N.transformMat4($,$,h[k].matrix),$[0]<-1||$[0]>1||$[1]<-1||$[1]>1){z=!1;break}}if(M.lastCascade=k,y=Math.max(y,k),z)break}}return y+1}}class Bi{constructor(r){this.painter=r,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new Ri,this._depthMode=new xn(r.context.gl.LEQUAL,xn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this.useNormalOffset=!1,r.tp.registerParameter(Fr,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),r.tp.registerParameter(Fr,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32})}destroy(){for(const r of this._cascades)r.texture.destroy(),r.framebuffer.destroy();this._cascades=[]}updateShadowParameters(r,s){const h=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!s||!s.properties)return;const p=s.properties.get("shadow-intensity");if(!s.shadowsEnabled()||p<=0||(this._shadowLayerCount=h.style.order.reduce((K,X)=>{const Q=h.style._mergedLayers[X];return K+(Q.hasShadowPass()&&!Q.isHidden(r.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this._enabled))return;const y=h.context,w=Fr.shadowMapResolution,M=Fr.shadowMapResolution;if(this._cascades.length===0||Fr.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let K=0;K<Fr.cascadeCount;++K){const X=h._shadowMapDebug,Q=y.gl,Z=y.createFramebuffer(w,M,X,"texture"),ie=new i.T(y,{width:w,height:M,data:null},Q.DEPTH_COMPONENT);if(Z.depthAttachment.set(ie.texture),X){const he=new i.T(y,{width:w,height:M,data:null},Q.RGBA);Z.colorAttachment.set(he.texture)}this._cascades.push({framebuffer:Z,texture:ie,matrix:[],far:0,boundingSphereRadius:0,frustum:new i.bq,scale:0})}}this.shadowDirection=Jr(s);let C=0;if(r.elevation){const K=r.elevation,X=[1e4,-1e4];K.visibleDemTiles.filter(Q=>Q.dem).forEach(Q=>{const Z=Q.dem.tree;X[0]=Math.min(X[0],Z.minimums[0]),X[1]=Math.max(X[1],Z.maximums[0])}),X[0]!==1e4&&(C=(X[1]-X[0])*K.exaggeration())}const k=1.5*r.cameraToCenterDistance,z=3*k,B=new Float64Array(16);for(let K=0;K<this._cascades.length;++K){const X=this._cascades[K];let Q=r.height/50,Z=1;Fr.cascadeCount===1?Z=z:K===0?Z=k:(Q=k,Z=z);const[ie,he]=Ni(r,this.shadowDirection,Q,Z,Fr.shadowMapResolution,C);X.scale=r.scale,X.matrix=ie,X.boundingSphereRadius=he,i.a6.invert(B,X.matrix),X.frustum=i.bq.fromInvProjectionMatrix(B,1,0,!0),X.far=Z}const $=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[$].far,this._cascades[$].far],this._uniformValues.u_shadow_intensity=p,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Fr.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Fr.shadowMapResolution,this._uniformValues.u_shadowmap_0=Er.ShadowMap0,this._uniformValues.u_shadowmap_1=Er.ShadowMap0+1,this._groundShadowTiles=h.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const H=h.transform.elevation;for(const K of this._groundShadowTiles){let X={min:0,max:0};if(H){const Q=H.getMinMaxForTile(K);Q&&(X=Q)}this.addShadowReceiver(K.toUnwrapped(),X.min,X.max)}}get enabled(){return this._enabled}set enabled(r){this._enabled=r}drawShadowPass(r,s){if(!this._enabled)return;const h=this.painter,p=h.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(h.transform.getFrustum(0),h.transform.worldSize,this._cascades),p.viewport.set([0,0,Fr.shadowMapResolution,Fr.shadowMapResolution]);for(let y=0;y<this._numCascadesToRender;++y){h.currentShadowCascade=y,p.bindFramebuffer.set(this._cascades[y].framebuffer.framebuffer),p.clear({color:i.ax.white,depth:1});for(const w of r.order){const M=r._mergedLayers[w];if(!M.hasShadowPass()||M.isHidden(h.transform.zoom))continue;const C=r.getLayerSourceCache(M),k=C?s[C.id]:void 0;(M.type==="model"||k&&k.length)&&h.renderLayer(h,C,M,k)}}h.currentShadowCascade=0}drawGroundShadows(){if(!this._enabled)return;const r=this.painter,s=r.style,h=r.context,p=s.directionalLight,y=s.ambientLight;if(!p||!y)return;const w=[],M=tr(r,r.longestCutoffRange);M.shouldRenderCutoff&&w.push("RENDER_CUTOFF");const C=ri(p,y),k=new xn(h.gl.LEQUAL,xn.ReadOnly,r.depthRangeFor3D);for(const z of this._groundShadowTiles){const B=z.toUnwrapped(),$=r.isTileAffectedByFog(z),H=r.getOrCreateProgram("groundShadow",{defines:w,overrideFog:$});this.setupShadows(B,H),r.uploadCommonUniforms(h,H,B,null,M);const K={u_matrix:r.transform.calculateProjMatrix(B),u_ground_shadow_factor:C};H.draw(r,h.gl.TRIANGLES,k,Dn.disabled,Yn.multiply,bn.disabled,K,"ground_shadow",r.tileExtentBuffer,r.quadTriangleIndexBuffer,r.tileExtentSegments,{},r.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Yn.unblended:Yn.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(r){const s=this.painter.transform,h=s.calculatePosMatrix(r,s.worldSize);return i.a6.multiply(h,this._cascades[this.painter.currentShadowCascade].matrix,h),Float32Array.from(h)}calculateShadowPassMatrixFromMatrix(r){return i.a6.multiply(r,this._cascades[this.painter.currentShadowCascade].matrix,r),Float32Array.from(r)}setupShadows(r,s,h,p=0){if(!this._enabled)return;const y=this.painter.transform,w=this.painter.context,M=w.gl,C=this._uniformValues,k=new Float64Array(16),z=y.calculatePosMatrix(r,y.worldSize);for(let B=0;B<this._cascades.length;B++)i.a6.multiply(k,this._cascades[B].matrix,z),C[B===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(k),w.activeTexture.set(M.TEXTURE0+Er.ShadowMap0+B),this._cascades[B].texture.bind(M.NEAREST,M.CLAMP_TO_EDGE);if(this.useNormalOffset=!!h,this.useNormalOffset){const B=i.bR(r.canonical),$=2/y.tileSize*i.V/Fr.shadowMapResolution,H=$*this._cascades[0].boundingSphereRadius,K=$*this._cascades[this._cascades.length-1].boundingSphereRadius,X=(h==="vector-tile"?1:3)/Math.pow(2,p-r.canonical.z-(1-y.zoom+Math.floor(y.zoom)));C.u_shadow_normal_offset=[B,H*X,K*X],C.u_shadow_bias=[6e-5,.0012,.012]}else C.u_shadow_bias=[36e-5,.0012,.012];s.setShadowUniformValues(w,C)}setupShadowsFromMatrix(r,s,h=!1){if(!this._enabled)return;const p=this.painter.context,y=p.gl,w=this._uniformValues,M=new Float64Array(16);for(let C=0;C<Fr.cascadeCount;C++)i.a6.multiply(M,this._cascades[C].matrix,r),w[C===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(M),p.activeTexture.set(y.TEXTURE0+Er.ShadowMap0+C),this._cascades[C].texture.bind(y.NEAREST,y.CLAMP_TO_EDGE);this.useNormalOffset=h,h?(w.u_shadow_normal_offset=[1,5,5],w.u_shadow_bias=[6e-5,.0012,.012]):w.u_shadow_bias=[36e-5,.0012,.012],s.setShadowUniformValues(p,w)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(r,s,h,p){if(p[2]>=0)return{};const y=function(C,k,z){const B=z/(1<<C.canonical.z);return new i.bS([C.canonical.x*B+C.wrap*z,C.canonical.y*B+C.wrap*z,0],[(C.canonical.x+1)*B+C.wrap*z,(C.canonical.y+1)*B+C.wrap*z,k])}(r,s,h).getCorners(),w=s/-p[2];p[0]<0?(i.N.add(y[0],y[0],[p[0]*w,0,0]),i.N.add(y[3],y[3],[p[0]*w,0,0])):p[0]>0&&(i.N.add(y[1],y[1],[p[0]*w,0,0]),i.N.add(y[2],y[2],[p[0]*w,0,0])),p[1]<0?(i.N.add(y[0],y[0],[0,p[1]*w,0]),i.N.add(y[1],y[1],[0,p[1]*w,0])):p[1]>0&&(i.N.add(y[2],y[2],[0,p[1]*w,0]),i.N.add(y[3],y[3],[0,p[1]*w,0]));const M={};return M.vertices=y,M.planes=[Vr(y[1],y[0],y[4]),Vr(y[2],y[1],y[5]),Vr(y[3],y[2],y[6]),Vr(y[0],y[3],y[7])],M}addShadowReceiver(r,s,h){this._receivers.add(r,i.bS.fromTileIdAndHeight(r,s,h))}getMaxCascadeForTile(r){const s=this._receivers.get(r);return s&&s.lastCascade?s.lastCascade:0}}function Vr(c,r,s){const h=i.N.sub([],s,r),p=i.N.sub([],c,r),y=i.N.cross([],h,p),w=i.N.length(y);return w===0?[0,0,1,0]:(i.N.scale(y,y,1/w),[y[0],y[1],y[2],-i.N.dot(y,r)])}function Jr(c){const r=c.properties.get("direction"),s=i.bQ(r.x,r.y,r.z);s[2]=i.aa(s[2],0,75);const h=i.bT([s[0],s[1],s[2]]);return i.N.fromValues(h.x,h.y,h.z)}function ri(c,r){const s=c.properties.get("color"),h=c.properties.get("intensity"),p=c.properties.get("direction"),y=[p.x,p.y,p.z],w=r.properties.get("color"),M=r.properties.get("intensity"),C=Math.max(i.N.dot([0,0,1],y),0),k=[0,0,0];i.N.scale(k,w.toArray01Linear().slice(0,3),M);const z=[0,0,0];return i.N.scale(z,s.toArray01Linear().slice(0,3),C*h),i.bU([k[0]>0?k[0]/(k[0]+z[0]):0,k[1]>0?k[1]/(k[1]+z[1]):0,k[2]>0?k[2]/(k[2]+z[2]):0])}function Ni(c,r,s,h,p,y){const w=c.zoom,M=c.scale,C=c.worldSize,k=1/C,z=c.aspect,B=Math.sqrt(1+z*z)*Math.tan(.5*c.fovX),$=B*B,H=h-s,K=h+s;let X,Q;$>H/K?(X=h,Q=h*B):(X=.5*K*(1+$),Q=.5*Math.sqrt(H*H+2*(h*h+s*s)*$+K*K*$*$));const Z=c.projection.pixelsPerMeter(c.center.lat,C),ie=c._camera.getCameraToWorldMercator(),he=[0,0,-X*k];i.N.transformMat4(he,he,ie);let se=Q*k;const de=c._edgeInsets;if(!(de.left===0&&de.top===0&&de.right===0&&de.bottom===0||de.left===de.right&&de.top===de.bottom)){const Bt=c._camera.getWorldToCamera(c.worldSize,c.projection.zAxisUnit==="meters"?Z:1),Ft=c._camera.getCameraToClipPerspective(c._fov,c.width/c.height,s,h);Ft[8]=2*-c.centerOffset.x/c.width,Ft[9]=2*c.centerOffset.y/c.height;const Xt=new Float64Array(16);i.a6.mul(Xt,Ft,Bt);const un=new Float64Array(16);i.a6.invert(un,Xt);const vn=i.bq.fromInvProjectionMatrix(un,C,w,!0);for(const pn of vn.points){const gn=((ne=pn)[0]/=M,ne[1]/=M,ne[2]=i.bl(ne[2],c._center.lat),ne);se=Math.max(se,i.N.len(i.N.subtract([],he,gn)))}}var ne;se*=p/(p-1);const pe=Math.acos(r[2]),Se=Math.atan2(-r[0],-r[1]),Ae=new Qt;Ae.position=he,Ae.setPitchBearing(pe,Se);const Le=Ae.getWorldToCamera(C,Z),et=se*C,je=Math.min(c._mercatorZfromZoom(17)*C*-2,-2*et),dt=Ae.getCameraToClipOrthographic(-et,et,-et,et,je,(et+y*Z)/r[2]),at=new Float64Array(16);i.a6.multiply(at,dt,Le);const At=i.N.fromValues(Math.floor(1e6*he[0])/1e6*C,Math.floor(1e6*he[1])/1e6*C,0),$e=.5*p,ot=[0,0,0];i.N.transformMat4(ot,At,at),i.N.scale(ot,ot,$e);const ke=[Math.floor(ot[0]),Math.floor(ot[1]),Math.floor(ot[2])],Ze=[0,0,0];i.N.sub(Ze,ot,ke),i.N.scale(Ze,Ze,-1/$e);const Pt=new Float64Array(16);return i.a6.identity(Pt),i.a6.translate(Pt,Pt,Ze),i.a6.multiply(at,Pt,at),[at,et]}const bi=(c,r)=>jt(c,r&&r.filter(s=>s.identifier!=="source.canvas")),so=i.ac(lr,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),ji=i.ac(lr,["setCenter","setZoom","setBearing","setPitch"]),Vi={version:8,layers:[],sources:{}},$o={duration:300,delay:0},Go=new Set(["fill","line","background","hillshade","raster"]);class ao extends i.E{constructor(r,s={}){super(),this.map=r,this.scope=s.scope||"",this.fragments=[],this.importDepth=s.importDepth||0,this.importsCache=s.importsCache||new Map,this.resolvedImports=s.resolvedImports||new Set,this.transition=i.e({},$o),this._buildingIndex=new Qc(this),this.crossTileSymbolIndex=new ze,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=s.styleChanges||new Te,this.dispatcher=s.dispatcher?s.dispatcher:new i.bW(i.bX(),this),s.imageManager?this.imageManager=s.imageManager:(this.imageManager=new Ht,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=s.glyphManager?s.glyphManager:new i.bY(r._requestManager,s.localFontFamily?i.bZ.all:s.localIdeographFontFamily?i.bZ.ideographs:i.bZ.none,s.localFontFamily||s.localIdeographFontFamily),s.modelManager?this.modelManager=s.modelManager:(this.modelManager=new Ye(r._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=s.configOptions?s.configOptions:new Map,this._configDependentLayers=s.configDependentLayers?s.configDependentLayers:new Set,this._config=s.config,this.dispatcher.broadcast("setReferrer",i.b_());const h=this;this._rtlTextPluginCallback=ao.registerForPluginStateChange(p=>{h.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:p.pluginStatus,pluginURL:p.pluginURL},(y,w)=>{if(i.b$(y),w&&w.every(M=>M))for(const M in h._sourceCaches){const C=h._sourceCaches[M],k=C.getSource().type;k!=="vector"&&k!=="geojson"||C.reload()}})}),this.on("data",p=>{if(p.dataType!=="source"||p.sourceDataType!=="metadata")return;const y=this.getOwnSource(p.sourceId);if(y&&y.vectorLayerIds)for(const w in this._layers){const M=this._layers[w];M.source===y.id&&this._validateLayer(M)}})}loadURL(r,s={}){this.fire(new i.b("dataloading",{dataType:"style"}));const h=typeof s.validate=="boolean"?s.validate:!i.c0(r);r=this.map._requestManager.normalizeStyleURL(r,s.accessToken),this.resolvedImports.add(r);const p=this.importsCache.get(r);if(p)return this._load(p,h);const y=this.map._requestManager.transformRequest(r,i.R.Style);this._request=i.g(y,(w,M)=>{if(this._request=null,w)this.fire(new i.a(w));else if(M)return this.importsCache.set(r,M),this._load(M,h)})}loadJSON(r,s={}){this.fire(new i.b("dataloading",{dataType:"style"})),this._request=i.f.frame(()=>{this._request=null,this._load(r,s.validate!==!1)})}loadEmpty(){this.fire(new i.b("dataloading",{dataType:"style"})),this._load(Vi,!1)}_loadImports(r,s,h){if(this.importDepth>=4)return i.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const p=[];for(const y of r){const w=this._createFragmentStyle(y),M=new Promise(z=>{w.once("style.import.load",z),w.once("error",z)}).then(()=>this.mergeAll());if(p.push(M),this.resolvedImports.has(y.url)){w.loadEmpty();continue}const C=y.data||this.importsCache.get(y.url);C?w.loadJSON(C,{validate:s}):y.url?w.loadURL(y.url,{validate:s}):w.loadEmpty();const k={style:w,id:y.id,config:y.config};if(h){const z=this.fragments.findIndex(({id:B})=>B===h);this.fragments=this.fragments.slice(0,z).concat(k).concat(this.fragments.slice(z))}else this.fragments.push(k)}return Promise.allSettled(p)}_createFragmentStyle(r){const s=this.scope?i.ag(r.id,this.scope):r.id,h=new ao(this.map,{scope:s,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:r.config,configOptions:this.options,configDependentLayers:this._configDependentLayers});return h.setEventedParent(this.map,{style:h}),h}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options});const r=this.isRootStyle();this._shouldPrecompile=r,this.fire(new i.b(r?"style.load":"style.import.load"))}_load(r,s){const h=r.schema;if(this.isRootStyle()&&(r.fragment||h&&r.fragment!==!1)){const w=i.e({},Vi,{imports:[{id:"basemap",data:r,url:""}]});return void this._load(w,s)}if(this.setConfig(this._config,h),s&&bi(this,qt(r)))return;this._loaded=!0,this.stylesheet=i.c1(r);for(const w in r.sources)this.addSource(w,r.sources[w],{validate:!1,isInitialLoad:!0});r.sprite?this._loadSprite(r.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(r.glyphs,this.scope);const p=nc(this.stylesheet.layers);if(this._order=p.map(w=>w.id),this.stylesheet.light&&i.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const w=this.stylesheet.lights[0];this.light=new tn(w.properties,w.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new tn(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const w of p){const M=i.c2(w,this.scope,this.options);M.isConfigDependent&&this._configDependentLayers.add(M.fqid),M.setEventedParent(this,{layer:{id:M.id}}),this._layers[M.id]=M,this._serializedLayers[M.id]=M.serialize();const C=this.getOwnLayerSourceCache(M),k=!!this.directionalLight&&this.directionalLight.shadowsEnabled();C&&M.canCastShadows()&&k&&(C.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const y=this.stylesheet.terrain;y&&(this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=i.f.hasCanvasFingerprintNoise()),this.disableElevatedTerrain?i.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."):this.terrainSetForDrapingOnly()||this._createTerrain(y,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new i.b("data",{dataType:"style"})),r.imports?this._loadImports(r.imports,s).then(()=>this._reloadImports()):this._reloadImports()}isRootStyle(){return this.importDepth===0}mergeAll(){let r,s,h,p,y,w,M,C;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(k=>{if(k.stylesheet){if(k.light!=null&&(r=k.light),k.stylesheet.lights)for(const z of k.stylesheet.lights)z.type==="ambient"&&k.ambientLight!=null&&(s=k.ambientLight),z.type==="directional"&&k.directionalLight!=null&&(h=k.directionalLight);p=this._prioritizeTerrain(p,k.terrain,k.stylesheet.terrain),k.stylesheet.fog&&k.fog!=null&&(y=k.fog),k.stylesheet.camera!=null&&(C=k.stylesheet.camera),k.stylesheet.projection!=null&&(w=k.stylesheet.projection),k.stylesheet.transition!=null&&(M=k.stylesheet.transition)}}),this.light=r,this.ambientLight=s,this.directionalLight=h,this.fog=y,p===null?delete this.terrain:this.terrain=p,this.camera=C||{"camera-projection":"perspective"},this.projection=w||{name:"mercator"},this.transition=i.e({},$o,M),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(r){const s=h=>{for(const p of h.fragments)s(p.style);r(h)};s(this)}_prioritizeTerrain(r,s,h){const p=r&&r.drapeRenderMode===0;return h===null?s&&s.drapeRenderMode===0?s:p?r:null:s!=null&&(!r||p||s&&s.drapeRenderMode===1)?s:r}mergeTerrain(){let r;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(s=>{r=this._prioritizeTerrain(r,s.terrain,s.stylesheet.terrain)}),r===null?delete this.terrain:this.terrain=r}mergeProjection(){let r;this.forEachFragmentStyle(s=>{s.stylesheet.projection!=null&&(r=s.stylesheet.projection)}),this.projection=r||{name:"mercator"}}mergeSources(){const r={},s={},h={};this.forEachFragmentStyle(p=>{for(const y in p._sourceCaches){const w=i.ag(y,p.scope);r[w]=p._sourceCaches[y]}for(const y in p._otherSourceCaches){const w=i.ag(y,p.scope);s[w]=p._otherSourceCaches[y]}for(const y in p._symbolSourceCaches){const w=i.ag(y,p.scope);h[w]=p._symbolSourceCaches[y]}}),this._mergedSourceCaches=r,this._mergedOtherSourceCaches=s,this._mergedSymbolSourceCaches=h}mergeLayers(){const r={},s=[],h={};this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(y=>{for(const w of y._order){const M=y._layers[w];if(M.type==="slot"){const C=i.c3(w);if(r[C])continue;r[C]=[]}M.slot&&r[M.slot]?r[M.slot].push(M):s.push(M)}}),this._mergedOrder=[];const p=(y=[])=>{for(const w of y)if(w.type==="slot"){const M=i.c3(w.id);r[M]&&p(r[M])}else{const M=i.ag(w.id,w.scope);this._mergedOrder.push(M),h[M]=w,w.is3D()&&(this._has3DLayers=!0),w.type==="circle"&&(this._hasCircleLayers=!0),w.type==="symbol"&&(this._hasSymbolLayers=!0)}};p(s),this._mergedLayers=h,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(r){return this.stylesheet.camera=i.e({},this.stylesheet.camera,r),this.camera=this.stylesheet.camera,this}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(r){this._spriteRequest=function(s,h,p){let y,w,M;const C=i.f.devicePixelRatio>1?"@2x":"";let k=i.g(h.transformRequest(h.normalizeSpriteURL(s,C,".json"),i.R.SpriteJSON),($,H)=>{k=null,M||(M=$,y=H,B())}),z=i.d(h.transformRequest(h.normalizeSpriteURL(s,C,".png"),i.R.SpriteImage),($,H)=>{z=null,M||(M=$,w=H,B())});function B(){if(M)p(M);else if(y&&w){const $=i.f.getImageData(w),H={};for(const K in y){const{width:X,height:Q,x:Z,y:ie,sdf:he,pixelRatio:se,stretchX:de,stretchY:ne,content:pe}=y[K],Se=new i.h({width:X,height:Q});i.h.copy($,Se,{x:Z,y:ie},{x:0,y:0},{width:X,height:Q}),H[K]={data:Se,pixelRatio:se,sdf:he,stretchX:de,stretchY:ne,content:pe}}p(null,H)}}return{cancel(){k&&(k.cancel(),k=null),z&&(z.cancel(),z=null)}}}(r,this.map._requestManager,(s,h)=>{if(this._spriteRequest=null,s)this.fire(new i.a(s));else if(h)for(const p in h)this.imageManager.addImage(p,this.scope,h[p]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.b("data",{dataType:"style"}))})}_validateLayer(r){const s=this.getOwnSource(r.source);if(!s)return;const h=r.sourceLayer;h&&(s.type==="geojson"||s.vectorLayerIds&&s.vectorLayerIds.indexOf(h)===-1)&&this.fire(new i.a(new Error(`Source layer "${h}" does not exist on source "${s.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded())return!1;for(const{style:r}of this.fragments)if(!r.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((r,s)=>{const h=this.fragments[s];return h&&h.style&&(r.data=h.style.serialize()),r})}_serializeSources(){const r={};for(const s in this._sourceCaches){const h=this._sourceCaches[s].getSource();r[h.id]||(r[h.id]=h.serialize())}return r}_serializeLayers(r){const s=[];for(const h of r){const p=this._layers[h];p&&p.type!=="custom"&&s.push(p.serialize())}return s}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(r){return!!this.terrain&&(typeof r.isLayerDraped=="function"?r.isLayerDraped(this.getLayerSourceCache(r)):Go.has(r.type))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(r){const s=this.getOwnLayer(r);if(s)return s;this.fire(new i.a(new Error(`The layer '${r}' does not exist in the map's style.`)))}_checkSource(r){const s=this.getOwnSource(r);if(s)return s;this.fire(new i.a(new Error(`The source '${r}' does not exist in the map's style.`)))}update(r){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(r),this.directionalLight&&this.directionalLight.recalculate(r);const s=this.calculateLightsBrightness();r.brightness=s||0,s!==this._brightness&&(this._brightness=s,this.dispatcher.broadcast("setBrightness",s));const h=this._changes.isDirty();if(this._changes.isDirty()){const y=this._changes.getLayerUpdatesByScope();for(const w in y){const{updatedIds:M,removedIds:C}=y[w];(M||C)&&this._updateWorkerLayers(w,M,C)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(r),this.light&&this.light.updateTransitions(r),this.ambientLight&&this.ambientLight.updateTransitions(r),this.directionalLight&&this.directionalLight.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this._changes.reset()}const p={};for(const y in this._mergedSourceCaches){const w=this._mergedSourceCaches[y];p[y]=w.used,w.used=!1,w.tileCoverLift=0}for(const y of this._mergedOrder){const w=this._mergedLayers[y];if(w.recalculate(r,this._availableImages),!w.isHidden(r.zoom)){const M=this.getLayerSourceCache(w);M&&(M.used=!0,M.tileCoverLift=Math.max(M.tileCoverLift,w.tileCoverLift()))}if(!this._precompileDone&&this._shouldPrecompile)for(let M=w.minzoom||0;M<(w.maxzoom||25.5);M++){const C=this.map.painter;if(C){const k=w.getProgramIds();if(!k)continue;for(const z of k){const B=w.getDefaultProgramParams(z,r.zoom);B&&(C.style=this,this.fog&&(C._fogVisible=!0,B.overrideFog=!0,C.getOrCreateProgram(z,B)),C._fogVisible=!1,B.overrideFog=!1,C.getOrCreateProgram(z,B),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(B.overrideRtt=!0,C.getOrCreateProgram(z,B)))}}}}this._shouldPrecompile&&(this._precompileDone=!0);for(const y in p){const w=this._mergedSourceCaches[y];p[y]!==w.used&&w.getSource().fire(new i.b("data",{sourceDataType:"visibility",dataType:"source",sourceId:w.getSource().id}))}this.light&&this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),h&&this.fire(new i.b("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=this._changes.getUpdatedImages();if(r.length){for(const s in this._sourceCaches)this._sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],r);this._changes.resetUpdatedImages()}}_updateWorkerLayers(r,s,h){const p=this.getFragmentStyle(r);p&&this.dispatcher.broadcast("updateLayers",{layers:s?p._serializeLayers(s):[],scope:r,removedIds:h||[],options:p.options})}setState(r){if(this._checkLoaded(),bi(this,qt(r)))return!1;(r=i.c1(r)).layers=nc(r.layers);const s=function(p,y){if(!p)return[{command:lr.setStyle,args:[y]}];let w=[];try{if(!P(p.version,y.version))return[{command:lr.setStyle,args:[y]}];P(p.center,y.center)||w.push({command:lr.setCenter,args:[y.center]}),P(p.zoom,y.zoom)||w.push({command:lr.setZoom,args:[y.zoom]}),P(p.bearing,y.bearing)||w.push({command:lr.setBearing,args:[y.bearing]}),P(p.pitch,y.pitch)||w.push({command:lr.setPitch,args:[y.pitch]}),P(p.sprite,y.sprite)||w.push({command:lr.setSprite,args:[y.sprite]}),P(p.glyphs,y.glyphs)||w.push({command:lr.setGlyphs,args:[y.glyphs]}),P(p.imports,y.imports)||function(B=[],$=[],H){$=$||[];const K=(B=B||[]).map(Xs),X=$.map(Xs),Q=B.reduce(rc,{}),Z=$.reduce(rc,{}),ie=K.slice();let he,se,de,ne;for(he=0,se=0;he<K.length;he++)de=K[he],Z.hasOwnProperty(de)?se++:(H.push({command:lr.removeImport,args:[de]}),ie.splice(ie.indexOf(de,se),1));for(he=0,se=0;he<X.length;he++)de=X[X.length-1-he],ie[ie.length-1-he]!==de&&(Q.hasOwnProperty(de)?(H.push({command:lr.removeImport,args:[de]}),ie.splice(ie.lastIndexOf(de,ie.length-se),1)):se++,ne=ie[ie.length-he],H.push({command:lr.addImport,args:[Z[de],ne]}),ie.splice(ie.length-he,0,de));for(const pe of $){const Se=Q[pe.id];Se&&!P(Se,pe)&&H.push({command:lr.updateImport,args:[pe.id,pe]})}}(p.imports,y.imports,w),P(p.transition,y.transition)||w.push({command:lr.setTransition,args:[y.transition]}),P(p.light,y.light)||w.push({command:lr.setLight,args:[y.light]}),P(p.fog,y.fog)||w.push({command:lr.setFog,args:[y.fog]}),P(p.projection,y.projection)||w.push({command:lr.setProjection,args:[y.projection]}),P(p.lights,y.lights)||w.push({command:lr.setLights,args:[y.lights]}),P(p.camera,y.camera)||w.push({command:lr.setCamera,args:[y.camera]});const M={},C=[];(function(B,$,H,K){let X;for(X in $=$||{},B=B||{})B.hasOwnProperty(X)&&($.hasOwnProperty(X)||Ga(X,H,K));for(X in $){if(!$.hasOwnProperty(X))continue;const Q=$[X];B.hasOwnProperty(X)?P(B[X],Q)||(B[X].type==="geojson"&&Q.type==="geojson"&&kd(B,$,X)?H.push({command:lr.setGeoJSONSourceData,args:[X,Q.data]}):Dd(X,$,H,K)):yl(X,$,H)}})(p.sources,y.sources,C,M);const k=[];p.layers&&p.layers.forEach(B=>{B.source&&M[B.source]?w.push({command:lr.removeLayer,args:[B.id]}):k.push(B)});let z=p.terrain;z&&M[z.source]&&(w.push({command:lr.setTerrain,args:[void 0]}),z=void 0),w=w.concat(C),P(z,y.terrain)||w.push({command:lr.setTerrain,args:[y.terrain]}),function(B,$,H){$=$||[];const K=(B=B||[]).map(Xs),X=$.map(Xs),Q=B.reduce(rc,{}),Z=$.reduce(rc,{}),ie=K.slice(),he=Object.create(null);let se,de,ne,pe,Se,Ae,Le;for(se=0,de=0;se<K.length;se++)ne=K[se],Z.hasOwnProperty(ne)?de++:(H.push({command:lr.removeLayer,args:[ne]}),ie.splice(ie.indexOf(ne,de),1));for(se=0,de=0;se<X.length;se++)ne=X[X.length-1-se],ie[ie.length-1-se]!==ne&&(Q.hasOwnProperty(ne)?(H.push({command:lr.removeLayer,args:[ne]}),ie.splice(ie.lastIndexOf(ne,ie.length-de),1)):de++,Ae=ie[ie.length-se],H.push({command:lr.addLayer,args:[Z[ne],Ae]}),ie.splice(ie.length-se,0,ne),he[ne]=!0);for(se=0;se<X.length;se++)if(ne=X[se],pe=Q[ne],Se=Z[ne],!he[ne]&&!P(pe,Se))if(P(pe.source,Se.source)&&P(pe["source-layer"],Se["source-layer"])&&P(pe.type,Se.type)){for(Le in Ys(pe.layout,Se.layout,H,ne,null,lr.setLayoutProperty),Ys(pe.paint,Se.paint,H,ne,null,lr.setPaintProperty),P(pe.slot,Se.slot)||H.push({command:lr.setSlot,args:[ne,Se.slot]}),P(pe.filter,Se.filter)||H.push({command:lr.setFilter,args:[ne,Se.filter]}),P(pe.minzoom,Se.minzoom)&&P(pe.maxzoom,Se.maxzoom)||H.push({command:lr.setLayerZoomRange,args:[ne,Se.minzoom,Se.maxzoom]}),pe)pe.hasOwnProperty(Le)&&Le!=="layout"&&Le!=="paint"&&Le!=="filter"&&Le!=="metadata"&&Le!=="minzoom"&&Le!=="maxzoom"&&Le!=="slot"&&(Le.indexOf("paint.")===0?Ys(pe[Le],Se[Le],H,ne,Le.slice(6),lr.setPaintProperty):P(pe[Le],Se[Le])||H.push({command:lr.setLayerProperty,args:[ne,Le,Se[Le]]}));for(Le in Se)Se.hasOwnProperty(Le)&&!pe.hasOwnProperty(Le)&&Le!=="layout"&&Le!=="paint"&&Le!=="filter"&&Le!=="metadata"&&Le!=="minzoom"&&Le!=="maxzoom"&&Le!=="slot"&&(Le.indexOf("paint.")===0?Ys(pe[Le],Se[Le],H,ne,Le.slice(6),lr.setPaintProperty):P(pe[Le],Se[Le])||H.push({command:lr.setLayerProperty,args:[ne,Le,Se[Le]]}))}else H.push({command:lr.removeLayer,args:[ne]}),Ae=ie[ie.lastIndexOf(ne)+1],H.push({command:lr.addLayer,args:[Se,Ae]})}(k,y.layers,w)}catch(M){console.warn("Unable to compute style diff:",M),w=[{command:lr.setStyle,args:[y]}]}return w}(this.serialize(),r).filter(p=>!(p.command in ji));if(s.length===0)return!1;const h=s.filter(p=>!(p.command in so));if(h.length>0)throw new Error(`Unimplemented: ${h.map(p=>p.command).join(", ")}.`);return s.forEach(p=>{this[p.command].apply(this,p.args)}),this.stylesheet=r,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(r,s){return this.getImage(r)?this.fire(new i.a(new Error("An image with this name already exists."))):(this.imageManager.addImage(r,this.scope,s),this._afterImageUpdated(r),this)}updateImage(r,s){this.imageManager.updateImage(r,this.scope,s)}getImage(r){return this.imageManager.getImage(r,this.scope)}removeImage(r){return this.getImage(r)?(this.imageManager.removeImage(r,this.scope),this._afterImageUpdated(r),this):this.fire(new i.a(new Error("No image with this name exists.")))}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(r),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new i.b("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(r,s,h={}){return this._checkLoaded(),this._validate(nn,`models.${r}`,s,null,h)||(this.modelManager.addModel(r,s,this.scope),this._changes.setDirty()),this}hasModel(r){return this.modelManager.hasModel(r,this.scope)}removeModel(r){return this.hasModel(r)?(this.modelManager.removeModel(r,this.scope),this):this.fire(new i.a(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(r,s,h={}){if(this._checkLoaded(),this.getOwnSource(r)!==void 0)throw new Error(`There is already a source with ID "${r}".`);if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(Mn,`sources.${r}`,s,null,h))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const p=xi(r,s,this.dispatcher,this);p.scope=this.scope,p.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(p.id),source:p.serialize(),sourceId:p.id}));const y=w=>{const M=(w?"symbol:":"other:")+p.id,C=i.ag(M,this.scope),k=this._sourceCaches[M]=new Oo(C,p,w);(w?this._symbolSourceCaches:this._otherSourceCaches)[p.id]=k,k.onAdd(this.map)};y(!1),s.type!=="vector"&&s.type!=="geojson"||y(!0),p.onAdd&&p.onAdd(this.map),h.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(r){this._checkLoaded();const s=this.getOwnSource(r);if(!s)throw new Error("There is no source with this ID");for(const p in this._layers)if(this._layers[p].source===r)return this.fire(new i.a(new Error(`Source "${r}" cannot be removed while layer "${p}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===r)return this.fire(new i.a(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const h=this.getOwnSourceCaches(r);for(const p of h){const y=i.c3(p.id);delete this._sourceCaches[y],this._changes.discardSourceCacheUpdate(p.id),p.fire(new i.b("data",{sourceDataType:"metadata",dataType:"source",sourceId:p.getSource().id})),p.setEventedParent(null),p.clearTiles()}return delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],this.mergeSources(),s.setEventedParent(null),s.onRemove&&s.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(r,s){this._checkLoaded(),this.getOwnSource(r).setData(s),this._changes.setDirty()}getOwnSource(r){const s=this.getOwnSourceCache(r);return s&&s.getSource()}getOwnSources(){const r=[];for(const s in this._otherSourceCaches){const h=this.getOwnSourceCache(s);h&&r.push(h.getSource())}return r}areTilesLoaded(){const r=this._mergedSourceCaches;for(const s in r){const h=r[s]._tiles;for(const p in h){const y=h[p];if(y.state!=="loaded"&&y.state!=="errored")return!1}}return!0}setLights(r){if(this._checkLoaded(),!r)return delete this.ambientLight,void delete this.directionalLight;const s=this._getTransitionParameters();for(const p of r){if(this._validate(Qe,"lights",p))return;switch(p.type){case"ambient":if(this.ambientLight){const y=this.ambientLight;y.set(p),y.updateTransitions(s)}else this.ambientLight=new Ji(p,oo,this.scope,this.options);break;case"directional":if(this.directionalLight){const y=this.directionalLight;y.set(p),y.updateTransitions(s)}else this.directionalLight=new Ji(p,rr,this.scope,this.options)}}const h=new i.K(this.z||0,s);this.ambientLight&&this.ambientLight.recalculate(h),this.directionalLight&&this.directionalLight.recalculate(h),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const r=this.directionalLight,s=this.ambientLight;if(!r||!s)return;const h=B=>.2126*(B[0]<=.03928?B[0]/12.92:Math.pow((B[0]+.055)/1.055,2.4))+.7152*(B[1]<=.03928?B[1]/12.92:Math.pow((B[1]+.055)/1.055,2.4))+.0722*(B[2]<=.03928?B[2]/12.92:Math.pow((B[2]+.055)/1.055,2.4)),p=r.properties.get("color").toArray01(),y=r.properties.get("intensity"),w=r.properties.get("direction"),M=1-i.bQ(w.x,w.y,w.z)[2]/90,C=h(p)*y*M,k=s.properties.get("color").toArray01(),z=s.properties.get("intensity");return(C+h(k)*z)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const r=[];return this.directionalLight&&r.push(this.directionalLight.get()),this.ambientLight&&r.push(this.ambientLight.get()),r}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(r){if(!r)return this;if(i.c4(r)){const s=i.c5(r),h=this.fragments.find(({id:y})=>y===s);if(!h)throw new Error(`Style import not found: ${r}`);const p=i.c3(r);return h.style.getFragmentStyle(p)}{const s=this.fragments.find(({id:h})=>h===r);if(!s)throw new Error(`Style import not found: ${r}`);return s.style}}getConfigProperty(r,s){const h=this.getFragmentStyle(r);if(!h)return null;const p=i.ag(s,h.scope),y=h.options.get(p),w=y?y.value||y.default:null;return w?w.serialize():null}setConfigProperty(r,s,h){const p=i.r(h);if(p.result!=="success")return void bi(this,p.value);const y=p.value.expression,w=this.getFragmentStyle(r);if(!w)return;const M=i.ag(s,w.scope),C=w.options.get(M);C&&(this.options.set(M,{...C,value:y}),this.updateConfigDependencies())}setConfig(r,s){if(this._config=r,r||s)if(s)for(const h in s){let p,y;const w=i.r(s[h].default);if(w.result==="success"&&(p=w.value.expression),r&&r[h]!==void 0){const $=i.r(r[h]);$.result==="success"&&(y=$.value.expression)}const{minValue:M,maxValue:C,stepValue:k,type:z,values:B}=s[h];if(p){const $=i.ag(h,this.scope);this.options.set($,{default:p,value:y,minValue:M,maxValue:C,stepValue:k,type:z,values:B})}else this.fire(new i.a(new Error(`No schema defined for config option "${h}".`)))}else this.fire(new i.a(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(){for(const r of this._configDependentLayers){const s=this.getLayer(r);s&&(s.possiblyEvaluateVisibility(),this._updateLayer(s))}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this._changes.setDirty()}addLayer(r,s,h={}){this._checkLoaded();const p=r.id;if(this._layers[p])return void this.fire(new i.a(new Error(`Layer with id "${p}" already exists on this map`)));let y;if(r.type==="custom"){if(bi(this,i.c6(r)))return;y=i.c2(r,this.scope,this.options)}else{if(typeof r.source=="object"&&(this.addSource(p,r.source),r=i.c1(r),r=i.e(r,{source:p})),this._validate(Ee,`layers.${p}`,r,{arrayIndex:-1},h))return;y=i.c2(r,this.scope,this.options),this._validateLayer(y),y.setEventedParent(this,{layer:{id:p}}),this._serializedLayers[y.id]=y.serialize()}y.isConfigDependent&&this._configDependentLayers.add(y.fqid);let w=this._order.length;if(s){const z=this._order.indexOf(s);if(z===-1)return void this.fire(new i.a(new Error(`Layer with id "${s}" does not exist on this map.`)));y.slot===this._layers[s].slot?w=z:i.w(`Layer with id "${s}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(w,0,p),this._layerOrderChanged=!0,this._layers[p]=y;const M=this.getOwnLayerSourceCache(y),C=!!this.directionalLight&&this.directionalLight.shadowsEnabled();M&&y.canCastShadows()&&C&&(M.castsShadows=!0);const k=this._changes.getRemovedLayer(y);if(k&&y.source&&M&&y.type!=="custom"){this._changes.discardLayerRemoval(y);const z=i.ag(y.source,y.scope);k.type!==y.type?this._changes.updateSourceCache(z,"clear"):(this._changes.updateSourceCache(z,"reload"),M.pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map),y.scope=this.scope,this.mergeLayers()}moveLayer(r,s){this._checkLoaded();const h=this._checkLayer(r);if(!h||r===s)return;const p=this._order.indexOf(r);this._order.splice(p,1);let y=this._order.length;if(s){const w=this._order.indexOf(s);if(w===-1)return void this.fire(new i.a(new Error(`Layer with id "${s}" does not exist on this map.`)));h.slot===this._layers[s].slot?y=w:i.w(`Layer with id "${s}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(y,0,r),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(r){this._checkLoaded();const s=this._checkLayer(r);if(!s)return;s.setEventedParent(null);const h=this._order.indexOf(r);this._order.splice(h,1),delete this._layers[r],delete this._serializedLayers[r],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(s.fqid),this._changes.removeLayer(s);const p=this.getOwnLayerSourceCache(s);if(p&&p.castsShadows){let y=!1;for(const w in this._layers)if(this._layers[w].source===s.source&&this._layers[w].canCastShadows()){y=!0;break}p.castsShadows=y}s.onRemove&&s.onRemove(this.map),this.mergeLayers()}getOwnLayer(r){return this._layers[r]}hasLayer(r){return r in this._mergedLayers}hasLayerType(r){for(const s in this._layers)if(this._layers[s].type===r)return!0;return!1}setLayerZoomRange(r,s,h){this._checkLoaded();const p=this._checkLayer(r);p&&(p.minzoom===s&&p.maxzoom===h||(s!=null&&(p.minzoom=s),h!=null&&(p.maxzoom=h),this._updateLayer(p)))}setSlot(r,s){this._checkLoaded();const h=this._checkLayer(r);h&&h.slot!==s&&(h.slot=s,this._updateLayer(h))}setFilter(r,s,h={}){this._checkLoaded();const p=this._checkLayer(r);if(p&&!P(p.filter,s))return s==null?(p.filter=void 0,void this._updateLayer(p)):void(this._validate(it,`layers.${p.id}.filter`,s,{layerType:p.type},h)||(p.filter=i.c1(s),this._updateLayer(p)))}getFilter(r){const s=this._checkLayer(r);if(s)return i.c1(s.filter)}setLayoutProperty(r,s,h,p={}){this._checkLoaded();const y=this._checkLayer(r);if(y&&!P(y.getLayoutProperty(s),h)){if(h!=null&&(!p||p.validate!==!1)&&bi(y,Mt.call(qt,{key:`layers.${r}.layout.${s}`,layerType:y.type,objectKey:s,value:h,styleSpec:i.D,style:{glyphs:!0,sprite:!0}})))return;y.setLayoutProperty(s,h),y.isConfigDependent&&this._configDependentLayers.add(y.fqid),this._updateLayer(y)}}getLayoutProperty(r,s){const h=this._checkLayer(r);if(h)return h.getLayoutProperty(s)}setPaintProperty(r,s,h,p={}){this._checkLoaded();const y=this._checkLayer(r);if(!y||P(y.getPaintProperty(s),h)||h!=null&&(!p||p.validate!==!1)&&bi(y,pt.call(qt,{key:`layers.${r}.paint.${s}`,layerType:y.type,objectKey:s,value:h,styleSpec:i.D})))return;const w=y.setPaintProperty(s,h);y.isConfigDependent&&this._configDependentLayers.add(y.fqid),w&&this._updateLayer(y),this._changes.updatePaintProperties(y)}getPaintProperty(r,s){const h=this._checkLayer(r);if(h)return h.getPaintProperty(s)}setFeatureState(r,s){this._checkLoaded();const h=r.source,p=r.sourceLayer,y=this._checkSource(h);if(!y)return;const w=y.type;if(w==="geojson"&&p)return void this.fire(new i.a(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(w==="vector"&&!p)return void this.fire(new i.a(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new i.a(new Error("The feature id parameter must be provided.")));const M=this.getOwnSourceCaches(h);for(const C of M)C.setFeatureState(p,r.id,s)}removeFeatureState(r,s){this._checkLoaded();const h=r.source,p=this._checkSource(h);if(!p)return;const y=p.type,w=y==="vector"?r.sourceLayer:void 0;if(y==="vector"&&!w)return void this.fire(new i.a(new Error("The sourceLayer parameter must be provided for vector source types.")));if(s&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new i.a(new Error("A feature id is required to remove its specific state property.")));const M=this.getOwnSourceCaches(h);for(const C of M)C.removeFeatureState(w,r.id,s)}getFeatureState(r){this._checkLoaded();const s=r.source,h=r.sourceLayer,p=this._checkSource(s);if(p){if(p.type!=="vector"||h)return r.id===void 0&&this.fire(new i.a(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(s)[0].getFeatureState(h,r.id);this.fire(new i.a(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(r){return this.stylesheet.transition=i.e({},this.stylesheet.transition,r),this.transition=this.stylesheet.transition,this}getTransition(){return i.e({},this.stylesheet.transition)}serialize(){this._checkLoaded();const r=this.getTerrain(),s=r&&this.terrain&&this.terrain.scope===this.scope?r:this.stylesheet.terrain;return i.c7({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:s,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},h=>h!==void 0)}_updateLayer(r){this._changes.updateLayer(r);const s=this.getLayerSourceCache(r),h=i.ag(r.source,r.scope),p=this._changes.getUpdatedSourceCaches();r.source&&!p[h]&&s&&s.getSource().type!=="raster"&&(this._changes.updateSourceCache(h,"reload"),s.pause()),r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const s=M=>this._mergedLayers[M].type==="fill-extrusion"||this._mergedLayers[M].type==="model",h=this.order,p={},y=[];for(let M=h.length-1;M>=0;M--){const C=h[M];if(s(C)){p[C]=M;for(const k of r){const z=k[C];if(z)for(const B of z)y.push(B)}}}y.sort((M,C)=>C.intersectionZ-M.intersectionZ);const w=[];for(let M=h.length-1;M>=0;M--){const C=h[M];if(s(C))for(let k=y.length-1;k>=0;k--){const z=y[k].feature;if(p[z.layer.id]<M)break;w.push(z),y.pop()}else for(const k of r){const z=k[C];if(z)for(const B of z)w.push(B.feature)}}return w}queryRenderedFeatures(r,s,h){s&&s.filter&&this._validate(it,"queryRenderedFeatures.filter",s.filter,null,s),s.scope=this.scope,s.availableImages=this._availableImages,s.serializedLayers=this._serializedLayers;const p={};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new i.a(new Error("parameters.layers must be an Array."))),[];for(const k of s.layers){const z=this._mergedLayers[k];if(!z)return this.fire(new i.a(new Error(`The layer '${k}' does not exist in the map's style and cannot be queried for features.`))),[];p[z.source]=!0}}const y=[],w=s.serializedLayers||{},M=s&&s.layers?s.layers.some(k=>{const z=this.getLayer(k);return z&&z.is3D()}):this.has3DLayers(),C=vi.createFromScreenPoints(r,h);for(const k in this._mergedSourceCaches){const z=this._mergedSourceCaches[k].getSource();if(!z||z.scope!==s.scope)continue;const B=this._mergedSourceCaches[k].getSource().id;s.layers&&!p[B]||y.push(Jc(this._mergedSourceCaches[k],this._mergedLayers,w,C,s,h,M,!!this.map._showQueryGeometry))}return this.placement&&y.push(function(k,z,B,$,H,K,X){const Q={},Z=K.queryRenderedSymbols($),ie=[];for(const he of Object.keys(Z).map(Number))ie.push(X[he]);ie.sort($a);for(const he of ie){const se=he.featureIndex.lookupSymbolFeatures(Z[he.bucketInstanceId],z,he.bucketIndex,he.sourceLayerIndex,H.filter,H.layers,H.availableImages,k);for(const de in se){const ne=Q[de]=Q[de]||[],pe=se[de];pe.sort((Se,Ae)=>{const Le=he.featureSortOrder;if(Le){const et=Le.indexOf(Se.featureIndex);return Le.indexOf(Ae.featureIndex)-et}return Ae.featureIndex-Se.featureIndex});for(const Se of pe)ne.push(Se)}}for(const he in Q)Q[he].forEach(se=>{const de=se.feature,ne=B(k[he]);if(!ne)return;const pe=ne.getFeatureState(de.layer["source-layer"],de.id);de.source=de.layer.source,de.layer["source-layer"]&&(de.sourceLayer=de.layer["source-layer"]),de.state=pe});return Q}(this._mergedLayers,w,this.getLayerSourceCache.bind(this),C.screenGeometry,s,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(r,s){s&&s.filter&&this._validate(it,"querySourceFeatures.filter",s.filter,null,s);const h=this.getOwnSourceCaches(r);let p=[];for(const y of h)p=p.concat(Ss(y,s));return p}addSourceType(r,s,h){return ao.getSourceType(r)?h(new Error(`A source type called "${r}" already exists.`)):(ao.setSourceType(r,s),s.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:s.workerSourceURL},h):h(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(r,s,h={}){this._checkLoaded();const p=this.light.getLight();let y=!1;for(const M in r)if(!P(r[M],p[M])){y=!0;break}if(!y)return;const w=this._getTransitionParameters();this.light.setLight(r,s,h),this.light.updateTransitions(w)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(r,s=1){if(this._checkLoaded(),!r)return this.terrainSetForDrapingOnly()&&s!==0||delete this.terrain,r===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let h=r;const p=r.source==null;if(s===1){if(typeof h.source=="object"){const M="terrain-dem-src";this.addSource(M,h.source),h=i.c1(h),h=i.e(h,{source:M})}const y=i.e({},h),w={};if(this.terrain&&p){y.source=this.terrain.get().source;const M=this.terrain?this.getFragmentStyle(this.terrain.scope):null;M&&(w.style=M.serialize())}if(this._validate(re,"terrain",y,w))return}if(!this.terrain||this.terrain.scope!==this.scope&&!p||this.terrain&&s!==this.terrain.drapeRenderMode){if(!h)return;this._createTerrain(h,s),this.fire(new i.b("data",{dataType:"style"}))}else{const y=this.terrain,w=y.get();for(const M of Object.keys(i.D.terrain))!h.hasOwnProperty(M)&&i.D.terrain[M].default&&(h[M]=i.D.terrain[M].default);for(const M in r)if(!P(r[M],w[M])){y.set(r,this.options),this.stylesheet.terrain=r;const C=this._getTransitionParameters({duration:0});y.updateTransitions(C),this.fire(new i.b("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const s=this.fog=new io(r,this.map.transform,this.scope,this.options);this.stylesheet.fog=s.get();const h=this._getTransitionParameters({duration:0});s.updateTransitions(h)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const s=this.fog;if(!P(s.get(),r)){s.set(r,this.options),this.stylesheet.fog=s.get();const h=this._getTransitionParameters({duration:0});s.updateTransitions(h)}}else this._createFog(r);this._markersNeedUpdate=!0}_getTransitionParameters(r){return{now:i.f.now(),transition:i.e(this.transition,r)}}updateDrapeFirstLayers(){if(!this.terrain)return;const r=[],s=[];for(const h in this._mergedLayers)this.isLayerDraped(this._mergedLayers[h])?r.push(h):s.push(h);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...s)}_createTerrain(r,s){const h=this.terrain=new Ln(r,s,this.scope,this.options);s===1&&(this.stylesheet.terrain=r),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const p=this._getTransitionParameters({duration:0});h.updateTransitions(p)}_force3DLayerUpdate(){for(const r in this._layers){const s=this._layers[r];s.type==="fill-extrusion"&&this._updateLayer(s)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const s=this._layers[r];s.type==="symbol"&&this._updateLayer(s)}}_validate(r,s,h,p,y={}){if(y&&y.validate===!1)return!1;const w=i.e({},this.serialize());return bi(this,r.call(qt,i.e({key:s,style:w,value:h,styleSpec:i.D},p)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.c8.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._mergedLayers)this._mergedLayers[r].setEventedParent(null);for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles(),this._mergedSourceCaches[r].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(r){const s=this.getSourceCaches(r);for(const h of s)h.clearTiles()}clearSources(){for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles()}reloadSource(r){const s=this.getSourceCaches(r);for(const h of s)h.resume(),h.reload()}reloadSources(){for(const r of this.getSources())r.reload&&r.reload()}updateSources(r){let s;this.directionalLight&&(s=Jr(this.directionalLight));for(const h in this._mergedSourceCaches)this._mergedSourceCaches[h].update(r,void 0,void 0,s)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const s=this._sourceCaches[r];s.resume(),s.reload()}}_updatePlacement(r,s,h,p,y=!1){let w=!1,M=!1;const C={},k={};for(const z of this._mergedOrder){const B=this._mergedLayers[z];if(B.type!=="symbol")continue;const $=i.ag(B.source,B.scope);let H=C[$];if(!H){const X=this.getLayerSourceCache(B);if(!X)continue;const Q=X.getRenderableIds(!0).map(Z=>X.getTileByID(Z));k[$]=Q.slice(),H=C[$]=Q.sort((Z,ie)=>ie.tileID.overscaledZ-Z.tileID.overscaledZ||(Z.tileID.isLessThan(ie.tileID)?-1:1))}const K=this.crossTileSymbolIndex.addLayer(B,H,r.center.lng,r.projection);w=w||K}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),y=y||this._layerOrderChanged||h===0,this._layerOrderChanged&&this.fire(new i.b("neworder")),(y||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.f.now(),r.zoom))&&(this.pauseablePlacement=new ac(r,this._mergedOrder,y,s,h,p,this.placement,this.fog&&r.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,C,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.f.now()),M=!0),w&&this.pauseablePlacement.placement.setStale()),M||w){this._buildingIndex.onNewFrame(r.zoom);for(const z of this._mergedOrder){const B=this._mergedLayers[z];B.type==="symbol"&&this.placement.updateLayerOpacities(B,C[i.ag(B.source,B.scope)])}}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.f.now())}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}addImport(r,s){this._checkLoaded();const h=this.stylesheet.imports=this.stylesheet.imports||[];if(h.findIndex(({id:y})=>y===r.id)!==-1)return this.fire(new i.a(new Error(`Import with id '${r.id}' already exists in the map's style.`)));if(!s)return h.push(r),this._loadImports([r],!0),this;const p=h.findIndex(({id:y})=>y===s);return p===-1?this.fire(new i.a(new Error(`Import with id "${s}" does not exist on this map.`))):(this.stylesheet.imports=h.slice(0,p).concat(r).concat(h.slice(p)),this._loadImports([r],!0,s),this)}updateImport(r,s){this._checkLoaded();const h=this.stylesheet.imports||[],p=this.getImportIndex(r);return p===-1?this:typeof s=="string"?(this.setImportUrl(r,s),this):(s.url&&s.url!==h[p].url&&this.setImportUrl(r,s.url),P(s.config,h[p].config)||this.setImportConfig(r,s.config),P(s.data,h[p].data)||this.setImportData(r,s.data),this)}moveImport(r,s){this._checkLoaded();let h=this.stylesheet.imports||[];const p=this.getImportIndex(r);if(p===-1)return this;const y=this.getImportIndex(s);if(y===-1)return this;const w=h[p],M=this.fragments[p];return h=h.filter(({id:C})=>C!==r),this.fragments=this.fragments.filter(({id:C})=>C!==r),this.stylesheet.imports=h.slice(0,y).concat(w).concat(h.slice(y)),this.fragments=this.fragments.slice(0,y).concat(M).concat(this.fragments.slice(y)),this.mergeLayers(),this}setImportUrl(r,s){this._checkLoaded();const h=this.stylesheet.imports||[],p=this.getImportIndex(r);if(p===-1)return this;h[p].url=s;const y=this.fragments[p];return y.style=this._createFragmentStyle(h[p]),y.style.on("style.import.load",()=>this.mergeAll()),y.style.loadURL(s),this}setImportData(r,s){this._checkLoaded();const h=this.getImportIndex(r),p=this.stylesheet.imports||[];return h===-1?this:s?(this.fragments[h].style.setState(s),this._reloadImports(),this):(delete p[h].data,this.setImportUrl(r,p[h].url))}setImportConfig(r,s){this._checkLoaded();const h=this.getImportIndex(r),p=this.stylesheet.imports||[];if(h===-1)return this;s?p[h].config=s:delete p[h].config;const y=this.fragments[h],w=y.style.stylesheet&&y.style.stylesheet.schema;return y.config=s,y.style.setConfig(s,w),this.updateConfigDependencies(),this}removeImport(r){this._checkLoaded();const s=this.stylesheet.imports||[],h=this.getImportIndex(r);return h===-1||(s.splice(h,1),this.fragments[h].style._remove(),this.fragments.splice(h,1),this._reloadImports()),this}getImportIndex(r){const s=(this.stylesheet.imports||[]).findIndex(h=>h.id===r);return s===-1&&this.fire(new i.a(new Error(`Import '${r}' does not exist in the map's style and cannot be updated.`))),s}getLayer(r){return this._mergedLayers[r]}getSources(){const r=[];for(const s in this._mergedOtherSourceCaches){const h=this._mergedOtherSourceCaches[s];h&&r.push(h.getSource())}return r}getSource(r,s){const h=this.getSourceCache(r,s);return h&&h.getSource()}getLayerSource(r){const s=this.getLayerSourceCache(r);return s&&s.getSource()}getSourceCache(r,s){const h=i.ag(r,s);return this._mergedOtherSourceCaches[h]}getLayerSourceCache(r){const s=i.ag(r.source,r.scope);return r.type==="symbol"?this._mergedSymbolSourceCaches[s]:this._mergedOtherSourceCaches[s]}getSourceCaches(r){const s=[];return this._mergedOtherSourceCaches[r]&&s.push(this._mergedOtherSourceCaches[r]),this._mergedSymbolSourceCaches[r]&&s.push(this._mergedSymbolSourceCaches[r]),s}updateSourceCaches(){const r=this._changes.getUpdatedSourceCaches();for(const s in r){const h=r[s];h==="reload"?this.reloadSource(s):h==="clear"&&this.clearSource(s)}}updateLayers(r){const s=this._changes.getUpdatedPaintProperties();for(const h of s){const p=this.getLayer(h);p&&p.updateTransitions(r)}}getImages(r,s,h){this.imageManager.getImages(s.icons,s.scope,h),this._updateTilesForChangedImages();const p=y=>{y&&y.setDependencies(s.tileID.key,s.type,s.icons)};p(this._otherSourceCaches[s.source]),p(this._symbolSourceCaches[s.source])}getGlyphs(r,s,h){this.glyphManager.getGlyphs(s.stacks,s.scope,h)}getResource(r,s,h){return i.c9(s,h)}getOwnSourceCache(r){return this._otherSourceCaches[r]}getOwnLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}getOwnSourceCaches(r){const s=[];return this._otherSourceCaches[r]&&s.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&s.push(this._symbolSourceCaches[r]),s}_isSourceCacheLoaded(r){const s=this.getOwnSourceCaches(r);return s.length===0?(this.fire(new i.a(new Error(`There is no source with ID '${r}'`))),!1):s.every(h=>h.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(r=>{r.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}ao.getSourceType=function(c){return Es[c]},ao.setSourceType=function(c,r){Es[c]=r},ao.registerForPluginStateChange=i.bV;var cs=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,_o=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,vec2 pos,vec2 lod_coord) {vec2 size=vec2(textureSize(image,0));vec2 dx=dFdx(lod_coord.xy*size);vec2 dy=dFdy(lod_coord.xy*size);float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}`,Eo=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,ya="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Cs=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture(u_depth,uv-df.xz)),unpack_depth(texture(u_depth,uv+df.xz)),unpack_depth(texture(u_depth,uv-df.zy)),unpack_depth(texture(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,Ya=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,lc=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,us=`#ifdef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Ps=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform vec2 u_velocity_res;uniform float u_max_speed;const vec2 INVALID_VELOCITY=vec2(-1);uniform vec2 u_texture_offset;uniform float u_data_offset;uniform vec4 u_data_scale;vec2 lookup_velocity(vec2 uv) {uv=u_texture_offset.x+u_texture_offset.y*uv;vec2 fxy;ivec4 c=_raTexLinearCoord(uv,u_velocity_res,fxy);vec4 tl=texelFetch(u_velocity,c.yz,0);vec4 tr=texelFetch(u_velocity,c.xz,0);vec4 bl=texelFetch(u_velocity,c.yw,0);vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NODATA) {return INVALID_VELOCITY;}if (tr==NODATA) {return INVALID_VELOCITY;}if (bl==NODATA) {return INVALID_VELOCITY;}if (br==NODATA) {return INVALID_VELOCITY;}vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);
#ifdef DATA_FORMAT_UINT32
vec2 velocity=vec2(u_data_offset+dot(t,u_data_scale),0);return velocity;
#else
vec2 velocity=vec2(u_data_offset+dot(t.rg,u_data_scale.yx),-(u_data_offset+dot(t.ba,u_data_scale.yx)));
#endif
return velocity/max(u_max_speed,length(velocity));}
#endif`,Ds=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Lo=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef NATIVE
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const ks=[];ea(cs,ks),ea(Eo,ks),ea(_o,ks);const lo={"_prelude_fog.vertex.glsl":Ya,"_prelude_terrain.vertex.glsl":Cs,"_prelude_shadow.vertex.glsl":Ds,"_prelude_fog.fragment.glsl":lc,"_prelude_shadow.fragment.glsl":Lo,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":us,"_prelude_raster_particle.glsl":Ps},ns={};fr("",Cs),fr(lc,Ya),fr(Lo,Ds),fr(us,""),fr(Ps,"");const pu=fr(_o,Eo),cc=cs;var Tl={background:fr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:fr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:fr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:fr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:fr(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:fr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:fr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in float a_size_scale;in vec2 a_padding;in float a_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(a_z_offset+elevation(a_anchor_pos)),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:fr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:fr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:fr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:fr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:fr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:fr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:fr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
uniform float u_emissive_strength;in float v_height;void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,u_emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=max(0.01,cutoff_opacity(u_cutoff_params,ground.z));if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff < 0.01 && centroid_pos.x !=0.0));gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:fr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:fr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
out vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:fr(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:fr(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:fr(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:fr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:fr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trimmed,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:fr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float pattern_x=v_linesofar/pattern_size.x*aspect;float x=mod(pattern_x,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:fr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:fr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;vec2 uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
vec2 uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:fr("precision highp float;uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`precision highp float;
#include "_prelude_raster_array.glsl"
#include "_prelude_raster_particle.glsl"
in vec3 a_pos;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {vec2 pos=a_pos.xy+u_tile_offset;vec2 tex_coords=fract(pos);gl_PointSize=1.0;vec2 velocity=lookup_velocity(tex_coords);if (velocity==INVALID_VELOCITY) {v_particle_speed=0.0;gl_Position=vec4(2.0,2.0,2.0,1.0);} else {v_particle_speed=length(velocity);gl_Position=vec4(2.0*pos-vec2(1.0),0.0,1.0);}}`),rasterParticleTexture:fr("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {v_tex_pos=0.5*a_pos+vec2(0.5);gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:fr("void main() {}",`#include "_prelude_raster_array.glsl"
#include "_prelude_raster_particle.glsl"
in vec3 a_pos;uniform float u_speed_factor;uniform float u_lifetime_delta;uniform float u_rand_seed;out vec3 v_new_particle;const vec3 rand_constants=vec3(12.9898,78.233,4375.85453);float rand(const vec2 co) {float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {float lifetime=a_pos.z;vec2 pos=a_pos.xy;vec2 uv=clamp(pos,vec2(0.0),vec2(1.0));vec2 velocity=lookup_velocity(uv);float next_lifetime=lifetime-u_lifetime_delta;float t=step(0.0,next_lifetime);
#ifdef DATA_FORMAT_UINT32
vec2 dp=vec2(0);
#else
vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;
#endif
vec2 seed=pos*u_rand_seed;vec2 next_pos=pos+dp;vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));v_new_particle=vec3(
vec2(mix(random_pos,next_pos,t)),mix(1.0,next_lifetime,t)
);}`),symbolIcon:fr(`#include "_prelude_lighting.glsl"
uniform sampler2D u_texture;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
in float v_fade_opacity;in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
uniform mediump float u_icon_saturation;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
lowp float alpha=opacity*v_fade_opacity;vec4 out_color;
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b)*alpha;
#else
out_color=texture(u_texture,v_tex_a)*alpha;
#endif
#ifdef SATURATION
vec3 luma=vec3(dot(out_color.rgb,vec3(0.2126,0.7152,0.0722)));out_color.rgb=mix(luma,out_color.rgb,u_icon_saturation);
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
v_tex_a=a_tex/u_texsize;
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
v_fade_opacity=out_fade_opacity;}`),symbolSDF:fr(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;in float v_draw_halo;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}`),symbolTextAndIcon:fr(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;in float v_draw_halo;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}`),terrainRaster:fr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:fr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:fr(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,ya),skyboxGradient:fr(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,ya),skyboxCapture:fr(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:fr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:fr(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:fr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture(u_depthTexture,coord));return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
return vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);color=mix(color,v_color_mix.rgb,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=u_matrix*pos;pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=local_pos;
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1);v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:fr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=u_matrix*pos;
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:fr(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`)};function ea(c,r){const s=c.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let h of s)if(h=h.trim(),h[0]==="#"&&h.includes("if")&&!h.includes("endif")){h=h.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const p=h.split(" ");for(const y of p)r.includes(y)||r.push(y)}}function fr(c,r){const s=/#include\s+"([^"]+)"/g,h=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let p=r.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);p&&(p=p.map(k=>{const z=k.split(" ");return z[z.length-1]}),p=[...new Set(p)]);const y={},w=[],M=[];if(c=c.replace(s,(k,z)=>(M.push(z),"")),(r=r.replace(s,(k,z)=>(w.push(z),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let C=[...ks];ea(c,C),ea(r,C);for(const k of[...w,...M])lo[k]||console.error(`Undefined include: ${k}`),ns[k]||(ns[k]=[],ea(lo[k],ns[k])),C=[...C,...ns[k]];return{fragmentSource:c=c.replace(h,(k,z,B,$,H)=>(y[H]=!0,z==="define"?`
#ifndef HAS_UNIFORM_u_${H}
in ${B} ${$} ${H};
#else
uniform ${B} ${$} u_${H};
#endif
`:z==="initialize"?`
#ifdef HAS_UNIFORM_u_${H}
    ${B} ${$} ${H} = u_${H};
#endif
`:z==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${H}
    in ${B} ${$} ${H};
#endif
`:z==="initialize-attribute"?"":void 0)),vertexSource:r=r.replace(h,(k,z,B,$,H)=>{const K=$==="float"?"vec2":$,X=H.match(/color/)?"color":K;return z==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${H}
in ${B} ${$} a_${H};
#endif
`:y[H]?z==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
in ${B} ${K} a_${H};
out ${B} ${$} ${H};
#else
uniform ${B} ${$} u_${H};
#endif
`:z==="initialize"?X==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = a_${H};
#else
    ${B} ${$} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = unpack_mix_${X}(a_${H}, u_${H}_t);
#else
    ${B} ${$} ${H} = u_${H};
#endif
`:z==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${H}
    in ${B} ${$} a_${H};
    out ${B} ${$} ${H};
#endif
`:z==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${H}
    ${H} = a_${H};
#endif
`:void 0:z==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
in ${B} ${K} a_${H};
#else
uniform ${B} ${$} u_${H};
#endif
`:z==="define-instanced"?X==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${H}0;
in vec4 a_${H}1;
in vec4 a_${H}2;
in vec4 a_${H}3;
#else
uniform ${B} ${$} u_${H};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${B} ${K} a_${H};
#else
uniform ${B} ${$} u_${H};
#endif
`:z==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${H}
    ${B} ${$} ${H} = a_${H};
#endif
`:X==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${B} ${$} ${H} = a_${H};
#else
    ${B} ${$} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${B} ${$} ${H} = unpack_mix_${X}(a_${H}, u_${H}_t);
#else
    ${B} ${$} ${H} = u_${H};
#endif
`}),staticAttributes:p,usedDefines:C,vertexIncludes:w,fragmentIncludes:M}}class mu{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(r,s,h,p,y,w,M,C){this.context=r;let k=this.boundPaintVertexBuffers.length!==p.length;for(let B=0;!k&&B<p.length;B++)this.boundPaintVertexBuffers[B]!==p[B]&&(k=!0);let z=this.boundDynamicVertexBuffers.length!==M.length;for(let B=0;!z&&B<M.length;B++)this.boundDynamicVertexBuffers[B]!==M[B]&&(z=!0);if(!this.vao||this.boundProgram!==s||this.boundLayoutVertexBuffer!==h||k||z||this.boundIndexBuffer!==y||this.boundVertexOffset!==w)this.freshBind(s,h,p,y,w,M,C);else{r.bindVertexArrayOES.set(this.vao);for(const B of M)B&&(B.bind(),C&&B.instanceCount&&B.setVertexAttribDivisor(r.gl,s,C));y&&y.dynamicDraw&&y.bind()}}freshBind(r,s,h,p,y,w,M){const C=r.numAttributes,k=this.context,z=k.gl;this.vao&&this.destroy(),this.vao=k.gl.createVertexArray(),k.bindVertexArrayOES.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=h,this.boundIndexBuffer=p,this.boundVertexOffset=y,this.boundDynamicVertexBuffers=w,s.enableAttributes(z,r),s.bind(),s.setVertexAttribPointers(z,r,y);for(const B of h)B.enableAttributes(z,r),B.bind(),B.setVertexAttribPointers(z,r,y);for(const B of w)B&&(B.enableAttributes(z,r),B.bind(),B.setVertexAttribPointers(z,r,y),M&&B.instanceCount&&B.setVertexAttribDivisor(z,r,M));p&&p.bind(),k.currentNumAttributes=C}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Bd(c,r){const s=Math.pow(2,r.canonical.z),h=r.canonical.y;return[new i.L(0,h/s).toLngLat().lat,new i.L(0,(h+1)/s).toLngLat().lat]}function El(c,r,s,h,p,y,w){const M=c.context,C=M.gl,k=s.hillshadeFBO;if(!k)return;c.prepareDrawTile();const z=c.isTileAffectedByFog(r),B=c.getOrCreateProgram("hillshade",{overrideFog:z});M.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,k.colorAttachment.get());const $=((Q,Z,ie,he)=>{const se=ie.paint.get("hillshade-shadow-color"),de=ie.paint.get("hillshade-highlight-color"),ne=ie.paint.get("hillshade-accent-color"),pe=ie.paint.get("hillshade-emissive-strength");let Se=i.bj(ie.paint.get("hillshade-illumination-direction"));if(ie.paint.get("hillshade-illumination-anchor")==="viewport")Se-=Q.transform.angle;else if(Q.style&&Q.style.enable3dLights()&&Q.style.directionalLight){const Le=Q.style.directionalLight.properties.get("direction"),et=i.bQ(Le.x,Le.y,Le.z);Se=i.bj(et[1])}const Ae=!Q.options.moving;return{u_matrix:he||Q.transform.calculateProjMatrix(Z.tileID.toUnwrapped(),Ae),u_image:0,u_latrange:Bd(0,Z.tileID),u_light:[ie.paint.get("hillshade-exaggeration"),Se],u_shadow:se,u_highlight:de,u_emissive_strength:pe,u_accent:ne}})(c,s,h,c.terrain?r.projMatrix:null);c.uploadCommonUniforms(M,B,r.toUnwrapped());const{tileBoundsBuffer:H,tileBoundsIndexBuffer:K,tileBoundsSegments:X}=c.getTileBoundsBuffers(s);B.draw(c,C.TRIANGLES,p,y,w,bn.disabled,$,h.id,H,K,X)}function _u(c,r,s){if(!r.needsDEMTextureUpload)return;const h=c.context,p=h.gl;h.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||c.getTileTexture(s.stride);const y=s.getPixels();r.demTexture?r.demTexture.update(y,{premultiply:!1}):r.demTexture=new i.T(h,y,p.R32F,{premultiply:!1}),r.needsDEMTextureUpload=!1}function gu(c,r,s){const h=c.context,p=h.gl;if(!r.dem)return;const y=r.dem;if(h.activeTexture.set(p.TEXTURE1),_u(c,r,y),!r.demTexture)return;r.demTexture.bind(p.NEAREST,p.CLAMP_TO_EDGE);const w=y.dim;h.activeTexture.set(p.TEXTURE0);let M=r.hillshadeFBO;if(!M){const $=new i.T(h,{width:w,height:w,data:null},p.RGBA);$.bind(p.LINEAR,p.CLAMP_TO_EDGE),M=r.hillshadeFBO=h.createFramebuffer(w,w,!0,"renderbuffer"),M.colorAttachment.set($.texture)}h.bindFramebuffer.set(M.framebuffer),h.viewport.set([0,0,w,w]);const{tileBoundsBuffer:C,tileBoundsIndexBuffer:k,tileBoundsSegments:z}=c.getMercatorTileBoundsBuffers(),B=[];c.linearFloatFilteringSupported()&&B.push("TERRAIN_DEM_FLOAT_FORMAT"),c.getOrCreateProgram("hillshadePrepare",{defines:B}).draw(c,p.TRIANGLES,xn.disabled,Dn.disabled,Yn.unblended,bn.disabled,(($,H)=>{const K=H.stride,X=i.a6.create();return i.a6.ortho(X,0,i.V,-i.V,0,0,1),i.a6.translate(X,X,[0,-i.V,0]),{u_matrix:X,u_image:1,u_dimension:[K,K],u_zoom:$.overscaledZ}})(r.tileID,y),s.id,C,k,z),r.needsHillshadePrepare=!1}const Th=c=>({u_matrix:new i.bK(c),u_image0:new i.bO(c),u_skirt_height:new i.bN(c),u_ground_shadow_factor:new i.bM(c)}),hs=(c,r,s)=>({u_matrix:c,u_image0:0,u_skirt_height:r,u_ground_shadow_factor:s}),Sl=(c,r,s,h,p,y,w,M,C,k,z,B,$,H,K,X)=>({u_proj_matrix:Float32Array.from(c),u_globe_matrix:r,u_normalize_matrix:Float32Array.from(h),u_merc_matrix:s,u_zoom_transition:p,u_merc_center:y,u_image0:0,u_frustum_tl:w,u_frustum_tr:M,u_frustum_br:C,u_frustum_bl:k,u_globe_pos:z,u_globe_radius:B,u_viewport:$,u_grid_matrix:X?Float32Array.from(X):new Float32Array(9),u_skirt_height:H,u_far_z_cutoff:K});function Xa(c,r){return c!=null&&r!=null&&!(!c.hasData()||!r.hasData())&&c.demTexture!=null&&r.demTexture!=null&&c.tileID.key!==r.tileID.key}const va=new class{constructor(){this.operations={}}newMorphing(c,r,s,h,p){if(c in this.operations){const y=this.operations[c];y.to.tileID.key!==s.tileID.key&&(y.queued=s)}else this.operations[c]={startTime:h,phase:0,duration:p,from:r,to:s,queued:null}}getMorphValuesForProxy(c){if(!(c in this.operations))return null;const r=this.operations[c];return{from:r.from,to:r.to,phase:r.phase}}update(c){for(const r in this.operations){const s=this.operations[r];for(s.phase=(c-s.startTime)/s.duration;s.phase>=1||!this._validOp(s);)if(!this._nextOp(s,c)){delete this.operations[r];break}}}_nextOp(c,r){return!!c.queued&&(c.from=c.to,c.to=c.queued,c.queued=null,c.phase=0,c.startTime=r,!0)}_validOp(c){return c.from.hasData()&&c.to.hasData()}},Ml={0:null,1:"TERRAIN_VERTEX_MORPHING"};function uc(c,r,s){if(r===0)return 0;const h=r<1&&s===514?.25/r:1;return 6*Math.pow(1.5,22-c)*Math.max(r,1)*h}function xa(c,r){const s=1<<c.z;return!r&&(c.x===0||c.x===s-1)||c.y===0||c.y===s-1}const hc=c=>({u_matrix:c});function dc(c,r,s,h,p){if(p>0){const y=i.f.now(),w=(y-c.timeAdded)/p,M=r?(y-r.timeAdded)/p:-1,C=s.getSource(),k=h.coveringZoomLevel({tileSize:C.tileSize,roundZoom:C.roundZoom}),z=!r||Math.abs(r.tileID.overscaledZ-k)>Math.abs(c.tileID.overscaledZ-k),B=z&&c.refreshedUponExpiration?1:i.aa(z?w:1-M,0,1);return c.refreshedUponExpiration&&w>=1&&(c.refreshedUponExpiration=!1),r?{opacity:1,mix:1-B}:{opacity:B,mix:0}}return{opacity:1,mix:0}}class Tg extends Oo{constructor(r){const s={type:"raster-dem",maxzoom:r.transform.maxZoom},h=new i.bW(i.bX(),null),p=xi("mock-dem",s,h,r.style);super("mock-dem",p,!1),p.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,s){r.state="loaded",s(null)}}class Eg extends Oo{constructor(r){const s=xi("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new i.bW(i.bX(),null),r.style);super("proxy",s,!1),s.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,s,h){if(r.freezeTileCoverage)return;this.transform=r;const p=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((y,w)=>{if(y[w.key]="",!this._tiles[w.key]){const M=new Zs(w,this._source.tileSize*w.overscaleFactor(),r.tileZoom);M.state="loaded",this._tiles[w.key]=M}return y},{});for(const y in this._tiles)y in p||(this.freeFBO(y),this._tiles[y].unloadVectorData(),delete this._tiles[y])}freeFBO(r){const s=this.proxyCachedFBO[r];if(s!==void 0){const h=Object.values(s);this.renderCachePool.push(...h),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Np extends i.am{constructor(r,s,h){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=s,this.projMatrix=h}}class Sg extends i.ck{constructor(r,s){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},r.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[h,p,y]=function(C){const k=new i.aN,z=new i.aw,B=131;k.reserve(17161),z.reserve(33800);const $=i.V/128,H=i.V+$/2,K=H+$;for(let Q=-$;Q<K;Q+=$)for(let Z=-$;Z<K;Z+=$){const ie=Z<0||Z>H||Q<0||Q>H?24575:0,he=i.aa(Math.round(Z),0,i.V),se=i.aa(Math.round(Q),0,i.V);k.emplaceBack(he+ie,se)}const X=(Q,Z)=>{const ie=Z*B+Q;z.emplaceBack(ie+1,ie,ie+B),z.emplaceBack(ie+B,ie+B+1,ie+1)};for(let Q=1;Q<129;Q++)for(let Z=1;Z<129;Z++)X(Z,Q);return[0,129].forEach(Q=>{for(let Z=0;Z<130;Z++)X(Z,Q),X(Q,Z)}),[k,z,32768]}(),w=r.context;this.gridBuffer=w.createVertexBuffer(h,i.aP.members),this.gridIndexBuffer=w.createIndexBuffer(p),this.gridSegments=i.aB.simpleSegment(0,0,h.length,p.length),this.gridNoSkirtSegments=i.aB.simpleSegment(0,0,h.length,y),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Eg(s.map),this.orthoMatrix=i.a6.create(),i.a6.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.V,0,i.V,0,1);const M=w.gl;this._overlapStencilMode=new Dn({func:M.GEQUAL,mask:255},0,255,M.KEEP,M.KEEP,M.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=s,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Tg(s.map),this._pendingGroundEffectLayers=[]}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),this._style=r,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(r,s,h){if(r&&r.terrain){this._style!==r&&(this.style=r,this._evaluationZoom=void 0);const p=r.terrain.properties,y=r.terrain.drapeRenderMode===0,w=r.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=i.f.now();const M=r.terrain&&r.terrain.scope,C=p.get("source"),k=y?this._mockSourceCache:r.getSourceCache(C,M);if(!k)return void i.w(`Couldn't find terrain source "${C}".`);if(this.sourceCache=k,this._exaggeration=w?this.calculateExaggeration(s):p.get("exaggeration"),!s.projection.requiresDraping&&w&&this._exaggeration===0)return void this._disable();this.enabled=!0;const z=()=>{this.sourceCache.used&&i.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const B=this.getScaledDemTileSize();this.sourceCache.update(s,B,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,z(),this._initializing=!0),z(),s.updateElevation(!0,h),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(s),this._emptyDEMTextureDirty=!0,this._previousZoom=s.zoom}else this._disable()}calculateExaggeration(r){const s=this._previousCameraAltitude,h=r.getFreeCameraOptions().position.z/r.pixelsPerMeter*r.worldSize;this._previousCameraAltitude=h;const p=s!=null?h-s:Number.MAX_VALUE;if(Math.abs(p)<2)return this._exaggeration;const y=r.zoom,w=this._style.terrain;if(!this._previousUpdateTimestamp)return w.getExaggeration(y);let M=y-this._previousZoom;const C=this._previousUpdateTimestamp;let k=y;this._evaluationZoom!=null&&(k=this._evaluationZoom,Math.abs(y-k)>.5&&(M=.5*(y-k+M)),M*p<0&&(k+=M)),this._evaluationZoom=k;const z=w.getExaggeration(k),B=z===w.getExaggeration(Math.max(0,k-.1));if(B&&Math.abs(z-this._exaggeration)<.01)return z;let $=Math.min(.1,.00375*(this._updateTimestamp-C));return(B||z<.1||Math.abs(M)<1e-4)&&($=Math.min(.2,4*$)),i.U(this._exaggeration,z,$)}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._mergedSourceCaches)this._style._mergedSourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const s=this.proxySourceCache,h=this.painter.transform;this._initializing&&(this._initializing=h._centerAltitude===0&&this.getAtPointOrZero(i.L.fromLngLat(h.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const p=this.proxyCoords=s.getIds().map(C=>{const k=s.getTileByID(C).tileID;return k.projMatrix=h.calculateProjMatrix(k.toUnwrapped()),k});(function(C,k){const z=k.transform.pointCoordinate(k.transform.getCameraPoint()),B=new i.P(z.x,z.y);C.sort(($,H)=>{if(H.overscaledZ-$.overscaledZ)return H.overscaledZ-$.overscaledZ;const K=new i.P($.canonical.x+(1<<$.canonical.z)*$.wrap,$.canonical.y),X=new i.P(H.canonical.x+(1<<H.canonical.z)*H.wrap,H.canonical.y),Q=B.mult(1<<$.canonical.z);return Q.x-=.5,Q.y-=.5,Q.distSqr(K)-Q.distSqr(X)})})(p,this.painter);const y=this.proxyToSource||{};this.proxyToSource={},p.forEach(C=>{this.proxyToSource[C.key]={}}),this.terrainTileForTile={};const w=this._style._mergedSourceCaches;for(const C in w){const k=w[C];if(!k.used||(k!==this.sourceCache&&this.resetTileLookupCache(k.id),this._setupProxiedCoordsForOrtho(k,r[C],y),k.usedForTerrain))continue;const z=r[C];k.getSource().reparseOverscaled&&this._assignTerrainTiles(z)}this.proxiedCoords[s.id]=p.map(C=>new Np(C,C.key,this.orthoMatrix)),this._assignTerrainTiles(p),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(y),this.renderingToTexture=!1;const M={};this._visibleDemTiles=[];for(const C of this.proxyCoords){const k=this.terrainTileForTile[C.key];if(!k)continue;const z=k.tileID.key;z in M||(this._visibleDemTiles.push(k),M[z]=z)}}_assignTerrainTiles(r){this._initializing||r.forEach(s=>{if(this.terrainTileForTile[s.key])return;const h=this._findTileCoveringTileID(s,this.sourceCache);h&&(this.terrainTileForTile[s.key]=h)})}_prepareDEMTextures(){const r=this.painter.context,s=r.gl;for(const h in this.terrainTileForTile){const p=this.terrainTileForTile[h],y=p.dem;!y||p.demTexture&&!p.needsDEMTextureUpload||(r.activeTexture.set(s.TEXTURE1),_u(this.painter,p,y))}}_prepareDemTileUniforms(r,s,h,p){if(!s||s.demTexture==null)return!1;const y=r.tileID.canonical,w=Math.pow(2,s.tileID.canonical.z-y.z),M=p||"";return h[`u_dem_tl${M}`]=[y.x*w%1,y.y*w%1],h[`u_dem_scale${M}`]=w,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const r=this.painter.context,s=r.gl;if(!this._emptyDepthBufferTexture){const h=new i.h({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new i.T(r,h,s.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let r=0;const s=this._visibleDemTiles.reduce((h,p)=>{if(!p.dem)return h;const y=p.dem.tree.minimums[0];return y>0&&r++,h+y},0);return r?s/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,s=r.gl;r.activeTexture.set(s.TEXTURE2);const h=this._getLoadedAreaMinimum(),[p,y]=(()=>{const M=new i.cm({width:1,height:1},new Float32Array([h]));return[s.R32F,M]})();this._emptyDEMTextureDirty=!1;let w=this._emptyDEMTexture;return w?w.update(y,{premultiply:!1}):w=this._emptyDEMTexture=new i.T(r,y,p,{premultiply:!1}),w}setupElevationDraw(r,s,h){const p=this.painter.context,y=p.gl,w={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0};w.u_exaggeration=this.exaggeration();let M=null,C=null,k=1;if(h&&h.morphing&&this._useVertexMorphing){const $=h.morphing.srcDemTile,H=h.morphing.dstDemTile;k=h.morphing.phase,$&&H&&(this._prepareDemTileUniforms(r,$,w,"_prev")&&(C=$),this._prepareDemTileUniforms(r,H,w)&&(M=H))}const z=$=>$&&$.demTexture&&this.painter.linearFloatFilteringSupported()?y.LINEAR:y.NEAREST,B=$=>{w.u_dem_size=$.size[0]===1?1:$.size[0]-2};if(C&&M)p.activeTexture.set(y.TEXTURE2),M.demTexture.bind(z(M),y.CLAMP_TO_EDGE),p.activeTexture.set(y.TEXTURE4),C.demTexture.bind(z(C),y.CLAMP_TO_EDGE),M.demTexture&&B(M.demTexture),w.u_dem_lerp=k;else{M=this.terrainTileForTile[r.tileID.key],p.activeTexture.set(y.TEXTURE2);const $=this._prepareDemTileUniforms(r,M,w)?M.demTexture:this.emptyDEMTexture;$.bind(z(M),y.CLAMP_TO_EDGE),B($)}if(p.activeTexture.set(y.TEXTURE3),h&&h.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(y.NEAREST,y.CLAMP_TO_EDGE),this._depthFBO&&(w.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(y.NEAREST,y.CLAMP_TO_EDGE),w.u_depth_size_inv=[1,1]),h&&h.useMeterToDem&&M){const $=(1<<M.tileID.canonical.z)*i.bl(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;w.u_meter_to_dem=$}if(h&&h.labelPlaneMatrixInv&&(w.u_label_plane_matrix_inv=h.labelPlaneMatrixInv),s.setTerrainUniformValues(p,w),this.painter.transform.projection.name==="globe"){const $=this.globeUniformValues(this.painter.transform,r.tileID.canonical,h&&h.useDenormalizedUpVectorScale);s.setGlobeUniformValues(p,$)}}globeUniformValues(r,s,h){const p=r.projection;return{u_tile_tl_up:p.upVector(s,0,0),u_tile_tr_up:p.upVector(s,i.V,0),u_tile_br_up:p.upVector(s,i.V,i.V),u_tile_bl_up:p.upVector(s,0,i.V),u_tile_up_scale:h?i.cl(1):p.upVectorScale(s,r.center.lat,r.worldSize).metersToTile}}renderToBackBuffer(r){const s=this.painter,h=this.painter.context;r.length!==0&&(h.bindFramebuffer.set(null),h.viewport.set([0,0,s.width,s.height]),s.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(p,y,w,M,C){if(p.transform.projection.name==="globe")(function(k,z,B,$,H){const K=k.context,X=K.gl;let Q,Z;const ie=k.transform,he=i.cd(k,K,ie),se=(dt,at)=>{if(Z===at)return;const At=[Ml[at],"PROJECTION_GLOBE_VIEW"];he&&At.push("CUSTOM_ANTIALIASING");const $e=k.isTileAffectedByFog(dt);Q=k.getOrCreateProgram("globeRaster",{defines:At,overrideFog:$e}),Z=at},de=k.colorModeForRenderPass(),ne=new xn(X.LEQUAL,xn.ReadWrite,k.depthRangeFor3D);va.update(H);const pe=i.ce(ie),Se=[i.a5(ie.center.lng),i.ae(ie.center.lat)],Ae=k.globeSharedBuffers,Le=[ie.width*i.f.devicePixelRatio,ie.height*i.f.devicePixelRatio],et=Float32Array.from(ie.globeMatrix),je={useDenormalizedUpVectorScale:!0};{const dt=k.transform,at=uc(dt.zoom,z.exaggeration(),z.sourceCache._source.tileSize);Z=-1;const At=X.TRIANGLES;for(const $e of $){const ot=B.getTile($e),ke=Dn.disabled,Ze=z.prevTerrainTileForTile[$e.key],Pt=z.terrainTileForTile[$e.key];Xa(Ze,Pt)&&va.newMorphing($e.key,Ze,Pt,H,250),K.activeTexture.set(X.TEXTURE0),ot.texture&&ot.texture.bind(X.LINEAR,X.CLAMP_TO_EDGE);const Bt=va.getMorphValuesForProxy($e.key),Ft=Bt?1:0;Bt&&i.j(je,{morphing:{srcDemTile:Bt.from,dstDemTile:Bt.to,phase:i.cc(Bt.phase)}});const Xt=i.cf($e.canonical),un=i.cg(Xt.getCenter().lat),vn=i.ch($e.canonical,Xt,un,dt.worldSize/dt._pixelsPerMercatorPixel),pn=i.aT(i.ci($e.canonical)),gn=Sl(dt.expandedFarZProjMatrix,et,pe,pn,i.S(dt.zoom),Se,dt.frustumCorners.TL,dt.frustumCorners.TR,dt.frustumCorners.BR,dt.frustumCorners.BL,dt.globeCenterInViewSpace,dt.globeRadius,Le,at,dt._farZ,vn);if(se($e,Ft),Q&&(z.setupElevationDraw(ot,Q,je),k.uploadCommonUniforms(K,Q,$e.toUnwrapped()),Ae)){const[qn,kn,Nn]=Ae.getGridBuffers(un,at!==0);Q.draw(k,At,ne,ke,de,bn.backCCW,gn,"globe_raster",qn,kn,Nn)}}}if(Ae&&(k.renderDefaultNorthPole||k.renderDefaultSouthPole)){const dt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];he&&dt.push("CUSTOM_ANTIALIASING"),Q=k.getOrCreateProgram("globeRaster",{defines:dt});for(const at of $){const{x:At,y:$e,z:ot}=at.canonical,ke=$e===0,Ze=$e===(1<<ot)-1,[Pt,Bt,Ft,Xt]=Ae.getPoleBuffers(ot,!1);if(Xt&&(ke||Ze)){const un=B.getTile(at);K.activeTexture.set(X.TEXTURE0),un.texture&&un.texture.bind(X.LINEAR,X.CLAMP_TO_EDGE);let vn=i.cj(ot,At,ie);const pn=i.aT(i.ci(at.canonical)),gn=(qn,kn)=>qn.draw(k,X.TRIANGLES,ne,Dn.disabled,de,bn.disabled,Sl(ie.expandedFarZProjMatrix,vn,vn,pn,0,Se,ie.frustumCorners.TL,ie.frustumCorners.TR,ie.frustumCorners.BR,ie.frustumCorners.BL,ie.globeCenterInViewSpace,ie.globeRadius,Le,0,ie._farZ),"globe_pole_raster",kn,Ft,Xt);z.setupElevationDraw(un,Q,je),k.uploadCommonUniforms(K,Q,at.toUnwrapped()),ke&&k.renderDefaultNorthPole&&gn(Q,Pt),Ze&&k.renderDefaultSouthPole&&(vn=i.a6.scale(i.a6.create(),vn,[1,-1,1]),gn(Q,Bt))}}}})(p,y,w,M,C);else{const k=p.context,z=k.gl;let B,$;const H=p.shadowRenderer,K=tr(p,p.longestCutoffRange),X=de=>{if($===de)return;const ne=[];ne.push(Ml[de]),K.shouldRenderCutoff&&ne.push("RENDER_CUTOFF"),B=p.getOrCreateProgram("terrainRaster",{defines:ne}),$=de},Q=p.colorModeForRenderPass(),Z=new xn(z.LEQUAL,xn.ReadWrite,p.depthRangeFor3D);va.update(C);const ie=p.transform,he=uc(ie.zoom,y.exaggeration(),y.sourceCache._source.tileSize);let se=[0,0,0];if(H){const de=p.style.directionalLight,ne=p.style.ambientLight;de&&ne&&(se=ri(de,ne))}{$=-1;const de=z.TRIANGLES,[ne,pe]=[y.gridIndexBuffer,y.gridSegments];for(const Se of M){const Ae=w.getTile(Se),Le=Dn.disabled,et=y.prevTerrainTileForTile[Se.key],je=y.terrainTileForTile[Se.key];Xa(et,je)&&va.newMorphing(Se.key,et,je,C,250),k.activeTexture.set(z.TEXTURE0),Ae.texture&&Ae.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE);const dt=va.getMorphValuesForProxy(Se.key),at=dt?1:0;let At;dt&&(At={morphing:{srcDemTile:dt.from,dstDemTile:dt.to,phase:i.cc(dt.phase)}});const $e=hs(Se.projMatrix,xa(Se.canonical,ie.renderWorldCopies)?he/10:he,se);if(X(at),!B)continue;y.setupElevationDraw(Ae,B,At);const ot=Se.toUnwrapped();H&&H.setupShadows(ot,B),p.uploadCommonUniforms(k,B,ot,null,K),B.draw(p,de,Z,Le,Q,bn.backCCW,$e,"terrain_raster",y.gridBuffer,ne,pe)}}}}(s,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,s.gpuTimingDeferredRenderEnd(),r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const s=this.painter,h=this.painter.context,p=this.proxySourceCache,y=this.proxiedCoords[p.id],w=this._drapedRenderBatches.shift(),M=s.style.order,C=[];let k=0;for(const z of y){const B=p.getTileByID(z.proxyTileKey),$=p.proxyCachedFBO[z.key]?p.proxyCachedFBO[z.key][r]:void 0,H=$!==void 0?p.renderCache[$]:this.pool[k++],K=$!==void 0;if(B.texture=H.tex,K&&!H.dirty){C.push(B.tileID);continue}let X;h.bindFramebuffer.set(H.fb.framebuffer),this.renderedToTile=!1,H.dirty&&(h.clear({color:i.ax.transparent,stencil:0}),H.dirty=!1);for(let Q=w.start;Q<=w.end;++Q){const Z=s.style._mergedLayers[M[Q]];if(Z.isHidden(s.transform.zoom))continue;const ie=s.style.getLayerSourceCache(Z),he=ie?this.proxyToSource[z.key][ie.id]:[z];if(!he)continue;const se=he;h.viewport.set([0,0,H.fb.width,H.fb.height]),X!==(ie?ie.id:null)&&(this._setupStencil(H,he,Z,ie),X=ie?ie.id:null),s.renderLayer(s,ie,Z,se)}if(this._drapedRenderBatches.length===0)for(const Q of this._pendingGroundEffectLayers){const Z=s.style._mergedLayers[M[Q]];if(Z.isHidden(s.transform.zoom))continue;const ie=s.style.getLayerSourceCache(Z),he=ie?this.proxyToSource[z.key][ie.id]:[z];if(!he)continue;const se=he;h.viewport.set([0,0,H.fb.width,H.fb.height]),X!==(ie?ie.id:null)&&(this._setupStencil(H,he,Z,ie),X=ie?ie.id:null),s.renderLayer(s,ie,Z,se)}this.renderedToTile?(H.dirty=!0,C.push(B.tileID)):K||--k,k===5&&(k=0,this.renderToBackBuffer(C))}return this.renderToBackBuffer(C),this.renderingToTexture=!1,h.bindFramebuffer.set(null),h.viewport.set([0,0,s.width,s.height]),w.end+1}postRender(){}isLayerOrderingCorrect(r){const s=r.order.length;let h=-1,p=s;for(let y=0;y<s;++y)this._style.isLayerDraped(r._mergedLayers[r.order[y]])?h=Math.max(h,y):p=Math.min(p,y);return p>h}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(s=>s.dem).forEach(s=>{r=Math.min(r,s.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,s,h){if(!this._visibleDemTiles)return null;const p=this._visibleDemTiles.filter(y=>y.dem).map(y=>{const w=y.tileID,M=1<<w.overscaledZ,{x:C,y:k}=w.canonical,z=C/M,B=(C+1)/M,$=k/M,H=(k+1)/M;return{minx:z,miny:$,maxx:B,maxy:H,t:y.dem.tree.raycastRoot(z,$,B,H,r,s,h),tile:y}});p.sort((y,w)=>(y.t!==null?y.t:Number.MAX_VALUE)-(w.t!==null?w.t:Number.MAX_VALUE));for(const y of p){if(y.t==null)return null;const w=y.tile.dem.tree.raycast(y.minx,y.miny,y.maxx,y.maxy,r,s,h);if(w!=null)return w}return null}_createFBO(){const r=this.painter.context,s=r.gl,h=this.drapeBufferSize;r.activeTexture.set(s.TEXTURE0);const p=new i.T(r,{width:h[0],height:h[1],data:null},s.RGBA);p.bind(s.LINEAR,s.CLAMP_TO_EDGE);const y=r.createFramebuffer(h[0],h[1],!0,null);return y.colorAttachment.set(p.texture),y.depthAttachment=new Oi(r,y.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,h[0],h[1]),this._stencilRef=0,y.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):y.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:y,tex:p,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const r in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const s=this._style._mergedLayers[r],h=s.isHidden(this.painter.transform.zoom);return s.type==="custom"?!h&&s.shouldRedrape():!h&&s.hasTransition()})}_clearLineLayersFromRenderCache(){let r=!1;for(const h of this._style.getSources())if(h instanceof Ve){r=!0;break}if(!r)return;const s={};for(let h=0;h<this._style.order.length;++h){const p=this._style._mergedLayers[this._style.order[h]],y=this._style.getLayerSourceCache(p);if(y&&!s[y.id]&&!p.isHidden(this.painter.transform.zoom)&&p.type==="line"&&p.widthExpression()instanceof i.Z){s[y.id]=!0;for(const w of this.proxyCoords){const M=this.proxyToSource[w.key][y.id];if(M)for(const C of M)this._clearRenderCacheForTile(y.id,C)}}}}_clearRasterLayersFromRenderCache(){let r=!1;for(const h in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[h]._source instanceof Ue){r=!0;break}if(!r)return;const s={};for(let h=0;h<this._style.order.length;++h){const p=this._style._mergedLayers[this._style.order[h]],y=this._style.getLayerSourceCache(p);if(!y||s[y.id]||p.isHidden(this.painter.transform.zoom)||p.type!=="raster")continue;const w=p.paint.get("raster-fade-duration");for(const M of this.proxyCoords){const C=this.proxyToSource[M.key][y.id];if(C)for(const k of C){const z=dc(y.getTile(k),y.findLoadedParent(k,0),y,this.painter.transform,w);(z.opacity!==1||z.mix!==0)&&this._clearRenderCacheForTile(y.id,k)}}}}_setupDrapedRenderBatches(){const r=this._style.order,s=r.length;if(s===0)return;const h=[];this._pendingGroundEffectLayers=[];let p,y=0,w=this._style._mergedLayers[r[y]];for(;!this._style.isLayerDraped(w)&&w.isHidden(this.painter.transform.zoom)&&++y<s;)w=this._style._mergedLayers[r[y]];for(;y<s;++y){const M=this._style._mergedLayers[r[y]];M.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(M)?p===void 0&&(p=y):(M.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(y),p!==void 0&&(h.push({start:p,end:y-1}),p=void 0)))}if(p!==void 0&&h.push({start:p,end:y-1}),h.length!==0){const M=h[h.length-1];this._pendingGroundEffectLayers.every(C=>C>M.end)||i.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=h}_setupRenderCache(r){const s=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,s.renderCache.length>s.renderCachePool.length){const w=Object.values(s.proxyCachedFBO);s.proxyCachedFBO={};for(let M=0;M<w.length;++M){const C=Object.values(w[M]);s.renderCachePool.push(...C)}}return}this._clearRasterLayersFromRenderCache();const h=this.proxyCoords,p=this._tilesDirty;for(let w=h.length-1;w>=0;w--){const M=h[w];if(s.getTileByID(M.key),s.proxyCachedFBO[M.key]!==void 0){const C=r[M.key],k=this.proxyToSource[M.key];let z=0;for(const B in k){const $=k[B],H=C[B];if(!H||H.length!==$.length||$.some((K,X)=>K!==H[X]||p[B]&&p[B].hasOwnProperty(K.key))){z=-1;break}++z}for(const B in s.proxyCachedFBO[M.key])s.renderCache[s.proxyCachedFBO[M.key][B]].dirty=z<0||z!==Object.values(C).length}}const y=[...this._drapedRenderBatches];y.sort((w,M)=>M.end-M.start-(w.end-w.start));for(const w of y)for(const M of h){if(s.proxyCachedFBO[M.key])continue;let C=s.renderCachePool.pop();C===void 0&&s.renderCache.length<50&&(C=s.renderCache.length,s.renderCache.push(this._createFBO())),C!==void 0&&(s.proxyCachedFBO[M.key]={},s.proxyCachedFBO[M.key][w.start]=C,s.renderCache[C].dirty=!0)}this._tilesDirty={}}_setupStencil(r,s,h,p){if(!p||!this._sourceTilesOverlap[p.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const y=this.painter.context,w=y.gl;if(s.length<=1)return void(this._overlapStencilType=!1);let M;if(h.isTileClipped())M=s.length,this._overlapStencilMode.test={func:w.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(s[0].overscaledZ>s[s.length-1].overscaledZ))return void(this._overlapStencilType=!1);M=1,this._overlapStencilMode.test={func:w.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+M>255&&(y.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=M,this._overlapStencilMode.ref=this._stencilRef,h.isTileClipped()&&this._renderTileClippingMasks(s,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):Dn.disabled}_renderTileClippingMasks(r,s){const h=this.painter,p=this.painter.context,y=p.gl;h._tileClippingMaskIDs={},p.setColorMode(Yn.disabled),p.setDepthMode(xn.disabled);const w=h.getOrCreateProgram("clippingMask");for(const M of r){const C=h._tileClippingMaskIDs[M.key]=--s;w.draw(h,y.TRIANGLES,xn.disabled,new Dn({func:y.ALWAYS,mask:0},C,255,y.KEEP,y.KEEP,y.REPLACE),Yn.disabled,bn.disabled,hc(M.projMatrix),"$clipping",h.tileExtentBuffer,h.quadTriangleIndexBuffer,h.tileExtentSegments)}}pointCoordinate(r){const s=this.painter.transform;if(r.x<0||r.x>s.width||r.y<0||r.y>s.height)return null;const h=[r.x,r.y,1,1];i.a7.transformMat4(h,h,s.pixelMatrixInverse),i.a7.scale(h,h,1/h[3]),h[0]/=s.worldSize,h[1]/=s.worldSize;const p=s._camera.position,y=i.bl(1,s.center.lat),w=[p[0],p[1],p[2]/y,0],M=i.N.subtract([],h.slice(0,3),w);i.N.normalize(M,M);const C=this.raycast(w,M,this._exaggeration);return C!==null&&C?(i.N.scaleAndAdd(w,w,M,C),w[3]=w[2],w[2]*=y,w):null}drawDepth(){const r=this.painter,s=r.context,h=this.proxySourceCache,p=Math.ceil(r.width),y=Math.ceil(r.height);if(!this._depthFBO||this._depthFBO.width===p&&this._depthFBO.height===y||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const w=s.gl,M=s.createFramebuffer(p,y,!0,"renderbuffer");s.activeTexture.set(w.TEXTURE0);const C=new i.T(s,{width:p,height:y,data:null},w.RGBA);C.bind(w.NEAREST,w.CLAMP_TO_EDGE),M.colorAttachment.set(C.texture);const k=s.createRenderbuffer(s.gl.DEPTH_COMPONENT16,p,y);M.depthAttachment.set(k),this._depthFBO=M,this._depthTexture=C}s.bindFramebuffer.set(this._depthFBO.framebuffer),s.viewport.set([0,0,p,y]),function(w,M,C,k){if(w.transform.projection.name==="globe")return;const z=w.context,B=z.gl;z.clear({depth:1});const $=w.getOrCreateProgram("terrainDepth"),H=new xn(B.LESS,xn.ReadWrite,w.depthRangeFor3D);for(const K of k){const X=C.getTile(K),Q=hs(K.projMatrix,0,[0,0,0]);M.setupElevationDraw(X,$),$.draw(w,B.TRIANGLES,H,Dn.disabled,Yn.unblended,bn.backCCW,Q,"terrain_depth",M.gridBuffer,M.gridIndexBuffer,M.gridNoSkirtSegments)}}(r,this,h,this.proxyCoords)}_setupProxiedCoordsForOrtho(r,s,h){if(r.getSource()instanceof i.ap)return this._setupProxiedCoordsForImageSource(r,s,h);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const p=this.proxiedCoords[r.id]=[],y=this.proxyCoords;for(let C=0;C<y.length;C++){const k=y[C],z=this._findTileCoveringTileID(k,r);if(z){const B=this._createProxiedId(k,z,h[k.key]&&h[k.key][r.id]);p.push(B),this.proxyToSource[k.key][r.id]=[B]}}let w=!1;const M=new Set;for(let C=0;C<s.length;C++){const k=r.getTile(s[C]);if(!k||!k.hasData())continue;const z=this._findTileCoveringTileID(k.tileID,this.proxySourceCache);if(z&&z.tileID.canonical.z!==k.tileID.canonical.z){const B=this.proxyToSource[z.tileID.key][r.id],$=this._createProxiedId(z.tileID,k,h[z.tileID.key]&&h[z.tileID.key][r.id]);B?B.splice(B.length-1,0,$):this.proxyToSource[z.tileID.key][r.id]=[$];const H=this.proxyToSource[z.tileID.key][r.id];M.has(H)||M.add(H),p.push($),w=!0}}if(this._sourceTilesOverlap[r.id]=w,w&&this._debugParams.sortTilesHiZFirst)for(const C of M)C.sort((k,z)=>z.overscaledZ-k.overscaledZ)}_setupProxiedCoordsForImageSource(r,s,h){if(!r.getSource().loaded())return;const p=this.proxiedCoords[r.id]=[],y=this.proxyCoords,w=r.getSource(),M=w.tileID;if(!M)return;const C=new i.P(M.x,M.y)._div(1<<M.z),k=w.coordinates.map(i.L.fromLngLat).reduce((B,$)=>(B.min.x=Math.min(B.min.x,$.x-C.x),B.min.y=Math.min(B.min.y,$.y-C.y),B.max.x=Math.max(B.max.x,$.x-C.x),B.max.y=Math.max(B.max.y,$.y-C.y),B),{min:new i.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),z=(B,$)=>{const H=B.wrap+B.canonical.x/(1<<B.canonical.z),K=B.canonical.y/(1<<B.canonical.z),X=i.V/(1<<B.canonical.z),Q=$.wrap+$.canonical.x/(1<<$.canonical.z),Z=$.canonical.y/(1<<$.canonical.z);return H+X<Q+k.min.x||H>Q+k.max.x||K+X<Z+k.min.y||K>Z+k.max.y};for(let B=0;B<y.length;B++){const $=y[B];for(let H=0;H<s.length;H++){const K=r.getTile(s[H]);if(!K||!K.hasData()||z($,K.tileID))continue;const X=this._createProxiedId($,K,h[$.key]&&h[$.key][r.id]),Q=this.proxyToSource[$.key][r.id];Q?Q.push(X):this.proxyToSource[$.key][r.id]=[X],p.push(X)}}}_createProxiedId(r,s,h){let p=this.orthoMatrix;if(h){const y=h.find(w=>w.key===s.tileID.key);if(y)return y}if(s.tileID.key!==r.key){const y=r.canonical.z-s.tileID.canonical.z;let w,M,C;p=i.a6.create();const k=s.tileID.wrap-r.wrap<<r.overscaledZ;y>0?(w=i.V>>y,M=w*((s.tileID.canonical.x<<y)-r.canonical.x+k),C=w*((s.tileID.canonical.y<<y)-r.canonical.y)):(w=i.V<<-y,M=i.V*(s.tileID.canonical.x-(r.canonical.x+k<<-y)),C=i.V*(s.tileID.canonical.y-(r.canonical.y<<-y))),i.a6.ortho(p,0,w,0,w,0,1),i.a6.translate(p,p,[M,C,0])}return new Np(s.tileID,r.key,p)}_findTileCoveringTileID(r,s){let h=s.getTile(r);if(h&&h.hasData())return h;const p=this._findCoveringTileCache[s.id],y=p[r.key];if(h=y?s.getTileByID(y):null,h&&h.hasData()||y===null)return h;let w=h?h.tileID:r,M=w.overscaledZ;const C=s.getSource().minzoom,k=[];if(!y){const B=s.getSource().maxzoom;if(r.canonical.z>=B){const $=r.canonical.z-B;s.getSource().reparseOverscaled?(M=Math.max(r.canonical.z+2,s.transform.tileZoom),w=new i.am(M,r.wrap,B,r.canonical.x>>$,r.canonical.y>>$)):$!==0&&(M=B,w=new i.am(M,r.wrap,B,r.canonical.x>>$,r.canonical.y>>$))}w.key!==r.key&&(k.push(w.key),h=s.getTile(w))}const z=B=>{k.forEach($=>{p[$]=B}),k.length=0};for(M-=1;M>=C&&(!h||!h.hasData());M--){h&&z(h.tileID.key);const B=w.calculateScaledKey(M);if(h=s.getTileByID(B),h&&h.hasData())break;const $=p[B];if($===null)break;$===void 0?k.push(B):h=s.getTileByID($)}return z(h?h.tileID.key:null),h&&h.hasData()?h:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(r,s){let h=this._tilesDirty[r];h||(h=this._tilesDirty[r]={}),h[s.key]=!0}}function Nd(c,r,s){const h=function(M,C,k){const z=i.N.dot(C,M),B=i.N.dot(k,[.2126,.7152,.0722]),$=(K,X,Q)=>(1-Q)*K+Q*X,H=$(1-.3*Math.min(B,1),1,Math.min(z+1,1));return $(.92,1,Math.asin(i.aa(C[2],-1,1))/Math.PI+.5)*H}(c,[0,0,1],r),p=[0,0,0];i.N.scale(p,s.slice(0,3),h);const y=[0,0,0];i.N.scale(y,r.slice(0,3),c[2]);const w=[0,0,0];return i.N.add(w,p,y),i.bU(w)}const jd=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],jp=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class Vd{static cacheKey(r,s,h,p){let y=`${s}${p?p.cacheKey:""}`;for(const w of h)r.usedDefines.includes(w)&&(y+=`/${w}`);return y}constructor(r,s,h,p,y,w,M){const C=r.gl;this.program=C.createProgram(),this.configuration=p,this.name=s,this.fixedDefines=[...w];const k=p?p.getBinderAttributes():[],z=(h.staticAttributes||[]).concat(k);let B=p?p.defines():[];B=B.concat(w.map(Z=>`#define ${Z}`));const $=`#version 300 es
`;let H=$+B.concat("precision mediump float;",cc,pu.fragmentSource).join(`
`);for(const Z of h.fragmentIncludes)H+=`
${lo[Z]}`;H+=`
${h.fragmentSource}`;let K=$+B.concat("precision highp float;",cc,pu.vertexSource).join(`
`);for(const Z of h.vertexIncludes)K+=`
${lo[Z]}`;K+=`
${h.vertexSource}`;const X=C.createShader(C.FRAGMENT_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);C.shaderSource(X,H),C.compileShader(X),C.attachShader(this.program,X);const Q=C.createShader(C.VERTEX_SHADER);if(C.isContextLost())this.failedToCreate=!0;else{C.shaderSource(Q,K),C.compileShader(Q),C.attachShader(this.program,Q),this.attributes={},this.numAttributes=z.length;for(let Z=0;Z<this.numAttributes;Z++)if(z[Z]){const ie=z[Z].startsWith("a_")?z[Z]:`a_${z[Z]}`;C.bindAttribLocation(this.program,Z,ie),this.attributes[ie]=Z}M&&M.shaderVaryings.length>0&&C.transformFeedbackVaryings(this.program,M.shaderVaryings,M.bufferMode),C.linkProgram(this.program),C.deleteShader(Q),C.deleteShader(X),this.fixedUniforms=y(r),this.binderUniforms=p?p.getUniforms(r):[],w.includes("TERRAIN")&&(this.terrainUniforms=(Z=>({u_dem:new i.bO(Z),u_dem_prev:new i.bO(Z),u_dem_tl:new i.bL(Z),u_dem_scale:new i.bN(Z),u_dem_tl_prev:new i.bL(Z),u_dem_scale_prev:new i.bN(Z),u_dem_size:new i.bN(Z),u_dem_lerp:new i.bN(Z),u_exaggeration:new i.bN(Z),u_depth:new i.bO(Z),u_depth_size_inv:new i.bL(Z),u_meter_to_dem:new i.bN(Z),u_label_plane_matrix_inv:new i.bK(Z)}))(r)),w.includes("GLOBE")&&(this.globeUniforms=(Z=>({u_tile_tl_up:new i.bM(Z),u_tile_tr_up:new i.bM(Z),u_tile_br_up:new i.bM(Z),u_tile_bl_up:new i.bM(Z),u_tile_up_scale:new i.bN(Z)}))(r)),w.includes("FOG")&&(this.fogUniforms=(Z=>({u_fog_matrix:new i.bK(Z),u_fog_range:new i.bL(Z),u_fog_color:new i.bP(Z),u_fog_horizon_blend:new i.bN(Z),u_fog_vertical_limit:new i.bL(Z),u_fog_temporal_offset:new i.bN(Z),u_frustum_tl:new i.bM(Z),u_frustum_tr:new i.bM(Z),u_frustum_br:new i.bM(Z),u_frustum_bl:new i.bM(Z),u_globe_pos:new i.bM(Z),u_globe_radius:new i.bN(Z),u_globe_transition:new i.bN(Z),u_is_globe:new i.bO(Z),u_viewport:new i.bL(Z)}))(r)),w.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(Z=>({u_cutoff_params:new i.bP(Z)}))(r)),w.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(Z=>({u_lighting_ambient_color:new i.bM(Z),u_lighting_directional_dir:new i.bM(Z),u_lighting_directional_color:new i.bM(Z),u_ground_radiance:new i.bM(Z)}))(r)),w.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(Z=>({u_light_matrix_0:new i.bK(Z),u_light_matrix_1:new i.bK(Z),u_fade_range:new i.bL(Z),u_shadow_normal_offset:new i.bM(Z),u_shadow_intensity:new i.bN(Z),u_shadow_texel_size:new i.bN(Z),u_shadow_map_resolution:new i.bN(Z),u_shadow_direction:new i.bM(Z),u_shadow_bias:new i.bM(Z),u_shadowmap_0:new i.bO(Z),u_shadowmap_1:new i.bO(Z)}))(r))}}setTerrainUniformValues(r,s){if(!this.terrainUniforms)return;const h=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const p in s)h[p]&&h[p].set(this.program,p,s[p])}}setGlobeUniformValues(r,s){if(!this.globeUniforms)return;const h=this.globeUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const p in s)h[p]&&h[p].set(this.program,p,s[p])}}setFogUniformValues(r,s){if(!this.fogUniforms)return;const h=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const p in s)h[p].set(this.program,p,s[p])}}setCutoffUniformValues(r,s){if(!this.cutoffUniforms)return;const h=this.cutoffUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const p in s)h[p].set(this.program,p,s[p])}}setLightsUniformValues(r,s){if(!this.lightsUniforms)return;const h=this.lightsUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const p in s)h[p].set(this.program,p,s[p])}}setShadowUniformValues(r,s){if(this.failedToCreate||!this.shadowUniforms)return;const h=this.shadowUniforms;r.program.set(this.program);for(const p in s)h[p].set(this.program,p,s[p])}_drawDebugWireframe(r,s,h,p,y,w,M,C,k,z){const B=r.options.wireframe;if(B.terrain===!1&&B.layers2D===!1&&B.layers3D===!1)return;const $=r.context;if(!(!(!B.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!B.layers2D||r._terrain&&r._terrain.renderingToTexture||!jd.includes(this.name))||!(!B.layers3D||!jp.includes(this.name))))return;const H=$.gl,K=r.wireframeDebugCache.getLinesFromTrianglesBuffer(r.frameCounter,y,$);if(!K)return;const X=[...this.fixedDefines];X.push("DEBUG_WIREFRAME");const Q=r.getOrCreateProgram(this.name,{config:this.configuration,defines:X});$.program.set(Q.program);const Z=(se,de,ne)=>{if(de[se]&&ne[se])for(const pe in de[se])ne[se][pe]&&ne[se][pe].set(ne.program,pe,de[se][pe].current)};k&&k.setUniforms(Q.program,$,Q.binderUniforms,M,{zoom:C}),Z("fixedUniforms",this,Q),Z("terrainUniforms",this,Q),Z("globeUniforms",this,Q),Z("fogUniforms",this,Q),Z("lightsUniforms",this,Q),Z("shadowUniforms",this,Q),K.bind(),$.setColorMode(new Yn([H.ONE,H.ONE_MINUS_SRC_ALPHA,H.ZERO,H.ONE],i.ax.transparent,[!0,!0,!0,!1])),$.setDepthMode(new xn(s.func===H.LESS?H.LEQUAL:s.func,xn.ReadOnly,s.range)),$.setStencilMode(Dn.disabled);const ie=3*w.primitiveLength*2,he=3*w.primitiveOffset*2*2;z&&z>1?H.drawElementsInstanced(H.LINES,ie,H.UNSIGNED_SHORT,he,z):H.drawElements(H.LINES,ie,H.UNSIGNED_SHORT,he),y.bind(),$.program.set(this.program),$.setDepthMode(s),$.setStencilMode(h),$.setColorMode(p)}draw(r,s,h,p,y,w,M,C,k,z,B,$,H,K,X,Q,Z){const ie=r.context,he=ie.gl;if(this.failedToCreate)return;ie.program.set(this.program),ie.setDepthMode(h),ie.setStencilMode(p),ie.setColorMode(y),ie.setCullFace(w);for(const pe of Object.keys(this.fixedUniforms))this.fixedUniforms[pe].set(this.program,pe,M[pe]);K&&K.setUniforms(this.program,ie,this.binderUniforms,$,{zoom:H});const se={[he.POINTS]:1,[he.LINES]:2,[he.TRIANGLES]:3,[he.LINE_STRIP]:1}[s],de=Z&&Z.length>0;if(de){for(const pe of Z)he.bindBufferBase(he.TRANSFORM_FEEDBACK_BUFFER,pe.targetIndex,pe.buffer.buffer);he.beginTransformFeedback(s)}const ne=Q&&Q>0?1:void 0;for(const pe of B.get()){const Se=pe.vaos||(pe.vaos={});(Se[C]||(Se[C]=new mu)).bind(ie,this,k,K?K.getPaintVertexBuffers():[],z,pe.vertexOffset,X||[],ne),Q&&Q>1?he.drawElementsInstanced(s,pe.primitiveLength*se,he.UNSIGNED_SHORT,pe.primitiveOffset*se*2,Q):z?he.drawElements(s,pe.primitiveLength*se,he.UNSIGNED_SHORT,pe.primitiveOffset*se*2):he.drawArrays(s,pe.vertexOffset,pe.vertexLength),s===he.TRIANGLES&&z&&this._drawDebugWireframe(r,h,p,y,z,pe,$,H,K,Q)}de&&he.endTransformFeedback()}}function Ud(c,r){const s=Math.pow(2,r.tileID.overscaledZ),h=r.tileSize*Math.pow(2,c.transform.tileZoom)/s,p=h*(r.tileID.canonical.x+r.tileID.wrap*s),y=h*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture?r.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/i.a3(r,1,c.transform.tileZoom),u_pixel_coord_upper:[p>>16,y>>16],u_pixel_coord_lower:[65535&p,65535&y]}}const Vp=i.a6.create(),$d=(c,r,s,h,p,y,w,M,C,k,z,B,$,H,K,X)=>{const Q=r.style.light,Z=Q.properties.get("position"),ie=[Z.x,Z.y,Z.z],he=i.co.create();Q.properties.get("anchor")==="viewport"&&(i.co.fromRotation(he,-r.transform.angle),i.N.transformMat3(ie,ie,he));const se=Q.properties.get("color"),de=r.transform,ne={u_matrix:c,u_lightpos:ie,u_lightintensity:Q.properties.get("intensity"),u_lightcolor:[se.r,se.g,se.b],u_vertical_gradient:+s,u_opacity:h,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Vp,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:p,u_edge_radius:y,u_flood_light_color:B,u_vertical_scale:$,u_flood_light_intensity:H,u_ground_shadow_factor:K,u_emissive_strength:X};return de.projection.name==="globe"&&(ne.u_tile_id=[w.canonical.x,w.canonical.y,1<<w.canonical.z],ne.u_zoom_transition=C,ne.u_inv_rot_matrix=z,ne.u_merc_center=k,ne.u_up_dir=de.projection.upVector(new i.bs(0,0,0),k[0]*i.V,k[1]*i.V),ne.u_height_lift=M),ne},Gd=(c,r,s)=>({u_matrix:c,u_edge_radius:r,u_vertical_scale:s}),Al=(c,r,s,h,p,y,w,M,C,k,z,B,$,H)=>{const K=$d(c,r,s,h,p,y,w,C,k,z,B,$,H,1,[0,0,0],0),X={u_height_factor:-Math.pow(2,w.overscaledZ)/M.tileSize/8};return i.e(K,Ud(r,M),X)},fc=(c,r)=>({u_matrix:c,u_emissive_strength:r}),Hd=(c,r,s,h)=>i.e(fc(c,r),Ud(s,h)),Il=(c,r,s)=>({u_matrix:c,u_world:s,u_emissive_strength:r}),Up=(c,r,s,h,p)=>i.e(Hd(c,r,s,h),{u_world:p}),Eh=(c,r,s,h)=>{const p=i.V/s.tileSize;return{u_matrix:c,u_camera_to_center_distance:r.getCameraToCenterDistance(h),u_extrude_scale:[r.pixelsToGLUnits[0]/p,r.pixelsToGLUnits[1]/p]}},qd=(c,r,s=1)=>({u_matrix:c,u_color:r,u_overlay:0,u_overlay_scale:s}),$p=i.a6.create(),Wd=(c,r,s,h,p,y,w)=>{const M=c.transform,C=M.projection.name==="globe",k=C?i.cp(M.zoom,r.canonical)*M._pixelsPerMercatorPixel:i.a3(s,1,y),z={u_matrix:r.projMatrix,u_extrude_scale:k,u_intensity:w,u_inv_rot_matrix:$p,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(C){z.u_inv_rot_matrix=h,z.u_merc_center=p,z.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],z.u_zoom_transition=i.S(M.zoom);const B=p[0]*i.V,$=p[1]*i.V;z.u_up_dir=M.projection.upVector(new i.bs(0,0,0),B,$)}return z};function Sh(c,[r,s,h,p],[y,w]){if(y===w)return[0,0,0,0];const M=255*(c-1)/(c*(w-y));return[r*M,s*M,h*M,p*M]}function Gp(c,r,[s,h]){return s===h?0:.5/c+(r-s)*(c-1)/(c*(h-s))}const Zd=(c,r,s,h,p,y,w,M,C,k,z,B,$,H,K,X,Q,Z,ie,he,se)=>{return{u_matrix:c,u_normalize_matrix:r,u_globe_matrix:s,u_merc_matrix:h,u_grid_matrix:p,u_tl_parent:y,u_scale_parent:k,u_fade_t:z.mix,u_opacity:z.opacity*B.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:B.paint.get("raster-brightness-min"),u_brightness_high:B.paint.get("raster-brightness-max"),u_saturation_factor:(ne=B.paint.get("raster-saturation"),ne>0?1-1/(1.001-ne):-ne),u_contrast_factor:(de=B.paint.get("raster-contrast"),de>0?1/(1-de):1+de),u_spin_weights:yu(B.paint.get("raster-hue-rotate")),u_perspective_transform:$,u_raster_elevation:H,u_zoom_transition:w,u_merc_center:M,u_cutoff_params:C,u_colorization_mix:Sh(i.cq,X,Z),u_colorization_offset:Gp(i.cq,Q,Z),u_color_ramp:K,u_texture_offset:[he/(ie+2*he),ie/(ie+2*he)],u_texture_res:[ie+2*he,ie+2*he],u_emissive_strength:se};var de,ne};function yu(c){c*=Math.PI/180;const r=Math.sin(c),s=Math.cos(c);return[(2*s+1)/3,(-Math.sqrt(3)*r-s+1)/3,(Math.sqrt(3)*r-s+1)/3]}const Mg=(c,r,s,h,p,y,w,M,C,k,z,B)=>({u_matrix:c,u_normalize_matrix:r,u_globe_matrix:s,u_merc_matrix:h,u_grid_matrix:p,u_tl_parent:y,u_scale_parent:k,u_fade_t:z.mix,u_opacity:z.opacity,u_image0:0,u_image1:1,u_raster_elevation:B,u_zoom_transition:w,u_merc_center:M,u_cutoff_params:C}),Ag=(c,r,s,h,p,y,w,M)=>({u_tile_offset:c,u_velocity:r,u_color_ramp:h,u_velocity_res:s,u_max_speed:p,u_texture_offset:y,u_data_scale:w,u_data_offset:M}),Hp=(c,r,s,h,p,y,w,M)=>({u_velocity:c,u_velocity_res:r,u_max_speed:s,u_speed_factor:h,u_lifetime_delta:p,u_rand_seed:Math.random(),u_texture_offset:y,u_data_scale:w,u_data_offset:M}),qp=i.a6.create(),Mh=(c,r,s,h,p,y,w,M,C,k,z,B,$,H,K,X,Q,Z)=>{const ie=p.transform,he={u_is_size_zoom_constant:+(c==="constant"||c==="source"),u_is_size_feature_constant:+(c==="constant"||c==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:ie.getCameraToCenterDistance(X),u_rotate_symbol:+s,u_aspect_ratio:ie.width/ie.height,u_fade_change:p.options.fadeDuration?p.symbolFadeChange:1,u_matrix:y,u_label_plane_matrix:w,u_coord_matrix:M,u_is_text:+C,u_pitch_with_map:+h,u_texsize:k,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:qp,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:qp,u_up_vector:[0,-1,0],u_icon_transition:Z||0,u_icon_saturation:Q};return X.name==="globe"&&(he.u_tile_id=[z.canonical.x,z.canonical.y,1<<z.canonical.z],he.u_zoom_transition=B,he.u_inv_rot_matrix=H,he.u_merc_center=$,he.u_camera_forward=ie._camera.forward(),he.u_ecef_origin=i.cr(ie.globeMatrix,z.toUnwrapped()),he.u_tile_matrix=Float32Array.from(ie.globeMatrix),he.u_up_vector=K),he},vu=(c,r,s,h,p,y,w,M,C,k,z,B,$,H,K,X,Q)=>i.e(Mh(c,r,s,h,p,y,w,M,C,k,B,$,H,K,X,Q,1),{u_gamma_scale:h?p.transform.getCameraToCenterDistance(Q)*Math.cos(p.terrain?0:p.transform._pitch):1,u_device_pixel_ratio:i.f.devicePixelRatio,u_is_halo:+z,undefined:void 0}),Ah=(c,r,s,h,p,y,w,M,C,k,z,B,$,H,K,X)=>i.e(vu(c,r,s,h,p,y,w,M,!0,C,!0,z,B,$,H,K,X),{u_texsize_icon:k,u_texture_icon:1}),Yd=(c,r,s,h)=>({u_matrix:c,u_emissive_strength:r,u_opacity:s,u_color:h}),xu=(c,r,s,h,p,y,w)=>i.e(function(M,C,k,z){const B=k.imageManager.getPattern(M.toString(),C),{width:$,height:H}=k.imageManager.getPixelSize(C),K=Math.pow(2,z.tileID.overscaledZ),X=z.tileSize*Math.pow(2,k.transform.tileZoom)/K,Q=X*(z.tileID.canonical.x+z.tileID.wrap*K),Z=X*z.tileID.canonical.y;return{u_image:0,u_pattern_tl:B.tl,u_pattern_br:B.br,u_texsize:[$,H],u_pattern_size:B.displaySize,u_tile_units_to_pixels:1/i.a3(z,1,k.transform.tileZoom),u_pixel_coord_upper:[Q>>16,Z>>16],u_pixel_coord_lower:[65535&Q,65535&Z]}}(p,y,h,w),{u_matrix:c,u_emissive_strength:r,u_opacity:s}),Ih=(c,r,s,h,p,y,w,M,C,k,z,B,$=[0,0,0],H)=>{const K=h.style.light,X=K.properties.get("position"),Q=[-X.x,-X.y,X.z],Z=i.co.create();K.properties.get("anchor")==="viewport"&&(i.co.fromRotation(Z,-h.transform.angle),i.N.transformMat3(Q,Q,Z));const ie=k.alphaMode==="MASK",he=K.properties.get("color"),se=B.paint.get("model-ambient-occlusion-intensity"),de=B.paint.get("model-color").constantOr(i.ax.white),ne=B.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:c,u_lighting_matrix:r,u_normal_matrix:s,u_lightpos:Q,u_lightintensity:K.properties.get("intensity"),u_lightcolor:[he.r,he.g,he.b],u_camera_pos:$,u_opacity:p,u_baseTextureIsAlpha:0,u_alphaMask:+ie,u_alphaCutoff:k.alphaCutoff,u_baseColorFactor:[y.r,y.g,y.b,y.a],u_emissiveFactor:[w[0],w[1],w[2],1],u_metallicFactor:M,u_roughnessFactor:C,u_baseColorTexture:Er.BaseColor,u_metallicRoughnessTexture:Er.MetallicRoughness,u_normalTexture:Er.Normal,u_occlusionTexture:Er.Occlusion,u_emissionTexture:Er.Emission,u_color_mix:[de.r,de.g,de.b,ne],u_aoIntensity:se,u_emissive_strength:z,u_occlusionTextureTransform:H||[0,0,0,0]}},bu=new Float32Array(16),wu=(c,r=bu,s=bu)=>({u_matrix:c,u_instance:r,u_node_matrix:s}),Ig={fillExtrusion:c=>({u_matrix:new i.bK(c),u_lightpos:new i.bM(c),u_lightintensity:new i.bN(c),u_lightcolor:new i.bM(c),u_vertical_gradient:new i.bN(c),u_opacity:new i.bN(c),u_edge_radius:new i.bN(c),u_ao:new i.bL(c),u_tile_id:new i.bM(c),u_zoom_transition:new i.bN(c),u_inv_rot_matrix:new i.bK(c),u_merc_center:new i.bL(c),u_up_dir:new i.bM(c),u_height_lift:new i.bN(c),u_flood_light_color:new i.bM(c),u_vertical_scale:new i.bN(c),u_flood_light_intensity:new i.bN(c),u_ground_shadow_factor:new i.bM(c),u_emissive_strength:new i.bN(c)}),fillExtrusionDepth:c=>({u_matrix:new i.bK(c),u_edge_radius:new i.bN(c),u_vertical_scale:new i.bN(c)}),fillExtrusionPattern:c=>({u_matrix:new i.bK(c),u_lightpos:new i.bM(c),u_lightintensity:new i.bN(c),u_lightcolor:new i.bM(c),u_vertical_gradient:new i.bN(c),u_height_factor:new i.bN(c),u_edge_radius:new i.bN(c),u_ao:new i.bL(c),u_tile_id:new i.bM(c),u_zoom_transition:new i.bN(c),u_inv_rot_matrix:new i.bK(c),u_merc_center:new i.bL(c),u_up_dir:new i.bM(c),u_height_lift:new i.bN(c),u_image:new i.bO(c),u_texsize:new i.bL(c),u_pixel_coord_upper:new i.bL(c),u_pixel_coord_lower:new i.bL(c),u_tile_units_to_pixels:new i.bN(c),u_opacity:new i.bN(c)}),fillExtrusionGroundEffect:c=>({u_matrix:new i.bK(c),u_opacity:new i.bN(c),u_ao_pass:new i.bN(c),u_meter_to_tile:new i.bN(c),u_ao:new i.bL(c),u_flood_light_intensity:new i.bN(c),u_flood_light_color:new i.bM(c),u_attenuation:new i.bN(c),u_edge_radius:new i.bN(c),u_fb:new i.bO(c),u_fb_size:new i.bN(c)}),fill:c=>({u_matrix:new i.bK(c),u_emissive_strength:new i.bN(c)}),fillPattern:c=>({u_matrix:new i.bK(c),u_emissive_strength:new i.bN(c),u_image:new i.bO(c),u_texsize:new i.bL(c),u_pixel_coord_upper:new i.bL(c),u_pixel_coord_lower:new i.bL(c),u_tile_units_to_pixels:new i.bN(c)}),fillOutline:c=>({u_matrix:new i.bK(c),u_emissive_strength:new i.bN(c),u_world:new i.bL(c)}),fillOutlinePattern:c=>({u_matrix:new i.bK(c),u_emissive_strength:new i.bN(c),u_world:new i.bL(c),u_image:new i.bO(c),u_texsize:new i.bL(c),u_pixel_coord_upper:new i.bL(c),u_pixel_coord_lower:new i.bL(c),u_tile_units_to_pixels:new i.bN(c)}),circle:i.cs,collisionBox:c=>({u_matrix:new i.bK(c),u_camera_to_center_distance:new i.bN(c),u_extrude_scale:new i.bL(c)}),collisionCircle:c=>({u_matrix:new i.bK(c),u_inv_matrix:new i.bK(c),u_camera_to_center_distance:new i.bN(c),u_viewport_size:new i.bL(c)}),debug:c=>({u_color:new i.ca(c),u_matrix:new i.bK(c),u_overlay:new i.bO(c),u_overlay_scale:new i.bN(c)}),clippingMask:c=>({u_matrix:new i.bK(c)}),heatmap:c=>({u_extrude_scale:new i.bN(c),u_intensity:new i.bN(c),u_matrix:new i.bK(c),u_inv_rot_matrix:new i.bK(c),u_merc_center:new i.bL(c),u_tile_id:new i.bM(c),u_zoom_transition:new i.bN(c),u_up_dir:new i.bM(c)}),heatmapTexture:c=>({u_image:new i.bO(c),u_color_ramp:new i.bO(c),u_opacity:new i.bN(c)}),hillshade:c=>({u_matrix:new i.bK(c),u_image:new i.bO(c),u_latrange:new i.bL(c),u_light:new i.bL(c),u_shadow:new i.ca(c),u_highlight:new i.ca(c),u_emissive_strength:new i.bN(c),u_accent:new i.ca(c)}),hillshadePrepare:c=>({u_matrix:new i.bK(c),u_image:new i.bO(c),u_dimension:new i.bL(c),u_zoom:new i.bN(c)}),line:i.ct,linePattern:i.cu,raster:c=>({u_matrix:new i.bK(c),u_normalize_matrix:new i.bK(c),u_globe_matrix:new i.bK(c),u_merc_matrix:new i.bK(c),u_grid_matrix:new i.cb(c),u_tl_parent:new i.bL(c),u_scale_parent:new i.bN(c),u_fade_t:new i.bN(c),u_opacity:new i.bN(c),u_image0:new i.bO(c),u_image1:new i.bO(c),u_brightness_low:new i.bN(c),u_brightness_high:new i.bN(c),u_saturation_factor:new i.bN(c),u_contrast_factor:new i.bN(c),u_spin_weights:new i.bM(c),u_perspective_transform:new i.bL(c),u_raster_elevation:new i.bN(c),u_zoom_transition:new i.bN(c),u_merc_center:new i.bL(c),u_cutoff_params:new i.bP(c),u_colorization_mix:new i.bP(c),u_colorization_offset:new i.bN(c),u_color_ramp:new i.bO(c),u_texture_offset:new i.bL(c),u_texture_res:new i.bL(c),u_emissive_strength:new i.bN(c)}),rasterParticle:c=>({u_matrix:new i.bK(c),u_normalize_matrix:new i.bK(c),u_globe_matrix:new i.bK(c),u_merc_matrix:new i.bK(c),u_grid_matrix:new i.cb(c),u_tl_parent:new i.bL(c),u_scale_parent:new i.bN(c),u_fade_t:new i.bN(c),u_opacity:new i.bN(c),u_image0:new i.bO(c),u_image1:new i.bO(c),u_raster_elevation:new i.bN(c),u_zoom_transition:new i.bN(c),u_merc_center:new i.bL(c),u_cutoff_params:new i.bP(c)}),rasterParticleTexture:c=>({u_texture:new i.bO(c),u_opacity:new i.bN(c)}),rasterParticleDraw:c=>({u_tile_offset:new i.bL(c),u_velocity:new i.bO(c),u_color_ramp:new i.bO(c),u_velocity_res:new i.bL(c),u_max_speed:new i.bN(c),u_texture_offset:new i.bL(c),u_data_scale:new i.bP(c),u_data_offset:new i.bN(c)}),rasterParticleUpdate:c=>({u_velocity:new i.bO(c),u_velocity_res:new i.bL(c),u_max_speed:new i.bN(c),u_speed_factor:new i.bN(c),u_lifetime_delta:new i.bN(c),u_rand_seed:new i.bN(c),u_texture_offset:new i.bL(c),u_data_scale:new i.bP(c),u_data_offset:new i.bN(c)}),symbolIcon:c=>({u_is_size_zoom_constant:new i.bO(c),u_is_size_feature_constant:new i.bO(c),u_size_t:new i.bN(c),u_size:new i.bN(c),u_camera_to_center_distance:new i.bN(c),u_rotate_symbol:new i.bO(c),u_aspect_ratio:new i.bN(c),u_fade_change:new i.bN(c),u_matrix:new i.bK(c),u_label_plane_matrix:new i.bK(c),u_coord_matrix:new i.bK(c),u_is_text:new i.bO(c),u_pitch_with_map:new i.bO(c),u_texsize:new i.bL(c),u_tile_id:new i.bM(c),u_zoom_transition:new i.bN(c),u_inv_rot_matrix:new i.bK(c),u_merc_center:new i.bL(c),u_camera_forward:new i.bM(c),u_tile_matrix:new i.bK(c),u_up_vector:new i.bM(c),u_ecef_origin:new i.bM(c),u_texture:new i.bO(c),u_icon_transition:new i.bN(c),u_icon_saturation:new i.bN(c)}),symbolSDF:c=>({u_is_size_zoom_constant:new i.bO(c),u_is_size_feature_constant:new i.bO(c),u_size_t:new i.bN(c),u_size:new i.bN(c),u_camera_to_center_distance:new i.bN(c),u_rotate_symbol:new i.bO(c),u_aspect_ratio:new i.bN(c),u_fade_change:new i.bN(c),u_matrix:new i.bK(c),u_label_plane_matrix:new i.bK(c),u_coord_matrix:new i.bK(c),u_is_text:new i.bO(c),u_pitch_with_map:new i.bO(c),u_texsize:new i.bL(c),u_texture:new i.bO(c),u_gamma_scale:new i.bN(c),u_device_pixel_ratio:new i.bN(c),u_tile_id:new i.bM(c),u_zoom_transition:new i.bN(c),u_inv_rot_matrix:new i.bK(c),u_merc_center:new i.bL(c),u_camera_forward:new i.bM(c),u_tile_matrix:new i.bK(c),u_up_vector:new i.bM(c),u_ecef_origin:new i.bM(c),u_is_halo:new i.bO(c)}),symbolTextAndIcon:c=>({u_is_size_zoom_constant:new i.bO(c),u_is_size_feature_constant:new i.bO(c),u_size_t:new i.bN(c),u_size:new i.bN(c),u_camera_to_center_distance:new i.bN(c),u_rotate_symbol:new i.bO(c),u_aspect_ratio:new i.bN(c),u_fade_change:new i.bN(c),u_matrix:new i.bK(c),u_label_plane_matrix:new i.bK(c),u_coord_matrix:new i.bK(c),u_is_text:new i.bO(c),u_pitch_with_map:new i.bO(c),u_texsize:new i.bL(c),u_texsize_icon:new i.bL(c),u_texture:new i.bO(c),u_texture_icon:new i.bO(c),u_gamma_scale:new i.bN(c),u_device_pixel_ratio:new i.bN(c),u_is_halo:new i.bO(c)}),background:c=>({u_matrix:new i.bK(c),u_emissive_strength:new i.bN(c),u_opacity:new i.bN(c),u_color:new i.ca(c)}),backgroundPattern:c=>({u_matrix:new i.bK(c),u_emissive_strength:new i.bN(c),u_opacity:new i.bN(c),u_image:new i.bO(c),u_pattern_tl:new i.bL(c),u_pattern_br:new i.bL(c),u_texsize:new i.bL(c),u_pattern_size:new i.bL(c),u_pixel_coord_upper:new i.bL(c),u_pixel_coord_lower:new i.bL(c),u_tile_units_to_pixels:new i.bN(c)}),terrainRaster:Th,terrainDepth:Th,skybox:c=>({u_matrix:new i.bK(c),u_sun_direction:new i.bM(c),u_cubemap:new i.bO(c),u_opacity:new i.bN(c),u_temporal_offset:new i.bN(c)}),skyboxGradient:c=>({u_matrix:new i.bK(c),u_color_ramp:new i.bO(c),u_center_direction:new i.bM(c),u_radius:new i.bN(c),u_opacity:new i.bN(c),u_temporal_offset:new i.bN(c)}),skyboxCapture:c=>({u_matrix_3f:new i.cb(c),u_sun_direction:new i.bM(c),u_sun_intensity:new i.bN(c),u_color_tint_r:new i.bP(c),u_color_tint_m:new i.bP(c),u_luminance:new i.bN(c)}),globeRaster:c=>({u_proj_matrix:new i.bK(c),u_globe_matrix:new i.bK(c),u_normalize_matrix:new i.bK(c),u_merc_matrix:new i.bK(c),u_zoom_transition:new i.bN(c),u_merc_center:new i.bL(c),u_image0:new i.bO(c),u_grid_matrix:new i.cb(c),u_skirt_height:new i.bN(c),u_far_z_cutoff:new i.bN(c),u_frustum_tl:new i.bM(c),u_frustum_tr:new i.bM(c),u_frustum_br:new i.bM(c),u_frustum_bl:new i.bM(c),u_globe_pos:new i.bM(c),u_globe_radius:new i.bN(c),u_viewport:new i.bL(c)}),globeAtmosphere:c=>({u_frustum_tl:new i.bM(c),u_frustum_tr:new i.bM(c),u_frustum_br:new i.bM(c),u_frustum_bl:new i.bM(c),u_horizon:new i.bN(c),u_transition:new i.bN(c),u_fadeout_range:new i.bN(c),u_color:new i.bP(c),u_high_color:new i.bP(c),u_space_color:new i.bP(c),u_temporal_offset:new i.bN(c),u_horizon_angle:new i.bN(c)}),model:c=>({u_matrix:new i.bK(c),u_lighting_matrix:new i.bK(c),u_normal_matrix:new i.bK(c),u_lightpos:new i.bM(c),u_lightintensity:new i.bN(c),u_lightcolor:new i.bM(c),u_camera_pos:new i.bM(c),u_opacity:new i.bN(c),u_baseColorFactor:new i.bP(c),u_emissiveFactor:new i.bP(c),u_metallicFactor:new i.bN(c),u_roughnessFactor:new i.bN(c),u_baseTextureIsAlpha:new i.bO(c),u_alphaMask:new i.bO(c),u_alphaCutoff:new i.bN(c),u_baseColorTexture:new i.bO(c),u_metallicRoughnessTexture:new i.bO(c),u_normalTexture:new i.bO(c),u_occlusionTexture:new i.bO(c),u_emissionTexture:new i.bO(c),u_color_mix:new i.bP(c),u_aoIntensity:new i.bN(c),u_emissive_strength:new i.bN(c),u_occlusionTextureTransform:new i.bP(c)}),modelDepth:c=>({u_matrix:new i.bK(c),u_instance:new i.bK(c),u_node_matrix:new i.bK(c)}),groundShadow:c=>({u_matrix:new i.bK(c),u_ground_shadow_factor:new i.bM(c)}),stars:c=>({u_matrix:new i.bK(c),u_up:new i.bM(c),u_right:new i.bM(c),u_intensity_multiplier:new i.bN(c)})};let Os;function Rs(c,r,s,h,p,y,w){const M=c.context,C=M.gl,k=c.transform,z=c.getOrCreateProgram("collisionBox"),B=[];let $=0,H=0;for(let se=0;se<h.length;se++){const de=h[se],ne=r.getTile(de),pe=ne.getBucket(s);if(!pe)continue;const Se=cu(de,pe,k);let Ae=Se;p[0]===0&&p[1]===0||(Ae=c.translatePosMatrix(Se,ne,p,y));const Le=w?pe.textCollisionBox:pe.iconCollisionBox,et=pe.collisionCircleArray;if(et.length>0){const je=i.a6.create(),dt=Ae;i.a6.mul(je,pe.placementInvProjMatrix,k.glCoordMatrix),i.a6.mul(je,je,pe.placementViewportMatrix),B.push({circleArray:et,circleOffset:H,transform:dt,invTransform:je,projection:pe.getProjection()}),$+=et.length/4,H=$}Le&&(c.terrain&&c.terrain.setupElevationDraw(ne,z),z.draw(c,C.LINES,xn.disabled,Dn.disabled,c.colorModeForRenderPass(),bn.disabled,Eh(Ae,k,ne,pe.getProjection()),s.id,Le.layoutVertexBuffer,Le.indexBuffer,Le.segments,null,k.zoom,null,[Le.collisionVertexBuffer,Le.collisionVertexBufferExt]))}if(!w||!B.length)return;const K=c.getOrCreateProgram("collisionCircle"),X=new i.cv;X.resize(4*$),X._trim();let Q=0;for(const se of B)for(let de=0;de<se.circleArray.length/4;de++){const ne=4*de,pe=se.circleArray[ne+0],Se=se.circleArray[ne+1],Ae=se.circleArray[ne+2],Le=se.circleArray[ne+3];X.emplace(Q++,pe,Se,Ae,Le,0),X.emplace(Q++,pe,Se,Ae,Le,1),X.emplace(Q++,pe,Se,Ae,Le,2),X.emplace(Q++,pe,Se,Ae,Le,3)}(!Os||Os.length<2*$)&&(Os=function(se){const de=2*se,ne=new i.aw;ne.resize(de),ne._trim();for(let pe=0;pe<de;pe++){const Se=6*pe;ne.uint16[Se+0]=4*pe+0,ne.uint16[Se+1]=4*pe+1,ne.uint16[Se+2]=4*pe+2,ne.uint16[Se+3]=4*pe+2,ne.uint16[Se+4]=4*pe+3,ne.uint16[Se+5]=4*pe+0}return ne}($));const Z=M.createIndexBuffer(Os,!0),ie=M.createVertexBuffer(X,i.cw.members,!0);for(const se of B){const de={u_matrix:se.transform,u_inv_matrix:se.invTransform,u_camera_to_center_distance:(he=k).getCameraToCenterDistance(se.projection),u_viewport_size:[he.width,he.height]};K.draw(c,C.TRIANGLES,xn.disabled,Dn.disabled,c.colorModeForRenderPass(),bn.disabled,de,s.id,ie,Z,i.aB.simpleSegment(0,2*se.circleOffset,se.circleArray.length,se.circleArray.length/2),null,k.zoom)}var he;ie.destroy(),Z.destroy()}const ba=i.a6.create();function Tu(c){const r=c._camera.getWorldToCamera(c.worldSize,1),s=i.a6.multiply([],r,c.globeMatrix);i.a6.invert(s,s);const h=[0,0,0],p=[0,1,0,0];return i.a7.transformMat4(p,p,s),h[0]=p[0],h[1]=p[1],h[2]=p[2],i.N.normalize(h,h),h}function sn({width:c,height:r,anchor:s,textOffset:h,textScale:p},y){const{horizontalAlign:w,verticalAlign:M}=i.bf(s),C=-(w-.5)*c,k=-(M-.5)*r,z=i.bd(s,h);return new i.P((C/p+z[0])*y,(k/p+z[1])*y)}function Wp(c,r,s,h,p,y,w,M,C,k,z){const B=c.text.placedSymbolArray,$=c.text.dynamicLayoutVertexArray,H=c.icon.dynamicLayoutVertexArray,K={},X=c.getProjection(),Q=bl(M,X,y),Z=y.elevation,ie=X.upVectorScale(M.canonical,y.center.lat,y.worldSize).metersToTile;$.clear();for(let he=0;he<B.length;he++){const se=B.get(he),{tileAnchorX:de,tileAnchorY:ne,numGlyphs:pe}=se,Se=se.hidden||!se.crossTileID||c.allowVerticalPlacement&&!se.placedOrientation?null:h[se.crossTileID];if(Se){let Ae=0,Le=0,et=0;if(Z){const Pt=Z?Z.getAtTileOffset(M,de,ne):0,[Bt,Ft,Xt]=X.upVector(M.canonical,de,ne);Ae=Pt*Bt*ie,Le=Pt*Ft*ie,et=Pt*Xt*ie}let[je,dt,at,At]=Vo(se.projectedAnchorX+Ae,se.projectedAnchorY+Le,se.projectedAnchorZ+et,s?Q:w);const $e=xh(y.getCameraToCenterDistance(X),At);let ot=p.evaluateSizeForFeature(c.textSizeData,k,se)*$e/i.bc;s&&(ot*=c.tilePixelRatio/C);const ke=sn(Se,ot);s?({x:je,y:dt,z:at}=X.projectTilePoint(de+ke.x,ne+ke.y,M.canonical),[je,dt,at]=Vo(je+Ae,dt+Le,at+et,w)):(r&&ke._rotate(-y.angle),je+=ke.x,dt+=ke.y,at=0);const Ze=c.allowVerticalPlacement&&se.placedOrientation===i.b6.vertical?Math.PI/2:0;for(let Pt=0;Pt<pe;Pt++)i.b9($,je,dt,at,Ze);z&&se.associatedIconIndex>=0&&(K[se.associatedIconIndex]={x:je,y:dt,z:at,angle:Ze})}else Js(pe,$)}if(z){H.clear();const he=c.icon.placedSymbolArray;for(let se=0;se<he.length;se++){const de=he.get(se),{numGlyphs:ne}=de,pe=K[se];if(de.hidden||!pe)Js(ne,H);else{const{x:Se,y:Ae,z:Le,angle:et}=pe;for(let je=0;je<ne;je++)i.b9(H,Se,Ae,Le,et)}}c.icon.dynamicLayoutVertexBuffer.updateData(H)}c.text.dynamicLayoutVertexBuffer.updateData($)}function Ch(c,r,s,h,p,y,w={}){const M=s.paint.get("icon-translate"),C=s.paint.get("text-translate"),k=s.paint.get("icon-translate-anchor"),z=s.paint.get("text-translate-anchor"),B=s.layout.get("icon-rotation-alignment"),$=s.layout.get("text-rotation-alignment"),H=s.layout.get("icon-pitch-alignment"),K=s.layout.get("text-pitch-alignment"),X=s.layout.get("icon-keep-upright"),Q=s.layout.get("text-keep-upright"),Z=s.paint.get("icon-color-saturation"),ie=c.context,he=ie.gl,se=c.transform,de=B==="map",ne=$==="map",pe=H==="map",Se=K==="map",Ae=s.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Le=!1;const et=c.depthModeForSublayer(0,xn.ReadOnly),je=[i.a5(se.center.lng),i.ae(se.center.lat)],dt=s.layout.get("text-variable-anchor"),at=se.projection.name==="globe",At=[],$e=[0,-1,0];for(const ot of h){const ke=r.getTile(ot),Ze=ke.getBucket(s);if(!Ze||Ze.projection.name==="mercator"&&at||Ze.fullyClipped)continue;const Pt=Ze.projection.name==="globe",Bt=Pt?i.S(se.zoom):0,Ft=bl(ot,Ze.getProjection(),se),Xt=se.calculatePixelsToTileUnitsMatrix(ke),un=dt&&Ze.hasTextData(),vn=Ze.hasIconTextFit()&&un&&Ze.hasIconData(),pn=Ze.getProjection().createInversionMatrix(se,ot.canonical),gn=()=>{const mi=de&&s.layout.get("symbol-placement")!=="point",or=[],Ar=mi||vn,sr=s.paint.get("icon-image-cross-fade").constantOr(0);c.terrainRenderModeElevated()&&pe&&or.push("PITCH_WITH_MAP_TERRAIN"),Pt&&(or.push("PROJECTION_GLOBE_VIEW"),Ar&&or.push("PROJECTED_POS_ON_VIEWPORT")),sr>0&&or.push("ICON_TRANSITION"),Ze.icon.zOffsetVertexBuffer&&or.push("Z_OFFSET"),Z<1&&or.push("SATURATION");const Sr=Ze.icon.programConfigurations.get(s.id),Qr=c.getOrCreateProgram(Ze.sdfIcons?"symbolSDF":"symbolIcon",{config:Sr,defines:or});let Lr;const to=ke.imageAtlasTexture?ke.imageAtlasTexture.size:[0,0],go=Ze.iconSizeData,Wo=i.b5(go,se.zoom),na=pe||se.pitch!==0,Zo=vl(Ft,ke.tileID.canonical,pe,de,se,Ze.getProjection(),Xt),no=nu(Ft,ke.tileID.canonical,pe,de,se,Ze.getProjection(),Xt),qi=c.translatePosMatrix(no,ke,M,k,!0),Mo=c.translatePosMatrix(Ft,ke,M,k),Fo=Ar?ba:Zo,Yo=de&&!pe&&!mi;let ra=$e;!at&&!se.mercatorFromTransition||de||(ra=Tu(se));const ol=Pt?ra:$e;Lr=Ze.sdfIcons&&!Ze.iconsInText?vu(go.kind,Wo,Yo,pe,c,Mo,Fo,qi,!1,to,!0,ot,Bt,je,pn,ol,Ze.getProjection()):Mh(go.kind,Wo,Yo,pe,c,Mo,Fo,qi,!1,to,ot,Bt,je,pn,ol,Ze.getProjection(),Z,sr);const Ol=ke.imageAtlasTexture?ke.imageAtlasTexture:null,Uu=s.layout.get("icon-size").constantOr(0)!==1||Ze.iconsNeedLinear,$u=Ze.sdfIcons||c.options.rotating||c.options.zooming||Uu||na?he.LINEAR:he.NEAREST,Mf=Ze.sdfIcons&&s.paint.get("icon-halo-width").constantOr(1)!==0,Gu=c.terrain&&pe&&mi?i.a6.invert(i.a6.create(),Zo):ba;if(mi&&Ze.icon){const yc=se.elevation,Nh=yc?yc.getAtTileOffsetFunc(ot,se.center.lat,se.worldSize,Ze.getProjection()):null,Sa=tu(Ft,ke.tileID.canonical,pe,de,se,Ze.getProjection(),Xt);iu(Ze,Ft,c,!1,Sa,no,pe,X,Nh,ot)}return{program:Qr,buffers:Ze.icon,uniformValues:Lr,atlasTexture:Ol,atlasTextureIcon:null,atlasInterpolation:$u,atlasInterpolationIcon:null,isSDF:Ze.sdfIcons,hasHalo:Mf,tile:ke,labelPlaneMatrixInv:Gu}},qn=()=>{const mi=ne&&s.layout.get("symbol-placement")!=="point",or=[],Ar=mi||dt||vn;c.terrainRenderModeElevated()&&Se&&or.push("PITCH_WITH_MAP_TERRAIN"),Pt&&(or.push("PROJECTION_GLOBE_VIEW"),Ar&&or.push("PROJECTED_POS_ON_VIEWPORT")),Ze.text.zOffsetVertexBuffer&&or.push("Z_OFFSET");const sr=Ze.text.programConfigurations.get(s.id),Sr=c.getOrCreateProgram(Ze.iconsInText?"symbolTextAndIcon":"symbolSDF",{config:sr,defines:or});let Qr,Lr=[0,0],to=null;const go=Ze.textSizeData;Ze.iconsInText&&(Lr=ke.imageAtlasTexture?ke.imageAtlasTexture.size:[0,0],to=ke.imageAtlasTexture?ke.imageAtlasTexture:null,Qr=Se||se.pitch!==0||c.options.rotating||c.options.zooming||go.kind==="composite"||go.kind==="camera"?he.LINEAR:he.NEAREST);const Wo=ke.glyphAtlasTexture?ke.glyphAtlasTexture.size:[0,0],na=i.b5(go,se.zoom),Zo=vl(Ft,ke.tileID.canonical,Se,ne,se,Ze.getProjection(),Xt),no=nu(Ft,ke.tileID.canonical,Se,ne,se,Ze.getProjection(),Xt),qi=c.translatePosMatrix(no,ke,C,z,!0),Mo=c.translatePosMatrix(Ft,ke,C,z),Fo=Ar?ba:Zo,Yo=ne&&!Se&&!mi;let ra=$e;!at&&!se.mercatorFromTransition||ne||(ra=Tu(se));const ol=Pt?ra:$e;let Ol;Ol=Ze.iconsInText?Ah(go.kind,na,Yo,Se,c,Mo,Fo,qi,Wo,Lr,ot,Bt,je,pn,ol,Ze.getProjection()):vu(go.kind,na,Yo,Se,c,Mo,Fo,qi,!0,Wo,!0,ot,Bt,je,pn,ol,Ze.getProjection());const Uu=ke.glyphAtlasTexture?ke.glyphAtlasTexture:null,$u=he.LINEAR,Mf=s.paint.get("text-halo-width").constantOr(1)!==0,Gu=c.terrain&&Se&&mi?i.a6.invert(i.a6.create(),Zo):ba;if(mi&&Ze.text){const yc=se.elevation,Nh=yc?yc.getAtTileOffsetFunc(ot,se.center.lat,se.worldSize,Ze.getProjection()):null,Sa=tu(Ft,ke.tileID.canonical,Se,ne,se,Ze.getProjection(),Xt);iu(Ze,Ft,c,!0,Sa,no,Se,Q,Nh,ot)}return{program:Sr,buffers:Ze.text,uniformValues:Ol,atlasTexture:Uu,atlasTextureIcon:to,atlasInterpolation:$u,atlasInterpolationIcon:Qr,isSDF:!0,hasHalo:Mf,tile:ke,labelPlaneMatrixInv:Gu}},kn=Ze.icon.segments.get().length,Nn=Ze.text.segments.get().length,Fn=kn&&!w.onlyText?gn():null,_r=Nn&&!w.onlyIcons?qn():null,Zr=s.paint.get("icon-opacity").constantOr(1),ir=s.paint.get("text-opacity").constantOr(1);if(Ae&&Ze.canOverlap){Le=!0;const mi=Zr&&!w.onlyText?Ze.icon.segments.get():[],or=ir&&!w.onlyIcons?Ze.text.segments.get():[];for(const Ar of mi)At.push({segments:new i.aB([Ar]),sortKey:Ar.sortKey,state:Fn});for(const Ar of or)At.push({segments:new i.aB([Ar]),sortKey:Ar.sortKey,state:_r})}else w.onlyText||At.push({segments:Zr?Ze.icon.segments:new i.aB([]),sortKey:0,state:Fn}),w.onlyIcons||At.push({segments:ir?Ze.text.segments:new i.aB([]),sortKey:0,state:_r})}Le&&At.sort((ot,ke)=>ot.sortKey-ke.sortKey);for(const ot of At){const ke=ot.state;if(ke)if(c.terrain&&c.terrain.setupElevationDraw(ke.tile,ke.program,{useDepthForOcclusion:se.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:ke.labelPlaneMatrixInv}),ie.activeTexture.set(he.TEXTURE0),ke.atlasTexture&&ke.atlasTexture.bind(ke.atlasInterpolation,he.CLAMP_TO_EDGE,!0),ke.atlasTextureIcon&&(ie.activeTexture.set(he.TEXTURE1),ke.atlasTextureIcon&&ke.atlasTextureIcon.bind(ke.atlasInterpolationIcon,he.CLAMP_TO_EDGE,!0)),c.uploadCommonLightUniforms(c.context,ke.program),ke.hasHalo){const Ze=ke.uniformValues;Ze.u_is_halo=1,Ka(ke.buffers,ot.segments,s,c,ke.program,et,p,y,Ze,2),Ze.u_is_halo=0}else{if(ke.isSDF){const Ze=ke.uniformValues;ke.hasHalo&&(Ze.u_is_halo=1,Ka(ke.buffers,ot.segments,s,c,ke.program,et,p,y,Ze,1)),Ze.u_is_halo=0}Ka(ke.buffers,ot.segments,s,c,ke.program,et,p,y,ke.uniformValues,1)}}}function Ka(c,r,s,h,p,y,w,M,C,k){const z=[c.dynamicLayoutVertexBuffer,c.opacityVertexBuffer,c.iconTransitioningVertexBuffer,c.globeExtVertexBuffer,c.zOffsetVertexBuffer];p.draw(h,h.context.gl.TRIANGLES,y,w,M,bn.disabled,C,s.id,c.layoutVertexBuffer,c.indexBuffer,r,s.paint,h.transform.zoom,c.programConfigurations.get(s.id),z,k)}function Cl(c,r,s,h,p,y,w){const M=c.context.gl,C=s.paint.get("fill-pattern"),k=C&&C.constantOr(1);let z,B,$,H,K;w?(B=k&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",z=M.LINES):(B=k?"fillPattern":"fill",z=M.TRIANGLES);for(const X of h){const Q=r.getTile(X);if(k&&!Q.patternsLoaded())continue;const Z=Q.getBucket(s);if(!Z)continue;c.prepareDrawTile();const ie=Z.programConfigurations.get(s.id),he=c.isTileAffectedByFog(X),se=c.getOrCreateProgram(B,{config:ie,overrideFog:he});k&&(c.context.activeTexture.set(M.TEXTURE0),Q.imageAtlasTexture&&Q.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),ie.updatePaintBuffers());const de=C.constantOr(null);if(de&&Q.imageAtlas){const Se=Q.imageAtlas.patternPositions[de.toString()];Se&&ie.setConstantPatternPositions(Se)}const ne=c.translatePosMatrix(X.projMatrix,Q,s.paint.get("fill-translate"),s.paint.get("fill-translate-anchor")),pe=s.paint.get("fill-emissive-strength");if(w){H=Z.indexBuffer2,K=Z.segments2;const Se=c.terrain&&c.terrain.renderingToTexture?c.terrain.drapeBufferSize:[M.drawingBufferWidth,M.drawingBufferHeight];$=B==="fillOutlinePattern"&&k?Up(ne,pe,c,Q,Se):Il(ne,pe,Se)}else H=Z.indexBuffer,K=Z.segments,$=k?Hd(ne,pe,c,Q):fc(ne,pe);c.uploadCommonUniforms(c.context,se,X.toUnwrapped()),se.draw(c,z,p,c.stencilModeForClipping(X),y,bn.disabled,$,s.id,Z.layoutVertexBuffer,H,K,s.paint,c.transform.zoom,ie,void 0)}}function hn(c,r,s,h,p,y,w,M){s.resetLayerRenderingStats(c);const C=c.context,k=C.gl,z=c.transform,B=s.paint.get("fill-extrusion-pattern"),$=B.constantOr(1),H=s.paint.get("fill-extrusion-opacity"),K=c.style.enable3dLights(),X=s.paint.get(K&&!$?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),Q=[s.paint.get("fill-extrusion-ambient-occlusion-intensity"),X],Z=s.layout.get("fill-extrusion-edge-radius"),ie=Z>0&&!s.paint.get("fill-extrusion-rounded-roof"),he=ie?0:Z,se=z.projection.name==="globe"?i.cF():0,de=z.projection.name==="globe",ne=de?i.S(z.zoom):0,pe=[i.a5(z.center.lng),i.ae(z.center.lat)],Se=s.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),Ae=s.paint.get("fill-extrusion-flood-light-intensity"),Le=s.paint.get("fill-extrusion-vertical-scale"),et=tr(c,s.paint.get("fill-extrusion-cutoff-fade-range")),je=s.paint.get("fill-extrusion-emissive-strength"),dt=[];let at;de&&dt.push("PROJECTION_GLOBE_VIEW"),Q[0]>0&&dt.push("FAUX_AO"),ie&&dt.push("ZERO_ROOF_RADIUS"),M&&dt.push("HAS_CENTROID"),Ae>0&&dt.push("FLOOD_LIGHT"),et.shouldRenderCutoff&&dt.push("RENDER_CUTOFF");const At=c.renderPass==="shadow",$e=c.shadowRenderer,ot=At&&!!$e;c.shadowRenderer&&(c.shadowRenderer.useNormalOffset=!0);let ke=[0,0,0];if($e){const Bt=c.style.directionalLight,Ft=c.style.ambientLight;Bt&&Ft&&(ke=ri(Bt,Ft)),at=dt.concat(["SHADOWS_SINGLE_CASCADE"])}const Ze=ot?"fillExtrusionDepth":$?"fillExtrusionPattern":"fillExtrusion",Pt=s.getLayerRenderingStats();for(const Bt of h){const Ft=r.getTile(Bt),Xt=Ft.getBucket(s);if(!Xt||Xt.projection.name!==z.projection.name)continue;let un=!1;$e&&(un=$e.getMaxCascadeForTile(Bt.toUnwrapped())===0);const vn=c.isTileAffectedByFog(Bt),pn=Xt.programConfigurations.get(s.id),gn=c.getOrCreateProgram(Ze,{config:pn,defines:un?at:dt,overrideFog:vn});if(c.terrain&&c.terrain.setupElevationDraw(Ft,gn,{useMeterToDem:!0}),!Xt.centroidVertexBuffer){const Zr=gn.attributes.a_centroid_pos;Zr!==void 0&&k.vertexAttrib2f(Zr,0,0)}!At&&$e&&$e.setupShadows(Ft.tileID.toUnwrapped(),gn,"vector-tile",Ft.tileID.overscaledZ),$&&(c.context.activeTexture.set(k.TEXTURE0),Ft.imageAtlasTexture&&Ft.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),pn.updatePaintBuffers());const qn=B.constantOr(null);if(qn&&Ft.imageAtlas){const Zr=Ft.imageAtlas.patternPositions[qn.toString()];Zr&&pn.setConstantPatternPositions(Zr)}const kn=s.paint.get("fill-extrusion-vertical-gradient");let Nn;if(At&&$e){if(Yp(Ft.tileID,Xt,c))continue;const Zr=$e.calculateShadowPassMatrixFromTile(Ft.tileID.toUnwrapped());Nn=Gd(Zr,he,Le)}else{const Zr=c.translatePosMatrix(Bt.expandedProjMatrix,Ft,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),ir=z.projection.createInversionMatrix(z,Bt.canonical);Nn=$?Al(Zr,c,kn,H,Q,he,Bt,Ft,se,ne,pe,ir,Se,Le):$d(Zr,c,kn,H,Q,he,Bt,se,ne,pe,ir,Se,Le,Ae,ke,je)}c.uploadCommonUniforms(C,gn,Bt.toUnwrapped(),null,et);let Fn=Xt.segments;if(z.projection.name==="mercator"&&!At&&(Fn=Xt.getVisibleSegments(Ft.tileID,c.terrain,c.transform.getFrustum(0)),!Fn.get().length))continue;if(Pt)if(At)for(const Zr of Fn.get())Pt.numRenderedVerticesInShadowPass+=Zr.primitiveLength;else for(const Zr of Fn.get())Pt.numRenderedVerticesInTransparentPass+=Zr.primitiveLength;const _r=[];(c.terrain||M)&&_r.push(Xt.centroidVertexBuffer),de&&_r.push(Xt.layoutVertexExtBuffer),gn.draw(c,C.gl.TRIANGLES,p,y,w,bn.backCCW,Nn,s.id,Xt.layoutVertexBuffer,Xt.indexBuffer,Fn,s.paint,c.transform.zoom,pn,_r)}c.shadowRenderer&&(c.shadowRenderer.useNormalOffset=!1)}function Ja(c,r,s,h,p,y,w,M,C,k,z,B,$,H,K,X,Q,Z,ie){const he=c.context,se=he.gl,de=c.transform,ne=c.transform.zoom,pe=[],Se=tr(c,s.paint.get("fill-extrusion-cutoff-fade-range"));k==="clear"?(pe.push("CLEAR_SUBPASS"),ie&&(pe.push("CLEAR_FROM_TEXTURE"),he.activeTexture.set(se.TEXTURE0),ie.bind(se.LINEAR,se.CLAMP_TO_EDGE))):k==="sdf"&&pe.push("SDF_SUBPASS"),Q&&pe.push("HAS_CENTROID"),Se.shouldRenderCutoff&&pe.push("RENDER_CUTOFF");const Ae=s.layout.get("fill-extrusion-edge-radius"),Le=(et,je,dt,at,At)=>{const $e=je.programConfigurations.get(s.id),ot=c.isTileAffectedByFog(et),ke=c.getOrCreateProgram("fillExtrusionGroundEffect",{config:$e,defines:pe,overrideFog:ot}),Ze=((Bt,Ft,Xt,un,vn,pn,gn,qn,kn,Nn,Fn)=>({u_matrix:Ft,u_opacity:Xt,u_ao_pass:un?1:0,u_meter_to_tile:vn,u_ao:pn,u_flood_light_intensity:gn,u_flood_light_color:qn,u_attenuation:kn,u_edge_radius:Nn,u_fb:0,u_fb_size:Fn}))(0,at,z,C,At,[B,$*At],H,K,X,ne>=17?0:Ae*At,ie?ie.size[0]:0),Pt=[];Q&&Pt.push(je.hiddenByLandmarkVertexBuffer),c.uploadCommonUniforms(he,ke,et.toUnwrapped(),null,Se),ke.draw(c,he.gl.TRIANGLES,p,y,w,M,Ze,s.id,je.vertexBuffer,je.indexBuffer,dt,s.paint,ne,$e,Pt)};for(const et of h){const je=r.getTile(et),dt=je.getBucket(s);if(!dt||dt.projection.name!==de.projection.name||!dt.groundEffect||dt.groundEffect&&!dt.groundEffect.hasData())continue;const at=dt.groundEffect,At=1/dt.tileToMeter;{const $e=c.translatePosMatrix(et.projMatrix,je,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),ot=at.getDefaultSegment();Le(et,at,ot,$e,At)}if(Z)for(let $e=0;$e<4;$e++){const ot=i.cG[$e](et),ke=r.getTile(ot);if(!ke)continue;const Ze=ke.getBucket(s);if(!Ze||Ze.projection.name!==de.projection.name||!Ze.groundEffect||Ze.groundEffect&&!Ze.groundEffect.hasData())continue;const Pt=Ze.groundEffect;let Bt,Ft;$e===0?(Bt=[-i.V,0,0],Ft=1):$e===1?(Bt=[i.V,0,0],Ft=0):$e===2?(Bt=[0,-i.V,0],Ft=3):(Bt=[0,i.V,0],Ft=2);const Xt=Pt.regionSegments[Ft];if(!Xt)continue;const un=new Float32Array(16);i.a6.translate(un,et.projMatrix,Bt),Le(et,Pt,Xt,c.translatePosMatrix(un,je,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),At)}}}function Cg(c,r,s,h,p,y,w){h.centroidVertexArray.length===0&&h.createCentroidsBuffer();const M=y?y.findDEMTileFor(s):null;if(!(M&&M.dem||w))return;const C=Z=>new i.P(Math.ceil((Z+i.cJ)*i.cK),0),k=Z=>{const ie=r.getSource().minzoom,he=de=>{const ne=r.getTileByID(de);if(ne&&ne.hasData())return ne.getBucket(p)},se=[0,-1,1];for(const de of se){if(Z.overscaledZ+de<ie)continue;const ne=he(Z.calculateScaledKey(Z.overscaledZ+de));if(ne)return ne}},z=[0,0,0],B=(Z,ie)=>(z[0]=Math.min(Z.min.y,ie.min.y),z[1]=Math.max(Z.max.y,ie.max.y),z[2]=i.V-ie.min.x>Z.max.x?ie.min.x-i.V:Z.max.x,z),$=(Z,ie)=>(z[0]=Math.min(Z.min.x,ie.min.x),z[1]=Math.max(Z.max.x,ie.max.x),z[2]=i.V-ie.min.y>Z.max.y?ie.min.y-i.V:Z.max.y,z),H=[(Z,ie)=>B(Z,ie),(Z,ie)=>B(ie,Z),(Z,ie)=>$(Z,ie),(Z,ie)=>$(ie,Z)],K=(Z,ie,he,se,de,ne,pe)=>{if(!y)return 0;const Se=[[ne?he:Z,ne?Z:he,0],[ne?he:ie,ne?ie:he,0]],Ae=pe<0?i.V+pe:pe,Le=[ne?Ae:(Z+ie)/2,ne?(Z+ie)/2:Ae,0];return he===0&&pe<0||he!==0&&pe>0?y.getForTilePoints(de,[Le],!0,se):Se.push(Le),y.getForTilePoints(s,Se,!0,M),Math.max(Se[0][2],Se[1][2],Le[2])/y.exaggeration()};for(let Z=0;Z<4;Z++){const ie=h.borderFeatureIndices[Z];if(ie.length===0)continue;const he=i.cG[Z](s),se=k(he);if(!(se&&se instanceof i.cH)||h.borderDoneWithNeighborZ[Z]===se.canonical.z)continue;se.centroidVertexArray.length===0&&se.createCentroidsBuffer();const de=y?y.findDEMTileFor(he):null;if(!(de&&de.dem||w))continue;const ne=(Z<2?1:5)-Z,pe=se.borderDoneWithNeighborZ[ne]!==h.canonical.z,Se=se.borderFeatureIndices[ne];let Ae=0;if(h.canonical.z!==se.canonical.z){for(const Le of ie)h.showCentroid(h.featuresOnBorder[Le]);if(pe)for(const Le of Se)se.showCentroid(se.featuresOnBorder[Le]);h.borderDoneWithNeighborZ[Z]=se.canonical.z,se.borderDoneWithNeighborZ[ne]=h.canonical.z}for(const Le of ie){const et=h.featuresOnBorder[Le],je=h.centroidData[et.centroidDataIndex],dt=et.borders[Z];let at;for(;Ae<Se.length;){at=se.featuresOnBorder[Se[Ae]];const At=at.borders[ne];if(At[1]>dt[0]+3||At[0]>dt[0]-3)break;se.showCentroid(at),Ae++}if(at&&Ae<Se.length){const At=Ae;let $e=0;for(;!(at.borders[ne][0]>dt[1]-3)&&($e++,++Ae!==Se.length);)at=se.featuresOnBorder[Se[Ae]];if(at=se.featuresOnBorder[Se[At]],$e>1){const Ze=at.borders[ne];Math.abs(dt[0]-Ze[0])<3&&Math.abs(dt[1]-Ze[1])<3&&($e=1,Ae=At+1)}else if($e===0){h.showCentroid(et);continue}const ot=se.centroidData[at.centroidDataIndex];w&&$e===1&&(((X=je).flags|(Q=ot).flags)&i.cI?(X.flags|=i.cI,Q.flags|=i.cI):(X.flags&=~i.cI,Q.flags&=~i.cI));const ke=et.intersectsCount()>1||at.intersectsCount()>1;if($e>1)Ae=At,je.centroidXY=ot.centroidXY=new i.P(0,0);else if(de&&de.dem&&!ke){const Ze=H[Z](je,ot),Pt=Z%2?i.V-1:0,Bt=K(Ze[0],Math.min(i.V-1,Ze[1]),Pt,de,he,Z<2,Ze[2]);je.centroidXY=ot.centroidXY=C(Bt)}else ke?je.centroidXY=ot.centroidXY=new i.P(0,0):(je.centroidXY=h.encodeBorderCentroid(et),ot.centroidXY=se.encodeBorderCentroid(at));h.writeCentroidToBuffer(je),se.writeCentroidToBuffer(ot)}else h.showCentroid(et)}h.borderDoneWithNeighborZ[Z]=se.canonical.z,se.borderDoneWithNeighborZ[ne]=h.canonical.z}var X,Q;(h.needsCentroidUpdate||!h.centroidVertexBuffer&&h.centroidVertexArray.length!==0)&&h.uploadCentroid(c)}const Pg=[1,0,0],Xd=[0,1,0],Zp=[0,0,1];function Yp(c,r,s){const h=s.transform,p=s.shadowRenderer;if(!p)return!0;const y=c.toUnwrapped(),w=h.tileSize*p._cascades[s.currentShadowCascade].scale;let M=r.maxHeight;if(h.elevation){const X=h.elevation.getMinMaxForTile(c);X&&(M+=X.max)}const C=[...p.shadowDirection];C[2]=-C[2];const k=p.computeSimplifiedTileShadowVolume(y,M,w,C);if(!k)return!1;const z=[Pg,Xd,Zp,C,[C[0],0,C[2]],[0,C[1],C[2]]],B=h.projection.name==="globe",$=h.scaleZoom(w),H=i.bq.fromInvProjectionMatrix(h.invProjMatrix,h.worldSize,$,!B),K=p.getCurrentCascadeFrustum();return H.intersectsPrecise(k.vertices,k.planes,z)===0||K.intersectsPrecise(k.vertices,k.planes,z)===0}function Xp(c){return[c[0]*i.cL,c[1]*i.cL,c[2]*i.cL,0]}function Kd(c,r,s,h,p,y,w,M,C){const k=h.getSource(),z=s.globeSharedBuffers;if(!z)return;let B,$,H;if(r&&(B=h.getTile(r)),k instanceof i.ap?($=k.texture,H=i.cj(0,0,s.transform)):B&&r&&($=B.texture,H=i.cj(r.canonical.z,r.canonical.x,s.transform)),!$||!H)return;c||(H=i.a6.scale(i.a6.create(),H,[1,-1,1]));const K=s.context,X=K.gl,Q=p.paint.get("raster-resampling")==="nearest"?X.NEAREST:X.LINEAR,Z=s.colorModeForDrapableLayerRenderPass(y),ie=w.defines;ie.push("GLOBE_POLES");const he=new xn(X.LEQUAL,xn.ReadWrite,s.depthRangeFor3D),se=Float32Array.from(s.transform.expandedFarZProjMatrix),de=Float32Array.from(i.aT(i.ci(new i.bs(0,0,0))));s.terrain&&s.terrain.prepareDrawTile(),K.activeTexture.set(X.TEXTURE0),$.bind(Q,X.CLAMP_TO_EDGE),K.activeTexture.set(X.TEXTURE1),$.bind(Q,X.CLAMP_TO_EDGE),$.useMipmap&&K.extTextureFilterAnisotropic&&s.transform.pitch>20&&X.texParameterf(X.TEXTURE_2D,K.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,K.extTextureFilterAnisotropicMax);const[ne,pe,Se,Ae]=r?z.getPoleBuffers(r.canonical.z,!1):z.getPoleBuffers(0,!0),Le=p.paint.get("raster-elevation");let et;c?(et=ne,s.renderDefaultNorthPole=Le!==0):(et=pe,s.renderDefaultSouthPole=Le!==0);const je=Xp(w.mix),dt=((At,$e,ot,ke,Ze,Pt,Bt,Ft,Xt,un,vn,pn,gn)=>Zd(At,$e,ot,new Float32Array(16),new Float32Array(9),[0,0],ke,[0,0],[0,0,0,0],1,{opacity:1,mix:0},Pt,[0,0],Ft,2,un,vn,pn,1,0,gn))(se,de,H,i.S(s.transform.zoom),0,p,0,Le,0,je,w.offset,w.range,y),at=s.getOrCreateProgram("raster",{defines:ie});s.uploadCommonUniforms(K,at,null),at.draw(s,X.TRIANGLES,he,C,Z,M,dt,p.id,et,Se,Ae)}function Jd(c){const r=c._nearZ,s=c.projection.farthestPixelDistance(c),h=s-r,p=.2*c.height,y=r+p;return[r,s,(y-p-r)/h,(y-r)/h]}function Qd(c,r,s,h){if(c)return r instanceof Xe&&c instanceof pa?r.getTextureDescriptor(c,s,!0):{texture:c.texture,mix:Xp(h.mix),offset:h.offset,buffer:0,tileSize:1}}function ef(c,r,s){if(!c)return null;const h=r.getTextureDescriptor(c,s,!0);if(!h)return null;let{texture:p,mix:y,offset:w,tileSize:M,buffer:C,format:k}=h;if(!p||!k)return null;let z=!1;return k==="uint32"&&(z=!0,y[3]=0,y=Sh(i.cM,y,[0,s.paint.get("raster-particle-max-speed")]),w=Gp(i.cM,w,[0,s.paint.get("raster-particle-max-speed")])),{texture:p,textureOffset:[C/(M+2*C),M/(M+2*C)],tileSize:M,scalarData:z,scale:y,offset:w,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[k]]}}function tf(c){const r=c._nearZ,s=c.projection.farthestPixelDistance(c),h=s-r,p=.2*c.height,y=r+p;return[r,s,(y-p-r)/h,(y-r)/h]}const Ho=new i.ax(1,0,0,1),Qa=new i.ax(0,1,0,1),Kp=new i.ax(0,0,1,1),nf=new i.ax(1,0,1,1),rf=new i.ax(0,1,1,1);function el(c,r,s,h,p,y,w){const M=c.context,C=c.transform,k=M.gl,z=C.projection.name==="globe",B=z?["PROJECTION_GLOBE_VIEW"]:[];let $=i.a6.clone(s.projMatrix);if(z&&i.S(C.zoom)>0){const je=i.aS(s.canonical,C),dt=i.cN(je);$=i.a6.multiply(new Float32Array(16),C.globeMatrix,dt),i.a6.multiply($,C.projMatrix,$)}const H=i.a6.create();H[12]+=2*p/(i.f.devicePixelRatio*C.width),H[13]+=2*y/(i.f.devicePixelRatio*C.height),i.a6.multiply($,H,$);const K=c.getOrCreateProgram("debug",{defines:B}),X=r.getTileByID(s.key);c.terrain&&c.terrain.setupElevationDraw(X,K);const Q=xn.disabled,Z=Dn.disabled,ie=c.colorModeForRenderPass(),he="$debug";M.activeTexture.set(k.TEXTURE0),c.emptyTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),z?X._makeGlobeTileDebugBuffers(c.context,C):X._makeDebugTileBoundsBuffers(c.context,C.projection);const se=X._tileDebugBuffer||c.debugBuffer,de=X._tileDebugIndexBuffer||c.debugIndexBuffer,ne=X._tileDebugSegments||c.debugSegments;if(K.draw(c,k.LINE_STRIP,Q,Z,ie,bn.disabled,qd($,h),he,se,de,ne,null,null,null,[X._globeTileDebugBorderBuffer]),w){const je=X.latestRawTileData,dt=Math.floor((je&&je.byteLength||0)/1024);let at=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(at+=` => ${s.overscaledZ}`),at+=` ${X.state}`,at+=` ${dt}kb`,function(At,$e){At.initDebugOverlayCanvas();const ot=At.debugOverlayCanvas,ke=At.context.gl,Ze=At.debugOverlayCanvas.getContext("2d");Ze.clearRect(0,0,ot.width,ot.height),Ze.shadowColor="white",Ze.shadowBlur=2,Ze.lineWidth=1.5,Ze.strokeStyle="white",Ze.textBaseline="top",Ze.font="bold 36px Open Sans, sans-serif",Ze.fillText($e,5,5),Ze.strokeText($e,5,5),At.debugOverlayTexture.update(ot),At.debugOverlayTexture.bind(ke.LINEAR,ke.CLAMP_TO_EDGE)}(c,at)}const pe=r.getTile(s).tileSize,Se=512/Math.min(pe,512)*(s.overscaledZ/C.zoom)*.5,Ae=X._tileDebugTextBuffer||c.debugBuffer,Le=X._tileDebugTextIndexBuffer||c.quadTriangleIndexBuffer,et=X._tileDebugTextSegments||c.debugSegments;K.draw(c,k.TRIANGLES,Q,Z,Yn.alphaBlended,bn.disabled,qd($,i.ax.transparent,Se),he,Ae,Le,et,null,null,null,[X._globeTileDebugTextBuffer])}function of(c,r,s,h){fi(c,0,r+s/2,c.transform.width,s,h)}function rs(c,r,s,h){fi(c,r-s/2,0,s,c.transform.height,h)}function fi(c,r,s,h,p,y){const w=c.context,M=w.gl;M.enable(M.SCISSOR_TEST),M.scissor(r*i.f.devicePixelRatio,s*i.f.devicePixelRatio,h*i.f.devicePixelRatio,p*i.f.devicePixelRatio),w.clear({color:y}),M.disable(M.SCISSOR_TEST)}const Ph=i.ay([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:sf}=Ph;function wa(c,r,s,h){c.emplaceBack(r,s,h)}class af{constructor(r){this.vertexArray=new i.az,this.indices=new i.aw,wa(this.vertexArray,-1,-1,1),wa(this.vertexArray,1,-1,1),wa(this.vertexArray,-1,1,1),wa(this.vertexArray,1,1,1),wa(this.vertexArray,-1,-1,-1),wa(this.vertexArray,1,-1,-1),wa(this.vertexArray,-1,1,-1),wa(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,sf),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=i.aB.simpleSegment(0,0,36,12)}}function Pl(c,r,s,h,p,y){const w=c.context.gl,M=r.paint.get("sky-atmosphere-color"),C=r.paint.get("sky-atmosphere-halo-color"),k=r.paint.get("sky-atmosphere-sun-intensity"),z=((B,$,H,K,X)=>({u_matrix_3f:B,u_sun_direction:$,u_sun_intensity:H,u_color_tint_r:[K.r,K.g,K.b,K.a],u_color_tint_m:[X.r,X.g,X.b,X.a],u_luminance:5e-5}))(i.co.fromMat4(i.co.create(),h),p,k,M,C);w.framebufferTexture2D(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,w.TEXTURE_CUBE_MAP_POSITIVE_X+y,r.skyboxTexture,0),s.draw(c,w.TRIANGLES,xn.disabled,Dn.disabled,Yn.unblended,bn.frontCW,z,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const Dg=i.ay([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class pc{constructor(r){const s=new i.cO;s.emplaceBack(-1,1,1,0,0),s.emplaceBack(1,1,1,1,0),s.emplaceBack(1,-1,1,1,1),s.emplaceBack(-1,-1,1,0,1);const h=new i.aw;h.emplaceBack(0,1,2),h.emplaceBack(2,3,0),this.vertexBuffer=r.createVertexBuffer(s,Dg.members),this.indexBuffer=r.createIndexBuffer(h),this.segments=i.aB.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Eu=i.ay([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Nt{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class wn{constructor(r){this.colorModeAlphaBlendedWriteRGB=new Yn([1,es,1,es],i.ax.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Yn([1,0,1,0],i.ax.transparent,[!1,!1,!1,!0]),this.params=new Nt,this.updateNeeded=!0,r.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),r.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(r){const s=r.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new pc(s);const h=this.params.sizeRange,p=this.params.intensityRange,y=function(z){const B=i.aA(30),$=[];for(let H=0;H<z;++H){const K=2*Math.PI*B(),X=Math.acos(1-2*B())-.5*Math.PI;$.push(i.N.fromValues(Math.cos(X)*Math.cos(K),Math.cos(X)*Math.sin(K),Math.sin(X)))}return $}(this.params.starsCount),w=i.aA(300),M=new i.cP,C=new i.aw;let k=0;for(let z=0;z<y.length;++z){const B=i.N.scale([],y[z],200),$=Math.max(0,1+.01*h*(1*w()-.5)),H=Math.max(0,1+.01*p*(1*w()-.5));M.emplaceBack(B[0],B[1],B[2],-1,-1,$,H),M.emplaceBack(B[0],B[1],B[2],1,-1,$,H),M.emplaceBack(B[0],B[1],B[2],1,1,$,H),M.emplaceBack(B[0],B[1],B[2],-1,1,$,H),C.emplaceBack(k+0,k+1,k+2),C.emplaceBack(k+0,k+2,k+3),k+=4}this.starsVx=s.createVertexBuffer(M,Eu.members),this.starsIdx=s.createIndexBuffer(C),this.starsSegments=i.aB.simpleSegment(0,0,M.length,C.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(r,s){const h=r.context,p=h.gl,y=r.transform,w=new xn(p.LEQUAL,xn.ReadOnly,[0,1]),M=i.S(y.zoom),C=s.properties.get("color").toArray01(),k=s.properties.get("high-color").toArray01(),z=s.properties.get("space-color").toArray01PremultipliedAlpha(),B=5e-4,$=i.cQ(s.properties.get("horizon-blend"),0,1,B,.25),H=i.cd(r,h,y)&&$===B?y.worldSize/(2*Math.PI*1.025)-1:y.globeRadius,K=r.frameCounter/1e3%1,X=i.N.length(y.globeCenterInViewSpace),Q=Math.sqrt(Math.pow(X,2)-Math.pow(H,2)),Z=Math.acos(Q/X),ie=he=>{const se=y.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];he&&se.push("ALPHA_PASS");const de=r.getOrCreateProgram("globeAtmosphere",{defines:se}),ne=((Se,Ae,Le,et,je,dt,at,At,$e,ot,ke,Ze)=>({u_frustum_tl:Se,u_frustum_tr:Ae,u_frustum_br:Le,u_frustum_bl:et,u_horizon:je,u_transition:dt,u_fadeout_range:at,u_color:At,u_high_color:$e,u_space_color:ot,u_temporal_offset:ke,u_horizon_angle:Ze}))(y.frustumCorners.TL,y.frustumCorners.TR,y.frustumCorners.BR,y.frustumCorners.BL,y.frustumCorners.horizon,M,$,C,k,z,K,Z);r.uploadCommonUniforms(h,de);const pe=this.atmosphereBuffer;pe&&de.draw(r,p.TRIANGLES,w,Dn.disabled,he?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,bn.backCW,ne,he?"atmosphere_glow_alpha":"atmosphere_glow",pe.vertexBuffer,pe.indexBuffer,pe.segments)};ie(!1),ie(!0)}drawStars(r,s){const h=i.aa(s.properties.get("star-intensity"),0,1);if(h===0)return;const p=r.context,y=p.gl,w=r.transform,M=r.getOrCreateProgram("stars"),C=i.bi.identity([]);i.bi.rotateX(C,C,-w._pitch),i.bi.rotateZ(C,C,-w.angle),i.bi.rotateX(C,C,i.bj(w._center.lat)),i.bi.rotateY(C,C,-i.bj(w._center.lng));const k=i.a6.fromQuat(new Float32Array(16),C),z=i.a6.multiply([],w.starsProjMatrix,k),B=i.co.fromMat4([],k),$=i.co.invert([],B),H=[0,1,0];i.N.transformMat3(H,H,$),i.N.scale(H,H,this.params.sizeMultiplier);const K=[1,0,0];i.N.transformMat3(K,K,$),i.N.scale(K,K,this.params.sizeMultiplier);const X=(Q=H,Z=K,ie=h,{u_matrix:Float32Array.from(z),u_up:Q,u_right:Z,u_intensity_multiplier:ie});var Q,Z,ie;r.uploadCommonUniforms(p,M),this.starsVx&&this.starsIdx&&M.draw(r,y.TRIANGLES,xn.disabled,Dn.disabled,this.colorModeAlphaBlendedWriteRGB,bn.disabled,X,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Dl(c,r){const s=[...c],h=r.cameraWorldSizeForFog/r.worldSize,p=i.a6.identity([]);return i.a6.scale(p,p,[h,h,1]),i.a6.multiply(s,p,s),i.a6.multiply(s,r.worldToFogMatrix,s),s}function pi(c,r,s,h){const p=s.material,y=h.context,{baseColorTexture:w,metallicRoughnessTexture:M}=p.pbrMetallicRoughness,{normalTexture:C,occlusionTexture:k,emissionTexture:z}=p;function B($,H,K){if($&&(c.push(H),y.activeTexture.set(y.gl.TEXTURE0+K),$.gfxTexture)){const{minFilter:X,magFilter:Q,wrapS:Z,wrapT:ie}=$.sampler;$.gfxTexture.bindExtraParam(X,Q,Z,ie)}}B(w,"HAS_TEXTURE_u_baseColorTexture",Er.BaseColor),B(M,"HAS_TEXTURE_u_metallicRoughnessTexture",Er.MetallicRoughness),B(C,"HAS_TEXTURE_u_normalTexture",Er.Normal),B(k,"HAS_TEXTURE_u_occlusionTexture",Er.Occlusion),B(z,"HAS_TEXTURE_u_emissionTexture",Er.Emission),s.texcoordBuffer&&(c.push("HAS_ATTRIBUTE_a_uv_2f"),r.push(s.texcoordBuffer)),s.colorBuffer&&(c.push(s.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),r.push(s.colorBuffer)),s.normalBuffer&&(c.push("HAS_ATTRIBUTE_a_normal_3f"),r.push(s.normalBuffer)),s.pbrBuffer&&(c.push("HAS_ATTRIBUTE_a_pbr"),c.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),r.push(s.pbrBuffer)),p.alphaMode!=="OPAQUE"&&p.alphaMode!=="MASK"||c.push("UNPREMULT_TEXTURE_IN_SHADER"),p.defined||c.push("DIFFUSE_SHADED"),c.push("USE_STANDARD_DERIVATIVES")}function Su(c,r,s,h,p,y){const w=s.paint.get("model-opacity"),M=r.context,C=new xn(r.context.gl.LEQUAL,xn.ReadWrite,r.depthRangeFor3D),k=r.transform,z=c.mesh,B=z.material,$=B.pbrMetallicRoughness,H=r.style.fog;let K;K=r.transform.projection.zAxisUnit==="pixels"?[...c.nodeModelMatrix]:i.a6.multiply([],h.zScaleMatrix,c.nodeModelMatrix),i.a6.multiply(K,h.negCameraPosMatrix,K);const X=i.a6.invert([],K);i.a6.transpose(X,X);const Q=s.paint.get("model-emissive-strength").constantOr(0),Z=Ih(new Float32Array(c.worldViewProjection),new Float32Array(K),new Float32Array(X),r,w,$.baseColorFactor,B.emissiveFactor,$.metallicFactor,$.roughnessFactor,B,Q,s),ie={defines:[]},he=[];pi(ie.defines,he,z,r);const se=r.shadowRenderer;se&&(se.useNormalOffset=!1);let de=null;if(H){const Se=Dl(c.nodeModelMatrix,r.transform);if(de=new Float32Array(Se),k.projection.name!=="globe"){const Ae=z.aabb.min,Le=z.aabb.max,[et,je]=H.getOpacityForBounds(Se,Ae[0],Ae[1],Le[0],Le[1]);ie.overrideFog=et>=hr||je>=hr}}const ne=tr(r,s.paint.get("model-cutoff-fade-range"));ne.shouldRenderCutoff&&ie.defines.push("RENDER_CUTOFF");const pe=r.getOrCreateProgram("model",ie);r.uploadCommonUniforms(M,pe,null,de,ne),r.renderPass!=="shadow"&&se&&se.setupShadowsFromMatrix(c.nodeModelMatrix,pe),pe.draw(r,M.gl.TRIANGLES,C,p,y,z.material.doubleSided?bn.disabled:bn.backCCW,Z,s.id,z.vertexBuffer,z.indexBuffer,z.segments,s.paint,r.transform.zoom,void 0,he)}function Mu(c,r,s,h,p,y,w){let M;M=c.projection.name==="globe"?i.cS(s,c):[...s],i.a6.multiply(M,M,r.matrix);const C=i.a6.multiply([],h,M);if(r.meshes)for(const k of r.meshes){if(k.material.alphaMode!=="BLEND"){w.push({mesh:k,depth:0,modelIndex:p,worldViewProjection:C,nodeModelMatrix:M});continue}const z=i.N.transformMat4([],k.centroid,C);z[2]>0&&y.push({mesh:k,depth:z[2],modelIndex:p,worldViewProjection:C,nodeModelMatrix:M})}if(r.children)for(const k of r.children)Mu(c,k,s,h,p,y,w)}function Je(c,r,s,h){const p=s.shadowRenderer;if(!p)return;const y=p.getShadowPassDepthMode(),w=p.getShadowPassColorMode(),M=p.calculateShadowPassMatrixFromMatrix(r),C=wu(M);s.getOrCreateProgram("modelDepth",{defines:s._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(s,s.context.gl.TRIANGLES,y,Dn.disabled,w,bn.backCCW,C,h.id,c.vertexBuffer,c.indexBuffer,c.segments,h.paint,s.transform.zoom,void 0,void 0)}function lf(c,r,s){const h=r.updateZoomBasedPaintProperties(),p=function(y,w,M){let C,k,z,B=y.terrain?y.terrain.exaggeration():0;if(y.terrain&&B>0){const $=y.terrain,H=$.findDEMTileFor(M);H&&H.dem?C=i.cU.create($,M,H):B=0}if(B===0&&(w.terrainElevationMin=0,w.terrainElevationMax=0),B===w.validForExaggeration&&(B===0||C&&C._demTile&&C._demTile.tileID===w.validForDEMTile.id&&C._dem._timestamp===w.validForDEMTile.timestamp))return!1;for(const $ in w.instancesPerModel){const H=w.instancesPerModel[$];for(let K=0;K<H.instancedDataArray.length;++K){const X=(C?B*C.getElevationAt(0|H.instancedDataArray.float32[16*K],0|H.instancedDataArray.float32[16*K+1],!0,!0):0)+H.instancesEvaluatedElevation[K];H.instancedDataArray.float32[16*K+6]=X,k=k?Math.min(w.terrainElevationMin,X):X,z=z?Math.max(w.terrainElevationMax,X):X}}return w.terrainElevationMin=k||0,w.terrainElevationMax=z||0,w.validForExaggeration=B,w.validForDEMTile=C&&C._demTile?{id:C._demTile.tileID,timestamp:C._dem._timestamp}:{id:void 0,timestamp:0},!0}(c,r,s);(h||p)&&(r.uploaded=!1,r.upload(c.context))}const is={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new i.bS([0,0,0],[i.V,i.V,0])};function Jp(c,r){const s=1<<c.canonical.z,h=r.getFreeCameraOptions().position,p=r.elevation,y=c.canonical.x/s,w=(c.canonical.x+1)/s,M=c.canonical.y/s,C=(c.canonical.y+1)/s;let k=r._centerAltitude;if(p){const H=p.getMinMaxForTile(c);H&&H.max>k&&(k=H.max)}const z=i.aa(h.x,y,w)-h.x,B=i.aa(h.y,M,C)-h.y,$=i.bl(k,r.center.lat)-h.z;return r._zoomFromMercatorZ(Math.sqrt(z*z+B*B+$*$))}function cf(c,r,s,h,p,y,w){const M=c.context,C=c.renderPass==="shadow",k=c.shadowRenderer,z=C&&k?k.getShadowPassDepthMode():new xn(M.gl.LEQUAL,xn.ReadWrite,c.depthRangeFor3D),B=c.isTileAffectedByFog(y);if(s.meshes)for(const $ of s.meshes){const H=["MODEL_POSITION_ON_GPU"],K=[];let X,Q,Z;h.instancedDataArray.length>20&&H.push("INSTANCED_ARRAYS");const ie=tr(c,r.paint.get("model-cutoff-fade-range"));if(ie.shouldRenderCutoff&&H.push("RENDER_CUTOFF"),C&&k)X=c.getOrCreateProgram("modelDepth",{defines:H}),Q=wu(w.shadowTileMatrix,w.shadowTileMatrix,Float32Array.from(s.matrix)),Z=k.getShadowPassColorMode();else{pi(H,K,$,c),X=c.getOrCreateProgram("model",{defines:H,overrideFog:B});const se=$.material,de=se.pbrMetallicRoughness,ne=r.paint.get("model-opacity"),pe=r.paint.get("model-emissive-strength").constantOr(0);Q=Ih(y.expandedProjMatrix,Float32Array.from(s.matrix),new Float32Array(16),c,ne,de.baseColorFactor,se.emissiveFactor,de.metallicFactor,de.roughnessFactor,se,pe,r,p),k&&(w.shadowUniformsInitialized?X.setShadowUniformValues(M,k.getShadowUniformValues()):(k.setupShadows(y.toUnwrapped(),X,"model-tile",y.overscaledZ),w.shadowUniformsInitialized=!0)),Z=ie.shouldRenderCutoff||ne<1||se.alphaMode!=="OPAQUE"?Yn.alphaBlended:Yn.unblended}c.uploadCommonUniforms(M,X,y.toUnwrapped(),null,ie);const he=$.material.doubleSided?bn.disabled:bn.backCCW;if(h.instancedDataArray.length>20)K.push(h.instancedDataBuffer),X.draw(c,M.gl.TRIANGLES,z,Dn.disabled,Z,he,Q,r.id,$.vertexBuffer,$.indexBuffer,$.segments,r.paint,c.transform.zoom,void 0,K,h.instancedDataArray.length);else{const se=C?"u_instance":"u_normal_matrix";for(let de=0;de<h.instancedDataArray.length;++de)Q[se]=new Float32Array(h.instancedDataArray.arrayBuffer,64*de,16),X.draw(c,M.gl.TRIANGLES,z,Dn.disabled,Z,he,Q,r.id,$.vertexBuffer,$.indexBuffer,$.segments,r.paint,c.transform.zoom,void 0,K)}}if(s.children)for(const $ of s.children)cf(c,r,$,h,p,y,w)}const mc=[1,-1,1];function kg(c,r,s,h){if(!s.modelManager)return!0;const p=s.modelManager;if(!s.shadowRenderer)return!0;const y=s.shadowRenderer,w=r.aabb;let M=!0,C=c.maxHeight;if(C===0){let z=0;for(const B in c.instancesPerModel){const $=p.getModel(B,h);$?z=Math.max(z,Math.max(Math.max($.aabb.max[0],$.aabb.max[1]),$.aabb.max[2])):M=!1}C=c.maxScale*z*1.41+c.maxVerticalOffset,M&&(c.maxHeight=C)}w.max[2]=C,w.min[2]+=c.terrainElevationMin,w.max[2]+=c.terrainElevationMax,i.N.transformMat4(w.min,w.min,r.tileMatrix),i.N.transformMat4(w.max,w.max,r.tileMatrix);const k=w.intersects(y.getCurrentCascadeFrustum());return s.currentShadowCascade===0&&(c.isInsideFirstShadowMapFrustum=k===2),k===0}class Og{}class Qp{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(r,s,h){{const B=this._storage.get(s.id);if(B)return B.lastUsedFrameIdx=r,B.buf}const p=h.gl,y=p.getBufferParameter(p.ELEMENT_ARRAY_BUFFER,p.BUFFER_SIZE),w=new ArrayBuffer(y),M=new Int16Array(w);p.getBufferSubData(p.ELEMENT_ARRAY_BUFFER,0,new Int16Array(w));const C=new i.cW;for(let B=0;B<y/2;B+=3){const $=M[B],H=M[B+1],K=M[B+2];C.emplaceBack($,H),C.emplaceBack(H,K),C.emplaceBack(K,$)}const k=h.bindVertexArrayOES.current,z=new Og;return z.buf=new Hn(h,C),z.lastUsedFrameIdx=r,this._storage.set(s.id,z),h.bindVertexArrayOES.set(k),z.buf}update(r){for(const[s,h]of this._storage)r-h.lastUsedFrameIdx>30&&(h.buf.destroy(),this._storage.delete(s))}destroy(){for(const[r,s]of this._storage)s.buf.destroy(),this._storage.delete(r)}}class Au{registerParameter(r,s,h,p,y){}registerButton(r,s,h){}}const Iu={symbol:function(c,r,s,h,p){if(c.renderPass!=="translucent")return;const y=Dn.disabled,w=c.colorModeForRenderPass();s.layout.get("text-variable-anchor")&&function(k,z,B,$,H,K,X){const Q=z.transform,Z=H==="map",ie=K==="map";for(const he of k){const se=$.getTile(he),de=se.getBucket(B);if(!de||!de.text||!de.text.segments.get().length)continue;const ne=i.b5(de.textSizeData,Q.zoom),pe=bl(he,de.getProjection(),Q),Se=Q.calculatePixelsToTileUnitsMatrix(se),Ae=vl(pe,se.tileID.canonical,ie,Z,Q,de.getProjection(),Se),Le=de.hasIconTextFit()&&de.hasIconData();if(ne){const et=Math.pow(2,Q.zoom-se.tileID.overscaledZ);Wp(de,Z,ie,X,i.cx,Q,Ae,he,et,ne,Le)}}}(h,c,s,r,s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),p);const M=s.paint.get("icon-opacity").constantOr(1)!==0,C=s.paint.get("text-opacity").constantOr(1)!==0;s.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(M||C)?Ch(c,r,s,h,y,w):(M&&Ch(c,r,s,h,y,w,{onlyIcons:!0}),C&&Ch(c,r,s,h,y,w,{onlyText:!0})),r.map.showCollisionBoxes&&(Rs(c,r,s,h,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),!0),Rs(c,r,s,h,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),!1))},circle:function(c,r,s,h){if(c.renderPass!=="translucent")return;const p=s.paint.get("circle-opacity"),y=s.paint.get("circle-stroke-width"),w=s.paint.get("circle-stroke-opacity"),M=s.layout.get("circle-sort-key").constantOr(1)!==void 0,C=s.paint.get("circle-emissive-strength");if(p.constantOr(1)===0&&(y.constantOr(1)===0||w.constantOr(1)===0))return;const k=c.context,z=k.gl,B=c.transform,$=c.depthModeForSublayer(0,xn.ReadOnly),H=Dn.disabled,K=c.colorModeForDrapableLayerRenderPass(C),X=B.projection.name==="globe",Q=[i.a5(B.center.lng),i.ae(B.center.lat)],Z=[];for(let he=0;he<h.length;he++){const se=h[he],de=r.getTile(se),ne=de.getBucket(s);if(!ne||ne.projection.name!==B.projection.name)continue;const pe=ne.programConfigurations.get(s.id),Se=i.cy(s),Ae=c.isTileAffectedByFog(se);X&&Se.push("PROJECTION_GLOBE_VIEW");const Le=c.getOrCreateProgram("circle",{config:pe,defines:Se,overrideFog:Ae}),et=ne.layoutVertexBuffer,je=ne.globeExtVertexBuffer,dt=ne.indexBuffer,at=B.projection.createInversionMatrix(B,se.canonical),At={programConfiguration:pe,program:Le,layoutVertexBuffer:et,globeExtVertexBuffer:je,indexBuffer:dt,uniformValues:i.cz(c,se,de,at,Q,s),tile:de};if(M){const $e=ne.segments.get();for(const ot of $e)Z.push({segments:new i.aB([ot]),sortKey:ot.sortKey,state:At})}else Z.push({segments:ne.segments,sortKey:0,state:At})}M&&Z.sort((he,se)=>he.sortKey-se.sortKey);const ie={useDepthForOcclusion:B.depthOcclusionForSymbolsAndCircles};for(const he of Z){const{programConfiguration:se,program:de,layoutVertexBuffer:ne,globeExtVertexBuffer:pe,indexBuffer:Se,uniformValues:Ae,tile:Le}=he.state,et=he.segments;c.terrain&&c.terrain.setupElevationDraw(Le,de,ie),c.uploadCommonUniforms(k,de,Le.tileID.toUnwrapped()),de.draw(c,z.TRIANGLES,$,H,K,bn.disabled,Ae,s.id,ne,Se,et,s.paint,B.zoom,se,[pe])}},heatmap:function(c,r,s,h){if(s.paint.get("heatmap-opacity")!==0)if(c.renderPass==="offscreen"){const p=c.context,y=p.gl,w=Dn.disabled,M=new Yn([y.ONE,y.ONE,y.ONE,y.ONE],i.ax.transparent,[!0,!0,!0,!0]);(function(H,K,X,Q){const Z=H.gl,ie=K.width*Q,he=K.height*Q;H.activeTexture.set(Z.TEXTURE1),H.viewport.set([0,0,ie,he]);let se=X.heatmapFbo;if(!se||se&&(se.width!==ie||se.height!==he)){se&&se.destroy();const de=Z.createTexture();Z.bindTexture(Z.TEXTURE_2D,de),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_S,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_T,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_MIN_FILTER,Z.LINEAR),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_MAG_FILTER,Z.LINEAR),se=X.heatmapFbo=H.createFramebuffer(ie,he,!0,null),function(ne,pe,Se,Ae,Le,et){const je=ne.gl;je.texImage2D(je.TEXTURE_2D,0,ne.extRenderToTextureHalfFloat?je.RGBA16F:je.RGBA,Le,et,0,je.RGBA,ne.extRenderToTextureHalfFloat?je.HALF_FLOAT:je.UNSIGNED_BYTE,null),Ae.colorAttachment.set(Se)}(H,0,de,se,ie,he)}else Z.bindTexture(Z.TEXTURE_2D,se.colorAttachment.get()),H.bindFramebuffer.set(se.framebuffer)})(p,c,s,c.transform.projection.name==="globe"?.5:.25),p.clear({color:i.ax.transparent});const C=c.transform,k=C.projection.name==="globe",z=k?["PROJECTION_GLOBE_VIEW"]:[],B=k?bn.frontCCW:bn.disabled,$=[i.a5(C.center.lng),i.ae(C.center.lat)];for(let H=0;H<h.length;H++){const K=h[H];if(r.hasRenderableParent(K))continue;const X=r.getTile(K),Q=X.getBucket(s);if(!Q||Q.projection.name!==C.projection.name)continue;const Z=c.isTileAffectedByFog(K),ie=Q.programConfigurations.get(s.id),he=c.getOrCreateProgram("heatmap",{config:ie,defines:z,overrideFog:Z}),{zoom:se}=c.transform;c.terrain&&c.terrain.setupElevationDraw(X,he),c.uploadCommonUniforms(p,he,K.toUnwrapped());const de=C.projection.createInversionMatrix(C,K.canonical);he.draw(c,y.TRIANGLES,xn.disabled,w,M,B,Wd(c,K,X,de,$,se,s.paint.get("heatmap-intensity")),s.id,Q.layoutVertexBuffer,Q.indexBuffer,Q.segments,s.paint,c.transform.zoom,ie,k?[Q.globeExtVertexBuffer]:null)}p.viewport.set([0,0,c.width,c.height])}else c.renderPass==="translucent"&&(c.context.setColorMode(c.colorModeForRenderPass()),function(p,y){const w=p.context,M=w.gl,C=y.heatmapFbo;if(!C)return;w.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,C.colorAttachment.get()),w.activeTexture.set(M.TEXTURE1);let k=y.colorRampTexture;k||(k=y.colorRampTexture=new i.T(w,y.colorRamp,M.RGBA)),k.bind(M.LINEAR,M.CLAMP_TO_EDGE),p.getOrCreateProgram("heatmapTexture").draw(p,M.TRIANGLES,xn.disabled,Dn.disabled,p.colorModeForRenderPass(),bn.disabled,((z,B,$,H)=>({u_image:0,u_color_ramp:1,u_opacity:B.paint.get("heatmap-opacity")}))(0,y),y.id,p.viewportBuffer,p.quadTriangleIndexBuffer,p.viewportSegments,y.paint,p.transform.zoom)}(c,s))},line:function(c,r,s,h){if(c.renderPass!=="translucent")return;const p=s.paint.get("line-opacity"),y=s.paint.get("line-width");if(p.constantOr(1)===0||y.constantOr(1)===0)return;const w=s.paint.get("line-emissive-strength"),M=c.depthModeForSublayer(0,xn.ReadOnly),C=c.colorModeForDrapableLayerRenderPass(w),k=c.terrain&&c.terrain.renderingToTexture?1:i.f.devicePixelRatio,z=s.paint.get("line-dasharray"),B=z.constantOr(1),$=s.layout.get("line-cap"),H=s.paint.get("line-pattern"),K=H.constantOr(1),X=s.paint.get("line-pattern").constantOr(1),Q=s.paint.get("line-opacity").constantOr(1)!==1;let Z=!X&&Q;const ie=s.paint.get("line-gradient"),he=K?"linePattern":"line",se=c.context,de=se.gl,ne=i.cA(s);c.terrain&&c.terrain.clipOrMaskOverlapStencilType()&&(Z=!1);for(const pe of h){const Se=r.getTile(pe);if(K&&!Se.patternsLoaded())continue;const Ae=Se.getBucket(s);if(!Ae)continue;c.prepareDrawTile();const Le=Ae.programConfigurations.get(s.id),et=c.isTileAffectedByFog(pe),je=c.getOrCreateProgram(he,{config:Le,defines:ne,overrideFog:et}),dt=H.constantOr(null);if(dt&&Se.imageAtlas){const Bt=Se.imageAtlas.patternPositions[dt.toString()];Bt&&Le.setConstantPatternPositions(Bt)}const at=z.constantOr(null),At=$.constantOr(null);if(!K&&at&&At&&Se.lineAtlas){const Bt=Se.lineAtlas.getDash(at,At);Bt&&Le.setConstantPatternPositions(Bt)}let[$e,ot]=s.paint.get("line-trim-offset");(At==="round"||At==="square")&&$e!==ot&&($e===0&&($e-=1),ot===1&&(ot+=1));const ke=c.terrain?pe.projMatrix:null,Ze=K?i.cB(c,Se,s,ke,k,[$e,ot]):i.cC(c,Se,s,ke,Ae.lineClipsArray.length,k,[$e,ot]);if(ie){const Bt=Ae.gradients[s.id];let Ft=Bt.texture;if(s.gradientVersion!==Bt.version){let Xt=256;if(s.stepInterpolant){const un=r.getSource().maxzoom,vn=pe.canonical.z===un?Math.ceil(1<<c.transform.maxZoom-pe.canonical.z):1;Xt=i.aa(i.cD(Ae.maxLineLength/i.V*1024*vn),256,se.maxTextureSize)}Bt.gradient=i.cE({expression:s.gradientExpression(),evaluationKey:"lineProgress",resolution:Xt,image:Bt.gradient||void 0,clips:Ae.lineClipsArray}),Bt.texture?Bt.texture.update(Bt.gradient):Bt.texture=new i.T(se,Bt.gradient,de.RGBA),Bt.version=s.gradientVersion,Ft=Bt.texture}se.activeTexture.set(de.TEXTURE1),Ft.bind(s.stepInterpolant?de.NEAREST:de.LINEAR,de.CLAMP_TO_EDGE)}B&&(se.activeTexture.set(de.TEXTURE0),Se.lineAtlasTexture&&Se.lineAtlasTexture.bind(de.LINEAR,de.REPEAT),Le.updatePaintBuffers()),K&&(se.activeTexture.set(de.TEXTURE0),Se.imageAtlasTexture&&Se.imageAtlasTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE),Le.updatePaintBuffers()),c.uploadCommonUniforms(se,je,pe.toUnwrapped());const Pt=Bt=>{je.draw(c,de.TRIANGLES,M,Bt,C,bn.disabled,Ze,s.id,Ae.layoutVertexBuffer,Ae.indexBuffer,Ae.segments,s.paint,c.transform.zoom,Le,[Ae.layoutVertexBuffer2])};if(Z){const Bt=c.stencilModeForClipping(pe).ref;Bt===0&&c.terrain&&se.clear({stencil:0});const Ft={func:de.EQUAL,mask:255};Ze.u_alpha_discard_threshold=.8,Pt(new Dn(Ft,Bt,255,de.KEEP,de.KEEP,de.INVERT)),Ze.u_alpha_discard_threshold=0,Pt(new Dn(Ft,Bt,255,de.KEEP,de.KEEP,de.KEEP))}else Pt(c.stencilModeForClipping(pe))}Z&&(c.resetStencilClippingMasks(),c.terrain&&se.clear({stencil:0}))},fill:function(c,r,s,h){const p=s.paint.get("fill-color"),y=s.paint.get("fill-opacity");if(y.constantOr(1)===0)return;const w=s.paint.get("fill-emissive-strength"),M=c.colorModeForDrapableLayerRenderPass(w),C=s.paint.get("fill-pattern"),k=c.opaquePassEnabledForLayer()&&!C.constantOr(1)&&p.constantOr(i.ax.transparent).a===1&&y.constantOr(0)===1?"opaque":"translucent";if(c.renderPass===k){const z=c.depthModeForSublayer(1,c.renderPass==="opaque"?xn.ReadWrite:xn.ReadOnly);Cl(c,r,s,h,z,M,!1)}if(c.renderPass==="translucent"&&s.paint.get("fill-antialias")){const z=c.depthModeForSublayer(s.getPaintProperty("fill-outline-color")?2:0,xn.ReadOnly);Cl(c,r,s,h,z,M,!0)}},"fill-extrusion":function(c,r,s,h){const p=s.paint.get("fill-extrusion-opacity"),y=c.context,w=y.gl,M=c.terrain,C=M&&M.renderingToTexture;if(p===0)return;const k=c.conflationActive&&c.layerUsedInConflation(s,r.getSource());if(k&&function(z,B,$,H){for(const K of H){const X=B.getTile(K).getBucket($);X&&(X.updateReplacement(K,z.replacementSource),X.uploadCentroid(z.context))}}(c,r,s,h),M||k)for(const z of h){const B=r.getTile(z).getBucket(s);B&&Cg(c.context,r,z,B,s,M,k)}if(c.renderPass==="shadow"&&c.shadowRenderer){const z=c.shadowRenderer;if(M&&p<.65&&s._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof i.Z)return;const B=z.getShadowPassDepthMode(),$=z.getShadowPassColorMode();hn(c,r,s,h,B,Dn.disabled,$,k)}else if(c.renderPass==="translucent"){const z=!s.paint.get("fill-extrusion-pattern").constantOr(1),B=s.paint.get("fill-extrusion-color").constantOr(i.ax.white);if(!C&&B.a!==0){const $=new xn(c.context.gl.LEQUAL,xn.ReadWrite,c.depthRangeFor3D);p===1&&z?hn(c,r,s,h,$,Dn.disabled,Yn.unblended,k):(hn(c,r,s,h,$,Dn.disabled,Yn.disabled,k),hn(c,r,s,h,$,c.stencilModeFor3D(),c.colorModeForRenderPass(),k),c.resetStencilClippingMasks())}if(c.style.enable3dLights()&&z&&(!M&&c.transform.projection.name!=="globe"||C)){const $=s.paint.get("fill-extrusion-opacity"),H=s.paint.get("fill-extrusion-ambient-occlusion-intensity"),K=s.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),X=s.paint.get("fill-extrusion-flood-light-intensity"),Q=s.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),Z=H>0&&K>0,ie=X>0,he=(de,ne,pe)=>(1-pe)*de+pe*ne,se=de=>{const ne=c.depthModeForSublayer(1,xn.ReadOnly,w.LEQUAL,!0),pe=s.paint.get(de?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Se=he(.1,3,pe),Ae=c._showOverdrawInspector;if(!Ae){const Le=new Dn({func:w.ALWAYS,mask:255},255,255,w.KEEP,w.KEEP,w.REPLACE),et=new Yn([w.ONE,w.ONE,w.ONE,w.ONE],i.ax.transparent,[!1,!1,!1,!0],w.MIN);Ja(c,r,s,h,ne,Le,et,bn.disabled,de,"sdf",$,H,K,X,Q,Se,k,!1)}{const Le=Ae?Dn.disabled:new Dn({func:w.EQUAL,mask:255},255,255,w.KEEP,w.DECR,w.DECR),et=Ae?c.colorModeForRenderPass():new Yn([w.ONE_MINUS_DST_ALPHA,w.DST_ALPHA,w.ONE,w.ONE],i.ax.transparent,[!0,!0,!0,!0]);Ja(c,r,s,h,ne,Le,et,bn.disabled,de,"color",$,H,K,X,Q,Se,k,!1)}};if(C){const de=(ne,pe,Se)=>{const Ae=c.depthModeForSublayer(1,xn.ReadOnly,w.LEQUAL,!1),Le=s.paint.get(ne?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),et=he(.1,3,Le);{const je=new Yn([w.ONE,w.ONE,w.ONE,w.ONE],i.ax.transparent,[!1,!1,!1,!0]);Ja(c,r,s,h,Ae,Dn.disabled,je,bn.disabled,ne,"clear",$,H,K,X,Q,et,k,pe)}{const je=new Dn({func:w.ALWAYS,mask:255},255,255,w.KEEP,w.KEEP,w.REPLACE),dt=new Yn([w.ONE,w.ONE,w.ONE,w.ONE],i.ax.transparent,[!1,!1,!1,!0],w.MIN);Ja(c,r,s,h,Ae,je,dt,bn.disabled,ne,"sdf",$,H,K,X,Q,et,k,pe)}{const je=ne?w.ZERO:w.ONE_MINUS_DST_ALPHA,dt=new Dn({func:w.EQUAL,mask:255},255,255,w.KEEP,w.DECR,w.DECR),at=new Yn([je,w.DST_ALPHA,w.ONE_MINUS_DST_ALPHA,w.ZERO],i.ax.transparent,[!0,!0,!0,!0]);Ja(c,r,s,h,Ae,dt,at,bn.disabled,ne,"color",$,H,K,X,Q,et,k,pe)}{const je=new Yn([w.ONE,w.ONE,w.ONE,ne?w.ZERO:w.ONE],i.ax.transparent,[!1,!1,!1,!0],ne?w.FUNC_ADD:w.MAX);Ja(c,r,s,h,Ae,Dn.disabled,je,bn.disabled,ne,"clear",$,H,K,X,Q,et,k,pe,Se)}};if(Z||ie){let ne;if(c.prepareDrawTile(),M){const pe=M.drapeBufferSize[0],Se=M.drapeBufferSize[1];ne=M.framebufferCopyTexture,ne&&(!ne||ne.size[0]===pe&&ne.size[1]===Se)||(ne&&ne.destroy(),ne=M.framebufferCopyTexture=new i.T(y,new i.h({width:pe,height:Se}),w.RGBA)),ne.bind(w.LINEAR,w.CLAMP_TO_EDGE),w.copyTexImage2D(w.TEXTURE_2D,0,w.RGBA,0,0,pe,Se,0)}Z&&de(!0,!1,ne),ie&&de(!1,!0,ne)}}else Z&&se(!0),ie&&se(!1)}}},hillshade:function(c,r,s,h){if(c.renderPass!=="offscreen"&&c.renderPass!=="translucent"||c.style.disableElevatedTerrain)return;const p=c.context,y=c.terrain&&c.terrain.renderingToTexture,[w,M]=c.renderPass!=="translucent"||y?[{},h]:c.stencilConfigForOverlap(h);for(const C of M){const k=r.getTile(C);if(k.needsHillshadePrepare&&c.renderPass==="offscreen")gu(c,k,s);else if(c.renderPass==="translucent"){const z=c.depthModeForSublayer(0,xn.ReadOnly),B=s.paint.get("hillshade-emissive-strength"),$=c.colorModeForDrapableLayerRenderPass(B),H=y&&c.terrain?c.terrain.stencilModeForRTTOverlap(C):w[C.overscaledZ];El(c,C,k,s,z,H,$)}}p.viewport.set([0,0,c.width,c.height]),c.resetStencilClippingMasks()},raster:function(c,r,s,h,p,y){if(c.renderPass!=="translucent"||s.paint.get("raster-opacity")===0)return;const w=c.transform.projection.name==="globe",M=s.paint.get("raster-elevation")!==0,C=M&&w;if(c.renderElevatedRasterBackface&&!C)return;const k=c.context,z=k.gl,B=r.getSource(),$=function(ne,pe,Se,Ae){const Le=pe.paint.get("raster-color"),et=ne.type==="raster-array",je=[],dt=pe.paint.get("raster-resampling"),at=pe.paint.get("raster-color-mix");let At=pe.paint.get("raster-color-range");const $e=[at[0],at[1],at[2],0],ot=at[3];let ke=dt==="nearest"?Ae.NEAREST:Ae.LINEAR;if(et&&(je.push("RASTER_ARRAY"),Le||je.push("RASTER_COLOR"),dt==="linear"&&je.push("RASTER_ARRAY_LINEAR"),ke=Ae.NEAREST,!At&&ne.rasterLayers)){const Ze=ne.rasterLayers.find(({id:Pt})=>Pt===pe.sourceLayer);Ze&&Ze.fields&&Ze.fields.range&&(At=Ze.fields.range)}if(At=At||[0,1],Le){je.push("RASTER_COLOR"),Se.activeTexture.set(Ae.TEXTURE2),pe.updateColorRamp(At);let Ze=pe.colorRampTexture;Ze||(Ze=pe.colorRampTexture=new i.T(Se,pe.colorRamp,Ae.RGBA)),Ze.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE)}return{mix:$e,range:At,offset:ot,defines:je,resampling:ke}}(B,s,k,z);if(B instanceof i.ap&&!h.length&&!w)return;const H=s.paint.get("raster-emissive-strength"),K=c.colorModeForDrapableLayerRenderPass(H),X=c.terrain&&c.terrain.renderingToTexture,Q=!c.options.moving,Z=s.paint.get("raster-resampling")==="nearest"?z.NEAREST:z.LINEAR;if(B instanceof i.ap&&!h.length&&(B.onNorthPole||B.onSouthPole)){const ne=M?c.stencilModeFor3D():Dn.disabled;return void Kd(!!B.onNorthPole,null,c,r,s,H,$,bn.disabled,ne)}if(!h.length)return;const[ie,he]=B instanceof i.ap||X?[{},h]:c.stencilConfigForOverlap(h),se=he[he.length-1].overscaledZ;C&&$.defines.push("PROJECTION_GLOBE_VIEW"),M&&$.defines.push("RENDER_CUTOFF");const de=(ne,pe,Se)=>{for(const Ae of ne){const Le=Ae.toUnwrapped(),et=r.getTile(Ae);if(X&&(!et||!et.hasData()))continue;k.activeTexture.set(z.TEXTURE0);const je=Qd(et,B,s,$);if(!je||!je.texture)continue;const{texture:dt,mix:at,offset:At,tileSize:$e,buffer:ot}=je;let ke,Ze;X?(ke=xn.disabled,Ze=Ae.projMatrix):M?(ke=new xn(z.LEQUAL,xn.ReadWrite,c.depthRangeFor3D),Ze=w?Float32Array.from(c.transform.expandedFarZProjMatrix):c.transform.calculateProjMatrix(Le,Q)):(ke=c.depthModeForSublayer(Ae.overscaledZ-se,s.paint.get("raster-opacity")===1?xn.ReadWrite:xn.ReadOnly,z.LESS),Ze=c.transform.calculateProjMatrix(Le,Q));const Pt=c.terrain&&X?c.terrain.stencilModeForRTTOverlap(Ae):ie[Ae.overscaledZ],Bt=y?0:s.paint.get("raster-fade-duration");et.registerFadeDuration(Bt);const Ft=r.findLoadedParent(Ae,0),Xt=dc(et,Ft,r,c.transform,Bt);let un,vn;c.terrain&&c.terrain.prepareDrawTile(),k.activeTexture.set(z.TEXTURE0),dt.bind(Z,z.CLAMP_TO_EDGE),k.activeTexture.set(z.TEXTURE1),Ft?(Ft.texture&&Ft.texture.bind(Z,z.CLAMP_TO_EDGE),un=Math.pow(2,Ft.tileID.overscaledZ-et.tileID.overscaledZ),vn=[et.tileID.canonical.x*un%1,et.tileID.canonical.y*un%1]):dt.bind(Z,z.CLAMP_TO_EDGE),dt.useMipmap&&k.extTextureFilterAnisotropic&&c.transform.pitch>20&&z.texParameterf(z.TEXTURE_2D,k.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,k.extTextureFilterAnisotropicMax);const pn=c.transform;let gn;const qn=M?Jd(pn):[0,0,0,0];let kn,Nn,Fn,_r,Zr,ir=0;if(C&&B instanceof i.ap&&B.coordinates.length>3)kn=Float32Array.from(i.aT(i.ci(new i.bs(0,0,0)))),Nn=Float32Array.from(pn.globeMatrix),Fn=Float32Array.from(i.ce(pn)),_r=[i.a5(pn.center.lng),i.ae(pn.center.lat)],gn=B.elevatedGlobePerspectiveTransform,Zr=B.elevatedGlobeGridMatrix||new Float32Array(9);else if(C){const sr=i.cf(Ae.canonical);ir=i.cg(sr.getCenter().lat),kn=Float32Array.from(i.aT(i.ci(Ae.canonical))),Nn=Float32Array.from(pn.globeMatrix),Fn=Float32Array.from(i.ce(pn)),_r=[i.a5(pn.center.lng),i.ae(pn.center.lat)],gn=[0,0],Zr=Float32Array.from(i.ch(Ae.canonical,sr,ir,pn.worldSize/pn._pixelsPerMercatorPixel))}else gn=B instanceof i.ap?B.perspectiveTransform:[0,0],kn=new Float32Array(16),Nn=new Float32Array(9),Fn=new Float32Array(16),_r=[0,0],Zr=new Float32Array(9);const mi=Zd(Ze,kn,Nn,Fn,Zr,vn||[0,0],i.S(c.transform.zoom),_r,qn,un||1,Xt,s,gn,M?s.paint.get("raster-elevation"):0,2,at,At,$.range,$e,ot,H),or=c.isTileAffectedByFog(Ae),Ar=c.getOrCreateProgram("raster",{defines:$.defines,overrideFog:or});if(c.uploadCommonUniforms(k,Ar,Le),B instanceof i.ap){const sr=B.elevatedGlobeVertexBuffer,Sr=B.elevatedGlobeIndexBuffer;if(X||!w)B.boundsBuffer&&B.boundsSegments&&Ar.draw(c,z.TRIANGLES,ke,Dn.disabled,K,bn.disabled,mi,s.id,B.boundsBuffer,c.quadTriangleIndexBuffer,B.boundsSegments);else if(sr&&Sr){const Qr=pn.zoom<=i.bG?B.elevatedGlobeSegments:B.getSegmentsForLongitude(pn.center.lng);Qr&&Ar.draw(c,z.TRIANGLES,ke,Dn.disabled,K,pe,mi,s.id,sr,Sr,Qr)}}else if(C){ke=new xn(z.LEQUAL,xn.ReadOnly,c.depthRangeFor3D);const sr=c.globeSharedBuffers;if(sr){const[Sr,Qr,Lr]=sr.getGridBuffers(ir,!1);Ar.draw(c,z.TRIANGLES,ke,Se||Pt,c.colorModeForRenderPass(),pe,mi,s.id,Sr,Qr,Lr)}}else{const{tileBoundsBuffer:sr,tileBoundsIndexBuffer:Sr,tileBoundsSegments:Qr}=c.getTileBoundsBuffers(et);Ar.draw(c,z.TRIANGLES,ke,Pt,K,bn.disabled,mi,s.id,sr,Sr,Qr)}}if(!(B instanceof i.ap)&&C)for(const Ae of ne){const Le=Ae.canonical.y===(1<<Ae.canonical.z)-1;Ae.canonical.y===0&&Kd(!0,Ae,c,r,s,H,$,pe,Se||Dn.disabled),Le&&Kd(!1,Ae,c,r,s,H,$,pe===bn.frontCW?bn.backCW:bn.frontCW,Se||Dn.disabled)}};C?de(he,c.renderElevatedRasterBackface?bn.backCW:bn.frontCW,c.stencilModeFor3D()):de(he,bn.disabled,void 0),c.resetStencilClippingMasks()},"raster-particle":function(c,r,s,h,p,y){c.renderPass==="offscreen"&&function(w,M,C,k){if(!k.length)return;const z=w.context,B=z.gl,$=M.getSource();if(!($ instanceof Xe))return;const H=[];for(const Q of k){const Z=M.getTile(Q);if(!(Z instanceof pa))continue;const ie=ef(Z,$,C);if(!ie)continue;const he=[ie.tileSize,ie.tileSize];let se=C.tileFramebuffer;se||(se=C.tileFramebuffer=z.createFramebuffer(he[0],he[1],!0,null));let de=Z.rasterParticleState;const ne=C.paint.get("raster-particle-count");de||(de=Z.rasterParticleState=new Fi(z,Q,he,ne));const pe=de.update(C.lastInvalidatedAt);de.numParticles!==ne&&de.setNumParticles(Q,ne);const Se=de.targetColorTexture;de.targetColorTexture=de.backgroundColorTexture,de.backgroundColorTexture=Se;const Ae=de.particleVertices0;de.particleVertices0=de.particleVertices1,de.particleVertices1=Ae,H.push([Q,ie,de,pe])}if(H.length===0)return;const K=i.f.now(),X=C.previousDrawTimestamp?.001*(K-C.previousDrawTimestamp):.0167;if(C.previousDrawTimestamp=K,C.hasColorMap()){z.activeTexture.set(B.TEXTURE0+2);let Q=C.colorRampTexture;Q||(Q=C.colorRampTexture=new i.T(z,C.colorRamp,B.RGBA)),Q.bind(B.LINEAR,B.CLAMP_TO_EDGE)}z.bindFramebuffer.set(C.tileFramebuffer.framebuffer),z.activeTexture.set(B.TEXTURE0),function(Q,Z,ie){const he=Q.context,se=he.gl,de=Z.tileFramebuffer;he.activeTexture.set(se.TEXTURE0);const ne={u_texture:0,u_opacity:1.05*(Se=Z.paint.get("raster-particle-fade-opacity-factor"))/(Se+.05)},pe=Q.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var Se;for(const Ae of ie){const[,,Le,et]=Ae;de.colorAttachment.set(Le.targetColorTexture.texture),he.viewport.set([0,0,de.width,de.height]),he.clear({color:i.ax.transparent}),et&&(Le.backgroundColorTexture.bind(se.NEAREST,se.CLAMP_TO_EDGE),pe.draw(Q,se.TRIANGLES,xn.disabled,Dn.disabled,Yn.alphaBlended,bn.disabled,ne,Z.id,Q.viewportBuffer,Q.quadTriangleIndexBuffer,Q.viewportSegments))}}(w,C,H),function(Q,Z,ie,he){const se=Q.context.gl,de=ie.tileFramebuffer,ne=Q.transform.projection.name==="globe",pe=ie.paint.get("raster-particle-max-speed");for(const Se of he){const[Ae,Le,et]=Se;Le.texture.bind(se.LINEAR,se.CLAMP_TO_EDGE),de.colorAttachment.set(et.targetColorTexture.texture);const je=Q.getOrCreateProgram("rasterParticleDraw",{defines:Le.defines,overrideFog:!1}),dt=Le.scalarData?[]:[0,1,2,3].map($e=>i.cG[$e](Ae));dt.push(Ae);const at=Ae.canonical.x,At=Ae.canonical.y;for(const $e of dt){const ot=Z.getTile(ne?$e.wrapped():$e);if(!ot)continue;const ke=ot.rasterParticleState;if(!ke)continue;const Ze=Ag([$e.canonical.x+(1<<$e.canonical.z)*($e.wrap-Ae.wrap)-at,$e.canonical.y-At],0,Le.texture.size,2,pe,Le.textureOffset,Le.scale,Le.offset);je.draw(Q,se.POINTS,xn.disabled,Dn.disabled,Yn.alphaBlended,bn.disabled,Ze,ie.id,ke.particleVertices0,void 0,ke.particleSegment)}}}(w,M,C,H),function(Q,Z,ie,he){const se=Q.context.gl;let de=Z.transformFeedbackObject;de||(de=Z.transformFeedbackObject=se.createTransformFeedback()),se.bindTransformFeedback(se.TRANSFORM_FEEDBACK,Z.transformFeedbackObject);const ne=Z.paint.get("raster-particle-max-speed"),pe=he*Z.paint.get("raster-particle-speed-factor")*.3,Se=(Ae=Z.paint.get("raster-particle-reset-rate-factor"),Math.pow(Ae,6));var Ae;for(const Le of ie){const[,et,je]=Le;et.texture.bind(se.LINEAR,se.CLAMP_TO_EDGE);const dt=Hp(0,et.texture.size,ne,pe,Se,et.textureOffset,et.scale,et.offset);Q.getOrCreateProgram("rasterParticleUpdate",{defines:et.defines,transformFeedback:{bufferMode:se.SEPARATE_ATTRIBS,shaderVaryings:["v_new_particle"]}}).draw(Q,se.POINTS,xn.disabled,Dn.disabled,Yn.disabled,bn.disabled,dt,Z.id,je.particleVertices0,void 0,je.particleSegment,{},void 0,void 0,void 0,void 0,[{buffer:je.particleVertices1,targetIndex:0}])}se.bindTransformFeedback(se.TRANSFORM_FEEDBACK,null)}(w,C,H,X)}(c,r,s,h),c.renderPass==="translucent"&&(function(w,M,C,k,z){const B=w.context,$=B.gl,H=!w.options.moving,K=w.transform.projection.name==="globe";if(!k.length)return;const[X,Q]=w.stencilConfigForOverlap(k),Z=[];K&&Z.push("PROJECTION_GLOBE_VIEW");for(const ie of Q){const he=ie.toUnwrapped(),se=M.getTile(ie);if(!se.rasterParticleState)continue;const de=se.rasterParticleState,ne=100;se.registerFadeDuration(ne);const pe=M.findLoadedParent(ie,0),Se=dc(se,pe,M,w.transform,ne);let Ae,Le;w.terrain&&w.terrain.prepareDrawTile(),B.activeTexture.set($.TEXTURE0),de.targetColorTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),B.activeTexture.set($.TEXTURE1),pe&&pe.rasterParticleState?(pe.rasterParticleState.targetColorTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),Ae=Math.pow(2,pe.tileID.overscaledZ-se.tileID.overscaledZ),Le=[se.tileID.canonical.x*Ae%1,se.tileID.canonical.y*Ae%1]):de.targetColorTexture.bind($.LINEAR,$.CLAMP_TO_EDGE);const et=K?Float32Array.from(w.transform.expandedFarZProjMatrix):w.transform.calculateProjMatrix(he,H),je=w.transform,dt=tf(je),at=i.cf(ie.canonical),At=i.cg(at.getCenter().lat);let $e,ot,ke,Ze,Pt;K?($e=Float32Array.from(i.aT(i.ci(ie.canonical))),ot=Float32Array.from(je.globeMatrix),ke=Float32Array.from(i.ce(je)),Ze=[i.a5(je.center.lng),i.ae(je.center.lat)],Pt=Float32Array.from(i.ch(ie.canonical,at,At,je.worldSize/je._pixelsPerMercatorPixel))):($e=new Float32Array(16),ot=new Float32Array(9),ke=new Float32Array(16),Ze=[0,0],Pt=new Float32Array(9));const Bt=Mg(et,$e,ot,ke,Pt,Le||[0,0],i.S(w.transform.zoom),Ze,dt,Ae||1,Se,250),Ft=w.isTileAffectedByFog(ie),Xt=w.getOrCreateProgram("rasterParticle",{defines:Z,overrideFog:Ft});if(w.uploadCommonUniforms(B,Xt,he),K){const un=new xn($.LEQUAL,xn.ReadWrite,w.depthRangeFor3D),vn=0,pn=w.globeSharedBuffers;if(pn){const[gn,qn,kn]=pn.getGridBuffers(At,vn!==0);Xt.draw(w,$.TRIANGLES,un,Dn.disabled,Yn.alphaBlended,bn.backCCW,Bt,C.id,gn,qn,kn)}}else{const un=w.depthModeForSublayer(0,xn.ReadOnly),vn=X[ie.overscaledZ],{tileBoundsBuffer:pn,tileBoundsIndexBuffer:gn,tileBoundsSegments:qn}=w.getTileBoundsBuffers(se);Xt.draw(w,$.TRIANGLES,un,vn,Yn.alphaBlended,bn.disabled,Bt,C.id,pn,gn,qn)}}w.resetStencilClippingMasks()}(c,r,s,h),c.style.map.triggerRepaint())},background:function(c,r,s,h){const p=s.paint.get("background-color"),y=s.paint.get("background-opacity"),w=s.paint.get("background-emissive-strength");if(y===0)return;const M=c.context,C=M.gl,k=c.transform,z=k.tileSize,B=s.paint.get("background-pattern");if(c.isPatternMissing(B,s.scope))return;const $=!B&&p.a===1&&y===1&&c.opaquePassEnabledForLayer()?"opaque":"translucent";if(c.renderPass!==$)return;const H=Dn.disabled,K=c.depthModeForSublayer(0,$==="opaque"?xn.ReadWrite:xn.ReadOnly),X=c.colorModeForDrapableLayerRenderPass(w),Q=B?"backgroundPattern":"background";let Z,ie=h;ie||(Z=c.getBackgroundTiles(),ie=Object.values(Z).map(he=>he.tileID)),B&&(M.activeTexture.set(C.TEXTURE0),c.imageManager.bind(c.context,s.scope));for(const he of ie){const se=c.isTileAffectedByFog(he),de=c.getOrCreateProgram(Q,{overrideFog:se}),ne=he.toUnwrapped(),pe=h?he.projMatrix:c.transform.calculateProjMatrix(ne);c.prepareDrawTile();const Se=r?r.getTile(he):Z?Z[he.key]:new Zs(he,z,k.zoom,c),Ae=B?xu(pe,w,y,c,B,s.scope,{tileID:he,tileSize:z}):Yd(pe,w,y,p);c.uploadCommonUniforms(M,de,ne);const{tileBoundsBuffer:Le,tileBoundsIndexBuffer:et,tileBoundsSegments:je}=c.getTileBoundsBuffers(Se);de.draw(c,C.TRIANGLES,K,H,X,bn.disabled,Ae,s.id,Le,et,je)}},sky:function(c,r,s){const h=c._atmosphere?i.S(c.transform.zoom):1,p=s.paint.get("sky-opacity")*h;if(p===0)return;const y=c.context,w=s.paint.get("sky-type"),M=new xn(y.gl.LEQUAL,xn.ReadOnly,[0,1]),C=c.frameCounter/1e3%1;w==="atmosphere"?c.renderPass==="offscreen"?s.needsSkyboxCapture(c)&&(function(k,z,B,$){const H=k.context,K=H.gl;let X=z.skyboxFbo;if(!X){X=z.skyboxFbo=H.createFramebuffer(32,32,!0,null),z.skyboxGeometry=new af(H),z.skyboxTexture=H.gl.createTexture(),K.bindTexture(K.TEXTURE_CUBE_MAP,z.skyboxTexture),K.texParameteri(K.TEXTURE_CUBE_MAP,K.TEXTURE_WRAP_S,K.CLAMP_TO_EDGE),K.texParameteri(K.TEXTURE_CUBE_MAP,K.TEXTURE_WRAP_T,K.CLAMP_TO_EDGE),K.texParameteri(K.TEXTURE_CUBE_MAP,K.TEXTURE_MIN_FILTER,K.LINEAR),K.texParameteri(K.TEXTURE_CUBE_MAP,K.TEXTURE_MAG_FILTER,K.LINEAR);for(let he=0;he<6;++he)K.texImage2D(K.TEXTURE_CUBE_MAP_POSITIVE_X+he,0,K.RGBA,32,32,0,K.RGBA,K.UNSIGNED_BYTE,null)}H.bindFramebuffer.set(X.framebuffer),H.viewport.set([0,0,32,32]);const Q=z.getCenter(k,!0),Z=k.getOrCreateProgram("skyboxCapture"),ie=new Float64Array(16);i.a6.identity(ie),i.a6.rotateY(ie,ie,.5*-Math.PI),Pl(k,z,Z,ie,Q,0),i.a6.identity(ie),i.a6.rotateY(ie,ie,.5*Math.PI),Pl(k,z,Z,ie,Q,1),i.a6.identity(ie),i.a6.rotateX(ie,ie,.5*-Math.PI),Pl(k,z,Z,ie,Q,2),i.a6.identity(ie),i.a6.rotateX(ie,ie,.5*Math.PI),Pl(k,z,Z,ie,Q,3),i.a6.identity(ie),Pl(k,z,Z,ie,Q,4),i.a6.identity(ie),i.a6.rotateY(ie,ie,Math.PI),Pl(k,z,Z,ie,Q,5),H.viewport.set([0,0,k.width,k.height])}(c,s),s.markSkyboxValid(c)):c.renderPass==="sky"&&function(k,z,B,$,H){const K=k.context,X=K.gl,Q=k.transform,Z=k.getOrCreateProgram("skybox");K.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_CUBE_MAP,z.skyboxTexture);const ie=((he,se,de,ne,pe)=>({u_matrix:he,u_sun_direction:se,u_cubemap:0,u_opacity:ne,u_temporal_offset:pe}))(Q.skyboxMatrix,z.getCenter(k,!1),0,$,H);k.uploadCommonUniforms(K,Z),Z.draw(k,X.TRIANGLES,B,Dn.disabled,k.colorModeForRenderPass(),bn.backCW,ie,"skybox",z.skyboxGeometry.vertexBuffer,z.skyboxGeometry.indexBuffer,z.skyboxGeometry.segment)}(c,s,M,p,C):w==="gradient"&&c.renderPass==="sky"&&function(k,z,B,$,H){const K=k.context,X=K.gl,Q=k.transform,Z=k.getOrCreateProgram("skyboxGradient");z.skyboxGeometry||(z.skyboxGeometry=new af(K)),K.activeTexture.set(X.TEXTURE0);let ie=z.colorRampTexture;ie||(ie=z.colorRampTexture=new i.T(K,z.colorRamp,X.RGBA)),ie.bind(X.LINEAR,X.CLAMP_TO_EDGE);const he=((se,de,ne,pe,Se)=>({u_matrix:se,u_color_ramp:0,u_center_direction:de,u_radius:i.bj(ne),u_opacity:pe,u_temporal_offset:Se}))(Q.skyboxMatrix,z.getCenter(k,!1),z.paint.get("sky-gradient-radius"),$,H);k.uploadCommonUniforms(K,Z),Z.draw(k,X.TRIANGLES,B,Dn.disabled,k.colorModeForRenderPass(),bn.backCW,he,"skyboxGradient",z.skyboxGeometry.vertexBuffer,z.skyboxGeometry.indexBuffer,z.skyboxGeometry.segment)}(c,s,M,p,C)},debug:function(c,r,s,h,p,y){for(let w=0;w<s.length;w++)if(p){const k=new i.ax(h.r*.8,h.g*.8,h.b*.8,1);el(c,r,s[w],h,-1,-1,y),el(c,r,s[w],h,-1,1,y),el(c,r,s[w],h,1,1,y),el(c,r,s[w],h,1,-1,y),el(c,r,s[w],k,0,0,y)}else el(c,r,s[w],h,0,0,y)},custom:function(c,r,s,h){const p=c.context,y=s.implementation;if(!c.transform.projection.unsupportedLayers||!c.transform.projection.unsupportedLayers.includes("custom")||c.terrain&&(c.terrain.renderingToTexture||c.renderPass==="offscreen")&&s.isLayerDraped(r)){if(c.renderPass==="offscreen"){const w=y.prerender;if(w){if(c.setCustomLayerDefaults(),p.setColorMode(c.colorModeForRenderPass()),c.transform.projection.name==="globe"){const M=c.transform.pointMerc;w.call(y,p.gl,c.transform.customLayerMatrix(),c.transform.getProjection(),c.transform.globeToMercatorMatrix(),i.S(c.transform.zoom),[M.x,M.y],c.transform.pixelsPerMeterRatio)}else w.call(y,p.gl,c.transform.customLayerMatrix());p.setDirty(),c.setBaseState()}}else if(c.renderPass==="translucent"){if(c.terrain&&c.terrain.renderingToTexture){const M=y.renderToTile;if(M){const C=h[0].canonical,k=new i.L(C.x+h[0].wrap*(1<<C.z),C.y,C.z);p.setDepthMode(xn.disabled),p.setStencilMode(Dn.disabled),p.setColorMode(c.colorModeForRenderPass()),c.setCustomLayerDefaults(),M.call(y,p.gl,k),p.setDirty(),c.setBaseState()}return}c.setCustomLayerDefaults(),p.setColorMode(c.colorModeForRenderPass()),p.setStencilMode(Dn.disabled);const w=y.renderingMode==="3d"?new xn(c.context.gl.LEQUAL,xn.ReadWrite,c.depthRangeFor3D):c.depthModeForSublayer(0,xn.ReadOnly);if(p.setDepthMode(w),c.transform.projection.name==="globe"){const M=c.transform.pointMerc;y.render(p.gl,c.transform.customLayerMatrix(),c.transform.getProjection(),c.transform.globeToMercatorMatrix(),i.S(c.transform.zoom),[M.x,M.y],c.transform.pixelsPerMeterRatio)}else y.render(p.gl,c.transform.customLayerMatrix());p.setDirty(),c.setBaseState(),p.bindFramebuffer.set(null)}}else i.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(c,r,s,h){if(c.renderPass==="opaque")return;const p=s.paint.get("model-opacity");if(p===0)return;const y=s.paint.get("model-cast-shadows");if(c.renderPass==="shadow"&&(!y||c.terrain&&p<.65&&s._transitionablePaint._values["model-opacity"].value.expression instanceof i.Z))return;const w=c.shadowRenderer,M=s.paint.get("model-receive-shadows");w&&(w.useNormalOffset=!0,M||(w.enabled=!1));const C=()=>{w&&(w.useNormalOffset=!0,M||(w.enabled=!0))},k=r.getSource();if(c.renderPass==="light-beam"&&k.type!=="batched-model")return;if(k.type==="vector"||k.type==="geojson")return function(Z,ie,he,se){const de=Z.transform;if(de.projection.name!=="mercator")return void i.w(`Drawing 3D models for ${de.projection.name} projection is not yet implemented`);const ne=de.getFreeCameraOptions().position;if(!Z.modelManager)return;const pe=Z.modelManager;he.modelManager=pe;const Se=Z.shadowRenderer;if(!he._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const Ae=he._unevaluatedLayout._values["model-id"],Le={...he.layout.get("model-id").parameters};for(const et of se){const je=ie.getTile(et).getBucket(he);if(!je||je.projection.name!==de.projection.name)continue;const dt=Jp(et,de);Le.zoom=dt;const at=Ae.possiblyEvaluate(Le);if(lf(Z,je,et),is.shadowUniformsInitialized=!1,is.useSingleShadowCascade=!!Se&&Se.getMaxCascadeForTile(et.toUnwrapped())===0,Z.renderPass==="shadow"&&Se){if(Z.currentShadowCascade===1&&je.isInsideFirstShadowMapFrustum)continue;const ot=de.calculatePosMatrix(et.toUnwrapped(),de.worldSize);if(is.tileMatrix.set(ot),is.shadowTileMatrix=Float32Array.from(Se.calculateShadowPassMatrixFromMatrix(ot)),is.aabb.min.fill(0),is.aabb.max[0]=is.aabb.max[1]=i.V,is.aabb.max[2]=0,kg(je,is,Z,he.scope))continue}const At=1<<et.canonical.z,$e=[((ne.x-et.wrap)*At-et.canonical.x)*i.V,(ne.y*At-et.canonical.y)*i.V,ne.z*At*i.V];for(let ot in je.instancesPerModel){const ke=je.instancesPerModel[ot];ke.features.length>0&&(ot=at.evaluate(ke.features[0].feature,{}));const Ze=pe.getModel(ot,he.scope);if(Ze&&Ze.uploaded)for(const Pt of Ze.nodes)cf(Z,he,Pt,ke,$e,et,is)}}}(c,r,s,h),void C();if(!k.loaded())return;if(k.type==="batched-model")return function(Z,ie,he,se){he.resetLayerRenderingStats(Z);const de=Z.context,ne=Z.transform,pe=Z.style.fog,Se=Z.shadowRenderer;if(ne.projection.name!=="mercator")return void i.w(`Drawing 3D landmark models for ${ne.projection.name} projection is not yet implemented`);const Ae=Z.transform.getFreeCameraOptions().position,Le=i.N.scale([],[Ae.x,Ae.y,Ae.z],Z.transform.worldSize);i.N.negate(Le,Le);const et=i.a6.identity([]),je=i.cR(ne.center.lat,ne.zoom),dt=i.a6.fromScaling([],[1,1,1/je]);i.a6.translate(et,et,Le);const at=he.paint.get("model-opacity"),At=new xn(de.gl.LEQUAL,xn.ReadWrite,Z.depthRangeFor3D),$e=new xn(de.gl.LEQUAL,xn.ReadOnly,Z.depthRangeFor3D),ot=new i.bS([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),ke=Z.renderPass==="shadow",Ze=ke&&Se?Se.getCurrentCascadeFrustum():ne.getFrustum(ne.scaleZoom(ne.worldSize)),Pt=he.getLayerRenderingStats(),Bt=function(Ft,Xt){for(const un of se){const vn=ie.getTile(un).getBucket(he);if(!vn||!vn.uploaded)continue;let pn=!1;Se&&(pn=Se.getMaxCascadeForTile(un.toUnwrapped())===0);const gn=ne.calculatePosMatrix(un.toUnwrapped(),ne.worldSize),qn=vn.modelTraits;for(const kn of vn.getNodesInfo()){if(kn.hiddenByReplacement||!kn.node.meshes)continue;const Nn=kn.evaluatedScale,Fn=kn.node;let _r=0;if(Z.terrain&&Fn.elevation&&(_r=Fn.elevation*Z.terrain.exaggeration()),Nn[0]<=1&&Nn[1]<=1&&Nn[2]<=1&&(()=>{const Qr=kn.getLocalBounds();return ot.min=[...Qr.min],ot.max=[...Qr.max],ot.min[2]+=_r,ot.max[2]+=_r,i.N.transformMat4(ot.min,ot.min,gn),i.N.transformMat4(ot.max,ot.max,gn),ot})().intersects(Ze)===0)continue;const Zr=Z.renderPass==="light-beam",ir=[...gn];i.a6.translate(ir,ir,[(Fn.anchor?Fn.anchor[0]:0)*(Nn[0]-1),(Fn.anchor?Fn.anchor[1]:0)*(Nn[1]-1),_r]),i.N.exactEquals(Nn,i.cT)||i.a6.scale(ir,ir,Nn),i.a6.multiply(ir,ir,Fn.matrix);const mi=i.a6.multiply([],dt,ir);i.a6.multiply(mi,et,mi);const or=i.a6.invert([],mi);i.a6.transpose(or,or),i.a6.scale(or,or,mc);const Ar=i.a6.multiply([],ne.expandedFarZProjMatrix,ir),sr=qn&i.cV.HasMapboxMeshFeatures,Sr=sr?0:kn.evaluatedRMEA[0][2];for(let Qr=0;Qr<Fn.meshes.length;++Qr){const Lr=Fn.meshes[Qr],to=Qr===Fn.lightMeshIndex;if(to){if(!Zr&&!Z.terrain&&Z.shadowRenderer){Z.currentLayer<Z.firstLightBeamLayer&&(Z.firstLightBeamLayer=Z.currentLayer);continue}}else if(Zr)continue;const go={defines:[]},Wo=[];if(pi(go.defines,Wo,Lr,Z),sr||go.defines.push("DIFFUSE_SHADED"),pn&&go.defines.push("SHADOWS_SINGLE_CASCADE"),Pt&&(ke?Pt.numRenderedVerticesInShadowPass+=Lr.vertexArray.length:Pt.numRenderedVerticesInTransparentPass+=Lr.vertexArray.length),ke){Je(Lr,ir,Z,he);continue}let na=null;if(pe){const Yo=Dl(ir,Z.transform);if(na=new Float32Array(Yo),ne.projection.name!=="globe"){const ra=Lr.aabb.min,ol=Lr.aabb.max,[Ol,Uu]=pe.getOpacityForBounds(Yo,ra[0],ra[1],ol[0],ol[1]);go.overrideFog=Ol>=hr||Uu>=hr}}const Zo=Lr.material;let no;Zo.occlusionTexture&&Zo.occlusionTexture.offsetScale&&(no=Zo.occlusionTexture.offsetScale,go.defines.push("OCCLUSION_TEXTURE_TRANSFORM")),!ke&&Se&&(Se.useNormalOffset=!!Lr.normalBuffer);const qi=Z.getOrCreateProgram("model",go);!ke&&Se&&Se.setupShadowsFromMatrix(ir,qi,Se.useNormalOffset),Z.uploadCommonUniforms(de,qi,un.toUnwrapped(),na);const Mo=Zo.pbrMetallicRoughness;Mo.metallicFactor=.9,Mo.roughnessFactor=.5;const Fo=Ih(new Float32Array(Ar),new Float32Array(mi),new Float32Array(or),Z,at,Mo.baseColorFactor,Zo.emissiveFactor,Mo.metallicFactor,Mo.roughnessFactor,Zo,Sr,he,[0,0,0],no);qi.draw(Z,de.gl.TRIANGLES,Xt&&!to?At:$e,Dn.disabled,Ft?to||at<1||kn.hasTranslucentParts?Yn.alphaBlended:Yn.unblended:Yn.disabled,bn.backCCW,Fo,he.id,Lr.vertexBuffer,Lr.indexBuffer,Lr.segments,he.paint,Z.transform.zoom,void 0,Wo)}}}};(function(Ft,Xt,un,vn){const pn=Ft.terrain?Ft.terrain.exaggeration():0,gn=Ft.transform.zoom;for(const qn of vn){const kn=Xt.getTile(qn).getBucket(un);kn&&(Ft.conflationActive&&kn.updateReplacement(qn,Ft.replacementSource),kn.evaluateScale(Ft,un),Ft.terrain&&pn>0&&kn.elevationUpdate(Ft.terrain,pn,qn,un.source),kn.needsReEvaluation(Ft,gn,un)&&kn.evaluate(un))}})(Z,ie,he,se),at===1?Bt(!0,!0):(Bt(!1,!0),Bt(!0,!1))}(c,r,s,h),void C();const z=k.getModels(),B=[],$=c.transform.getFreeCameraOptions().position,H=i.N.scale([],[$.x,$.y,$.z],c.transform.worldSize);i.N.negate(H,H);const K=[],X=[];let Q=0;for(const Z of z){const ie=s.paint.get("model-rotation").constantOr(null),he=s.paint.get("model-scale").constantOr(null),se=s.paint.get("model-translation").constantOr(null);Z.computeModelMatrix(c,ie,he,se,!0,!0,!1);const de=i.a6.identity([]),ne=i.cR(Z.position.lat,c.transform.zoom),pe=i.a6.fromScaling([],[1,1,1/ne]);i.a6.translate(de,de,H),B.push({zScaleMatrix:pe,negCameraPosMatrix:de});for(const Se of Z.nodes)Mu(c.transform,Se,Z.matrix,c.transform.expandedFarZProjMatrix,Q,K,X);Q++}if(K.sort((Z,ie)=>ie.depth-Z.depth),c.renderPass!=="shadow"){if(p===1)for(const Z of X)Su(Z,c,s,B[Z.modelIndex],Dn.disabled,c.colorModeForRenderPass());else{for(const Z of X)Su(Z,c,s,B[Z.modelIndex],Dn.disabled,Yn.disabled);for(const Z of X)Su(Z,c,s,B[Z.modelIndex],c.stencilModeFor3D(),c.colorModeForRenderPass());c.resetStencilClippingMasks()}for(const Z of K)Su(Z,c,s,B[Z.modelIndex],Dn.disabled,c.colorModeForRenderPass());C()}else{for(const Z of X)Je(Z.mesh,Z.nodeModelMatrix,c,s);for(const Z of K)Je(Z.mesh,Z.nodeModelMatrix,c,s);C()}}},uf={model:function(c,r,s){const h=c.scope,p=r.getSource();if(!p.loaded())return;if(p.type==="vector"||p.type==="geojson")return void(s.modelManager&&s.modelManager.upload(s,h));if(p.type==="batched-model")return;const y=p.getModels();for(const w of y)w.upload(s.context)},raster:function(c,r,s){const h=r.getSource();if(!(h instanceof Xe&&h.loaded()))return;const p=c.sourceLayer||h.rasterLayerIds&&h.rasterLayerIds[0];if(!p)return;const y=c.paint.get("raster-array-band")||h.getInitialBand(p);if(y==null)return;const w=r.getIds().map(M=>r.getTileByID(M));for(const M of w)M.updateNeeded(p,y)&&h.prepareTile(M,p,y)},"raster-particle":function(c,r,s){const h=r.getSource();if(!(h instanceof Xe&&h.loaded()))return;const p=c.sourceLayer||h.rasterLayerIds&&h.rasterLayerIds[0];if(!p)return;const y=c.paint.get("raster-particle-array-band")||h.getInitialBand(p);if(y==null)return;const w=r.getIds().map(M=>r.getTileByID(M));for(const M of w)M.updateNeeded(p,y)&&h.prepareTile(M,p,y)}};class em{constructor(r,s,h,p){this.context=new vh(r,s),this.transform=h,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=p,this._debugParams={showTerrainProxyTiles:!1},p.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),this.setup(),this.numSublayers=Oo.maxUnderzooming+Oo.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new i.cX,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Bi(this),this._wireframeDebugCache=new Qp,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0}updateTerrain(r,s){const h=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(h||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Sg(this,r));const p=this._terrain;this.transform.elevation=h?p:null,p.update(r,this.transform,s),this.transform.elevation&&!p.enabled&&(this.transform.elevation=null)}_updateFog(r){const s=r.fog;if(!s||this.transform.projection.name==="globe"||s.getOpacity(this.transform.pitch)<1||s.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[h,p]=s.getFovAdjustedRange(this.transform._fov);if(h>p)return void(this.transform.fogCullDistSq=null);const y=h+.78*(p-h);this.transform.fogCullDistSq=y*y}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(r,s){if(this.width=r*i.f.devicePixelRatio,this.height=s*i.f.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const h of this.style.order)this.style._mergedLayers[h].resize()}setup(){const r=this.context,s=new i.aN;s.emplaceBack(0,0),s.emplaceBack(i.V,0),s.emplaceBack(0,i.V),s.emplaceBack(i.V,i.V),this.tileExtentBuffer=r.createVertexBuffer(s,i.aP.members),this.tileExtentSegments=i.aB.simpleSegment(0,0,4,2);const h=new i.aN;h.emplaceBack(0,0),h.emplaceBack(i.V,0),h.emplaceBack(0,i.V),h.emplaceBack(i.V,i.V),this.debugBuffer=r.createVertexBuffer(h,i.aP.members),this.debugSegments=i.aB.simpleSegment(0,0,4,5);const p=new i.aN;p.emplaceBack(-1,-1),p.emplaceBack(1,-1),p.emplaceBack(-1,1),p.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(p,i.aP.members),this.viewportSegments=i.aB.simpleSegment(0,0,4,2);const y=new i.av;y.emplaceBack(0,0,0,0),y.emplaceBack(i.V,0,i.V,0),y.emplaceBack(0,i.V,0,i.V),y.emplaceBack(i.V,i.V,i.V,i.V),this.mercatorBoundsBuffer=r.createVertexBuffer(y,i.aR.members),this.mercatorBoundsSegments=i.aB.simpleSegment(0,0,4,2);const w=new i.aw;w.emplaceBack(0,1,2),w.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(w);const M=new i.aO;for(const k of[0,1,3,2,0])M.emplaceBack(k);this.debugIndexBuffer=r.createIndexBuffer(M),this.emptyTexture=new i.T(r,new i.h({width:1,height:1},Uint8Array.of(0,0,0,0)),r.gl.RGBA),this.identityMat=i.a6.create();const C=this.context.gl;this.stencilClearMode=new Dn({func:C.ALWAYS,mask:0},0,255,C.ZERO,C.ZERO,C.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,r.TRIANGLES,xn.disabled,this.stencilClearMode,Yn.disabled,bn.disabled,hc(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,s,h){if(!s||this.currentStencilSource===s.id||!r.isTileClipped()||!h||h.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let M=!1;for(const C of h)if(this._tileClippingMaskIDs[C.key]===void 0){M=!0;break}if(!M)return}this.currentStencilSource=s.id;const p=this.context,y=p.gl;this.nextStencilID+h.length>256&&this.clearStencil(),p.setColorMode(Yn.disabled),p.setDepthMode(xn.disabled);const w=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const M of h){const C=s.getTile(M),k=this._tileClippingMaskIDs[M.key]=this.nextStencilID++,{tileBoundsBuffer:z,tileBoundsIndexBuffer:B,tileBoundsSegments:$}=this.getTileBoundsBuffers(C);w.draw(this,y.TRIANGLES,xn.disabled,new Dn({func:y.ALWAYS,mask:0},k,255,y.KEEP,y.KEEP,y.REPLACE),Yn.disabled,bn.disabled,hc(M.projMatrix),"$clipping",z,B,$)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,s=this.context.gl;return new Dn({func:s.NOTEQUAL,mask:255},r,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const s=this.context.gl;return new Dn({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,s.KEEP,s.KEEP,s.REPLACE)}stencilConfigForOverlap(r){const s=this.context.gl,h=r.sort((w,M)=>M.overscaledZ-w.overscaledZ),p=h[h.length-1].overscaledZ,y=h[0].overscaledZ-p+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const w={};for(let M=0;M<y;M++)w[M+p]=new Dn({func:s.GEQUAL,mask:255},M+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=y,[w,h]}return[{[p]:Dn.disabled},h]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new Yn([r.CONSTANT_COLOR,r.ONE,r.CONSTANT_COLOR,r.ONE],new i.ax(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Yn.unblended:Yn.alphaBlended}colorModeForDrapableLayerRenderPass(r){const s=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Yn([s.ONE,s.ONE_MINUS_SRC_ALPHA,s.CONSTANT_ALPHA,s.ONE_MINUS_SRC_ALPHA],new i.ax(0,0,0,r===void 0?0:r),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(r,s,h,p=!1){if(!this.opaquePassEnabledForLayer()&&!p)return xn.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new xn(h||this.context.gl.LEQUAL,s,[y,y])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,s){this._wireframeDebugCache.update(this.frameCounter),this.style=r,this.options=s;const h=this.style._mergedLayers,p=this.style.order,y=p.map(ne=>h[ne]),w=this.style._mergedSourceCaches;this.imageManager=r.imageManager,this.modelManager=r.modelManager,this.symbolFadeChange=r.placement.symbolFadeChange(i.f.now()),this.imageManager.beginFrame();let M=0,C=!1;for(const ne in w){const pe=w[ne];pe.used&&(pe.prepare(this.context),pe.getSource().usedInConflation&&++M)}for(const ne of y)ne.isHidden(this.transform.zoom)||this.prepareLayer(ne);const k={},z={},B={},$={},H={};for(const ne in w){const pe=w[ne];k[ne]=pe.getVisibleCoordinates(),z[ne]=k[ne].slice().reverse(),B[ne]=pe.getVisibleCoordinates(!0).reverse(),$[ne]=pe.getShadowCasterCoordinates(),H[ne]=pe.sortCoordinatesByDistance(k[ne])}const K=ne=>{const pe=this.style.getLayerSourceCache(ne);return pe&&pe.used?pe.getSource():null};if(M){const ne=[];for(const pe of y)this.layerUsedInConflation(pe,K(pe))&&ne.push(pe);if(ne&&ne.length>1){const pe=[];for(const Se of ne){const Ae=this.style.getLayerSourceCache(Se);Ae&&Ae.used&&Ae.getSource().usedInConflation&&pe.push({layer:Se.fqid,cache:Ae})}this.replacementSource.setSources(pe),C=!0}}C||this.replacementSource.clear(),this.conflationActive=C,this.minCutoffZoom=0,this.longestCutoffRange=0;for(const ne of y){const pe=ne.cutoffRange();if(this.longestCutoffRange=Math.max(pe,this.longestCutoffRange),pe>0){const Se=K(ne);Se&&(this.minCutoffZoom=Math.max(Se.minzoom,this.minCutoffZoom)),ne.minzoom&&(this.minCutoffZoom=Math.max(ne.minzoom,this.minCutoffZoom))}}this.opaquePassCutoff=1/0;for(let ne=0;ne<y.length;ne++)if(y[ne].is3D()){this.opaquePassCutoff=ne;break}const X=this.style&&this.style.fog;X?(this._fogVisible=X.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=X.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(B),this.opaquePassCutoff=0);const Q=this._shadowRenderer;if(Q){Q.updateShadowParameters(this.transform,this.style.directionalLight);for(const ne in w)for(const pe of k[ne]){let Se={min:0,max:0};this.terrain&&(Se=this.terrain.getMinMaxForTile(pe)||Se),Q.addShadowReceiver(pe.toUnwrapped(),Se.min,Se.max)}}if(this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.cY(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new wn(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!i.cZ(this.context.gl))return;this.renderPass="offscreen";for(const ne of y){const pe=r.getLayerSourceCache(ne);if(!ne.hasOffscreenPass()||ne.isHidden(this.transform.zoom))continue;const Se=pe?z[pe.id]:void 0;(ne.type==="custom"||ne.type==="raster"||ne.type==="raster-particle"||ne.isSky()||Se&&Se.length)&&this.renderLayer(this,pe,ne,Se)}this.depthRangeFor3D=[0,1-(y.length+2)*this.numSublayers*this.depthEpsilon];const Z=this.terrain;Z&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&Z.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,$)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const ie=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),he=(()=>{if(s.showOverdrawInspector)return i.ax.black;if(this.style.fog&&this.transform.projection.supportsFog&&!ie){const ne=this.style.fog.properties.get("color").toArray01();return new i.ax(...ne)}if(this.style.fog&&this.transform.projection.supportsFog&&ie){const ne=this.style.fog.properties.get("space-color").toArray01();return new i.ax(...ne)}return i.ax.transparent})();if(this.context.clear({color:he,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&ie&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const ne=y[this.currentLayer],pe=r.getLayerSourceCache(ne);if(ne.isSky())continue;const Se=pe?(ne.is3D()?H:z)[pe.id]:void 0;this._renderTileClippingMasks(ne,pe,Se),this.renderLayer(this,pe,ne,Se)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&ie&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||i.S(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const ne=y[this.currentLayer],pe=r.getLayerSourceCache(ne);ne.isSky()&&this.renderLayer(this,pe,ne,pe?z[pe.id]:void 0)}function se(ne,pe){let Se;return pe&&(Se=(ne.type==="symbol"?B:ne.is3D()?H:z)[pe.id]),Se}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<p.length;){const ne=y[this.currentLayer];if(ne.type==="raster"){const pe=r.getLayerSourceCache(ne);this.renderLayer(this,pe,ne,se(ne,pe))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let de=0;for(Q&&(de=Q.getShadowCastingLayerCount());this.currentLayer<p.length;){const ne=y[this.currentLayer],pe=r.getLayerSourceCache(ne);if(ne.isSky())++this.currentLayer;else if(Z&&this.style.isLayerDraped(ne)){if(ne.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=Z.renderBatch(this.currentLayer)}else{if(this._renderTileClippingMasks(ne,pe,pe?k[pe.id]:void 0),this.renderLayer(this,pe,ne,se(ne,pe)),!Z&&Q&&de>0&&ne.hasShadowPass()&&--de==0&&(Q.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Se=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Se;this.currentLayer++){const Ae=y[this.currentLayer];if(!Ae.hasLightBeamPass())continue;const Le=r.getLayerSourceCache(Ae);this.renderLayer(this,Le,Ae,Le?z[Le.id]:void 0)}this.currentLayer=Se,this.renderPass="translucent"}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let ne=null;y.forEach(pe=>{const Se=r.getLayerSourceCache(pe);Se&&!pe.isHidden(this.transform.zoom)&&Se.getVisibleCoordinates().length&&(!ne||ne.getSource().maxzoom<Se.getSource().maxzoom)&&(ne=Se)}),ne&&this.options.showTileBoundaries&&Iu.debug(this,ne,ne.getVisibleCoordinates(),i.ax.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Iu.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new i.ax(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(ne){const pe=ne.transform.padding;of(ne,ne.transform.height-(pe.top||0),3,Ho),of(ne,pe.bottom||0,3,Qa),rs(ne,pe.left||0,3,Kp),rs(ne,ne.transform.width-(pe.right||0),3,nf);const Se=ne.transform.centerPoint;(function(Ae,Le,et,je){fi(Ae,Le-1,et-10,2,20,je),fi(Ae,Le-10,et-1,20,2,je)})(ne,Se.x,ne.transform.height-Se.y,rf)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),C||(this.conflationActive=!1)}prepareLayer(r){this.gpuTimingStart(r);const{unsupportedLayers:s}=this.transform.projection,h=!s||!s.includes(r.type);if(uf[r.type]&&(h||this.terrain&&r.type==="custom")){const p=this.style.getLayerSourceCache(r);uf[r.type](r,p,this)}this.gpuTimingEnd()}renderLayer(r,s,h,p){h.isHidden(this.transform.zoom)||(h.type==="background"||h.type==="sky"||h.type==="custom"||h.type==="model"||h.type==="raster"||h.type==="raster-particle"||p&&p.length)&&(this.id=h.id,this.gpuTimingStart(h),(!r.transform.projection.unsupportedLayers||!r.transform.projection.unsupportedLayers.includes(h.type)||r.terrain&&h.type==="custom")&&Iu[h.type](r,s,h,p,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const s=this.context.extTimerQuery,h=this.context.gl;let p=this.gpuTimers[r.id];p||(p=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:h.createQuery()}),p.calls++,h.beginQuery(s.TIME_ELAPSED_EXT,p.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const r=this.context.extTimerQuery,s=this.context.gl,h=s.createQuery();this.deferredRenderGpuTimeQueries.push(h),s.beginQuery(r.TIME_ELAPSED_EXT,h)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}collectDeferredRenderGpuQueries(){const r=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],r}queryGpuTimers(r){const s={};for(const h in r){const p=r[h],y=this.context.extTimerQuery,w=y.getQueryParameter(p.query,this.context.gl.QUERY_RESULT)/1e6;y.deleteQueryEXT(p.query),s[h]=w}return s}queryGpuTimeDeferredRender(r){if(!this.options.gpuTimingDeferredRender)return 0;const s=this.context.extTimerQuery,h=this.context.gl;let p=0;for(const y of r)p+=s.getQueryParameter(y,h.QUERY_RESULT)/1e6,s.deleteQueryEXT(y);return p}translatePosMatrix(r,s,h,p,y){if(!h[0]&&!h[1])return r;const w=y?p==="map"?this.transform.angle:0:p==="viewport"?-this.transform.angle:0;if(w){const k=Math.sin(w),z=Math.cos(w);h=[h[0]*z-h[1]*k,h[0]*k+h[1]*z]}const M=[y?h[0]:i.a3(s,h[0],this.transform.zoom),y?h[1]:i.a3(s,h[1],this.transform.zoom),0],C=new Float32Array(16);return i.a6.translate(C,r,M),C}saveTileTexture(r){const s=r.size[0],h=this._tileTextures[s];h?h.push(r):this._tileTextures[s]=[r]}getTileTexture(r){const s=this._tileTextures[r];return s&&s.length>0?s.pop():null}isPatternMissing(r,s){return r===null||r!==void 0&&!this.imageManager.getPattern(r.toString(),s)}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(r,s,h){const p=h===void 0?this.terrain&&this.terrain.renderingToTexture:h,y=this.terrain&&this.terrain.exaggeration()===0,w=[];return this.style&&this.style.enable3dLights()&&(r==="globeRaster"||r==="terrainRaster"?(w.push("LIGHTING_3D_MODE"),w.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):p||w.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||w.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?w.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):w.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(w.push("TERRAIN"),this.linearFloatFilteringSupported()&&w.push("TERRAIN_DEM_FLOAT_FORMAT"),y&&w.push("ZERO_EXAGGERATION")),this.transform.projection.name==="globe"&&w.push("GLOBE"),!this._fogVisible||p||s!==void 0&&!s||w.push("FOG","FOG_DITHERING"),p&&w.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&w.push("OVERDRAW_INSPECTOR"),w}getOrCreateProgram(r,s){this.cache=this.cache||{};const h=s&&s.defines||[],p=s&&s.config,y=s&&s.transformFeedback,w=this.currentGlobalDefines(r,s&&s.overrideFog,s&&s.overrideRtt).concat(h),M=Vd.cacheKey(Tl[r],r,w,p);return this.cache[M]||(this.cache[M]=new Vd(this.context,r,Tl[r],p,Ig[r],w,y)),this.cache[M]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(r,s){if(this.style.enable3dLights()){const h=this.style.directionalLight,p=this.style.ambientLight;if(h&&p){const y=((w,M)=>{const C=w.properties.get("direction"),k=w.properties.get("color").toArray01(),z=w.properties.get("intensity"),B=M.properties.get("color").toArray01(),$=M.properties.get("intensity"),H=[C.x,C.y,C.z],K=i.cn(B,$),X=i.cn(k,z);return{u_lighting_ambient_color:K,u_lighting_directional_dir:H,u_lighting_directional_color:X,u_ground_radiance:Nd(H,X,K)}})(h,p);s.setLightsUniformValues(r,y)}}}uploadCommonUniforms(r,s,h,p,y){if(this.uploadCommonLightUniforms(r,s),this.terrain&&this.terrain.renderingToTexture)return;const w=this.style.fog;if(w){const M=w.getOpacity(this.transform.pitch),C=((k,z,B,$,H,K,X,Q,Z,ie,he,se)=>{const de=k.transform,ne=z.properties.get("color").toArray01();ne[3]=$;const pe=k.frameCounter/1e3%1,[Se,Ae]=z.properties.get("vertical-range");return{u_fog_matrix:B?de.calculateFogTileMatrix(B):se||k.identityMat,u_fog_range:z.getFovAdjustedRange(de._fov),u_fog_color:ne,u_fog_horizon_blend:z.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Se,Ae),Ae],u_fog_temporal_offset:pe,u_frustum_tl:H,u_frustum_tr:K,u_frustum_br:X,u_frustum_bl:Q,u_globe_pos:Z,u_globe_radius:ie,u_viewport:he,u_globe_transition:i.S(de.zoom),u_is_globe:+(de.projection.name==="globe")}})(this,w,h,M,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.f.devicePixelRatio,this.transform.height*i.f.devicePixelRatio],p);s.setFogUniformValues(r,C)}y&&s.setCutoffUniformValues(r,y.uniformValues)}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){const r=this.canvasCopy();r&&(this.frameCopies.push(r),this.tileLoaded=!1)}canvasCopy(){const r=this.context.gl,s=r.createTexture();return r.bindTexture(r.TEXTURE_2D,s),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),s}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,s=this._backgroundTiles={},h=this.transform.coveringTiles({tileSize:512});for(const p of h)s[p.key]=r[p.key]||new Zs(p,512,this.transform.tileZoom,this);return s}clearBackgroundTiles(){this._backgroundTiles={}}layerUsedInConflation(r,s){return!(!r.is3D()||r.minzoom&&r.minzoom>this.transform.zoom||r.sourceLayer!=="building"&&(!s||s.type!=="batched-model"))}isTileAffectedByFog(r){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let s=this._cachedTileFogOpacities[r.key];return s||(this._cachedTileFogOpacities[r.key]=s=this.style.fog.getOpacityForTile(r)),s[0]>=hr||s[1]>=hr}}function Cu(c,r){let s=!1,h=null;const p=()=>{h=null,s&&(c(),h=setTimeout(p,r),s=!1)};return()=>(s=!0,h||p(),h)}class Dh{constructor(r){this._hashName=r&&encodeURIComponent(r),i.aY(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Cu(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,window.addEventListener("hashchange",this._onHashChange,!1),r.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const r=this._map;if(!r)return"";const s=hf(r);if(this._hashName){const h=this._hashName;let p=!1;const y=location.hash.slice(1).split("&").map(w=>{const M=w.split("=")[0];return M===h?(p=!0,`${M}=${s}`):w}).filter(w=>w);return p||y.push(`${h}=${s}`),`#${y.join("&")}`}return`#${s}`}_getCurrentHash(){const r=location.hash.replace("#","");if(this._hashName){let s;return r.split("&").map(h=>h.split("=")).forEach(h=>{h[0]===this._hashName&&(s=h)}),(s&&s[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._map;if(!r)return!1;const s=this._getCurrentHash();if(s.length>=3&&!s.some(h=>isNaN(h))){const h=r.dragRotate.isEnabled()&&r.touchZoomRotate.isEnabled()?+(s[3]||0):r.getBearing();return r.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:h,pitch:+(s[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function hf(c,r){const s=c.getCenter(),h=Math.round(100*c.getZoom())/100,p=Math.ceil((h*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,p),w=Math.round(s.lng*y)/y,M=Math.round(s.lat*y)/y,C=c.getBearing(),k=c.getPitch();let z=r?`/${w}/${M}/${h}`:`${h}/${M}/${w}`;return(C||k)&&(z+="/"+Math.round(10*C)/10),k&&(z+=`/${Math.round(k)}`),z}const Pu={linearity:.3,easing:i.c_(0,0,.3,1)},qo=i.e({deceleration:2500,maxSpeed:1400},Pu),Rg=i.e({deceleration:20,maxSpeed:1400},Pu),kh=i.e({deceleration:1e3,maxSpeed:360},Pu),si=i.e({deceleration:1e3,maxSpeed:90},Pu);class jr{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.f.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,s=i.f.now();for(;r.length>0&&s-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const s={zoom:0,bearing:0,pitch:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)s.zoom+=y.zoomDelta||0,s.bearing+=y.bearingDelta||0,s.pitch+=y.pitchDelta||0,y.panDelta&&s.pan._add(y.panDelta),y.around&&(s.around=y.around),y.pinchAround&&(s.pinchAround=y.pinchAround);const h=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,p={};if(s.pan.mag()){const y=Ls(s.pan.mag(),h,i.e({},qo,r||{}));p.offset=s.pan.mult(y.amount/s.pan.mag()),p.center=this._map.transform.center,Du(p,y)}if(s.zoom){const y=Ls(s.zoom,h,Rg);p.zoom=this._map.transform.zoom+y.amount,Du(p,y)}if(s.bearing){const y=Ls(s.bearing,h,kh);p.bearing=this._map.transform.bearing+i.aa(y.amount,-179,179),Du(p,y)}if(s.pitch){const y=Ls(s.pitch,h,si);p.pitch=this._map.transform.pitch+y.amount,Du(p,y)}if(p.zoom||p.bearing){const y=s.pinchAround===void 0?s.around:s.pinchAround;p.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),p.noMoveStart=!0,p}}function Du(c,r){(!c.duration||c.duration<r.duration)&&(c.duration=r.duration,c.easing=r.easing)}function Ls(c,r,s){const{maxSpeed:h,linearity:p,deceleration:y}=s,w=i.aa(c*p/(r/1e3),-h,h),M=Math.abs(w)/(y*p);return{easing:s.easing,duration:1e3*M,amount:w*(M/2)}}class zo extends i.b{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,s,h,p={}){const y=Be(s.getCanvasContainer(),h),w=s.unproject(y);super(r,i.e({point:y,lngLat:w,originalEvent:h},p)),this._defaultPrevented=!1,this.target=s}}class Ta extends i.b{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,s,h){const p=r==="touchend"?h.changedTouches:h.touches,y=He(s.getCanvasContainer(),p),w=y.map(C=>s.unproject(C)),M=y.reduce((C,k,z,B)=>C.add(k.div(B.length)),new i.P(0,0));super(r,{points:y,point:M,lngLats:w,lngLat:s.unproject(M),originalEvent:h}),this._defaultPrevented=!1}}class df extends i.b{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,s,h){super(r,{originalEvent:h}),this._defaultPrevented=!1}}class ff{constructor(r,s){this._map=r,this._clickTolerance=s.clickTolerance}reset(){this._mousedownPos=void 0}wheel(r){return this._firePreventable(new df(r.type,this._map,r))}mousedown(r,s){return this._mousedownPos=s,this._firePreventable(new zo(r.type,this._map,r))}mouseup(r){this._map.fire(new zo(r.type,this._map,r))}preclick(r){const s=i.e({},r);s.type="preclick",this._map.fire(new zo(s.type,this._map,s))}click(r,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||(this.preclick(r),this._map.fire(new zo(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new zo(r.type,this._map,r))}mouseover(r){this._map.fire(new zo(r.type,this._map,r))}mouseout(r){this._map.fire(new zo(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Ta(r.type,this._map,r))}touchmove(r){this._map.fire(new Ta(r.type,this._map,r))}touchend(r){this._map.fire(new Ta(r.type,this._map,r))}touchcancel(r){this._map.fire(new Ta(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class tl{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(r){this._map.fire(new zo(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new zo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new zo(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class nl{constructor(r,s){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,s){this.isEnabled()&&r.shiftKey&&r.button===0&&(we(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(r,s){if(!this._active)return;const h=s,p=this._startPos,y=this._lastPos;if(!p||!y||y.equals(h)||!this._box&&h.dist(p)<this._clickTolerance)return;this._lastPos=h,this._box||(this._box=j("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const w=Math.min(p.x,h.x),M=Math.max(p.x,h.x),C=Math.min(p.y,h.y),k=Math.max(p.y,h.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${w}px,${C}px)`,this._box.style.width=M-w+"px",this._box.style.height=k-C+"px")})}mouseupWindow(r,s){if(!this._active)return;const h=this._startPos,p=s;if(h&&r.button===0){if(this.reset(),Fe(),h.x!==p.x||h.y!==p.y)return this._map.fire(new i.b("boxzoomend",{originalEvent:r})),{cameraAnimation:y=>y.fitScreenCoordinates(h,p,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ye(),delete this._startPos,delete this._lastPos}_fireEvent(r,s){return this._map.fire(new i.b(r,{originalEvent:s}))}}function _c(c,r){const s={};for(let h=0;h<c.length;h++)s[c[h].identifier]=r[h];return s}class Oh{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(r,s,h){(this.centroid||h.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=r.timeStamp),h.length===this.numTouches&&(this.centroid=function(p){const y=new i.P(0,0);for(const w of p)y._add(w);return y.div(p.length)}(s),this.touches=_c(h,s)))}touchmove(r,s,h){if(this.aborted||!this.centroid)return;const p=_c(h,s);for(const y in this.touches){const w=p[y];(!w||w.dist(this.touches[y])>30)&&(this.aborted=!0)}}touchend(r,s,h){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),h.length===0){const p=!this.aborted&&this.centroid;if(this.reset(),p)return p}}}class ku{constructor(r){this.singleTap=new Oh(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(r,s,h){this.singleTap.touchstart(r,s,h)}touchmove(r,s,h){this.singleTap.touchmove(r,s,h)}touchend(r,s,h){const p=this.singleTap.touchend(r,s,h);if(p){const y=r.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(p)<30;if(y&&w||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=p,this.count===this.numTaps)return this.reset(),p}}}class pf{constructor(){this._zoomIn=new ku({numTouches:1,numTaps:2}),this._zoomOut=new ku({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,s,h){this._zoomIn.touchstart(r,s,h),this._zoomOut.touchstart(r,s,h)}touchmove(r,s,h){this._zoomIn.touchmove(r,s,h),this._zoomOut.touchmove(r,s,h)}touchend(r,s,h){const p=this._zoomIn.touchend(r,s,h),y=this._zoomOut.touchend(r,s,h);return p?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()+1,around:w.unproject(p)},{originalEvent:r})}):y?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()-1,around:w.unproject(y)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const mf={0:1,2:2};class ta{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(r,s){return!1}_move(r,s){return{}}mousedown(r,s){if(this._lastPoint)return;const h=Ce(r);this._correctButton(r,h)&&(this._lastPoint=s,this._eventButton=h)}mousemoveWindow(r,s){const h=this._lastPoint;if(h){if(r.preventDefault(),this._eventButton!=null&&function(p,y){const w=mf[y];return p.buttons===void 0||(p.buttons&w)!==w}(r,this._eventButton))this.reset();else if(this._moved||!(s.dist(h)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(h,s)}}mouseupWindow(r){this._lastPoint&&Ce(r)===this._eventButton&&(this._moved&&Fe(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _f extends ta{mousedown(r,s){super.mousedown(r,s),this._lastPoint&&(this._active=!0)}_correctButton(r,s){return s===0&&!r.ctrlKey}_move(r,s){return{around:s,panDelta:s.sub(r)}}}class Ou extends ta{_correctButton(r,s){return s===0&&r.ctrlKey||s===2}_move(r,s){const h=.8*(s.x-r.x);if(h)return this._active=!0,{bearingDelta:h}}contextmenu(r){r.preventDefault()}}class Rh extends ta{_correctButton(r,s){return s===0&&r.ctrlKey||s===2}_move(r,s){const h=-.5*(s.y-r.y);if(h)return this._active=!0,{pitchDelta:h}}contextmenu(r){r.preventDefault()}}class gf{constructor(r,s){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=s.clickTolerance||1,this.reset(),i.aY(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}touchstart(r,s,h){return this._calculateTransform(r,s,h)}touchmove(r,s,h){if(this._active&&!(h.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(h.length===1&&!i.c$())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.cancelable&&r.preventDefault(),this._calculateTransform(r,s,h)}}touchend(r,s,h){this._calculateTransform(r,s,h),this._active&&h.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,s,h){h.length>0&&(this._active=!0);const p=_c(h,s),y=new i.P(0,0),w=new i.P(0,0);let M=0;for(const k in p){const z=p[k],B=this._touches[k];B&&(y._add(z),w._add(z.sub(B)),M++,p[k]=z)}if(this._touches=p,M<this._minTouches||!w.mag())return;const C=w.div(M);return this._sum._add(C),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(M),panDelta:C}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=j("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class eo{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(r){}_move(r,s,h){return{}}touchstart(r,s,h){this._firstTwoTouches||h.length<2||(this._firstTwoTouches=[h[0].identifier,h[1].identifier],this._start([s[0],s[1]]))}touchmove(r,s,h){const p=this._firstTwoTouches;if(!p)return;r.preventDefault();const[y,w]=p,M=gc(h,s,y),C=gc(h,s,w);if(!M||!C)return;const k=this._aroundCenter?null:M.add(C).div(2);return this._move([M,C],k,r)}touchend(r,s,h){if(!this._firstTwoTouches)return;const[p,y]=this._firstTwoTouches,w=gc(h,s,p),M=gc(h,s,y);w&&M||(this._active&&Fe(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function gc(c,r,s){for(let h=0;h<c.length;h++)if(c[h].identifier===s)return r[h]}function Lh(c,r){return Math.log(c/r)/Math.LN2}class Ru extends eo{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,s){const h=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(Lh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Lh(this._distance,h),pinchAround:s}}}function rl(c,r){return 180*c.angleWith(r)/Math.PI}class yf extends eo{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,s){const h=this._vector;if(this._vector=r[0].sub(r[1]),h&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:rl(this._vector,h),pinchAround:s}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const s=25/(Math.PI*this._minDiameter)*360,h=this._startVector;if(!h)return!1;const p=rl(r,h);return Math.abs(p)<s}}function Lu(c){return Math.abs(c.y)>Math.abs(c.x)}class vf extends eo{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(r){this._lastPoints=r,Lu(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,s,h){const p=this._lastPoints;if(!p)return;const y=r[0].sub(p[0]),w=r[1].sub(p[1]);return this._map._cooperativeGestures&&!i.c$()&&h.touches.length<3||(this._valid=this.gestureBeginsVertically(y,w,h.timeStamp),!this._valid)?void 0:(this._lastPoints=r,this._active=!0,{pitchDelta:(y.y+w.y)/2*-.5})}gestureBeginsVertically(r,s,h){if(this._valid!==void 0)return this._valid;const p=r.mag()>=2,y=s.mag()>=2;if(!p&&!y)return;if(!p||!y)return this._firstMove==null&&(this._firstMove=h),h-this._firstMove<100&&void 0;const w=r.y>0==s.y>0;return Lu(r)&&Lu(s)&&w}}const kl={panStep:100,bearingStep:15,pitchStep:10};class zu{constructor(){const r=kl;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let s=0,h=0,p=0,y=0,w=0;switch(r.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:r.shiftKey?h=-1:(r.preventDefault(),y=-1);break;case 39:r.shiftKey?h=1:(r.preventDefault(),y=1);break;case 38:r.shiftKey?p=1:(r.preventDefault(),w=-1);break;case 40:r.shiftKey?p=-1:(r.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(h=0,p=0),{cameraAnimation:M=>{const C=M.getZoom();M.easeTo({duration:300,easeId:"keyboardHandler",easing:xf,zoom:s?Math.round(C)+s*(r.shiftKey?2:1):C,bearing:M.getBearing()+h*this._bearingStep,pitch:M.getPitch()+p*this._pitchStep,offset:[-y*this._panStep,-w*this._panStep],center:M.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function xf(c){return c*(2-c)}const Fu=4.000244140625,bf=1/450;class tm{constructor(r,s){this._map=r,this._el=r.getCanvasContainer(),this._handler=s,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=bf,i.aY(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||i.c$()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let s=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const h=i.f.now(),p=h-(this._lastWheelEventTime||0);this._lastWheelEventTime=h,s!==0&&s%Fu==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":p>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(p*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),r.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=r,this._delta-=s,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=Be(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:s,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;this._type==="wheel"&&r.projection.wrap&&(r._center.lng>=180||r._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const s=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const k=this._type==="wheel"&&Math.abs(this._delta)>Fu?this._wheelZoomRate:this._defaultZoomRate;let z=2/(1+Math.exp(-Math.abs(this._delta*k)));this._delta<0&&z!==0&&(z=1/z);const B=s(),$=Math.pow(2,B),H=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):$;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(H*z))),this._type==="wheel"&&(this._startZoom=B,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const h=typeof this._targetZoom=="number"?this._targetZoom:s(),p=this._startZoom,y=this._easing;let w,M=!1;if(this._type==="wheel"&&p&&y){const k=Math.min((i.f.now()-this._lastWheelEventTime)/200,1),z=y(k);w=i.U(p,h,z),k<1?this._frameId||(this._frameId=!0):M=!0}else w=h,M=!0;this._active=!0,M&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let C=w-s();return C*this._lastDelta<0&&(C=0),{noInertia:!0,needsRenderFrame:!M,zoomDelta:C,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let s=i.d0;if(this._prevEase){const h=this._prevEase,p=(i.f.now()-h.start)/h.duration,y=h.easing(p+.01)-h.easing(p),w=.27/Math.sqrt(y*y+1e-4)*.01,M=Math.sqrt(.0729-w*w);s=i.c_(w,M,.25,1)}return this._prevEase={start:i.f.now(),duration:r,easing:s},s}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=j("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class nm{constructor(r,s){this._clickZoom=r,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class rm{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,s){return r.preventDefault(),{cameraAnimation:h=>{h.easeTo({duration:300,zoom:h.getZoom()+(r.shiftKey?-1:1),around:h.unproject(s)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class im{constructor(){this._tap=new ku({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(r,s,h){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?h.length>0&&(this._swipePoint=s[0],this._swipeTouch=h[0].identifier):this._tap.touchstart(r,s,h))}touchmove(r,s,h){if(this._tapTime){if(this._swipePoint){if(h[0].identifier!==this._swipeTouch)return;const p=s[0],y=p.y-this._swipePoint.y;return this._swipePoint=p,r.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(r,s,h)}touchend(r,s,h){this._tapTime?this._swipePoint&&h.length===0&&this.reset():this._tap.touchend(r,s,h)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class om{constructor(r,s,h){this._el=r,this._mousePan=s,this._touchPan=h}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class sm{constructor(r,s,h){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=s,this._mousePitch=h}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class am{constructor(r,s,h,p){this._el=r,this._touchZoom=s,this._touchRotate=h,this._tapDragZoom=p,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Bu=c=>c.zoom||c.drag||c.pitch||c.rotate;class lm extends i.b{}class cm{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,s){const h=i.N.sub([],s,r);this.radius=i.N.length(h[2]<0?i.N.div([],h,this.constants):[h[0],h[1],0])}projectRay(r){i.N.div(r,r,this.constants),i.N.normalize(r,r),i.N.mul(r,r,this.constants);const s=i.N.scale([],r,this.radius);if(s[2]>0){const h=i.N.scale([],[0,0,1],i.N.dot(s,[0,0,1])),p=i.N.scale([],i.N.normalize([],[s[0],s[1],0]),this.radius),y=i.N.add([],s,i.N.scale([],i.N.sub([],i.N.add([],p,h),s),2));s[0]=y[0],s[1]=y[1]}return s}}function Nu(c){return c.panDelta&&c.panDelta.mag()||c.zoomDelta||c.bearingDelta||c.pitchDelta}class Lg{constructor(r,s){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new jr(r),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new cm,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(s),i.aY(["handleEvent","handleWindowEvent"],this);const h=this._el;this._listeners=[[h,"touchstart",{passive:!0}],[h,"touchmove",{passive:!1}],[h,"touchend",void 0],[h,"touchcancel",void 0],[h,"mousedown",void 0],[h,"mousemove",void 0],[h,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[h,"mouseover",void 0],[h,"mouseout",void 0],[h,"dblclick",void 0],[h,"click",void 0],[h,"keydown",{capture:!1}],[h,"keyup",void 0],[h,"wheel",{passive:!1}],[h,"contextmenu",void 0],[window,"blur",void 0]];for(const[p,y,w]of this._listeners){const M=p===document?this.handleWindowEvent:this.handleEvent;p.addEventListener(y,M,w)}}destroy(){for(const[r,s,h]of this._listeners){const p=r===document?this.handleWindowEvent:this.handleEvent;r.removeEventListener(s,p,h)}}_addDefaultHandlers(r){const s=this._map,h=s.getCanvasContainer();this._add("mapEvent",new ff(s,r));const p=s.boxZoom=new nl(s,r);this._add("boxZoom",p);const y=new pf,w=new rm;s.doubleClickZoom=new nm(w,y),this._add("tapZoom",y),this._add("clickZoom",w);const M=new im;this._add("tapDragZoom",M);const C=s.touchPitch=new vf(s);this._add("touchPitch",C);const k=new Ou(r),z=new Rh(r);s.dragRotate=new sm(r,k,z),this._add("mouseRotate",k,["mousePitch"]),this._add("mousePitch",z,["mouseRotate"]);const B=new _f(r),$=new gf(s,r);s.dragPan=new om(h,B,$),this._add("mousePan",B),this._add("touchPan",$,["touchZoom","touchRotate"]);const H=new yf,K=new Ru;s.touchZoomRotate=new am(h,K,H,M),this._add("touchRotate",H,["touchPan","touchZoom"]),this._add("touchZoom",K,["touchPan","touchRotate"]),this._add("blockableMapEvent",new tl(s));const X=s.scrollZoom=new tm(s,this);this._add("scrollZoom",X,["mousePan"]);const Q=s.keyboard=new zu;this._add("keyboard",Q);for(const Z of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[Z]&&s[Z].enable(r[Z])}_add(r,s,h){this._handlers.push({handlerName:r,handler:s,allowed:h}),this._handlersById[r]=s}stop(r){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Bu(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(r,s,h){for(const p in r)if(p!==h&&(!s||s.indexOf(p)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const s=[];for(const h of r)this._el.contains(h.target)&&s.push(h);return s}handleEvent(r,s){this._updatingCamera=!0;const h=r.type==="renderFrame",p=h?void 0:r,y={needsRenderFrame:!1},w={},M={},C=r.touches?this._getMapTouches(r.touches):void 0,k=C?He(this._el,C):h?void 0:Be(this._el,r);for(const{handlerName:$,handler:H,allowed:K}of this._handlers){if(!H.isEnabled())continue;let X;this._blockedByActive(M,K,$)?H.reset():H[s||r.type]&&(X=H[s||r.type](r,k,C),this.mergeHandlerResult(y,w,X,$,p),X&&X.needsRenderFrame&&this._triggerRenderFrame()),(X||H.isActive())&&(M[$]=H)}const z={};for(const $ in this._previousActiveHandlers)M[$]||(z[$]=p);this._previousActiveHandlers=M,(Object.keys(z).length||Nu(y))&&(this._changes.push([y,w,z]),this._triggerRenderFrame()),(Object.keys(M).length||Nu(y))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:B}=y;B&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],B(this._map))}mergeHandlerResult(r,s,h,p,y){if(!h)return;i.e(r,h);const w={handlerName:p,originalEvent:h.originalEvent||y};h.zoomDelta!==void 0&&(s.zoom=w),h.panDelta!==void 0&&(s.drag=w),h.pitchDelta!==void 0&&(s.pitch=w),h.bearingDelta!==void 0&&(s.rotate=w)}_applyChanges(){const r={},s={},h={};for(const[p,y,w]of this._changes)p.panDelta&&(r.panDelta=(r.panDelta||new i.P(0,0))._add(p.panDelta)),p.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+p.zoomDelta),p.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+p.bearingDelta),p.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+p.pitchDelta),p.around!==void 0&&(r.around=p.around),p.aroundCoord!==void 0&&(r.aroundCoord=p.aroundCoord),p.pinchAround!==void 0&&(r.pinchAround=p.pinchAround),p.noInertia&&(r.noInertia=p.noInertia),i.e(s,y),i.e(h,w);this._updateMapTransform(r,s,h),this._changes=[]}_updateMapTransform(r,s,h){const p=this._map,y=p.transform,w=ie=>[ie.x,ie.y,ie.z];if((ie=>{const he=this._eventsInProgress.drag;return he&&!this._handlersById[he.handlerName].isActive()})()&&!Nu(r)){const ie=y.zoom;y.cameraElevationReference="sea",this._originalZoom!=null&&y._orthographicProjectionAtLowPitch&&y.projection.name!=="globe"&&y.pitch===0?(y.cameraElevationReference="ground",y.zoom=this._originalZoom):(y.recenterOnTerrain(),y.cameraElevationReference="ground"),ie!==y.zoom&&this._map._update(!0)}if(y._isCameraConstrained&&p._stop(!0),!Nu(r))return void this._fireEvents(s,h,!0);let{panDelta:M,zoomDelta:C,bearingDelta:k,pitchDelta:z,around:B,aroundCoord:$,pinchAround:H}=r;y._isCameraConstrained&&(C>0&&(C=0),y._isCameraConstrained=!1),H!==void 0&&(B=H),(C||(ie=>s[ie]&&!this._eventsInProgress[ie])("drag"))&&B&&(this._dragOrigin=w(y.pointCoordinate3D(B)),this._originalZoom=y.zoom,this._trackingEllipsoid.setup(y._camera.position,this._dragOrigin)),y.cameraElevationReference="sea",p._stop(!0),B=B||p.transform.centerPoint,k&&(y.bearing+=k),z&&(y.pitch+=z),y._updateCameraState();const K=[0,0,0];if(M)if(y.projection.name==="mercator"){const ie=this._trackingEllipsoid.projectRay(y.screenPointToMercatorRay(B).dir),he=this._trackingEllipsoid.projectRay(y.screenPointToMercatorRay(B.sub(M)).dir);K[0]=he[0]-ie[0],K[1]=he[1]-ie[1]}else{const ie=y.pointCoordinate(B);if(y.projection.name==="globe"){M=M.rotate(-y.angle);const he=y._pixelsPerMercatorPixel/y.worldSize;K[0]=-M.x*i.d1(i.au(ie.y))*he,K[1]=-M.y*i.d1(y.center.lat)*he}else{const he=y.pointCoordinate(B.sub(M));ie&&he&&(K[0]=he.x-ie.x,K[1]=he.y-ie.y)}}const X=y.zoom,Q=[0,0,0];if(C){const ie=w($||y.pointCoordinate3D(B)),he={dir:i.N.normalize([],i.N.sub([],ie,y._camera.position))};if(he.dir[2]<0){const se=y.zoomDeltaToMovement(ie,C);i.N.scale(Q,he.dir,se)}}const Z=i.N.add(K,K,Q);y._translateCameraConstrained(Z),C&&Math.abs(y.zoom-X)>1e-4&&y.recenterOnTerrain(),y.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(s,h,!0)}_fireEvents(r,s,h){const p=Bu(this._eventsInProgress),y=Bu(r),w={};for(const z in r){const{originalEvent:B}=r[z];this._eventsInProgress[z]||(w[`${z}start`]=B),this._eventsInProgress[z]=r[z]}!p&&y&&this._fireEvent("movestart",y.originalEvent);for(const z in w)this._fireEvent(z,w[z]);y&&this._fireEvent("move",y.originalEvent);for(const z in r){const{originalEvent:B}=r[z];this._fireEvent(z,B)}const M={};let C;for(const z in this._eventsInProgress){const{handlerName:B,originalEvent:$}=this._eventsInProgress[z];this._handlersById[B].isActive()||(delete this._eventsInProgress[z],C=s[B]||$,M[`${z}end`]=C)}for(const z in M)this._fireEvent(z,M[z]);const k=Bu(this._eventsInProgress);if(h&&(p||y)&&!k){this._updatingCamera=!0;const z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),B=$=>$!==0&&-this._bearingSnap<$&&$<this._bearingSnap;z?(B(z.bearing||this._map.getBearing())&&(z.bearing=0),this._map.easeTo(z,{originalEvent:C})):(this._map.fire(new i.b("moveend",{originalEvent:C})),B(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,s){this._map.fire(new i.b(r,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{this._frameId=void 0,this.handleEvent(new lm("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const um="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Ii extends i.E{constructor(r,s){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=s.bearingSnap,this._respectPrefersReducedMotion=s.respectPrefersReducedMotion!==!1,i.aY(["_renderFrameCallback"],this)}getCenter(){return new i.bn(this.transform.center.lng,this.transform.center.lat)}setCenter(r,s){return this.jumpTo({center:r},s)}panBy(r,s,h){return r=i.P.convert(r).mult(-1),this.panTo(this.transform.center,i.e({offset:r},s),h)}panTo(r,s,h){return this.easeTo(i.e({center:r},s),h)}getZoom(){return this.transform.zoom}setZoom(r,s){return this.jumpTo({zoom:r},s),this}zoomTo(r,s,h){return this.easeTo(i.e({zoom:r},s),h)}zoomIn(r,s){return this.zoomTo(this.getZoom()+1,r,s),this}zoomOut(r,s){return this.zoomTo(this.getZoom()-1,r,s),this}getBearing(){return this.transform.bearing}setBearing(r,s){return this.jumpTo({bearing:r},s),this}getPadding(){return this.transform.padding}setPadding(r,s){return this.jumpTo({padding:r},s),this}rotateTo(r,s,h){return this.easeTo(i.e({bearing:r},s),h)}resetNorth(r,s){return this.rotateTo(0,i.e({duration:1e3},r),s),this}resetNorthPitch(r,s){return this.easeTo(i.e({bearing:0,pitch:0,duration:1e3},r),s),this}snapToNorth(r,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,s):this}getPitch(){return this.transform.pitch}setPitch(r,s){return this.jumpTo({pitch:r},s),this}cameraForBounds(r,s){r=i.ad.convert(r);const h=s&&s.bearing||0,p=s&&s.pitch||0,y=r.getNorthWest(),w=r.getSouthEast();return this._cameraForBounds(this.transform,y,w,h,p,s)}_extendCameraOptions(r){const s={top:0,bottom:0,right:0,left:0};if(typeof(r=i.e({padding:s,offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=="number"){const h=r.padding;r.padding={top:h,bottom:h,right:h,left:h}}return r.padding=i.e(s,r.padding),r}_minimumAABBFrustumDistance(r,s){const h=s.max[0]-s.min[0],p=s.max[1]-s.min[1];return h/p>r.aspect?h/(2*Math.tan(.5*r.fovX)*r.aspect):p/(2*Math.tan(.5*r.fovY)*r.aspect)}_cameraForBoundsOnGlobe(r,s,h,p,y,w){const M=r.clone(),C=this._extendCameraOptions(w);M.bearing=p,M.pitch=y;const k=i.bn.convert(s),z=i.bn.convert(h),B=.5*(k.lat+z.lat),$=.5*(k.lng+z.lng),H=i.d2(B,$),K=i.N.normalize([],H),X=i.N.normalize([],i.N.cross([],K,[0,1,0])),Q=i.N.cross([],X,K),Z=[X[0],X[1],X[2],0,Q[0],Q[1],Q[2],0,K[0],K[1],K[2],0,0,0,0,1],ie=[H,i.d2(k.lat,k.lng),i.d2(z.lat,k.lng),i.d2(z.lat,z.lng),i.d2(k.lat,z.lng),i.d2(B,k.lng),i.d2(B,z.lng),i.d2(k.lat,$),i.d2(z.lat,$)];let he=i.bS.fromPoints(ie.map(Ze=>[i.N.dot(X,Ze),i.N.dot(Q,Ze),i.N.dot(K,Ze)]));const se=i.N.transformMat4([],he.center,Z);i.N.squaredLength(se)===0&&i.N.set(se,0,0,1),i.N.normalize(se,se),i.N.scale(se,se,i.ab),M.center=i.d3(se);const de=M.getWorldToCameraMatrix(),ne=i.a6.invert(new Float64Array(16),de);he=i.bS.applyTransform(he,i.a6.multiply([],de,Z)),i.N.transformMat4(se,se,de);const pe=.5*(he.max[2]-he.min[2]),Se=this._minimumAABBFrustumDistance(M,he),Ae=i.N.scale([],[0,0,1],pe),Le=i.N.add(Ae,se,Ae),et=Se+(M.pitch===0?0:i.N.distance(se,Le)),je=M.globeCenterInViewSpace,dt=i.N.sub([],se,[je[0],je[1],je[2]]);i.N.normalize(dt,dt),i.N.scale(dt,dt,et);const at=i.N.add([],se,dt);i.N.transformMat4(at,at,ne);const At=i.d4/i.ab,$e=i.N.length(at),ot=i.bl(Math.max($e*At-i.d4,Number.EPSILON),0),ke=Math.min(M.zoomFromMercatorZAdjusted(ot),C.maxZoom);return ke>.5*(i.bG+i.bx)?(M.setProjection({name:"mercator"}),M.zoom=ke,this._cameraForBounds(M,s,h,p,y,w)):{center:M.center,zoom:ke,bearing:p,pitch:y}}queryTerrainElevation(r,s){const h=this.transform.elevation;return h?(s=i.e({},{exaggerated:!0},s),h.getAtPoint(i.L.fromLngLat(r),null,s.exaggerated)):null}_cameraForBounds(r,s,h,p,y,w){if(r.projection.name==="globe")return this._cameraForBoundsOnGlobe(r,s,h,p,y,w);const M=r.clone(),C=this._extendCameraOptions(w),k=M.padding;M.bearing=p,M.pitch=y;const z=i.bn.convert(s),B=i.bn.convert(h),$=new i.bn(z.lng,B.lat),H=new i.bn(B.lng,z.lat),K=M.project(z),X=M.project(B),Q=this.queryTerrainElevation(z),Z=this.queryTerrainElevation(B),ie=this.queryTerrainElevation($),he=this.queryTerrainElevation(H),se=[[K.x,K.y,Math.min(Q||0,Z||0,ie||0,he||0)],[X.x,X.y,Math.max(Q||0,Z||0,ie||0,he||0)]];let de=i.bS.fromPoints(se);const ne=M.getWorldToCameraMatrix(),pe=i.a6.invert(new Float64Array(16),ne);de=i.bS.applyTransform(de,ne);const Se=i.N.sub([],de.max,de.min),Ae=k.left||0,Le=k.right||0,et=k.bottom||0,je=k.top||0,{left:dt,right:at,top:At,bottom:$e}=C.padding,ot=.5*(Ae+Le),ke=.5*(je+et),Ze=Math.min(M.scaleZoom(M.scale*Math.min((M.width-(Ae+Le+dt+at))/Se[0],(M.height-(et+je+$e+At))/Se[1])),C.maxZoom),Pt=M.scale/M.zoomScale(Ze);de=new i.bS([de.min[0]-(dt+ot)*Pt,de.min[1]-($e+ke)*Pt,de.min[2]],[de.max[0]+(at+ot)*Pt,de.max[1]+(At+ke)*Pt,de.max[2]]);const Bt=.5*Se[2],Ft=this._minimumAABBFrustumDistance(M,de),Xt=[0,0,1,0];i.a7.transformMat4(Xt,Xt,ne),i.a7.normalize(Xt,Xt);const un=i.N.scale([],Xt,Ft+Bt),vn=i.N.add([],de.center,un),pn=(typeof C.offset.x=="number"&&typeof C.offset.y=="number"?new i.P(C.offset.x,C.offset.y):i.P.convert(C.offset)).rotate(-i.bj(p));de.center[0]-=pn.x*Pt,de.center[1]+=pn.y*Pt,i.N.transformMat4(de.center,de.center,pe),i.N.transformMat4(vn,vn,pe);const gn=[de.center[0],de.center[1],vn[2]*M.pixelsPerMeter];i.N.scale(gn,gn,1/M.worldSize);const qn=i.at(gn[0]),kn=i.au(gn[1]),Nn=Math.min(M._zoomFromMercatorZ(gn[2]),C.maxZoom),Fn=new i.bn(qn,kn);return M.mercatorFromTransition&&Nn<.5*(i.bG+i.bx)?(M.setProjection({name:"globe"}),M.zoom=Nn,this._cameraForBounds(M,s,h,p,y,w)):{center:Fn,zoom:Nn,bearing:p,pitch:y}}fitBounds(r,s,h){const p=this.cameraForBounds(r,s);return this._fitInternal(p,s,h)}fitScreenCoordinates(r,s,h,p,y){const w=i.P.convert(r),M=i.P.convert(s),C=new i.P(Math.min(w.x,M.x),Math.min(w.y,M.y)),k=new i.P(Math.max(w.x,M.x),Math.max(w.y,M.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(w,M))return this;const z=this.transform.pointLocation3D(C),B=this.transform.pointLocation3D(k),$=this.transform.pointLocation3D(new i.P(C.x,k.y)),H=this.transform.pointLocation3D(new i.P(k.x,C.y)),K=[Math.min(z.lng,B.lng,$.lng,H.lng),Math.min(z.lat,B.lat,$.lat,H.lat)],X=[Math.max(z.lng,B.lng,$.lng,H.lng),Math.max(z.lat,B.lat,$.lat,H.lat)],Q=p&&p.pitch?p.pitch:this.getPitch(),Z=this._cameraForBounds(this.transform,K,X,h,Q,p);return this._fitInternal(Z,p,y)}_fitInternal(r,s,h){return r?(delete(s=i.e(r,s)).padding,s.linear?this.easeTo(s,h):this.flyTo(s,h)):this}jumpTo(r,s){this.stop();const h=r.preloadOnly?this.transform.clone():this.transform;let p=!1,y=!1,w=!1;return"zoom"in r&&h.zoom!==+r.zoom&&(p=!0,h.zoom=+r.zoom),r.center!==void 0&&(h.center=i.bn.convert(r.center)),"bearing"in r&&h.bearing!==+r.bearing&&(y=!0,h.bearing=+r.bearing),"pitch"in r&&h.pitch!==+r.pitch&&(w=!0,h.pitch=+r.pitch),r.padding==null||h.isPaddingEqual(r.padding)||(h.padding=r.padding),r.preloadOnly?(this._preloadTiles(h),this):(this.fire(new i.b("movestart",s)).fire(new i.b("move",s)),p&&this.fire(new i.b("zoomstart",s)).fire(new i.b("zoom",s)).fire(new i.b("zoomend",s)),y&&this.fire(new i.b("rotatestart",s)).fire(new i.b("rotate",s)).fire(new i.b("rotateend",s)),w&&this.fire(new i.b("pitchstart",s)).fire(new i.b("pitch",s)).fire(new i.b("pitchend",s)),this.fire(new i.b("moveend",s)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.w(um),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,s){const h=this.transform;if(!h.projection.supportsFreeCamera)return i.w(um),this;this.stop();const p=h.zoom,y=h.pitch,w=h.bearing;h.setFreeCameraOptions(r);const M=p!==h.zoom,C=y!==h.pitch,k=w!==h.bearing;return this.fire(new i.b("movestart",s)).fire(new i.b("move",s)),M&&this.fire(new i.b("zoomstart",s)).fire(new i.b("zoom",s)).fire(new i.b("zoomend",s)),k&&this.fire(new i.b("rotatestart",s)).fire(new i.b("rotate",s)).fire(new i.b("rotateend",s)),C&&this.fire(new i.b("pitchstart",s)).fire(new i.b("pitch",s)).fire(new i.b("pitchend",s)),this.fire(new i.b("moveend",s)),this}easeTo(r,s){this._stop(!1,r.easeId),((r=i.e({offset:[0,0],duration:500,easing:i.d0},r)).animate===!1||this._prefersReducedMotion(r))&&(r.duration=0);const h=this.transform,p=this.getZoom(),y=this.getBearing(),w=this.getPitch(),M=this.getPadding(),C="zoom"in r?+r.zoom:p,k="bearing"in r?this._normalizeBearing(r.bearing,y):y,z="pitch"in r?+r.pitch:w,B="padding"in r?r.padding:h.padding,$=i.P.convert(r.offset);let H,K,X;if(h.projection.name==="globe"){const Ae=i.L.fromLngLat(h.center),Le=$.rotate(-h.angle);Ae.x+=Le.x/h.worldSize,Ae.y+=Le.y/h.worldSize;const et=Ae.toLngLat(),je=i.bn.convert(r.center||et);this._normalizeCenter(je),H=h.centerPoint.add(Le),K=new i.P(Ae.x,Ae.y).mult(h.worldSize),X=new i.P(i.a5(je.lng),i.ae(je.lat)).mult(h.worldSize).sub(K)}else{H=h.centerPoint.add($);const Ae=h.pointLocation(H),Le=i.bn.convert(r.center||Ae);this._normalizeCenter(Le),K=h.project(Ae),X=h.project(Le).sub(K)}const Q=h.zoomScale(C-p);let Z,ie;r.around&&(Z=i.bn.convert(r.around),ie=h.locationPoint(Z));const he=this._zooming||C!==p,se=this._rotating||y!==k,de=this._pitching||z!==w,ne=!h.isPaddingEqual(B),pe=Ae=>Le=>{if(he&&(Ae.zoom=i.U(p,C,Le)),se&&(Ae.bearing=i.U(y,k,Le)),de&&(Ae.pitch=i.U(w,z,Le)),ne&&(Ae.interpolatePadding(M,B,Le),H=Ae.centerPoint.add($)),Z)Ae.setLocationAtPoint(Z,ie);else{const et=Ae.zoomScale(Ae.zoom-p),je=C>p?Math.min(2,Q):Math.max(.5,Q),dt=Math.pow(je,1-Le),at=Ae.unproject(K.add(X.mult(Le*dt)).mult(et));Ae.setLocationAtPoint(Ae.renderWorldCopies?at.wrap():at,H)}return r.preloadOnly||this._fireMoveEvents(s),Ae};if(r.preloadOnly){const Ae=this._emulate(pe,r.duration,h);return this._preloadTiles(Ae),this}const Se={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=he,this._rotating=se,this._pitching=de,this._easeId=r.easeId,this._prepareEase(s,r.noMoveStart,Se),this._ease(pe(h),Ae=>{h.cameraElevationReference==="sea"&&h.recenterOnTerrain(),this._afterEase(s,Ae)},r),this}_prepareEase(r,s,h={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),s||h.moving||this.fire(new i.b("movestart",r)),this._zooming&&!h.zooming&&this.fire(new i.b("zoomstart",r)),this._rotating&&!h.rotating&&this.fire(new i.b("rotatestart",r)),this._pitching&&!h.pitching&&this.fire(new i.b("pitchstart",r))}_fireMoveEvents(r){this.fire(new i.b("move",r)),this._zooming&&this.fire(new i.b("zoom",r)),this._rotating&&this.fire(new i.b("rotate",r)),this._pitching&&this.fire(new i.b("pitch",r))}_afterEase(r,s){if(this._easeId&&s&&this._easeId===s)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const h=this._zooming,p=this._rotating,y=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,h&&this.fire(new i.b("zoomend",r)),p&&this.fire(new i.b("rotateend",r)),y&&this.fire(new i.b("pitchend",r)),this.fire(new i.b("moveend",r))}flyTo(r,s){if(this._prefersReducedMotion(r)){const $e=i.ac(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo($e,s)}this.stop(),r=i.e({offset:[0,0],speed:1.2,curve:1.42,easing:i.d0},r);const h=this.transform,p=this.getZoom(),y=this.getBearing(),w=this.getPitch(),M="zoom"in r?i.aa(+r.zoom,h.minZoom,h.maxZoom):p,C="bearing"in r?this._normalizeBearing(r.bearing,y):y,k="pitch"in r?+r.pitch:w,z=h.zoomScale(M-p),B=i.P.convert(r.offset),$=h.centerPoint.add(B),H=h.pointLocation($);let K=r.center;if(K&&r.padding){const $e=this._cameraForBounds(this.transform,K,K,C,k,r);$e&&(K=$e.center)}K=i.bn.convert(K||H),this._normalizeCenter(K);const X=h.project(H),Q=h.project(K).sub(X);let Z=r.curve;const ie=Math.max(h.width,h.height),he=ie/z,se=Q.mag();if("minZoom"in r){const $e=i.aa(Math.min(r.minZoom,p,M),h.minZoom,h.maxZoom),ot=ie/h.zoomScale($e-p);Z=Math.sqrt(ot/se*2)}const de=Z*Z;function ne($e){const ot=(he*he-ie*ie+($e?-1:1)*de*de*se*se)/(2*($e?he:ie)*de*se);return Math.log(Math.sqrt(ot*ot+1)-ot)}function pe($e){return(Math.exp($e)-Math.exp(-$e))/2}function Se($e){return(Math.exp($e)+Math.exp(-$e))/2}const Ae=ne(0);let Le=function($e){return Se(Ae)/Se(Ae+Z*$e)},et=function($e){return ie*((Se(Ae)*(pe(ot=Ae+Z*$e)/Se(ot))-pe(Ae))/de)/se;var ot},je=(ne(1)-Ae)/Z;if(Math.abs(se)<1e-6||!isFinite(je)){if(Math.abs(ie-he)<1e-6)return this.easeTo(r,s);const $e=he<ie?-1:1;je=Math.abs(Math.log(he/ie))/Z,et=function(){return 0},Le=function(ot){return Math.exp($e*Z*ot)}}r.duration="duration"in r?+r.duration:1e3*je/("screenSpeed"in r?+r.screenSpeed/Z:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const dt=y!==C,at=k!==w,At=$e=>ot=>{const ke=ot*je,Ze=1/Le(ke);$e.zoom=ot===1?M:p+$e.scaleZoom(Ze),dt&&($e.bearing=i.U(y,C,ot)),at&&($e.pitch=i.U(w,k,ot));const Pt=ot===1?K:$e.unproject(X.add(Q.mult(et(ke))).mult(Ze));return $e.setLocationAtPoint($e.renderWorldCopies?Pt.wrap():Pt,$),$e._updateCameraOnTerrain(),r.preloadOnly||this._fireMoveEvents(s),$e};if(r.preloadOnly){const $e=this._emulate(At,r.duration,h);return this._preloadTiles($e),this}return this._zooming=!0,this._rotating=dt,this._pitching=at,this._prepareEase(s,!1),this._ease(At(h),()=>this._afterEase(s),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,s){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const h=this._onEaseEnd;this._onEaseEnd=void 0,h.call(this,s)}if(!r){const h=this.handlers;h&&h.stop(!1)}return this}_ease(r,s,h){h.animate===!1||h.duration===0?(r(1),s()):(this._easeStart=i.f.now(),this._easeOptions=h,this._onEaseFrame=r,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((i.f.now()-this._easeStart)/this._easeOptions.duration,1),s=this._onEaseFrame;s&&s(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,s){r=i.bh(r,-180,180);const h=Math.abs(r-s);return Math.abs(r-360-s)<h&&(r-=360),Math.abs(r+360-s)<h&&(r+=360),r}_normalizeCenter(r){const s=this.transform;if(s.maxBounds||s.projection.name!=="globe"&&!s.renderWorldCopies)return;const h=r.lng-s.center.lng;r.lng+=h>180?-360:h<-180?360:0}_prefersReducedMotion(r){return this._respectPrefersReducedMotion&&i.f.prefersReducedMotion&&!(r&&r.essential)}_emulate(r,s,h){const p=Math.ceil(15*s/1e3),y=[],w=r(h.clone());for(let M=0;M<=p;M++){const C=w(M/p);y.push(C.clone())}return y}}class wf{constructor(r={}){this.options=r,i.aY(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const s=this.options&&this.options.compact;return this._map=r,this._container=j("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=j("button","mapboxgl-ctrl-attrib-button",this._container),j("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=j("div","mapboxgl-ctrl-attrib-inner",this._container),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),s===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(r,s){const h=this._map._getUIString(`AttributionControl.${s}`);r.removeAttribute("title"),r.firstElementChild&&r.firstElementChild.setAttribute("title",h)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.d5.ACCESS_TOKEN}];if(r){const h=s.reduce((p,y,w)=>(y.value&&(p+=`${y.key}=${y.value}${w<s.length-1?"&":""}`),p),"?");r.href=`${i.d5.FEEDBACK_URL}/${h}#${hf(this._map,!0)}`,r.rel="noopener nofollow",this._setElementTitle(r,"MapFeedback")}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}const s=this._map.style._mergedSourceCaches;for(const p in s){const y=s[p];if(y.used){const w=y.getSource();w.attribution&&r.indexOf(w.attribution)<0&&r.push(w.attribution)}}r.sort((p,y)=>p.length-y.length),r=r.filter((p,y)=>{for(let w=y+1;w<r.length;w++)if(r[w].indexOf(p)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const h=r.join(" | ");h!==this._attribHTML&&(this._attribHTML=h,r.length?(this._innerContainer.innerHTML=h,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class hm{constructor(){i.aY(["_updateLogo","_updateCompact"],this)}onAdd(r){this._map=r,this._container=j("div","mapboxgl-ctrl");const s=j("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const s in r){const h=r[s].getSource();if(h.hasOwnProperty("mapbox_logo")&&!h.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const s=r[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}}}class dm{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const s=++this._id;return this._queue.push({callback:r,id:s,cancelled:!1}),s}remove(r){const s=this._currentlyRunning,h=s?this._queue.concat(s):this._queue;for(const p of h)if(p.id===r)return void(p.cancelled=!0)}run(r=0){const s=this._currentlyRunning=this._queue;this._queue=[];for(const h of s)if(!h.cancelled&&(h.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function ju(c,r,s){if(c=new i.bn(c.lng,c.lat),r){const h=new i.bn(c.lng-360,c.lat),p=new i.bn(c.lng+360,c.lat),y=360*Math.ceil(Math.abs(c.lng-s.center.lng)/360),w=s.locationPoint(c).distSqr(r),M=r.x<0||r.y<0||r.x>s.width||r.y>s.height;s.locationPoint(h).distSqr(r)<w&&(M||Math.abs(h.lng-s.center.lng)<y)?c=h:s.locationPoint(p).distSqr(r)<w&&(M||Math.abs(p.lng-s.center.lng)<y)&&(c=p)}for(;Math.abs(c.lng-s.center.lng)>180;){const h=s.locationPoint(c);if(h.x>=0&&h.y>=0&&h.x<=s.width&&h.y<=s.height)break;c.lng>s.center.lng?c.lng-=360:c.lng+=360}return c}const zh={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Tf extends i.E{constructor(r,s){if(super(),(r instanceof HTMLElement||s)&&(r=i.e({element:r},s)),i.aY(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=r&&r.occludedOpacity||.2,r&&r.element)this._element=r.element,this._offset=i.P.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=j("div");const y=41,w=27,M=W("svg",{display:"block",height:y*this._scale+"px",width:w*this._scale+"px",viewBox:`0 0 ${w} ${y}`},this._element),C=W("radialGradient",{id:"shadowGradient"},W("defs",{},M));W("stop",{offset:"10%","stop-opacity":.4},C),W("stop",{offset:"100%","stop-opacity":.05},C),W("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},M),W("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},M),W("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},M),W("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},M),this._offset=i.P.convert(r&&r.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",y=>{y.preventDefault()}),this._element.addEventListener("mousedown",y=>{y.preventDefault()});const h=this._element.classList;for(const y in zh)h.remove(`mapboxgl-marker-anchor-${y}`);h.add(`mapboxgl-marker-anchor-${this._anchor}`);const p=r&&r.className?r.className.trim().split(/\s+/):[];h.add(...p),this._popup=null}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),r.on("click",this._onMapClick)),this}remove(){const r=this._map;return r&&(r.off("click",this._onMapClick),r.off("move",this._updateMoving),r.off("moveend",this._update),r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler),r.off("mouseup",this._onUp),r.off("touchend",this._onUp),r.off("mousemove",this._onMove),r.off("touchmove",this._onMove),r.off("remove",this._clearFadeTimer),r._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=i.bn.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const p=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[p,-1*(38.1-13.5+p)],"bottom-right":[-p,-1*(38.1-13.5+p)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,r._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const s=r.code,h=r.charCode||r.keyCode;s!=="Space"&&s!=="Enter"&&h!==32&&h!==13||this.togglePopup()}_onMapClick(r){const s=r.originalEvent.target,h=this._element;this._popup&&(s===h||h.contains(s))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const r=this._map,s=this._pos;if(!r||!s)return!1;const h=r.unproject(s),p=r.getFreeCameraOptions();if(!p.position)return!1;const y=p.position.toLngLat();return y.distanceTo(h)<.9*y.distanceTo(this._lngLat)}_evaluateOpacity(){const r=this._map;if(!r)return;const s=this._pos;if(!s||s.x<0||s.x>r.transform.width||s.y<0||s.y>r.transform.height)return void this._clearFadeTimer();const h=r.unproject(s);let p;r._showingGlobe()&&i.d6(r.transform,this._lngLat)?p=0:(p=1-r._queryFogOpacity(h),r.transform._terrainEnabled()&&r.getTerrain()&&this._behindTerrain()&&(p*=this._occludedOpacity)),this._element.style.opacity=`${p}`,this._element.style.pointerEvents=p>0?"auto":"none",this._popup&&this._popup._setOpacity(p),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const r=this._pos;if(!r||!this._map)return;const s=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${r.x}px,${r.y}px)
            ${zh[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${s.x}px,${s.y}px)
        `}_calculateXYTransform(){const r=this._pos,s=this._map,h=this.getPitchAlignment();if(!s||!r||h!=="map")return"";if(!s._showingGlobe()){const C=s.getPitch();return C?`rotateX(${C}deg)`:""}const p=i.bF(i.d7(s.transform,this._lngLat)),y=r.sub(i.d8(s.transform)),w=Math.abs(y.x)+Math.abs(y.y);if(w===0)return"";const M=p/w;return`rotateX(${-y.y*M}deg) rotateY(${y.x*M}deg)`}_calculateZTransform(){const r=this._pos,s=this._map;if(!s||!r)return"";let h=0;const p=this.getRotationAlignment();if(p==="map")if(s._showingGlobe()){const y=s.project(new i.bn(this._lngLat.lng,this._lngLat.lat+.001)),w=s.project(new i.bn(this._lngLat.lng,this._lngLat.lat-.001)).sub(y);h=i.bF(Math.atan2(w.y,w.x))-90}else h=-s.getBearing();else if(p==="horizon"){const y=i.O(4,6,s.getZoom()),w=i.d8(s.transform);w.y+=y*s.transform.height;const M=r.sub(w),C=i.bF(Math.atan2(M.y,M.x));h=(C>90?C-270:C+90)*(1-y)}return h+=this._rotation,h?`rotateZ(${h}deg)`:""}_update(r){cancelAnimationFrame(this._updateFrameId);const s=this._map;s&&(s.transform.renderWorldCopies&&(this._lngLat=ju(this._lngLat,this._pos,s.transform)),this._pos=s.project(this._lngLat),r===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),s._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(s._showingGlobe()||s.getTerrain()||s.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(r){return this._offset=i.P.convert(r),this._update(),this}addClassName(r){return this._element.classList.add(r),this}removeClassName(r){return this._element.classList.remove(r),this}toggleClassName(r){return this._element.classList.toggle(r)}_onMove(r){const s=this._map;if(!s)return;const h=this._pointerdownPos,p=this._positionDelta;if(h&&p){if(!this._isDragging){const y=this._clickTolerance||s._clickTolerance;if(r.point.dist(h)<y)return;this._isDragging=!0}this._pos=r.point.sub(p),this._lngLat=s.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.b("dragstart"))),this.fire(new i.b("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const r=this._map;r&&(r.off("mousemove",this._onMove),r.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.b("dragend")),this._state="inactive"}_addDragHandler(r){const s=this._map,h=this._pos;s&&h&&this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(h),this._pointerdownPos=r.point,this._state="pending",s.on("mousemove",this._onMove),s.on("touchmove",this._onMove),s.once("mouseup",this._onUp),s.once("touchend",this._onUp))}setDraggable(r){this._draggable=!!r;const s=this._map;return s&&(r?(s.on("mousedown",this._addDragHandler),s.on("touchstart",this._addDragHandler)):(s.off("mousedown",this._addDragHandler),s.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(r){return this._occludedOpacity=r||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const fm={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},pm=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function mm(c=new i.P(0,0),r="bottom"){if(typeof c=="number"){const s=Math.round(Math.sqrt(.5*Math.pow(c,2)));switch(r){case"top":return new i.P(0,c);case"top-left":return new i.P(s,s);case"top-right":return new i.P(-s,s);case"bottom":return new i.P(0,-c);case"bottom-left":return new i.P(s,-s);case"bottom-right":return new i.P(-s,-s);case"left":return new i.P(c,0);case"right":return new i.P(-c,0)}return new i.P(0,0)}return c instanceof i.P||Array.isArray(c)?i.P.convert(c):i.P.convert(c[r]||[0,0])}class Ef{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const s=i.cc((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-s)+this._end*s}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,s,h){this._start=this.getValue(s),this._end=r,this._startTime=s,this._endTime=s+h}}const Vu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},_m={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1};class Sf{constructor(){this.showOverdrawInspector=!1,this.showTileBoundaries=!1,this.showParseStatus=!1,this.continuousRedraw=!1,this.showTileAABBs=!1,this.showPadding=!1,this.showTerrainWireframe=!1,this.showLayers2DWireframe=!1,this.showLayers3DWireframe=!1}}const Fh={showCompass:!0,showZoom:!0,visualizePitch:!1};class Ea{constructor(r,s,h=!1){this._clickTolerance=10,this.element=s,this.mouseRotate=new Ou({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,h&&(this.mousePitch=new Rh({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),i.aY(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),s.addEventListener("mousedown",this.mousedown),s.addEventListener("touchstart",this.touchstart,{passive:!1}),s.addEventListener("touchmove",this.touchmove),s.addEventListener("touchend",this.touchend),s.addEventListener("touchcancel",this.reset)}down(r,s){this.mouseRotate.mousedown(r,s),this.mousePitch&&this.mousePitch.mousedown(r,s),we()}move(r,s){const h=this.map,p=this.mouseRotate.mousemoveWindow(r,s),y=p&&p.bearingDelta;if(y&&h.setBearing(h.getBearing()+y),this.mousePitch){const w=this.mousePitch.mousemoveWindow(r,s),M=w&&w.pitchDelta;M&&h.setPitch(h.getPitch()+M)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart,{passive:!1}),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ye(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(i.e({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),Be(this.element,r)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,Be(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=He(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=He(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Bh={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},So={maxWidth:100,unit:"metric"},il={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"};return{version:i.dk,supported:O,setRTLTextPlugin:i.dm,getRTLTextPluginStatus:i.dn,Map:class extends Ii{constructor(c){const r=c;if((c=i.e({},_m,c)).minZoom!=null&&c.maxZoom!=null&&c.minZoom>c.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(c.minPitch!=null&&c.maxPitch!=null&&c.minPitch>c.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(c.minPitch!=null&&c.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(c.maxPitch!=null&&c.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(c.antialias&&i.d9(window)&&(c.antialias=!1,i.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new er(c.minZoom,c.maxZoom,c.minPitch,c.maxPitch,c.renderWorldCopies),c),this._repaint=!1,this._interactive=c.interactive,this._minTileCacheSize=c.minTileCacheSize,this._maxTileCacheSize=c.maxTileCacheSize,this._failIfMajorPerformanceCaveat=c.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=c.preserveDrawingBuffer,this._antialias=c.antialias,this._trackResize=c.trackResize,this._bearingSnap=c.bearingSnap,this._refreshExpiredTiles=c.refreshExpiredTiles,this._fadeDuration=c.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=c.crossSourceCollisions,this._collectResourceTiming=c.collectResourceTiming,this._language=this._parseLanguage(c.language),this._worldview=c.worldview,this._renderTaskQueue=new dm,this._domRenderTaskQueue=new dm,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.aC(),this._locale=i.e({},Vu,c.locale),this._clickTolerance=c.clickTolerance,this._cooperativeGestures=c.cooperativeGestures,this._performanceMetricsCollection=c.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Ef(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new i.da(c.transformRequest,c.accessToken,c.testMode),this._silenceAuthErrors=!!c.testMode,this._contextCreateOptions=c.contextCreateOptions?{...c.contextCreateOptions}:{},typeof c.container=="string"){const s=document.getElementById(c.container);if(!s)throw new Error(`Container '${c.container.toString()}' not found.`);this._container=s}else{if(!(c.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=c.container}if(this._container.childNodes.length>0&&i.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),c.maxBounds&&this.setMaxBounds(c.maxBounds),i.aY(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._debugParams=new Sf,this._tp=c.devtools?new Au(this):new Au,this._tp.registerParameter(this._debugParams,["Debug"],"showOverdrawInspector",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug"],"showTileBoundaries",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug"],"showParseStatus",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug"],"continuousRedraw",void 0,s=>{this.repaint=s}),this._tp.registerParameter(this._debugParams,["Debug"],"showTileAABBs",void 0,s=>{this.showTileAABBs=s}),this._tp.registerParameter(this._debugParams,["Debug"],"showPadding",void 0,s=>{this.showPadding=s}),this._tp.registerParameter(this._debugParams,["Debug","Wireframe"],"showTerrainWireframe",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug","Wireframe"],"showLayers2DWireframe",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug","Wireframe"],"showLayers3DWireframe",void 0,()=>{this._update()}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Lg(this,c),this._localFontFamily=c.localFontFamily,this._localIdeographFontFamily=c.localIdeographFontFamily,(c.style||!c.testMode)&&this.setStyle(c.style||i.d5.DEFAULT_STYLE,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),c.projection&&this.setProjection(c.projection),c.hash&&(this._hash=new Dh(typeof c.hash=="string"&&c.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){r.center==null&&r.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:c.center,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch});const s=c.bounds;s&&(this.resize(),this.fitBounds(s,i.e({},c.fitBoundsOptions,{duration:0})))}this.resize(),c.attributionControl&&this.addControl(new wf({customAttribution:c.customAttribution})),this._logoControl=new hm,this.addControl(this._logoControl,c.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",s=>{this._update(s.dataType==="style"),this.fire(new i.b(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new i.b(`${s.dataType}dataloading`,s))})}_getMapId(){return this._mapId}addControl(c,r){if(r===void 0&&(r=c.getDefaultPosition?c.getDefaultPosition():"top-right"),!c||!c.onAdd)return this.fire(new i.a(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=c.onAdd(this);this._controls.push(c);const h=this._controlPositions[r];return r.indexOf("bottom")!==-1?h.insertBefore(s,h.firstChild):h.appendChild(s),this}removeControl(c){if(!c||!c.onRemove)return this.fire(new i.a(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(c);return r>-1&&this._controls.splice(r,1),c.onRemove(this),this}hasControl(c){return this._controls.indexOf(c)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(c){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new i.b("movestart",c)).fire(new i.b("move",c)),this.fire(new i.b("resize",c)),r&&this.fire(new i.b("moveend",c)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(c){return this.transform.setMaxBounds(i.ad.convert(c)),this._update()}setMinZoom(c){if((c=c??-2)>=-2&&c<=this.transform.maxZoom)return this.transform.minZoom=c,this._update(),this.getZoom()<c?this.setZoom(c):this.fire(new i.b("zoomstart")).fire(new i.b("zoom")).fire(new i.b("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(c){if((c=c??22)>=this.transform.minZoom)return this.transform.maxZoom=c,this._update(),this.getZoom()>c?this.setZoom(c):this.fire(new i.b("zoomstart")).fire(new i.b("zoom")).fire(new i.b("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(c){if((c=c??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(c>=0&&c<=this.transform.maxPitch)return this.transform.minPitch=c,this._update(),this.getPitch()<c?this.setPitch(c):this.fire(new i.b("pitchstart")).fire(new i.b("pitch")).fire(new i.b("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(c){if((c=c??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(c>=this.transform.minPitch)return this.transform.maxPitch=c,this._update(),this.getPitch()>c?this.setPitch(c):this.fire(new i.b("pitchstart")).fire(new i.b("pitch")).fire(new i.b("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(c){return this.transform.renderWorldCopies=c,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(c){return c==="auto"?navigator.language:Array.isArray(c)?c.length===0?void 0:c.map(r=>r==="auto"?navigator.language:r):c}setLanguage(c){const r=this._parseLanguage(c);if(!this.style||r===this._language)return this;this._language=r,this.style.reloadSources();for(const s of this._controls)s._setLanguage&&s._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(c){return this.style&&c!==this._worldview?(this._worldview=c,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(c){return this._lazyInitEmptyStyle(),c?typeof c=="string"&&(c={name:c}):c=null,this._useExplicitProjection=!!c,this._prioritizeAndUpdateProjection(c,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const c=this.transform,r=c.projection.name;let s;r==="globe"&&c.zoom>=i.bx?(c.setMercatorFromTransition(),s=!0):r==="mercator"&&c.zoom<i.bx&&(c.setProjection({name:"globe"}),s=!0),s&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(c,r){return this._updateProjection(c||r||{name:"mercator"})}_updateProjection(c){let r;return r=c.name==="globe"&&this.transform.zoom>=i.bx?this.transform.setMercatorFromTransition():this.transform.setProjection(c),this.style.applyProjectionUpdate(),r&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(c){return this.transform.locationPoint3D(i.bn.convert(c))}unproject(c){return this.transform.pointLocation3D(i.P.convert(c))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(c,r,s){if(c==="mouseenter"||c==="mouseover"){let h=!1;const p=w=>{const M=r.filter(k=>this.getLayer(k)),C=M.length?this.queryRenderedFeatures(w.point,{layers:M}):[];C.length?h||(h=!0,s.call(this,new zo(c,this,w.originalEvent,{features:C}))):h=!1},y=()=>{h=!1};return{layers:new Set(r),listener:s,delegates:{mousemove:p,mouseout:y}}}if(c==="mouseleave"||c==="mouseout"){let h=!1;const p=w=>{const M=r.filter(C=>this.getLayer(C));(M.length?this.queryRenderedFeatures(w.point,{layers:M}):[]).length?h=!0:h&&(h=!1,s.call(this,new zo(c,this,w.originalEvent)))},y=w=>{h&&(h=!1,s.call(this,new zo(c,this,w.originalEvent)))};return{layers:new Set(r),listener:s,delegates:{mousemove:p,mouseout:y}}}{const h=p=>{const y=r.filter(M=>this.getLayer(M)),w=y.length?this.queryRenderedFeatures(p.point,{layers:y}):[];w.length&&(p.features=w,s.call(this,p),delete p.features)};return{layers:new Set(r),listener:s,delegates:{[c]:h}}}}on(c,r,s){if(s===void 0)return super.on(c,r);if(Array.isArray(r)||(r=[r]),r){for(const p of r)if(!this._isValidId(p))return this}const h=this._createDelegatedListener(c,r,s);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[c]=this._delegatedListeners[c]||[],this._delegatedListeners[c].push(h);for(const p in h.delegates)this.on(p,h.delegates[p]);return this}once(c,r,s){if(s===void 0)return super.once(c,r);if(Array.isArray(r)||(r=[r]),r){for(const p of r)if(!this._isValidId(p))return this}const h=this._createDelegatedListener(c,r,s);for(const p in h.delegates)this.once(p,h.delegates[p]);return this}off(c,r,s){if(s===void 0)return super.off(c,r);r=new Set(Array.isArray(r)?r:[r]);for(const y of r)if(!this._isValidId(y))return this;const h=(y,w)=>{if(y.size!==w.size)return!1;for(const M of y)if(!w.has(M))return!1;return!0},p=this._delegatedListeners?this._delegatedListeners[c]:void 0;return p&&(y=>{for(let w=0;w<y.length;w++){const M=y[w];if(M.listener===s&&h(M.layers,r)){for(const C in M.delegates)this.off(C,M.delegates[C]);return y.splice(w,1),this}}})(p),this}queryRenderedFeatures(c,r){if(!this.style)return[];if(r!==void 0||c===void 0||c instanceof i.P||Array.isArray(c)||(r=c,c=void 0),c=c||[[0,0],[this.transform.width,this.transform.height]],(r=r||{}).layers&&Array.isArray(r.layers)){for(const s of r.layers)if(!this._isValidId(s))return[]}return this.style.queryRenderedFeatures(c,r,this.transform)}querySourceFeatures(c,r){return this._isValidId(c)?this.style.querySourceFeatures(c,r):[]}isPointOnSurface(c){const{name:r}=this.transform.projection;return r!=="globe"&&r!=="mercator"&&i.w(`${r} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.P.convert(c))}setStyle(c,r){return(r=i.e({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&r.localFontFamily===this._localFontFamily&&this.style&&c?(this._diffStyle(c,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(c,r))}_getUIString(c){const r=this._locale[c];if(r==null)throw new Error(`Missing UI string '${c}'`);return r}_updateStyle(c,r){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),c&&(this.style=new ao(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof c=="string"?this.style.loadURL(c):this.style.loadJSON(c)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ao(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(c,r){if(typeof c=="string"){const s=this._requestManager.normalizeStyleURL(c),h=this._requestManager.transformRequest(s,i.R.Style);i.g(h,(p,y)=>{p?this.fire(new i.a(p)):y&&this._updateDiff(y,r)})}else typeof c=="object"&&this._updateDiff(c,r)}_updateDiff(c,r){try{this.style.setState(c)&&this._update(!0)}catch(s){i.w(`Unable to perform style diff: ${s.message||s.error||s}.  Rebuilding the style from scratch.`),this._updateStyle(c,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.w("There is no style added to the map."),!1)}_isValidId(c){return c==null?(this.fire(new i.a(new Error("IDs can't be empty."))),!1):!i.c4(c)||(this.fire(new i.a(new Error(`IDs can't contain special symbols: "${c}".`))),!1)}addSource(c,r){return this._isValidId(c)?(this._lazyInitEmptyStyle(),this.style.addSource(c,r),this._update(!0)):this}isSourceLoaded(c){return!!this._isValidId(c)&&!!this.style&&this.style._isSourceCacheLoaded(c)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(c,r,s){this._lazyInitEmptyStyle(),this.style.addSourceType(c,r,s)}removeSource(c){return this._isValidId(c)?(this.style.removeSource(c),this._updateTerrain(),this._update(!0)):this}getSource(c){return this._isValidId(c)?this.style.getOwnSource(c):null}addImage(c,r,{pixelRatio:s=1,sdf:h=!1,stretchX:p,stretchY:y,content:w}={}){if(this._lazyInitEmptyStyle(),r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap){const{width:M,height:C,data:k}=i.f.getImageData(r);this.style.addImage(c,{data:new i.h({width:M,height:C},k),pixelRatio:s,stretchX:p,stretchY:y,content:w,sdf:h,version:0})}else if(r.width===void 0||r.height===void 0)this.fire(new i.a(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:M,height:C}=r,k=r;this.style.addImage(c,{data:new i.h({width:M,height:C},new Uint8Array(k.data)),pixelRatio:s,stretchX:p,stretchY:y,content:w,sdf:h,version:0,userImage:k}),k.onAdd&&k.onAdd(this,c)}}updateImage(c,r){this._lazyInitEmptyStyle();const s=this.style.getImage(c);if(!s)return void this.fire(new i.a(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const h=r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap?i.f.getImageData(r):r,{width:p,height:y}=h,w=h.data;if(p===void 0||y===void 0)return void this.fire(new i.a(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(p!==s.data.width||y!==s.data.height)return void this.fire(new i.a(new Error(`The width and height of the updated image (${p}, ${y})
                must be that same as the previous version of the image
                (${s.data.width}, ${s.data.height})`)));const M=!(r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap);s.data.replace(w,M),this.style.updateImage(c,s)}hasImage(c){return c?!!this.style&&!!this.style.getImage(c):(this.fire(new i.a(new Error("Missing required image id"))),!1)}removeImage(c){this.style.removeImage(c)}loadImage(c,r){i.d(this._requestManager.transformRequest(c,i.R.Image),(s,h)=>{r(s,h instanceof HTMLImageElement?i.f.getImageData(h):h)})}listImages(){return this.style.listImages()}addModel(c,r){this._lazyInitEmptyStyle(),this.style.addModel(c,r)}hasModel(c){return c?this.style.hasModel(c):(this.fire(new i.a(new Error("Missing required model id"))),!1)}removeModel(c){this.style.removeModel(c)}listModels(){return this.style.listModels()}addLayer(c,r){return this._isValidId(c.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(c,r),this._update(!0)):this}getSlot(c){const r=this.getLayer(c);return r&&r.slot||null}setSlot(c,r){return this.style.setSlot(c,r),this.style.mergeLayers(),this._update(!0)}addImport(c,r){return this.style.addImport(c,r),this}updateImport(c,r){return typeof r!="string"&&r.id!==c?(this.removeImport(c),this.addImport(r)):(this.style.updateImport(c,r),this._update(!0))}removeImport(c){return this.style.removeImport(c),this}moveImport(c,r){return this.style.moveImport(c,r),this._update(!0)}moveLayer(c,r){return this._isValidId(c)?(this.style.moveLayer(c,r),this._update(!0)):this}removeLayer(c){return this._isValidId(c)?(this.style.removeLayer(c),this._update(!0)):this}getLayer(c){return this._isValidId(c)?this.style.getOwnLayer(c):null}setLayerZoomRange(c,r,s){return this._isValidId(c)?(this.style.setLayerZoomRange(c,r,s),this._update(!0)):this}setFilter(c,r,s={}){return this._isValidId(c)?(this.style.setFilter(c,r,s),this._update(!0)):this}getFilter(c){return this._isValidId(c)?this.style.getFilter(c):null}setPaintProperty(c,r,s,h={}){return this._isValidId(c)?(this.style.setPaintProperty(c,r,s,h),this._update(!0)):this}getPaintProperty(c,r){return this._isValidId(c)?this.style.getPaintProperty(c,r):null}setLayoutProperty(c,r,s,h={}){return this._isValidId(c)?(this.style.setLayoutProperty(c,r,s,h),this._update(!0)):this}getLayoutProperty(c,r){return this._isValidId(c)?this.style.getLayoutProperty(c,r):null}getConfigProperty(c,r){return this.style.getConfigProperty(c,r)}setConfigProperty(c,r,s){return this.style.setConfigProperty(c,r,s),this._update(!0)}setLights(c){if(this._lazyInitEmptyStyle(),c&&c.length===1&&c[0].type==="flat"){const r=c[0];r.properties?this.style.setFlatLight(r.properties,r.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(c),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const c=this.style.getLights()||[];return c.length===0&&c.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),c}setLight(c,r={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:c}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(c){return this._lazyInitEmptyStyle(),!c&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(c),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(c){return this._lazyInitEmptyStyle(),this.style.setFog(c),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setCamera(c){return this.style.setCamera(c),this._triggerCameraUpdate(c)}_triggerCameraUpdate(c){return this._update(this.transform.setOrthographicProjectionAtLowPitch(c["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(c){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.bn.convert(c),this.transform):0}setFeatureState(c,r){return this._isValidId(c.source)?(this.style.setFeatureState(c,r),this._update()):this}removeFeatureState(c,r){return this._isValidId(c.source)?(this.style.removeFeatureState(c,r),this._update()):this}getFeatureState(c){return this._isValidId(c.source)?this.style.getFeatureState(c):null}_updateContainerDimensions(){if(!this._container)return;const c=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let s,h,p,y=this._container;for(;y&&(!h||!p);){const w=window.getComputedStyle(y).transform;w&&w!=="none"&&(s=w.match(/matrix.*\((.+)\)/)[1].split(", "),s[0]&&s[0]!=="0"&&s[0]!=="1"&&(h=s[0]),s[3]&&s[3]!=="0"&&s[3]!=="1"&&(p=s[3])),y=y.parentElement}this._containerWidth=h?Math.abs(c/h):c,this._containerHeight=p?Math.abs(r/p):r}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const c=this._container;c.classList.add("mapboxgl-map"),(this._missingCSSCanary=j("div","mapboxgl-canary",c)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=j("div","mapboxgl-canvas-container",c);this._canvas=j("canvas","mapboxgl-canvas",r),this._interactive&&(r.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const s=this._controlContainer=j("div","mapboxgl-control-container",c),h=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(p=>{h[p]=j("div",`mapboxgl-ctrl-${p}`,s)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(c,r){const s=i.f.devicePixelRatio||1;this._canvas.width=s*Math.ceil(c),this._canvas.height=s*Math.ceil(r),this._canvas.style.width=`${c}px`,this._canvas.style.height=`${r}px`}_addMarker(c){this._markers.push(c)}_removeMarker(c){const r=this._markers.indexOf(c);r!==-1&&this._markers.splice(r,1)}_addPopup(c){this._popups.push(c)}_removePopup(c){const r=this._popups.indexOf(c);r!==-1&&this._popups.splice(r,1)}_setupPainter(){const c=i.e({},O.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl2",c);r?(i.db(r,!0),this.painter=new em(r,this._contextCreateOptions,this.transform,this._tp),this.on("data",s=>{s.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),i.dc.testSupport(r)):this.fire(new i.a(new Error("Failed to initialize WebGL")))}_contextLost(c){c.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.b("webglcontextlost",{originalEvent:c}))}_contextRestored(c){this._setupPainter(),this.resize(),this._update(),this.fire(new i.b("webglcontextrestored",{originalEvent:c}))}_onMapScroll(c){if(c.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(c){return this.style?(this._styleDirty=this._styleDirty||c,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(c){return this._update(),this._renderTaskQueue.add(c)}_cancelRenderFrame(c){this._renderTaskQueue.remove(c)}_requestDomTask(c){!this.loaded()||this.loaded()&&!this.isMoving()?c():this._domRenderTaskQueue.add(c)}_render(c){let r;this.fire(new i.b("renderstart"));const s=this.painter.context.extTimerQuery,h=i.f.now(),p=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(r=p.createQuery(),p.beginQuery(s.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(c),this._domRenderTaskQueue.run(c),this._removed)return;this._updateProjectionTransition();const y=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const C=this.transform.zoom,k=this.transform.pitch,z=i.f.now(),B=new i.K(C,{now:z,fadeDuration:y,pitch:k,transition:this.style.transition});this.style.update(B)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let w=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),w=this._updateAverageElevation(h),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):w=this._updateAverageElevation(h),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,y,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries||this._debugParams.showTileBoundaries,showParseStatus:this.showParseStatus||this._debugParams.showParseStatus,wireframe:{terrain:this.showTerrainWireframe||this._debugParams.showTerrainWireframe,layers2D:this.showLayers2DWireframe||this._debugParams.showLayers2DWireframe,layers3D:this.showLayers3DWireframe||this._debugParams.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector||this._debugParams.showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs||this._debugParams.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:y,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding||this._debugParams.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.b("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new i.b("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const C=i.f.now()-h;p.endQuery(s.TIME_ELAPSED_EXT),setTimeout(()=>{const k=p.getQueryParameter(r,p.QUERY_RESULT)/1e6;p.deleteQuery(r),this.fire(new i.b("gpu-timing-frame",{cpuTime:C,gpuTime:k}))},50)}if(this.listens("gpu-timing-layer")){const C=this.painter.collectGpuTimers();setTimeout(()=>{const k=this.painter.queryGpuTimers(C);this.fire(new i.b("gpu-timing-layer",{layerTimes:k}))},50)}if(this.listens("gpu-timing-deferred-render")){const C=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const k=this.painter.queryGpuTimeDeferredRender(C);this.fire(new i.b("gpu-timing-deferred-render",{gpuTime:k}))},50)}const M=this._sourcesDirty||this._styleDirty||this._placementDirty||w;if(M||this._repaint)this.triggerRepaint();else{const C=!this.isMoving()&&this.loaded();if(C&&(w=this._updateAverageElevation(h,!0)),w)this.triggerRepaint();else if(this._triggerFrame(!1),C&&(this.fire(new i.b("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const k=this._calculateSpeedIndex();this.fire(new i.b("speedindexcompleted",{speedIndex:k})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||M||(this._fullyLoaded=!0,this._performanceMetricsCollection&&i.dd(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(c){for(const r of this._markers)c&&!this.getRenderWorldCopies()&&(r._lngLat=r._lngLat.wrap()),r._update();for(const r of this._popups)!c||this.getRenderWorldCopies()||r._trackPointer||(r._lngLat=r._lngLat.wrap()),r._update()}_updateAverageElevation(c,r=!1){const s=p=>(this.transform.averageElevation=p,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&s(0);const h=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(h||(r||c-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(c)){const p=this.transform.averageElevation;let y=this.transform.sampleAverageElevation();this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(y)?y=0:this._averageElevationLastSampledAt=c;const w=Math.abs(p-y);if(w>1){if(this._isInitialLoad||h)return this._averageElevation.jumpTo(y),s(y);this._averageElevation.easeTo(y,c,300)}else if(w>1e-4)return this._averageElevation.jumpTo(y),s(y)}return!!this._averageElevation.isEasing(c)&&s(this._averageElevation.getValue(c))}_authenticate(){i.de(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,c=>{if(c&&(c.message===i.df||c.status===401)){const r=this.painter.context.gl;i.db(r,!1),this._logoControl instanceof hm&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.a(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),i.dg(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const c=this._isDragging();this.painter.updateTerrain(this.style,c)}_calculateSpeedIndex(){const c=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const s=this.painter.context.gl,h=s.createFramebuffer();function p(y){s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,y,0);const w=new Uint8Array(s.drawingBufferWidth*s.drawingBufferHeight*4);return s.readPixels(0,0,s.drawingBufferWidth,s.drawingBufferHeight,s.RGBA,s.UNSIGNED_BYTE,w),w}return s.bindFramebuffer(s.FRAMEBUFFER,h),this._canvasPixelComparison(p(c),r.canvasCopies.map(p),r.timeStamps)}_canvasPixelComparison(c,r,s){let h=s[1]-s[0];const p=c.length/4;for(let y=0;y<r.length;y++){const w=r[y];let M=0;for(let C=0;C<w.length;C+=4)w[C]===c[C]&&w[C+1]===c[C+1]&&w[C+2]===c[C+2]&&w[C+3]===c[C+3]&&(M+=1);h+=(s[y+2]-s[y+1])*(1-M/p)}return h}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const c=this.painter.context.gl.getExtension("WEBGL_lose_context");c&&c.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),i.dh(this.painter.context.gl),i.di.remove(),i.dj.remove(),this._removed=!0,this.fire(new i.b("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(c){this._renderNextFrame=this._renderNextFrame||c,this.style&&!this._frame&&(this._frame=i.f.frame(r=>{const s=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,s&&this._render(r)}))}_preloadTiles(c){const r=this.style?Object.values(this.style._sourceCaches):[];return i.b1(r,(s,h)=>s._preloadTiles(c,h),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(c){this._trackResize&&this.resize({originalEvent:c})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(c){this._showTileBoundaries!==c&&(this._showTileBoundaries=c,this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(c){this._showParseStatus!==c&&(this._showParseStatus=c,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(c){this._showTerrainWireframe!==c&&(this._showTerrainWireframe=c,this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(c){this._showLayers2DWireframe!==c&&(this._showLayers2DWireframe=c,this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(c){this._showLayers3DWireframe!==c&&(this._showLayers3DWireframe=c,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(c){this._speedIndexTiming!==c&&(this._speedIndexTiming=c,this._update())}get showPadding(){return!!this._showPadding}set showPadding(c){this._showPadding!==c&&(this._showPadding=c,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(c){this._showCollisionBoxes!==c&&(this._showCollisionBoxes=c,c?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(c){this._showOverdrawInspector!==c&&(this._showOverdrawInspector=c,this._update())}get repaint(){return!!this._repaint}set repaint(c){this._repaint!==c&&(this._repaint=c,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(c){this._vertices=c,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(c){this._showTileAABBs!==c&&(this._showTileAABBs=c,c&&this._update())}_setCacheLimits(c,r){i.dl(c,r)}get version(){return i.dk}},NavigationControl:class{constructor(c){this.options=i.e({},Fh,c),this._container=j("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(i.aY(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>{this._map&&this._map.zoomIn({},{originalEvent:r})}),j("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>{this._map&&this._map.zoomOut({},{originalEvent:r})}),j("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.aY(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{const s=this._map;s&&(this.options.visualizePitch?s.resetNorthPitch({},{originalEvent:r}):s.resetNorth({},{originalEvent:r}))}),this._compassIcon=j("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const c=this._map;if(!c)return;const r=c.getZoom(),s=r===c.getMaxZoom(),h=r===c.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=h,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",h.toString())}_rotateCompassArrow(){const c=this._map;if(!c)return;const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(c.transform.pitch*(Math.PI/180)),.5)}) rotateX(${c.transform.pitch}deg) rotateZ(${c.transform.angle*(180/Math.PI)}deg)`:`rotate(${c.transform.angle*(180/Math.PI)}deg)`;c._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=r)})}onAdd(c){return this._map=c,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),c.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&c.on("pitch",this._rotateCompassArrow),c.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ea(c,this._compass,this.options.visualizePitch)),this._container}onRemove(){const c=this._map;c&&(this._container.remove(),this.options.showZoom&&c.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&c.off("pitch",this._rotateCompassArrow),c.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(c,r){const s=j("button",c,this._container);return s.type="button",s.addEventListener("click",r),s}_setButtonTitle(c,r){if(!this._map)return;const s=this._map._getUIString(`NavigationControl.${r}`);c.setAttribute("aria-label",s),c.firstElementChild&&c.firstElementChild.setAttribute("title",s)}},GeolocateControl:class extends i.E{constructor(c){super();const r=navigator.geolocation;this.options=i.e({geolocation:r},Bh,c),i.aY(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Cu(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(c){return this._map=c,this._container=j("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(c){const r=(s=!!this.options.geolocation)=>{this._supportsGeolocation=s,c(s)};this._supportsGeolocation!==void 0?c(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(s=>r(s.state!=="denied")).catch(()=>r()):r()}_isOutOfMapMaxBounds(c){const r=this._map.getMaxBounds(),s=c.coords;return!!r&&(s.longitude<r.getWest()||s.longitude>r.getEast()||s.latitude<r.getSouth()||s.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(c){if(this._map){if(this._isOutOfMapMaxBounds(c))return this._setErrorState(),this.fire(new i.b("outofmaxbounds",c)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=c,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(c),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(c),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.b("geolocate",c)),this._finish()}}_updateCamera(c){const r=new i.bn(c.coords.longitude,c.coords.latitude),s=c.coords.accuracy,h=this._map.getBearing(),p=i.e({bearing:h},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(s),p,{geolocateSource:!0})}_updateMarker(c){if(c){const r=new i.bn(c.coords.longitude,c.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=c.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const c=this._map.transform,r=i.bl(1,c._center.lat)*c.worldSize,s=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${s}px`,this._circleElement.style.height=`${s}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(c){if(this._map){if(this.options.trackUserLocation)if(c.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(c.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.b("error",c)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(c){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=j("button","mapboxgl-ctrl-geolocate",this._container),j("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",c===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=j("div","mapboxgl-user-location"),this._dotElement.appendChild(j("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(j("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Tf({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=j("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Tf({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.b("trackuserlocationend")))})}}_onDeviceOrientation(c){this._userLocationDotMarker&&(c.webkitCompassHeading?this._heading=c.webkitCompassHeading:c.absolute===!0&&(this._heading=-1*c.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.b("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.b("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.b("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let c;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(c={maximumAge:6e5,timeout:0},this._noTimeout=!0):(c=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,c),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const c=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&c()}).catch(console.error):c()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:wf,ScaleControl:class{constructor(c){this.options=i.e({},So,c),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),i.aY(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const c=this.options.maxWidth||100,r=this._map,s=r._containerHeight/2,h=r._containerWidth/2-c/2,p=r.unproject([h,s]),y=r.unproject([h+c,s]),w=p.distanceTo(y);if(this.options.unit==="imperial"){const M=3.2808*w;M>5280?this._setScale(c,M/5280,"mile"):this._setScale(c,M,"foot")}else this.options.unit==="nautical"?this._setScale(c,w/1852,"nautical-mile"):w>=1e3?this._setScale(c,w/1e3,"kilometer"):this._setScale(c,w,"meter")}_setScale(c,r,s){this._map._requestDomTask(()=>{const h=function(y){const w=Math.pow(10,`${Math.floor(y)}`.length-1);let M=y/w;return M=M>=10?10:M>=5?5:M>=3?3:M>=2?2:M>=1?1:function(C){const k=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10));return Math.round(C*k)/k}(M),w*M}(r),p=h/r;this._container.innerHTML=this._isNumberFormatSupported&&s!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:s}).format(h):`${h}&nbsp;${il[s]}`,this._container.style.width=c*p+"px"})}onAdd(c){return this._map=c,this._language=c.getLanguage(),this._container=j("div","mapboxgl-ctrl mapboxgl-ctrl-scale",c.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(c){this._language=c,this._update()}setUnit(c){this.options.unit=c,this._update()}},FullscreenControl:class{constructor(c){this._fullscreen=!1,c&&c.container&&(c.container instanceof HTMLElement?this._container=c.container:i.w("Full screen control 'container' must be a DOM element.")),i.aY(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(c){return this._map=c,this._container||(this._container=this._map.getContainer()),this._controlContainer=j("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const c=this._fullscreenButton=j("button","mapboxgl-ctrl-fullscreen",this._controlContainer);j("span","mapboxgl-ctrl-icon",c).setAttribute("aria-hidden","true"),c.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const c=this._getTitle();this._fullscreenButton.setAttribute("aria-label",c),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",c)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends i.E{constructor(c){super(),this.options=i.e(Object.create(fm),c),i.aY(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(c&&c.className?c.className.trim().split(/\s+/):[])}addTo(c){return this._map&&this.remove(),this._map=c,this.options.closeOnClick&&c.on("preclick",this._onClose),this.options.closeOnMove&&c.on("move",this._onClose),c.on("remove",this.remove),this._update(),c._addPopup(this),this._focusFirstElement(),this._trackPointer?(c.on("mousemove",this._onMouseEvent),c.on("mouseup",this._onMouseEvent),c._canvasContainer.classList.add("mapboxgl-track-pointer")):c.on("move",this._update),this.fire(new i.b("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const c=this._map;return c&&(c.off("move",this._update),c.off("move",this._onClose),c.off("preclick",this._onClose),c.off("click",this._onClose),c.off("remove",this.remove),c.off("mousemove",this._onMouseEvent),c.off("mouseup",this._onMouseEvent),c.off("drag",this._onMouseEvent),c._canvasContainer&&c._canvasContainer.classList.remove("mapboxgl-track-pointer"),c._removePopup(this),this._map=void 0),this.fire(new i.b("close")),this}getLngLat(){return this._lngLat}setLngLat(c){this._lngLat=i.bn.convert(c),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const c=this._map;return c&&(c.off("move",this._update),c.on("mousemove",this._onMouseEvent),c.on("drag",this._onMouseEvent),c._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(c){return this.setDOMContent(document.createTextNode(c))}setHTML(c){const r=document.createDocumentFragment(),s=document.createElement("body");let h;for(s.innerHTML=c;h=s.firstChild,h;)r.appendChild(h);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(c){return this.options.maxWidth=c,this._update(),this}setDOMContent(c){let r=this._content;if(r)for(;r.hasChildNodes();)r.firstChild&&r.removeChild(r.firstChild);else r=this._content=j("div","mapboxgl-popup-content",this._container||void 0);if(r.appendChild(c),this.options.closeButton){const s=this._closeButton=j("button","mapboxgl-popup-close-button",r);s.type="button",s.setAttribute("aria-label","Close popup"),s.setAttribute("aria-hidden","true"),s.innerHTML="&#215;",s.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(c){return this._classList.add(c),this._updateClassList(),this}removeClassName(c){return this._classList.delete(c),this._updateClassList(),this}setOffset(c){return this.options.offset=c,this._update(),this}toggleClassName(c){let r;return this._classList.delete(c)?r=!1:(this._classList.add(c),r=!0),this._updateClassList(),r}_onMouseEvent(c){this._update(c.point)}_getAnchor(c){if(this.options.anchor)return this.options.anchor;const r=this._map,s=this._container,h=this._pos;if(!r||!s||!h)return"bottom";const p=s.offsetWidth,y=s.offsetHeight,w=h.x<p/2,M=h.x>r.transform.width-p/2;if(h.y+c<y)return w?"top-left":M?"top-right":"top";if(h.y>r.transform.height-y){if(w)return"bottom-left";if(M)return"bottom-right"}return w?"left":M?"right":"bottom"}_updateClassList(){const c=this._container;if(!c)return;const r=[...this._classList];r.push("mapboxgl-popup"),this._anchor&&r.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&r.push("mapboxgl-popup-track-pointer"),c.className=r.join(" ")}_update(c){const r=this._map,s=this._content;if(!r||!this._lngLat&&!this._trackPointer||!s)return;let h=this._container;if(h||(h=this._container=j("div","mapboxgl-popup",r.getContainer()),this._tip=j("div","mapboxgl-popup-tip",h),h.appendChild(s)),this.options.maxWidth&&h.style.maxWidth!==this.options.maxWidth&&(h.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ju(this._lngLat,this._pos,r.transform)),!this._trackPointer||c){const p=this._pos=this._trackPointer&&c?c:r.project(this._lngLat),y=mm(this.options.offset),w=this._anchor=this._getAnchor(y.y),M=mm(this.options.offset,w),C=p.add(M).round();r._requestDomTask(()=>{this._container&&w&&(this._container.style.transform=`${zh[w]} translate(${C.x}px,${C.y}px)`)})}if(!this._marker&&r._showingGlobe()){const p=i.d6(r.transform,this._lngLat)?0:1;this._setOpacity(p)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const c=this._container.querySelector(pm);c&&c.focus()}_onClose(){this.remove()}_setOpacity(c){this._container&&(this._container.style.opacity=`${c}`),this._content&&(this._content.style.pointerEvents=c?"auto":"none")}},Marker:Tf,Style:ao,LngLat:i.bn,LngLatBounds:i.ad,Point:i.P,MercatorCoordinate:i.L,FreeCameraOptions:xt,Evented:i.E,config:i.d5,prewarm:i.dp,clearPrewarmedResources:i.dq,get accessToken(){return i.d5.ACCESS_TOKEN},set accessToken(c){i.d5.ACCESS_TOKEN=c},get baseApiUrl(){return i.d5.API_URL},set baseApiUrl(c){i.d5.API_URL=c},get workerCount(){return i.dr.workerCount},set workerCount(c){i.dr.workerCount=c},get maxParallelImageRequests(){return i.d5.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(c){i.d5.MAX_PARALLEL_IMAGE_REQUESTS=c},clearStorage(c){i.ds(c)},get workerUrl(){return i.dt.workerUrl},set workerUrl(c){i.dt.workerUrl=c},get workerClass(){return i.dt.workerClass},set workerClass(c){i.dt.workerClass=c},get workerParams(){return i.dt.workerParams},set workerParams(c){i.dt.workerParams=c},get dracoUrl(){return i.du()},set dracoUrl(c){i.dv(c)},get meshoptUrl(){return i.dw()},set meshoptUrl(c){i.dx(c)},setNow:i.f.setNow,restoreNow:i.f.restoreNow}});var A=f;return A})})(wM);var vR=wM.exports;const KT=gR(vR),xR=u=>(Zl("data-v-62681a9c"),u=u(),Yl(),u),bR=xR(()=>Ct("div",{id:"map-cont"},null,-1)),wR=[bR],TR={__name:"mapbox",setup(u){const _=Yr(null),E=Yr(!0),m=Yr(!1);KT.accessToken="pk.eyJ1IjoibWFyaW8wMiIsImEiOiJjbHNxMXR6OWUweDZoMmlvOWVtZjJtMDAwIn0.q5mRNtCKJpmnMPRuhrG_XA";const T={pitch:90,zoom:3,center:[100,70],bearing:0};Kl(()=>{window.innerWidth<=450&&(T.zoom=2),_.value=new KT.Map({container:"map-cont",style:"mapbox://styles/mapbox/satellite-v9",projection:"globe",...T}),_.value.on("style.load",()=>{_.value.setFog({color:"rgb(26, 31, 76)","high-color":"rgb(0, 104, 149)","horizon-blend":.02,"space-color":"rgb(11, 11, 25)","star-intensity":1})}),_.value.scrollZoom.disable(),_.value.on("mousedown",()=>{m.value=!0}),_.value.on("mouseup",()=>{m.value=!1,f()}),_.value.on("dragend",()=>{m.value=!1,f()}),_.value.on("pitchend",()=>{m.value=!1,f()}),_.value.on("rotateend",()=>{m.value=!1,f()}),_.value.on("moveend",()=>{f()}),f()});const f=()=>{if(!_.value||m.value)return;const x=_.value.getZoom(),A=120,i=5,P=3;if(E.value&&x<i){let O=360/A;if(x>P){const U=(i-x)/(i-P);O*=U}const L=_.value.getCenter();L.lng-=O,_.value.easeTo({center:L,duration:2e3,easing:U=>U})}};return(x,A)=>(gr(),Pr("section",null,wR))}},EM=Ao(TR,[["__scopeId","data-v-62681a9c"]]),ER={id:"content"},SR={id:"txtbox"},MR=["innerHTML"],AR=["innerHTML"],IR={__name:"layer1",setup(u){const _=ua(),E=Mi(()=>ca().get("layer1",_.language));return(m,T)=>(gr(),Pr("div",ER,[Ct("div",SR,[Ct("h1",{innerHTML:E.value.txt1},null,8,MR),Ct("h2",{innerHTML:E.value.txt2},null,8,AR)])]))}},CR=Ao(IR,[["__scopeId","data-v-4cf58e51"]]),PR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAC0SURBVEiJ7dWxCkFRAIfx7950B5llvQvlHRgMeASLVzF5QAZSZjKSwWD4DBRuWM65pfiPZ/h9dTp14Oem5upcXaqt2Hiqrr1vEzWiZurB50WPDNVT2ZH+i8hObceMDH4jkqhTYAQkAZ0GUC2cbYFeop6BSgD+aasUsCQcuF7RBBgDaYBTB2qFsy3QCzCvUzvqsZSX9Mff4d0y8UzdF/CN2gzGb4FXH04c/CGSqzN1ER3/yl0ATTCRVV25kfwAAAAASUVORK5CYII=",DR="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAACxAAAAsQHGLUmNAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAaJJREFUSInd1b1rFVEQBfDfS9IYEkja4AcGQgpbTaOgVvoPWGoltpZWgTSClSSlbexsLIKVgk2wEdFKWxHiR9TCEKMGdC3u3GRz3yZvl1h5YOAxzJyzs3veDO0xgxU8xqkOfQMxgbvYxtuI7chNHIZ4CNfwEd9xB2M4glvYwFfcxHBX8vN4iT94gBMNNVO4h994jUttiI9iOYhf4FyLnjN4hkr6RtNNRaNYwBbe44ZuY/dwBe/wC0sYrxdcjyfYxFwH4hJzwVEFp6Gi4AtWsYjJDsST0bMaHH3IE4xKrvhm1yEjBxBnp32SnLYgOW1nglIgk9Ud8gaXG8gv4JVdpx2P/EgbgYzT0th1hxyTnFbhOc4WPZ0ESA65ijX8iFiLXK+hfo/AQe83o8J9PMTTyF2U3DIQbQQyNqW1kX+3QmnTf47/T+C2Yod0xHhw9KG+7D7bf8evRJToSf/oD/ZZdhmD1nWTQLmuTzYRl8gHJzflg1MXmKo9TOuDU8ewdBfWJd/P40nEfOTWdb8dfRiTvs9PaaJKOvpLDnn0S8ziUcRs26a/tHlyo5MtwLoAAAAASUVORK5CYII=",kv=Cv("varStore",()=>{var u=Yr({height:10,destiny:"null",date:[null,null],activities:[],people:1,type:"null"});return{vars:u,changeVar:(E,m)=>{u.value[E]=m}}}),kR={id:"content"},OR=["src"],RR=["placeholder"],LR=["innerHTML"],zR=["src"],FR={__name:"search",setup(u){const _=ua(),E=Yr(null),m=Yr(!1),T=Mi(()=>ca().get("search",_.language)),f=Dv(),x=kv(),A=Yr("");Kl(()=>{E.value=window.innerWidth,E.value<=750?m.value=!0:m.value=!1}),window.addEventListener("resize",()=>{E.value=window.innerWidth,E.value<=750?m.value=!0:m.value=!1});const i=()=>{x.changeVar("destiny",A.value),setTimeout(()=>{f.push("/options")},1300)};return(P,O)=>(gr(),Pr("div",kR,[Ct("div",{id:"box",class:ys({"fit-area":m.value})},[Ct("img",{id:"arrow",src:$i(PR),alt:"flecha"},null,8,OR),lh(Ct("input",{type:"text","onUpdate:modelValue":O[0]||(O[0]=L=>A.value=L),name:"",id:"txt",placeholder:T.value.txt1},null,8,RR),[[ph,A.value]]),Ct("div",{id:"generate",class:ys({fit:m.value}),onClick:i},[!m.value&&E.value>=600?(gr(),Pr("p",{key:0,innerHTML:T.value.txt2},null,8,LR)):sg("",!0),Ct("img",{id:"imgbox",src:$i(DR),alt:"cubo"},null,8,zR)],2)],2)]))}},BR=Ao(FR,[["__scopeId","data-v-60fabf0b"]]),NR={__name:"home",setup(u){return(_,E)=>(gr(),Pr("section",null,[cr(fg),cr(CR),cr(EM),cr(BR)]))}},jR=Ao(NR,[["__scopeId","data-v-b9d35bda"]]),VR={__name:"HomeView",setup(u){return(_,E)=>(gr(),Pr("main",null,[Ct("div",null,[cr(jR)])]))}},UR={__name:"test",setup(u){return(_,E)=>(gr(),Pr("div",null,[cr(EM)]))}},$R={__name:"test",setup(u){return(_,E)=>(gr(),Pr("main",null,[Ct("div",null,[cr(UR)])]))}};function SM(u,_){return function(){return u.apply(_,arguments)}}const{toString:GR}=Object.prototype,{getPrototypeOf:Ov}=Object,pg=(u=>_=>{const E=GR.call(_);return u[E]||(u[E]=E.slice(8,-1).toLowerCase())})(Object.create(null)),pl=u=>(u=u.toLowerCase(),_=>pg(_)===u),mg=u=>_=>typeof _===u,{isArray:Cd}=Array,Ip=mg("undefined");function HR(u){return u!==null&&!Ip(u)&&u.constructor!==null&&!Ip(u.constructor)&&la(u.constructor.isBuffer)&&u.constructor.isBuffer(u)}const MM=pl("ArrayBuffer");function qR(u){let _;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?_=ArrayBuffer.isView(u):_=u&&u.buffer&&MM(u.buffer),_}const WR=mg("string"),la=mg("function"),AM=mg("number"),_g=u=>u!==null&&typeof u=="object",ZR=u=>u===!0||u===!1,C_=u=>{if(pg(u)!=="object")return!1;const _=Ov(u);return(_===null||_===Object.prototype||Object.getPrototypeOf(_)===null)&&!(Symbol.toStringTag in u)&&!(Symbol.iterator in u)},YR=pl("Date"),XR=pl("File"),KR=pl("Blob"),JR=pl("FileList"),QR=u=>_g(u)&&la(u.pipe),eL=u=>{let _;return u&&(typeof FormData=="function"&&u instanceof FormData||la(u.append)&&((_=pg(u))==="formdata"||_==="object"&&la(u.toString)&&u.toString()==="[object FormData]"))},tL=pl("URLSearchParams"),nL=u=>u.trim?u.trim():u.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function zp(u,_,{allOwnKeys:E=!1}={}){if(u===null||typeof u>"u")return;let m,T;if(typeof u!="object"&&(u=[u]),Cd(u))for(m=0,T=u.length;m<T;m++)_.call(null,u[m],m,u);else{const f=E?Object.getOwnPropertyNames(u):Object.keys(u),x=f.length;let A;for(m=0;m<x;m++)A=f[m],_.call(null,u[A],A,u)}}function IM(u,_){_=_.toLowerCase();const E=Object.keys(u);let m=E.length,T;for(;m-- >0;)if(T=E[m],_===T.toLowerCase())return T;return null}const CM=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,PM=u=>!Ip(u)&&u!==CM;function H0(){const{caseless:u}=PM(this)&&this||{},_={},E=(m,T)=>{const f=u&&IM(_,T)||T;C_(_[f])&&C_(m)?_[f]=H0(_[f],m):C_(m)?_[f]=H0({},m):Cd(m)?_[f]=m.slice():_[f]=m};for(let m=0,T=arguments.length;m<T;m++)arguments[m]&&zp(arguments[m],E);return _}const rL=(u,_,E,{allOwnKeys:m}={})=>(zp(_,(T,f)=>{E&&la(T)?u[f]=SM(T,E):u[f]=T},{allOwnKeys:m}),u),iL=u=>(u.charCodeAt(0)===65279&&(u=u.slice(1)),u),oL=(u,_,E,m)=>{u.prototype=Object.create(_.prototype,m),u.prototype.constructor=u,Object.defineProperty(u,"super",{value:_.prototype}),E&&Object.assign(u.prototype,E)},sL=(u,_,E,m)=>{let T,f,x;const A={};if(_=_||{},u==null)return _;do{for(T=Object.getOwnPropertyNames(u),f=T.length;f-- >0;)x=T[f],(!m||m(x,u,_))&&!A[x]&&(_[x]=u[x],A[x]=!0);u=E!==!1&&Ov(u)}while(u&&(!E||E(u,_))&&u!==Object.prototype);return _},aL=(u,_,E)=>{u=String(u),(E===void 0||E>u.length)&&(E=u.length),E-=_.length;const m=u.indexOf(_,E);return m!==-1&&m===E},lL=u=>{if(!u)return null;if(Cd(u))return u;let _=u.length;if(!AM(_))return null;const E=new Array(_);for(;_-- >0;)E[_]=u[_];return E},cL=(u=>_=>u&&_ instanceof u)(typeof Uint8Array<"u"&&Ov(Uint8Array)),uL=(u,_)=>{const m=(u&&u[Symbol.iterator]).call(u);let T;for(;(T=m.next())&&!T.done;){const f=T.value;_.call(u,f[0],f[1])}},hL=(u,_)=>{let E;const m=[];for(;(E=u.exec(_))!==null;)m.push(E);return m},dL=pl("HTMLFormElement"),fL=u=>u.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(E,m,T){return m.toUpperCase()+T}),JT=(({hasOwnProperty:u})=>(_,E)=>u.call(_,E))(Object.prototype),pL=pl("RegExp"),DM=(u,_)=>{const E=Object.getOwnPropertyDescriptors(u),m={};zp(E,(T,f)=>{let x;(x=_(T,f,u))!==!1&&(m[f]=x||T)}),Object.defineProperties(u,m)},mL=u=>{DM(u,(_,E)=>{if(la(u)&&["arguments","caller","callee"].indexOf(E)!==-1)return!1;const m=u[E];if(la(m)){if(_.enumerable=!1,"writable"in _){_.writable=!1;return}_.set||(_.set=()=>{throw Error("Can not rewrite read-only method '"+E+"'")})}})},_L=(u,_)=>{const E={},m=T=>{T.forEach(f=>{E[f]=!0})};return Cd(u)?m(u):m(String(u).split(_)),E},gL=()=>{},yL=(u,_)=>(u=+u,Number.isFinite(u)?u:_),m0="abcdefghijklmnopqrstuvwxyz",QT="0123456789",kM={DIGIT:QT,ALPHA:m0,ALPHA_DIGIT:m0+m0.toUpperCase()+QT},vL=(u=16,_=kM.ALPHA_DIGIT)=>{let E="";const{length:m}=_;for(;u--;)E+=_[Math.random()*m|0];return E};function xL(u){return!!(u&&la(u.append)&&u[Symbol.toStringTag]==="FormData"&&u[Symbol.iterator])}const bL=u=>{const _=new Array(10),E=(m,T)=>{if(_g(m)){if(_.indexOf(m)>=0)return;if(!("toJSON"in m)){_[T]=m;const f=Cd(m)?[]:{};return zp(m,(x,A)=>{const i=E(x,T+1);!Ip(i)&&(f[A]=i)}),_[T]=void 0,f}}return m};return E(u,0)},wL=pl("AsyncFunction"),TL=u=>u&&(_g(u)||la(u))&&la(u.then)&&la(u.catch),Wt={isArray:Cd,isArrayBuffer:MM,isBuffer:HR,isFormData:eL,isArrayBufferView:qR,isString:WR,isNumber:AM,isBoolean:ZR,isObject:_g,isPlainObject:C_,isUndefined:Ip,isDate:YR,isFile:XR,isBlob:KR,isRegExp:pL,isFunction:la,isStream:QR,isURLSearchParams:tL,isTypedArray:cL,isFileList:JR,forEach:zp,merge:H0,extend:rL,trim:nL,stripBOM:iL,inherits:oL,toFlatObject:sL,kindOf:pg,kindOfTest:pl,endsWith:aL,toArray:lL,forEachEntry:uL,matchAll:hL,isHTMLForm:dL,hasOwnProperty:JT,hasOwnProp:JT,reduceDescriptors:DM,freezeMethods:mL,toObjectSet:_L,toCamelCase:fL,noop:gL,toFiniteNumber:yL,findKey:IM,global:CM,isContextDefined:PM,ALPHABET:kM,generateString:vL,isSpecCompliantForm:xL,toJSONObject:bL,isAsyncFn:wL,isThenable:TL};function ti(u,_,E,m,T){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=u,this.name="AxiosError",_&&(this.code=_),E&&(this.config=E),m&&(this.request=m),T&&(this.response=T)}Wt.inherits(ti,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Wt.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const OM=ti.prototype,RM={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(u=>{RM[u]={value:u}});Object.defineProperties(ti,RM);Object.defineProperty(OM,"isAxiosError",{value:!0});ti.from=(u,_,E,m,T,f)=>{const x=Object.create(OM);return Wt.toFlatObject(u,x,function(i){return i!==Error.prototype},A=>A!=="isAxiosError"),ti.call(x,u.message,_,E,m,T),x.cause=u,x.name=u.name,f&&Object.assign(x,f),x};const EL=null;function q0(u){return Wt.isPlainObject(u)||Wt.isArray(u)}function LM(u){return Wt.endsWith(u,"[]")?u.slice(0,-2):u}function eE(u,_,E){return u?u.concat(_).map(function(T,f){return T=LM(T),!E&&f?"["+T+"]":T}).join(E?".":""):_}function SL(u){return Wt.isArray(u)&&!u.some(q0)}const ML=Wt.toFlatObject(Wt,{},null,function(_){return/^is[A-Z]/.test(_)});function gg(u,_,E){if(!Wt.isObject(u))throw new TypeError("target must be an object");_=_||new FormData,E=Wt.toFlatObject(E,{metaTokens:!0,dots:!1,indexes:!1},!1,function(J,fe){return!Wt.isUndefined(fe[J])});const m=E.metaTokens,T=E.visitor||O,f=E.dots,x=E.indexes,i=(E.Blob||typeof Blob<"u"&&Blob)&&Wt.isSpecCompliantForm(_);if(!Wt.isFunction(T))throw new TypeError("visitor must be a function");function P(W){if(W===null)return"";if(Wt.isDate(W))return W.toISOString();if(!i&&Wt.isBlob(W))throw new ti("Blob is not supported. Use a Buffer instead.");return Wt.isArrayBuffer(W)||Wt.isTypedArray(W)?i&&typeof Blob=="function"?new Blob([W]):Buffer.from(W):W}function O(W,J,fe){let _e=W;if(W&&!fe&&typeof W=="object"){if(Wt.endsWith(J,"{}"))J=m?J:J.slice(0,-2),W=JSON.stringify(W);else if(Wt.isArray(W)&&SL(W)||(Wt.isFileList(W)||Wt.endsWith(J,"[]"))&&(_e=Wt.toArray(W)))return J=LM(J),_e.forEach(function(ye,Pe){!(Wt.isUndefined(ye)||ye===null)&&_.append(x===!0?eE([J],Pe,f):x===null?J:J+"[]",P(ye))}),!1}return q0(W)?!0:(_.append(eE(fe,J,f),P(W)),!1)}const L=[],U=Object.assign(ML,{defaultVisitor:O,convertValue:P,isVisitable:q0});function j(W,J){if(!Wt.isUndefined(W)){if(L.indexOf(W)!==-1)throw Error("Circular reference detected in "+J.join("."));L.push(W),Wt.forEach(W,function(_e,we){(!(Wt.isUndefined(_e)||_e===null)&&T.call(_,_e,Wt.isString(we)?we.trim():we,J,U))===!0&&j(_e,J?J.concat(we):[we])}),L.pop()}}if(!Wt.isObject(u))throw new TypeError("data must be an object");return j(u),_}function tE(u){const _={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(u).replace(/[!'()~]|%20|%00/g,function(m){return _[m]})}function Rv(u,_){this._pairs=[],u&&gg(u,this,_)}const zM=Rv.prototype;zM.append=function(_,E){this._pairs.push([_,E])};zM.toString=function(_){const E=_?function(m){return _.call(this,m,tE)}:tE;return this._pairs.map(function(T){return E(T[0])+"="+E(T[1])},"").join("&")};function AL(u){return encodeURIComponent(u).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function FM(u,_,E){if(!_)return u;const m=E&&E.encode||AL,T=E&&E.serialize;let f;if(T?f=T(_,E):f=Wt.isURLSearchParams(_)?_.toString():new Rv(_,E).toString(m),f){const x=u.indexOf("#");x!==-1&&(u=u.slice(0,x)),u+=(u.indexOf("?")===-1?"?":"&")+f}return u}class nE{constructor(){this.handlers=[]}use(_,E,m){return this.handlers.push({fulfilled:_,rejected:E,synchronous:m?m.synchronous:!1,runWhen:m?m.runWhen:null}),this.handlers.length-1}eject(_){this.handlers[_]&&(this.handlers[_]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(_){Wt.forEach(this.handlers,function(m){m!==null&&_(m)})}}const BM={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},IL=typeof URLSearchParams<"u"?URLSearchParams:Rv,CL=typeof FormData<"u"?FormData:null,PL=typeof Blob<"u"?Blob:null,DL={isBrowser:!0,classes:{URLSearchParams:IL,FormData:CL,Blob:PL},protocols:["http","https","file","blob","url","data"]},NM=typeof window<"u"&&typeof document<"u",kL=(u=>NM&&["ReactNative","NativeScript","NS"].indexOf(u)<0)(typeof navigator<"u"&&navigator.product),OL=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",RL=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:NM,hasStandardBrowserEnv:kL,hasStandardBrowserWebWorkerEnv:OL},Symbol.toStringTag,{value:"Module"})),dl={...RL,...DL};function LL(u,_){return gg(u,new dl.classes.URLSearchParams,Object.assign({visitor:function(E,m,T,f){return dl.isNode&&Wt.isBuffer(E)?(this.append(m,E.toString("base64")),!1):f.defaultVisitor.apply(this,arguments)}},_))}function zL(u){return Wt.matchAll(/\w+|\[(\w*)]/g,u).map(_=>_[0]==="[]"?"":_[1]||_[0])}function FL(u){const _={},E=Object.keys(u);let m;const T=E.length;let f;for(m=0;m<T;m++)f=E[m],_[f]=u[f];return _}function jM(u){function _(E,m,T,f){let x=E[f++];if(x==="__proto__")return!0;const A=Number.isFinite(+x),i=f>=E.length;return x=!x&&Wt.isArray(T)?T.length:x,i?(Wt.hasOwnProp(T,x)?T[x]=[T[x],m]:T[x]=m,!A):((!T[x]||!Wt.isObject(T[x]))&&(T[x]=[]),_(E,m,T[x],f)&&Wt.isArray(T[x])&&(T[x]=FL(T[x])),!A)}if(Wt.isFormData(u)&&Wt.isFunction(u.entries)){const E={};return Wt.forEachEntry(u,(m,T)=>{_(zL(m),T,E,0)}),E}return null}function BL(u,_,E){if(Wt.isString(u))try{return(_||JSON.parse)(u),Wt.trim(u)}catch(m){if(m.name!=="SyntaxError")throw m}return(E||JSON.stringify)(u)}const Lv={transitional:BM,adapter:["xhr","http"],transformRequest:[function(_,E){const m=E.getContentType()||"",T=m.indexOf("application/json")>-1,f=Wt.isObject(_);if(f&&Wt.isHTMLForm(_)&&(_=new FormData(_)),Wt.isFormData(_))return T?JSON.stringify(jM(_)):_;if(Wt.isArrayBuffer(_)||Wt.isBuffer(_)||Wt.isStream(_)||Wt.isFile(_)||Wt.isBlob(_))return _;if(Wt.isArrayBufferView(_))return _.buffer;if(Wt.isURLSearchParams(_))return E.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),_.toString();let A;if(f){if(m.indexOf("application/x-www-form-urlencoded")>-1)return LL(_,this.formSerializer).toString();if((A=Wt.isFileList(_))||m.indexOf("multipart/form-data")>-1){const i=this.env&&this.env.FormData;return gg(A?{"files[]":_}:_,i&&new i,this.formSerializer)}}return f||T?(E.setContentType("application/json",!1),BL(_)):_}],transformResponse:[function(_){const E=this.transitional||Lv.transitional,m=E&&E.forcedJSONParsing,T=this.responseType==="json";if(_&&Wt.isString(_)&&(m&&!this.responseType||T)){const x=!(E&&E.silentJSONParsing)&&T;try{return JSON.parse(_)}catch(A){if(x)throw A.name==="SyntaxError"?ti.from(A,ti.ERR_BAD_RESPONSE,this,null,this.response):A}}return _}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:dl.classes.FormData,Blob:dl.classes.Blob},validateStatus:function(_){return _>=200&&_<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Wt.forEach(["delete","get","head","post","put","patch"],u=>{Lv.headers[u]={}});const zv=Lv,NL=Wt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),jL=u=>{const _={};let E,m,T;return u&&u.split(`
`).forEach(function(x){T=x.indexOf(":"),E=x.substring(0,T).trim().toLowerCase(),m=x.substring(T+1).trim(),!(!E||_[E]&&NL[E])&&(E==="set-cookie"?_[E]?_[E].push(m):_[E]=[m]:_[E]=_[E]?_[E]+", "+m:m)}),_},rE=Symbol("internals");function ip(u){return u&&String(u).trim().toLowerCase()}function P_(u){return u===!1||u==null?u:Wt.isArray(u)?u.map(P_):String(u)}function VL(u){const _=Object.create(null),E=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let m;for(;m=E.exec(u);)_[m[1]]=m[2];return _}const UL=u=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(u.trim());function _0(u,_,E,m,T){if(Wt.isFunction(m))return m.call(this,_,E);if(T&&(_=E),!!Wt.isString(_)){if(Wt.isString(m))return _.indexOf(m)!==-1;if(Wt.isRegExp(m))return m.test(_)}}function $L(u){return u.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(_,E,m)=>E.toUpperCase()+m)}function GL(u,_){const E=Wt.toCamelCase(" "+_);["get","set","has"].forEach(m=>{Object.defineProperty(u,m+E,{value:function(T,f,x){return this[m].call(this,_,T,f,x)},configurable:!0})})}class yg{constructor(_){_&&this.set(_)}set(_,E,m){const T=this;function f(A,i,P){const O=ip(i);if(!O)throw new Error("header name must be a non-empty string");const L=Wt.findKey(T,O);(!L||T[L]===void 0||P===!0||P===void 0&&T[L]!==!1)&&(T[L||i]=P_(A))}const x=(A,i)=>Wt.forEach(A,(P,O)=>f(P,O,i));return Wt.isPlainObject(_)||_ instanceof this.constructor?x(_,E):Wt.isString(_)&&(_=_.trim())&&!UL(_)?x(jL(_),E):_!=null&&f(E,_,m),this}get(_,E){if(_=ip(_),_){const m=Wt.findKey(this,_);if(m){const T=this[m];if(!E)return T;if(E===!0)return VL(T);if(Wt.isFunction(E))return E.call(this,T,m);if(Wt.isRegExp(E))return E.exec(T);throw new TypeError("parser must be boolean|regexp|function")}}}has(_,E){if(_=ip(_),_){const m=Wt.findKey(this,_);return!!(m&&this[m]!==void 0&&(!E||_0(this,this[m],m,E)))}return!1}delete(_,E){const m=this;let T=!1;function f(x){if(x=ip(x),x){const A=Wt.findKey(m,x);A&&(!E||_0(m,m[A],A,E))&&(delete m[A],T=!0)}}return Wt.isArray(_)?_.forEach(f):f(_),T}clear(_){const E=Object.keys(this);let m=E.length,T=!1;for(;m--;){const f=E[m];(!_||_0(this,this[f],f,_,!0))&&(delete this[f],T=!0)}return T}normalize(_){const E=this,m={};return Wt.forEach(this,(T,f)=>{const x=Wt.findKey(m,f);if(x){E[x]=P_(T),delete E[f];return}const A=_?$L(f):String(f).trim();A!==f&&delete E[f],E[A]=P_(T),m[A]=!0}),this}concat(..._){return this.constructor.concat(this,..._)}toJSON(_){const E=Object.create(null);return Wt.forEach(this,(m,T)=>{m!=null&&m!==!1&&(E[T]=_&&Wt.isArray(m)?m.join(", "):m)}),E}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([_,E])=>_+": "+E).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(_){return _ instanceof this?_:new this(_)}static concat(_,...E){const m=new this(_);return E.forEach(T=>m.set(T)),m}static accessor(_){const m=(this[rE]=this[rE]={accessors:{}}).accessors,T=this.prototype;function f(x){const A=ip(x);m[A]||(GL(T,x),m[A]=!0)}return Wt.isArray(_)?_.forEach(f):f(_),this}}yg.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Wt.reduceDescriptors(yg.prototype,({value:u},_)=>{let E=_[0].toUpperCase()+_.slice(1);return{get:()=>u,set(m){this[E]=m}}});Wt.freezeMethods(yg);const Wl=yg;function g0(u,_){const E=this||zv,m=_||E,T=Wl.from(m.headers);let f=m.data;return Wt.forEach(u,function(A){f=A.call(E,f,T.normalize(),_?_.status:void 0)}),T.normalize(),f}function VM(u){return!!(u&&u.__CANCEL__)}function Fp(u,_,E){ti.call(this,u??"canceled",ti.ERR_CANCELED,_,E),this.name="CanceledError"}Wt.inherits(Fp,ti,{__CANCEL__:!0});function HL(u,_,E){const m=E.config.validateStatus;!E.status||!m||m(E.status)?u(E):_(new ti("Request failed with status code "+E.status,[ti.ERR_BAD_REQUEST,ti.ERR_BAD_RESPONSE][Math.floor(E.status/100)-4],E.config,E.request,E))}const qL=dl.hasStandardBrowserEnv?{write(u,_,E,m,T,f){const x=[u+"="+encodeURIComponent(_)];Wt.isNumber(E)&&x.push("expires="+new Date(E).toGMTString()),Wt.isString(m)&&x.push("path="+m),Wt.isString(T)&&x.push("domain="+T),f===!0&&x.push("secure"),document.cookie=x.join("; ")},read(u){const _=document.cookie.match(new RegExp("(^|;\\s*)("+u+")=([^;]*)"));return _?decodeURIComponent(_[3]):null},remove(u){this.write(u,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function WL(u){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(u)}function ZL(u,_){return _?u.replace(/\/?\/$/,"")+"/"+_.replace(/^\/+/,""):u}function UM(u,_){return u&&!WL(_)?ZL(u,_):_}const YL=dl.hasStandardBrowserEnv?function(){const _=/(msie|trident)/i.test(navigator.userAgent),E=document.createElement("a");let m;function T(f){let x=f;return _&&(E.setAttribute("href",x),x=E.href),E.setAttribute("href",x),{href:E.href,protocol:E.protocol?E.protocol.replace(/:$/,""):"",host:E.host,search:E.search?E.search.replace(/^\?/,""):"",hash:E.hash?E.hash.replace(/^#/,""):"",hostname:E.hostname,port:E.port,pathname:E.pathname.charAt(0)==="/"?E.pathname:"/"+E.pathname}}return m=T(window.location.href),function(x){const A=Wt.isString(x)?T(x):x;return A.protocol===m.protocol&&A.host===m.host}}():function(){return function(){return!0}}();function XL(u){const _=/^([-+\w]{1,25})(:?\/\/|:)/.exec(u);return _&&_[1]||""}function KL(u,_){u=u||10;const E=new Array(u),m=new Array(u);let T=0,f=0,x;return _=_!==void 0?_:1e3,function(i){const P=Date.now(),O=m[f];x||(x=P),E[T]=i,m[T]=P;let L=f,U=0;for(;L!==T;)U+=E[L++],L=L%u;if(T=(T+1)%u,T===f&&(f=(f+1)%u),P-x<_)return;const j=O&&P-O;return j?Math.round(U*1e3/j):void 0}}function iE(u,_){let E=0;const m=KL(50,250);return T=>{const f=T.loaded,x=T.lengthComputable?T.total:void 0,A=f-E,i=m(A),P=f<=x;E=f;const O={loaded:f,total:x,progress:x?f/x:void 0,bytes:A,rate:i||void 0,estimated:i&&x&&P?(x-f)/i:void 0,event:T};O[_?"download":"upload"]=!0,u(O)}}const JL=typeof XMLHttpRequest<"u",QL=JL&&function(u){return new Promise(function(E,m){let T=u.data;const f=Wl.from(u.headers).normalize();let{responseType:x,withXSRFToken:A}=u,i;function P(){u.cancelToken&&u.cancelToken.unsubscribe(i),u.signal&&u.signal.removeEventListener("abort",i)}let O;if(Wt.isFormData(T)){if(dl.hasStandardBrowserEnv||dl.hasStandardBrowserWebWorkerEnv)f.setContentType(!1);else if((O=f.getContentType())!==!1){const[J,...fe]=O?O.split(";").map(_e=>_e.trim()).filter(Boolean):[];f.setContentType([J||"multipart/form-data",...fe].join("; "))}}let L=new XMLHttpRequest;if(u.auth){const J=u.auth.username||"",fe=u.auth.password?unescape(encodeURIComponent(u.auth.password)):"";f.set("Authorization","Basic "+btoa(J+":"+fe))}const U=UM(u.baseURL,u.url);L.open(u.method.toUpperCase(),FM(U,u.params,u.paramsSerializer),!0),L.timeout=u.timeout;function j(){if(!L)return;const J=Wl.from("getAllResponseHeaders"in L&&L.getAllResponseHeaders()),_e={data:!x||x==="text"||x==="json"?L.responseText:L.response,status:L.status,statusText:L.statusText,headers:J,config:u,request:L};HL(function(ye){E(ye),P()},function(ye){m(ye),P()},_e),L=null}if("onloadend"in L?L.onloadend=j:L.onreadystatechange=function(){!L||L.readyState!==4||L.status===0&&!(L.responseURL&&L.responseURL.indexOf("file:")===0)||setTimeout(j)},L.onabort=function(){L&&(m(new ti("Request aborted",ti.ECONNABORTED,u,L)),L=null)},L.onerror=function(){m(new ti("Network Error",ti.ERR_NETWORK,u,L)),L=null},L.ontimeout=function(){let fe=u.timeout?"timeout of "+u.timeout+"ms exceeded":"timeout exceeded";const _e=u.transitional||BM;u.timeoutErrorMessage&&(fe=u.timeoutErrorMessage),m(new ti(fe,_e.clarifyTimeoutError?ti.ETIMEDOUT:ti.ECONNABORTED,u,L)),L=null},dl.hasStandardBrowserEnv&&(A&&Wt.isFunction(A)&&(A=A(u)),A||A!==!1&&YL(U))){const J=u.xsrfHeaderName&&u.xsrfCookieName&&qL.read(u.xsrfCookieName);J&&f.set(u.xsrfHeaderName,J)}T===void 0&&f.setContentType(null),"setRequestHeader"in L&&Wt.forEach(f.toJSON(),function(fe,_e){L.setRequestHeader(_e,fe)}),Wt.isUndefined(u.withCredentials)||(L.withCredentials=!!u.withCredentials),x&&x!=="json"&&(L.responseType=u.responseType),typeof u.onDownloadProgress=="function"&&L.addEventListener("progress",iE(u.onDownloadProgress,!0)),typeof u.onUploadProgress=="function"&&L.upload&&L.upload.addEventListener("progress",iE(u.onUploadProgress)),(u.cancelToken||u.signal)&&(i=J=>{L&&(m(!J||J.type?new Fp(null,u,L):J),L.abort(),L=null)},u.cancelToken&&u.cancelToken.subscribe(i),u.signal&&(u.signal.aborted?i():u.signal.addEventListener("abort",i)));const W=XL(U);if(W&&dl.protocols.indexOf(W)===-1){m(new ti("Unsupported protocol "+W+":",ti.ERR_BAD_REQUEST,u));return}L.send(T||null)})},W0={http:EL,xhr:QL};Wt.forEach(W0,(u,_)=>{if(u){try{Object.defineProperty(u,"name",{value:_})}catch{}Object.defineProperty(u,"adapterName",{value:_})}});const oE=u=>`- ${u}`,ez=u=>Wt.isFunction(u)||u===null||u===!1,$M={getAdapter:u=>{u=Wt.isArray(u)?u:[u];const{length:_}=u;let E,m;const T={};for(let f=0;f<_;f++){E=u[f];let x;if(m=E,!ez(E)&&(m=W0[(x=String(E)).toLowerCase()],m===void 0))throw new ti(`Unknown adapter '${x}'`);if(m)break;T[x||"#"+f]=m}if(!m){const f=Object.entries(T).map(([A,i])=>`adapter ${A} `+(i===!1?"is not supported by the environment":"is not available in the build"));let x=_?f.length>1?`since :
`+f.map(oE).join(`
`):" "+oE(f[0]):"as no adapter specified";throw new ti("There is no suitable adapter to dispatch the request "+x,"ERR_NOT_SUPPORT")}return m},adapters:W0};function y0(u){if(u.cancelToken&&u.cancelToken.throwIfRequested(),u.signal&&u.signal.aborted)throw new Fp(null,u)}function sE(u){return y0(u),u.headers=Wl.from(u.headers),u.data=g0.call(u,u.transformRequest),["post","put","patch"].indexOf(u.method)!==-1&&u.headers.setContentType("application/x-www-form-urlencoded",!1),$M.getAdapter(u.adapter||zv.adapter)(u).then(function(m){return y0(u),m.data=g0.call(u,u.transformResponse,m),m.headers=Wl.from(m.headers),m},function(m){return VM(m)||(y0(u),m&&m.response&&(m.response.data=g0.call(u,u.transformResponse,m.response),m.response.headers=Wl.from(m.response.headers))),Promise.reject(m)})}const aE=u=>u instanceof Wl?{...u}:u;function Sd(u,_){_=_||{};const E={};function m(P,O,L){return Wt.isPlainObject(P)&&Wt.isPlainObject(O)?Wt.merge.call({caseless:L},P,O):Wt.isPlainObject(O)?Wt.merge({},O):Wt.isArray(O)?O.slice():O}function T(P,O,L){if(Wt.isUndefined(O)){if(!Wt.isUndefined(P))return m(void 0,P,L)}else return m(P,O,L)}function f(P,O){if(!Wt.isUndefined(O))return m(void 0,O)}function x(P,O){if(Wt.isUndefined(O)){if(!Wt.isUndefined(P))return m(void 0,P)}else return m(void 0,O)}function A(P,O,L){if(L in _)return m(P,O);if(L in u)return m(void 0,P)}const i={url:f,method:f,data:f,baseURL:x,transformRequest:x,transformResponse:x,paramsSerializer:x,timeout:x,timeoutMessage:x,withCredentials:x,withXSRFToken:x,adapter:x,responseType:x,xsrfCookieName:x,xsrfHeaderName:x,onUploadProgress:x,onDownloadProgress:x,decompress:x,maxContentLength:x,maxBodyLength:x,beforeRedirect:x,transport:x,httpAgent:x,httpsAgent:x,cancelToken:x,socketPath:x,responseEncoding:x,validateStatus:A,headers:(P,O)=>T(aE(P),aE(O),!0)};return Wt.forEach(Object.keys(Object.assign({},u,_)),function(O){const L=i[O]||T,U=L(u[O],_[O],O);Wt.isUndefined(U)&&L!==A||(E[O]=U)}),E}const GM="1.6.8",Fv={};["object","boolean","number","function","string","symbol"].forEach((u,_)=>{Fv[u]=function(m){return typeof m===u||"a"+(_<1?"n ":" ")+u}});const lE={};Fv.transitional=function(_,E,m){function T(f,x){return"[Axios v"+GM+"] Transitional option '"+f+"'"+x+(m?". "+m:"")}return(f,x,A)=>{if(_===!1)throw new ti(T(x," has been removed"+(E?" in "+E:"")),ti.ERR_DEPRECATED);return E&&!lE[x]&&(lE[x]=!0,console.warn(T(x," has been deprecated since v"+E+" and will be removed in the near future"))),_?_(f,x,A):!0}};function tz(u,_,E){if(typeof u!="object")throw new ti("options must be an object",ti.ERR_BAD_OPTION_VALUE);const m=Object.keys(u);let T=m.length;for(;T-- >0;){const f=m[T],x=_[f];if(x){const A=u[f],i=A===void 0||x(A,f,u);if(i!==!0)throw new ti("option "+f+" must be "+i,ti.ERR_BAD_OPTION_VALUE);continue}if(E!==!0)throw new ti("Unknown option "+f,ti.ERR_BAD_OPTION)}}const Z0={assertOptions:tz,validators:Fv},zc=Z0.validators;class $_{constructor(_){this.defaults=_,this.interceptors={request:new nE,response:new nE}}async request(_,E){try{return await this._request(_,E)}catch(m){if(m instanceof Error){let T;Error.captureStackTrace?Error.captureStackTrace(T={}):T=new Error;const f=T.stack?T.stack.replace(/^.+\n/,""):"";m.stack?f&&!String(m.stack).endsWith(f.replace(/^.+\n.+\n/,""))&&(m.stack+=`
`+f):m.stack=f}throw m}}_request(_,E){typeof _=="string"?(E=E||{},E.url=_):E=_||{},E=Sd(this.defaults,E);const{transitional:m,paramsSerializer:T,headers:f}=E;m!==void 0&&Z0.assertOptions(m,{silentJSONParsing:zc.transitional(zc.boolean),forcedJSONParsing:zc.transitional(zc.boolean),clarifyTimeoutError:zc.transitional(zc.boolean)},!1),T!=null&&(Wt.isFunction(T)?E.paramsSerializer={serialize:T}:Z0.assertOptions(T,{encode:zc.function,serialize:zc.function},!0)),E.method=(E.method||this.defaults.method||"get").toLowerCase();let x=f&&Wt.merge(f.common,f[E.method]);f&&Wt.forEach(["delete","get","head","post","put","patch","common"],W=>{delete f[W]}),E.headers=Wl.concat(x,f);const A=[];let i=!0;this.interceptors.request.forEach(function(J){typeof J.runWhen=="function"&&J.runWhen(E)===!1||(i=i&&J.synchronous,A.unshift(J.fulfilled,J.rejected))});const P=[];this.interceptors.response.forEach(function(J){P.push(J.fulfilled,J.rejected)});let O,L=0,U;if(!i){const W=[sE.bind(this),void 0];for(W.unshift.apply(W,A),W.push.apply(W,P),U=W.length,O=Promise.resolve(E);L<U;)O=O.then(W[L++],W[L++]);return O}U=A.length;let j=E;for(L=0;L<U;){const W=A[L++],J=A[L++];try{j=W(j)}catch(fe){J.call(this,fe);break}}try{O=sE.call(this,j)}catch(W){return Promise.reject(W)}for(L=0,U=P.length;L<U;)O=O.then(P[L++],P[L++]);return O}getUri(_){_=Sd(this.defaults,_);const E=UM(_.baseURL,_.url);return FM(E,_.params,_.paramsSerializer)}}Wt.forEach(["delete","get","head","options"],function(_){$_.prototype[_]=function(E,m){return this.request(Sd(m||{},{method:_,url:E,data:(m||{}).data}))}});Wt.forEach(["post","put","patch"],function(_){function E(m){return function(f,x,A){return this.request(Sd(A||{},{method:_,headers:m?{"Content-Type":"multipart/form-data"}:{},url:f,data:x}))}}$_.prototype[_]=E(),$_.prototype[_+"Form"]=E(!0)});const D_=$_;class Bv{constructor(_){if(typeof _!="function")throw new TypeError("executor must be a function.");let E;this.promise=new Promise(function(f){E=f});const m=this;this.promise.then(T=>{if(!m._listeners)return;let f=m._listeners.length;for(;f-- >0;)m._listeners[f](T);m._listeners=null}),this.promise.then=T=>{let f;const x=new Promise(A=>{m.subscribe(A),f=A}).then(T);return x.cancel=function(){m.unsubscribe(f)},x},_(function(f,x,A){m.reason||(m.reason=new Fp(f,x,A),E(m.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(_){if(this.reason){_(this.reason);return}this._listeners?this._listeners.push(_):this._listeners=[_]}unsubscribe(_){if(!this._listeners)return;const E=this._listeners.indexOf(_);E!==-1&&this._listeners.splice(E,1)}static source(){let _;return{token:new Bv(function(T){_=T}),cancel:_}}}const nz=Bv;function rz(u){return function(E){return u.apply(null,E)}}function iz(u){return Wt.isObject(u)&&u.isAxiosError===!0}const Y0={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Y0).forEach(([u,_])=>{Y0[_]=u});const oz=Y0;function HM(u){const _=new D_(u),E=SM(D_.prototype.request,_);return Wt.extend(E,D_.prototype,_,{allOwnKeys:!0}),Wt.extend(E,_,null,{allOwnKeys:!0}),E.create=function(T){return HM(Sd(u,T))},E}const mo=HM(zv);mo.Axios=D_;mo.CanceledError=Fp;mo.CancelToken=nz;mo.isCancel=VM;mo.VERSION=GM;mo.toFormData=gg;mo.AxiosError=ti;mo.Cancel=mo.CanceledError;mo.all=function(_){return Promise.all(_)};mo.spread=rz;mo.isAxiosError=iz;mo.mergeConfig=Sd;mo.AxiosHeaders=Wl;mo.formToJSON=u=>jM(Wt.isHTMLForm(u)?new FormData(u):u);mo.getAdapter=$M.getAdapter;mo.HttpStatusCode=oz;mo.default=mo;const sz={class:"sec1"},az={class:"title"},lz=["innerHTML"],cz=["innerHTML"],uz=["innerHTML"],hz=["innerHTML"],dz={__name:"AboutSection1",setup(u){const _=ua(),E=ca(),m=kv(),T=Mi(()=>E.get("aboutSection1",_.language)),f=Yr(null),x=()=>{var A=document.querySelector(".sec1").offsetHeight;window.innerWidth<700?A+=80:A+=90,m.changeVar("height",A);var i=m.vars.height;f.value.style.height=Yr(i+"px").value};return Kl(()=>{x(),window.addEventListener("resize",x)}),(A,i)=>(gr(),Pr(zi,null,[Ct("section",sz,[Ct("h1",az,[Ct("span",{class:"t-part",innerHTML:T.value.span1},null,8,lz),Ct("span",{class:"t-part",innerHTML:T.value.span2},null,8,cz)]),Ct("p",{class:"mid-title",innerHTML:T.value.txt1},null,8,uz),Ct("p",{class:"bottom-title",innerHTML:T.value.txt2},null,8,hz)]),Ct("div",{class:"hidden-comp",ref_key:"hiddenHeight",ref:f},null,512)],64))}},fz=Ao(dz,[["__scopeId","data-v-00ce8a13"]]),pz=u=>(Zl("data-v-5d0309d9"),u=u(),Yl(),u),mz=pz(()=>Ct("section",{class:"sec2"},[Ct("p",null,"content available in future versions")],-1)),_z=[mz],gz={__name:"AboutSection2",setup(u){const _=ua(),E=ca();return Mi(()=>E.get("",_.language)),(m,T)=>(gr(),Pr("div",null,_z))}},yz=Ao(gz,[["__scopeId","data-v-5d0309d9"]]),vz={class:"col1"},xz=["innerHTML"],bz=["innerHTML"],wz=["innerHTML"],Tz=["innerHTML"],Ez={key:4,class:"btns"},Sz={class:"type1 btn-filled"},Mz=["innerHTML"],Az={class:"type1"},Iz=["innerHTML"],Cz={key:5},Pz=["innerHTML"],Dz={class:"col2"},kz={class:"img"},Oz={key:0,src:"",alt:"foto/"},Rz={key:1,src:"",alt:"foto/"},Lz={__name:"AboutSection3",props:["type"],setup(u){const _=ua(),E=ca(),m=Mi(()=>E.get("aboutSection3",_.language));return(T,f)=>(gr(),Pr("div",null,[Ct("section",{class:ys(["sec3",{sec3bottom:u.type==1}])},[Ct("div",vz,[u.type==0?(gr(),Pr("h3",{key:0,innerHTML:m.value.type0.txt1},null,8,xz)):(gr(),Pr("h3",{key:1,class:ys({biggerh3:u.type==1}),innerHTML:m.value.type1.txt1},null,10,bz)),u.type==0?(gr(),Pr("p",{key:2,innerHTML:m.value.type0.txt2},null,8,wz)):(gr(),Pr("p",{key:3,innerHTML:m.value.type1.txt2},null,8,Tz)),u.type==1?(gr(),Pr("div",Ez,[Ct("button",Sz,[Ct("a",{href:"",innerHTML:m.value.type1.btn1},null,8,Mz)]),Ct("button",Az,[Ct("a",{href:"",innerHTML:m.value.type1.btn2},null,8,Iz)])])):(gr(),Pr("button",Cz,[Ct("a",{href:"",innerHTML:m.value.type0.btn1},null,8,Pz)]))]),Ct("div",Dz,[Ct("div",kz,[u.type==1?(gr(),Pr("img",Oz)):(gr(),Pr("img",Rz))])])],2)]))}},cE=Ao(Lz,[["__scopeId","data-v-e75b82f2"]]),Bp=u=>(Zl("data-v-17ca36f5"),u=u(),Yl(),u),zz={class:"sec4"},Fz={class:"col"},Bz=Bp(()=>Ct("span",{class:"material-symbols-outlined"},"chat_bubble",-1)),Nz=["innerHTML"],jz=["innerHTML"],Vz={class:"col"},Uz=Bp(()=>Ct("span",{class:"material-symbols-outlined"},"photo_camera",-1)),$z=["innerHTML"],Gz=["innerHTML"],Hz={class:"col"},qz=Bp(()=>Ct("span",{class:"material-symbols-outlined"},"globe",-1)),Wz=["innerHTML"],Zz=["innerHTML"],Yz={class:"col"},Xz=Bp(()=>Ct("span",{class:"material-symbols-outlined"},"battery_horiz_050",-1)),Kz=["innerHTML"],Jz=["innerHTML"],Qz=Bp(()=>Ct("link",{rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"},null,-1)),e4={__name:"AboutSection4",setup(u){const _=ua(),E=ca(),m=Mi(()=>E.get("aboutSection4",_.language));return(T,f)=>(gr(),Pr(zi,null,[Ct("div",null,[Ct("section",zz,[Ct("div",Fz,[Bz,Ct("h5",{innerHTML:m.value.title1},null,8,Nz),Ct("p",{innerHTML:m.value.txt1},null,8,jz)]),Ct("div",Vz,[Uz,Ct("h5",{innerHTML:m.value.title2},null,8,$z),Ct("p",{innerHTML:m.value.txt2},null,8,Gz)]),Ct("div",Hz,[qz,Ct("h5",{innerHTML:m.value.title3},null,8,Wz),Ct("p",{innerHTML:m.value.txt3},null,8,Zz)]),Ct("div",Yz,[Xz,Ct("h5",{innerHTML:m.value.title4},null,8,Kz),Ct("p",{innerHTML:m.value.txt4},null,8,Jz)])])]),Qz],64))}},t4=Ao(e4,[["__scopeId","data-v-17ca36f5"]]),n4=u=>(Zl("data-v-349044c7"),u=u(),Yl(),u),r4=n4(()=>Ct("section",{class:"sec5"},[Ct("p",null,"content available in future versions")],-1)),i4=[r4],o4={__name:"AboutSection5",setup(u){const _=ua(),E=ca();return Mi(()=>E.get("",_.language)),(m,T)=>(gr(),Pr("div",null,i4))}},s4=Ao(o4,[["__scopeId","data-v-349044c7"]]),qM=u=>(Zl("data-v-e6792e7f"),u=u(),Yl(),u),a4={class:"col1"},l4=qM(()=>Ct("h6",null,"AIVOY",-1)),c4=["innerHTML"],u4=qM(()=>Ct("div",{class:"col2"},[Ct("span",{class:"material-symbols-outlined"},"nest_thermostat_gen_3"),Ct("span",{class:"material-symbols-outlined"},"nest_thermostat_gen_3"),Ct("span",{class:"material-symbols-outlined"},"nest_thermostat_gen_3")],-1)),h4={__name:"FooterTeo",setup(u){const _=ua(),E=ca(),m=Mi(()=>E.get("footerTeo",_.language));return(T,f)=>(gr(),Pr("div",null,[Ct("footer",null,[Ct("div",a4,[l4,Ct("p",{innerHTML:m.value.txt1},null,8,c4)]),u4])]))}},d4=Ao(h4,[["__scopeId","data-v-e6792e7f"]]),f4={class:"allComponents"},p4={__name:"AboutComponent",setup(u){console.log("ESTAS EN bienvenido CLIENTE");const _=Dv();return(async()=>{try{const m=await mo.get("/session");console.log("Log client bienvenido=> ",m),m.status===200&&_.push("/about")}catch(m){console.error("Error al iniciar sesin:",m),m.response&&m.response.status===401&&(console.log("La sesin ha caducado, redirigiendo al formulario de inicio de sesin..."),_.push("/login"))}})(),(m,T)=>(gr(),Pr("section",f4,[cr(fg),cr(fz),cr(yz),cr(cE,{type:"0"}),cr(t4),cr(s4),cr(cE,{type:"1"}),cr(d4)]))}},m4=Ao(p4,[["__scopeId","data-v-5dae32a6"]]),_4={class:"container-fluid"},g4={__name:"AboutView",setup(u){return(_,E)=>(gr(),Pr("main",_4,[Ct("div",null,[cr(m4)])]))}};var vg={library:"https://accounts.google.com/gsi/client",defaultButtonConfig:{theme:"outline",size:"large"},scopes:"email profile openid"};const as=za({clientId:null,popupType:"CODE",prompt:!1,autoLogin:!1,idConfiguration:null,buttonConfig:vg.defaultButtonConfig,callback:()=>{},error:null}),yd=za({apiLoaded:!1,apiLoadIntitited:!1}),y4=u=>{try{const _=u.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),E=decodeURIComponent(atob(_).split("").map(function(m){return"%"+("00"+m.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(E)}catch{throw"JWT provided is invalid"}},WM=new Promise(u=>{const _=typeof window<"u";if(!yd.apiLoadIntitited&&_){const E=document.createElement("script");yd.apiLoadIntitited=!0,E.addEventListener("load",()=>{yd.apiLoaded=!0,u(window.google)}),E.src=vg.library,E.async=!0,E.defer=!0,document.head.appendChild(E)}}),xg=u=>{yd.apiLoadIntitited?yd.apiLoaded?u(window.google):qc(()=>yd.apiLoaded,_=>{_&&u(window.google)}):WM.then(_=>{u(_)})},v4=(u,_,E,m)=>{if(!u.client_id)throw new Error("Prop client id required since plugin is not initialized with a client id");xg(()=>{((T,f,x,A,i)=>{if(i){const O=T.callback;T.callback=L=>{L.credential?O&&O(L):i(L)}}window.google.accounts.id.initialize(T);const P=f.value;P&&!A&&window.google.accounts.id.renderButton(P,x)})(u,_,E.buttonConfig,m,E.error),E.prompt&&w4({clientId:E.clientId,callback:E.callback,error:E.error,autoLogin:E.autoLogin})})},x4=u=>new Promise((_,E)=>{xg(m=>{if(!(u&&u.clientId||as.clientId))throw new Error("clientId is required since the plugin is not initialized with a Client Id");m.accounts.oauth2.initCodeClient({client_id:u&&u.clientId||as.clientId||"",scope:vg.scopes,ux_mode:"popup",callback:T=>{T.code?_(T):E(T)},error_callback:T=>{E(T)}}).requestCode()})}),b4=u=>new Promise((_,E)=>{xg(m=>{if(!(u&&u.clientId||as.clientId))throw new Error("clientId is required since the plugin is not initialized with a Client Id");m.accounts.oauth2.initTokenClient({client_id:u&&u.clientId||as.clientId||"",scope:vg.scopes,callback:T=>{T.access_token?_(T):E(T)},error_callback:T=>{E(T)}}).requestAccessToken()})}),w4=u=>{if(!u&&(u={}),!u.clientId&&!as.clientId)throw new Error("clientId is required");const _={use_fedcm_for_prompt:!0};return u.clientId&&(_.client_id=u.clientId),!u.clientId&&as.clientId&&(_.client_id=as.clientId),u.context&&(_.context=u.context),u.autoLogin!=null&&(_.auto_select=u.autoLogin),u.cancelOnTapOutside!=null&&(_.cancel_on_tap_outside=u.cancelOnTapOutside),new Promise((E,m)=>{_.callback=T=>{u&&u.callback&&u.callback(T),T.credential?E(T):m(T)},xg(T=>{T.accounts.id.initialize(_),T.accounts.id.prompt()})})};var X0=Id({__name:"GoogleLogin",props:{clientId:{type:String,required:!1},prompt:{type:Boolean,required:!1,default:!1},autoLogin:{type:Boolean,required:!1,default:!1},popupType:{type:String,required:!1},idConfiguration:{type:Object,required:!1},buttonConfig:{type:Object,required:!1},callback:{type:Function,required:!1},error:{type:Function,required:!1}},setup(u){const _=!!uS().default,E=u,m=((x,A)=>{const i={...x};for(const P in A)A[P]!==void 0&&A[P]!==null&&(i[P]=A[P]);return i})(as,E),T={client_id:m.clientId||null,auto_select:m.autoLogin||!1,callback:m.callback,...m.idConfiguration},f=Yr();return Kl(()=>{v4(T,f,m,_),E.popupType&&!_&&console.warn("Option 'popupType' is ignored since a slot which act as a custom login button was not found!!!")}),(x,A)=>(gr(),Pr("div",{class:"g-btn-wrapper",onClick:A[0]||(A[0]=i=>$i(_)&&void($i(m).popupType==="TOKEN"?b4({clientId:m.clientId}).then(P=>{m.callback&&m.callback(P)}).catch(P=>{m.error&&m.error(P)}):x4({clientId:m.clientId}).then(P=>{m.callback&&m.callback(P)}).catch(P=>{m.error&&m.error(P)})))},[$i(_)?sg("v-if",!0):(gr(),Pr("span",{key:0,ref_key:"buttonRef",ref:f,class:"g-btn"},null,512)),aS(x.$slots,"default")]))}});(function(u,_){_===void 0&&(_={});var E=_.insertAt;if(u&&typeof document<"u"){var m=document.head||document.getElementsByTagName("head")[0],T=document.createElement("style");T.type="text/css",E==="top"&&m.firstChild?m.insertBefore(T,m.firstChild):m.appendChild(T),T.styleSheet?T.styleSheet.cssText=u:T.appendChild(document.createTextNode(u))}})(`
.g-btn-wrapper[data-v-5e610566] {
  display: inline-block;
}
`),X0.__scopeId="data-v-5e610566",X0.__file="src/plugin/GoogleLogin.vue";var T4={install:(u,_)=>{_&&(E=>{E.clientId&&(as.clientId=E.clientId),E.popupType&&(as.popupType=E.popupType),E.prompt!=null&&(as.prompt=E.prompt),E.autoLogin!=null&&(as.autoLogin=E.autoLogin),E.idConfiguration&&(as.idConfiguration=E.idConfiguration),E.buttonConfig&&(as.buttonConfig=E.buttonConfig),E.callback&&(as.callback=E.callback)})(_),WM.then(()=>{if(_.clientId){const E={client_id:_.clientId,auto_select:_.autoLogin===!0,callback:_.callback,use_fedcm_for_prompt:!0,..._.idConfiguration};window.google.accounts.id.initialize(E),_.prompt&&window.google.accounts.id.prompt()}}),u.component("GoogleLogin",X0)}};const bg=u=>(Zl("data-v-829acfef"),u=u(),Yl(),u),E4={id:"section"},S4={id:"login"},M4={id:"title"},A4={class:"input-line"},I4={class:"input-line"},C4=bg(()=>Ct("div",{class:"input-line regist"},[Ct("input",{type:"text",id:"password",placeholder:"Nombre..."})],-1)),P4=bg(()=>Ct("div",{class:"input-line regist"},[Ct("input",{type:"text",id:"password",placeholder:"Apellido..."})],-1)),D4={id:"submit"},k4={id:"google-log"},O4=bg(()=>Ct("button",{type:"submit",form:"form"},"Validar datos prueba",-1)),R4=bg(()=>Ct("div",{id:"register"},null,-1)),L4={__name:"Login",setup(u){const _=Yr(""),E=Yr(""),m=Dv(),T=Yr(!1),f=Yr(!1),x=Yr("Iniciar Sesin");var A=document.documentElement,i=.5;A.style.setProperty("--AnimationTime",i+"s");const P=Mi(()=>({animate__animated:!0,animate__flipOutX:f.value,animate__flipInX:!f.value}));function O(j){T.value=j,f.value=!0,setTimeout(()=>{f.value=!1},i*1e3),setTimeout(()=>{j?x.value="Registrarse":x.value="Iniciar Sesin"},i*1e3)}const L=j=>{const W=y4(j.credential);console.log("Handle the userData",W)},U=async()=>{try{const j=await mo.post("/server/login",{mail:_.value,password:E.value});console.log("Log client login => ",j),j.status===200?m.push("/about"):j.status===401?(console.log("La sesin ha caducado, redirigiendo al formulario de inicio de sesin..."),m.push("/login")):console.error("Inicio de sesin fallido:",j.data.message)}catch(j){console.error("Error al iniciar sesin:",j)}};return(j,W)=>{const J=VE("GoogleLogin");return gr(),Pr("div",null,[Ct("div",E4,[Ct("div",S4,[Ct("div",{id:"content",class:ys({"animate-content":T.value})},[Ct("div",M4,[Ct("h1",{class:ys(P.value)},Gc(x.value),3)]),Ct("form",{onSubmit:I_(U,["prevent"]),id:"form",class:ys({"form-Animation":T.value})},[Ct("div",A4,[lh(Ct("input",{type:"email",id:"email",placeholder:"Email...","onUpdate:modelValue":W[0]||(W[0]=fe=>_.value=fe),required:""},null,512),[[ph,_.value]])]),Ct("div",I4,[lh(Ct("input",{type:"password",id:"password",placeholder:"Contrasea...","onUpdate:modelValue":W[1]||(W[1]=fe=>E.value=fe),required:""},null,512),[[ph,E.value]])]),C4,P4],34),Ct("div",D4,[Ct("button",{type:"submit",id:"regis",form:"form",onClick:W[2]||(W[2]=I_(fe=>O(!0),["prevent"]))},"Registrarse"),Ct("button",{type:"submit",id:"log",form:"form",onClick:W[3]||(W[3]=I_(fe=>O(!1),["prevent"]))},"Inciar sesin"),Ct("div",{class:ys(["colorbox",{"colorbox-tranform":T.value}])},null,2)]),Ct("div",k4,[cr(J,{callback:L,prompt:"","auto-login":""})]),O4],2)]),R4])])}}},z4=Ao(L4,[["__scopeId","data-v-829acfef"]]),F4={id:"body"},B4={__name:"LoginView",setup(u){return(_,E)=>(gr(),Pr("div",F4,[cr(fg),cr(z4)]))}},N4=Ao(B4,[["__scopeId","data-v-94fe72c5"]]);var ZM={exports:{}};const j4=yR(Nk);(function(u,_){(function(E,m){u.exports=m(j4)})(typeof self<"u"?self:bM,function(E){return function(m){var T={};function f(x){if(T[x])return T[x].exports;var A=T[x]={i:x,l:!1,exports:{}};return m[x].call(A.exports,A,A.exports,f),A.l=!0,A.exports}return f.m=m,f.c=T,f.d=function(x,A,i){f.o(x,A)||Object.defineProperty(x,A,{enumerable:!0,get:i})},f.r=function(x){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(x,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(x,"__esModule",{value:!0})},f.t=function(x,A){if(1&A&&(x=f(x)),8&A||4&A&&typeof x=="object"&&x&&x.__esModule)return x;var i=Object.create(null);if(f.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:x}),2&A&&typeof x!="string")for(var P in x)f.d(i,P,(function(O){return x[O]}).bind(null,P));return i},f.n=function(x){var A=x&&x.__esModule?function(){return x.default}:function(){return x};return f.d(A,"a",A),A},f.o=function(x,A){return Object.prototype.hasOwnProperty.call(x,A)},f.p="",f(f.s="fb15")}({"00ee":function(m,T,f){var x=f("b622"),A=x("toStringTag"),i={};i[A]="z",m.exports=String(i)==="[object z]"},"00fd":function(m,T,f){var x=f("9e69"),A=Object.prototype,i=A.hasOwnProperty,P=A.toString,O=x?x.toStringTag:void 0;function L(U){var j=i.call(U,O),W=U[O];try{U[O]=void 0;var J=!0}catch{}var fe=P.call(U);return J&&(j?U[O]=W:delete U[O]),fe}m.exports=L},"03dd":function(m,T,f){var x=f("eac5"),A=f("57a5"),i=Object.prototype,P=i.hasOwnProperty;function O(L){if(!x(L))return A(L);var U=[];for(var j in Object(L))P.call(L,j)&&j!="constructor"&&U.push(j);return U}m.exports=O},"0459":function(m,T,f){f("643d")},"04f8":function(m,T,f){var x=f("2d00"),A=f("d039"),i=f("da84"),P=i.String;m.exports=!!Object.getOwnPropertySymbols&&!A(function(){var O=Symbol("symbol detection");return!P(O)||!(Object(O)instanceof Symbol)||!Symbol.sham&&x&&x<41})},"0621":function(m,T,f){var x=f("9e69"),A=f("d370"),i=f("6747"),P=x?x.isConcatSpreadable:void 0;function O(L){return i(L)||A(L)||!!(P&&L&&L[P])}m.exports=O},"06cf":function(m,T,f){var x=f("83ab"),A=f("c65b"),i=f("d1e7"),P=f("5c6c"),O=f("fc6a"),L=f("a04b"),U=f("1a2d"),j=f("0cfb"),W=Object.getOwnPropertyDescriptor;T.f=x?W:function(J,fe){if(J=O(J),fe=L(fe),j)try{return W(J,fe)}catch{}if(U(J,fe))return P(!A(i.f,J,fe),J[fe])}},"0733":function(m,T,f){f.d(T,"a",function(){return i});var x=f("2fa3"),A=f("9404");const i=function(P,O,{maxSwipeTime:L,minHorizontalSwipeDistance:U,maxVerticalSwipeDistance:j}){if(!P||!P.addEventListener||!Object(A.k)(O))return null;let W=0,J=0,fe=null,_e=!1;function we(Pe){const Fe=Pe.changedTouches[0];W=Fe.screenX,J=Fe.screenY,fe=new Date().getTime(),_e=!0}function ye(Pe){if(!_e)return;_e=!1;const Fe=Pe.changedTouches[0],Be=Fe.screenX-W,He=Fe.screenY-J;if(new Date().getTime()-fe<L&&Math.abs(Be)>=U&&Math.abs(He)<=j){const ve={toLeft:!1,toRight:!1};Be<0?ve.toLeft=!0:ve.toRight=!0,O(ve)}}return Object(x.k)(P,"touchstart",we,{passive:!0}),Object(x.k)(P,"touchend",ye,{passive:!0}),function(){Object(x.j)(P,"touchstart",we),Object(x.j)(P,"touchend",ye)}}},"07c7":function(m,T){function f(){return!1}m.exports=f},"07fa":function(m,T,f){var x=f("50c4");m.exports=function(A){return x(A.length)}},"083a":function(m,T,f){var x=f("0d51"),A=TypeError;m.exports=function(i,P){if(!delete i[P])throw new A("Cannot delete property "+x(P)+" of "+x(i))}},"0840":function(m,T,f){var x=f("24fb");T=x(!1),T.push([m.i,".vc-svg-icon[data-v-63f7b5ec]{display:inline-block;stroke:currentColor;stroke-width:0}.vc-svg-icon path[data-v-63f7b5ec]{fill:currentColor}",""]),m.exports=T},"087d":function(m,T){function f(x,A){for(var i=-1,P=A.length,O=x.length;++i<P;)x[O+i]=A[i];return x}m.exports=f},"08cc":function(m,T,f){var x=f("1a8c");function A(i){return i===i&&!x(i)}m.exports=A},"0b07":function(m,T,f){var x=f("34ac"),A=f("3698");function i(P,O){var L=A(P,O);return x(L)?L:void 0}m.exports=i},"0cfb":function(m,T,f){var x=f("83ab"),A=f("d039"),i=f("cc12");m.exports=!x&&!A(function(){return Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a!==7})},"0d24":function(m,T,f){(function(x){var A=f("2b3e"),i=f("07c7"),P=T&&!T.nodeType&&T,O=P&&typeof x=="object"&&x&&!x.nodeType&&x,L=O&&O.exports===P,U=L?A.Buffer:void 0,j=U?U.isBuffer:void 0,W=j||i;x.exports=W}).call(this,f("62e4")(m))},"0d26":function(m,T,f){var x=f("e330"),A=Error,i=x("".replace),P=function(U){return String(new A(U).stack)}("zxcasd"),O=/\n\s*at [^:]*:[^\n]*/,L=O.test(P);m.exports=function(U,j){if(L&&typeof U=="string"&&!A.prepareStackTrace)for(;j--;)U=i(U,O,"");return U}},"0d51":function(m,T,f){var x=String;m.exports=function(A){try{return x(A)}catch{return"Object"}}},"0f0f":function(m,T,f){var x=f("8eeb"),A=f("9934");function i(P,O){return P&&x(O,A(O),P)}m.exports=i},"0f5c":function(m,T,f){var x=f("159a");function A(i,P,O){return i==null?i:x(i,P,O)}m.exports=A},"0f62":function(m,T,f){var x=f("24fb");T=x(!1),T.push([m.i,".vc-pane-container{width:100%;position:relative}.vc-pane-container.in-transition{overflow:hidden}.vc-pane-layout{display:grid}.vc-arrow{display:flex;justify-content:center;align-items:center;cursor:pointer;-webkit-user-select:none;user-select:none;pointer-events:auto;color:var(--gray-600);border-width:2px;border-style:solid;border-radius:var(--rounded);border-color:transparent}.vc-arrow:hover{background:var(--gray-200)}.vc-arrow:focus{border-color:var(--gray-300)}.vc-arrow.is-disabled{opacity:.25;pointer-events:none;cursor:not-allowed}.vc-day-popover-container{color:var(--white);background-color:var(--gray-800);border:1px solid;border-color:var(--gray-700);border-radius:var(--rounded);font-size:var(--text-xs);font-weight:var(--font-medium);padding:4px 8px;box-shadow:var(--shadow)}.vc-day-popover-header{font-size:var(--text-xs);color:var(--gray-300);font-weight:var(--font-semibold);text-align:center}.vc-arrows-container{width:100%;position:absolute;top:0;display:flex;justify-content:space-between;padding:8px 10px;pointer-events:none}.vc-arrows-container.title-left{justify-content:flex-end}.vc-arrows-container.title-right{justify-content:flex-start}.vc-is-dark .vc-arrow{color:var(--white)}.vc-is-dark .vc-arrow:hover{background:var(--gray-800)}.vc-is-dark .vc-arrow:focus{border-color:var(--gray-700)}.vc-is-dark .vc-day-popover-container{color:var(--gray-800);background-color:var(--white);border-color:var(--gray-100)}.vc-is-dark .vc-day-popover-header{color:var(--gray-700)}",""]),m.exports=T},"100e":function(m,T,f){var x=f("cd9d"),A=f("2286"),i=f("c1c9");function P(O,L){return i(A(O,L,x),O+"")}m.exports=P},1041:function(m,T,f){var x=f("8eeb"),A=f("a029");function i(P,O){return x(P,A(P),O)}m.exports=i},"116a":function(m,T,f){var x=f("24fb");T=x(!1),T.push([m.i,".none-enter-active[data-v-5be4b00c],.none-leave-active[data-v-5be4b00c]{transition-duration:0s}.fade-enter-active[data-v-5be4b00c],.fade-leave-active[data-v-5be4b00c],.slide-down-enter-active[data-v-5be4b00c],.slide-down-leave-active[data-v-5be4b00c],.slide-left-enter-active[data-v-5be4b00c],.slide-left-leave-active[data-v-5be4b00c],.slide-right-enter-active[data-v-5be4b00c],.slide-right-leave-active[data-v-5be4b00c],.slide-up-enter-active[data-v-5be4b00c],.slide-up-leave-active[data-v-5be4b00c]{transition:transform var(--slide-duration) var(--slide-timing),opacity var(--slide-duration) var(--slide-timing);backface-visibility:hidden}.fade-leave-active[data-v-5be4b00c],.none-leave-active[data-v-5be4b00c],.slide-down-leave-active[data-v-5be4b00c],.slide-left-leave-active[data-v-5be4b00c],.slide-right-leave-active[data-v-5be4b00c],.slide-up-leave-active[data-v-5be4b00c]{position:absolute;width:100%}.fade-enter[data-v-5be4b00c],.fade-leave-to[data-v-5be4b00c],.none-enter[data-v-5be4b00c],.none-leave-to[data-v-5be4b00c],.slide-down-enter[data-v-5be4b00c],.slide-down-leave-to[data-v-5be4b00c],.slide-left-enter[data-v-5be4b00c],.slide-left-leave-to[data-v-5be4b00c],.slide-right-enter[data-v-5be4b00c],.slide-right-leave-to[data-v-5be4b00c],.slide-up-enter[data-v-5be4b00c],.slide-up-leave-to[data-v-5be4b00c]{opacity:0}.slide-left-enter[data-v-5be4b00c],.slide-right-leave-to[data-v-5be4b00c]{transform:translateX(var(--slide-translate))}.slide-left-leave-to[data-v-5be4b00c],.slide-right-enter[data-v-5be4b00c]{transform:translateX(calc(var(--slide-translate)*-1))}.slide-down-leave-to[data-v-5be4b00c],.slide-up-enter[data-v-5be4b00c]{transform:translateY(var(--slide-translate))}.slide-down-enter[data-v-5be4b00c],.slide-up-leave-to[data-v-5be4b00c]{transform:translateY(calc(var(--slide-translate)*-1))}",""]),m.exports=T},1205:function(m,T,f){var x=f("b7f0");x.__esModule&&(x=x.default),typeof x=="string"&&(x=[[m.i,x,""]]),x.locals&&(m.exports=x.locals);var A=f("499e").default;A("181b238b",x,!0,{sourceMap:!1,shadowMode:!1})},1290:function(m,T){function f(x){var A=typeof x;return A=="string"||A=="number"||A=="symbol"||A=="boolean"?x!=="__proto__":x===null}m.exports=f},1310:function(m,T){function f(x){return x!=null&&typeof x=="object"}m.exports=f},1315:function(m,T,f){f.d(T,"a",function(){return W}),f("13d5");var x=f("8bbf"),A=f.n(x),i=f("9404");function P(J){return Object(i.n)(J)&&(J={min:J}),Object(i.h)(J)||(J=[J]),J.map(function(fe){return Object(i.e)(fe,"raw")?fe.raw:Object(i.q)(fe,function(_e,we){return we=Object(i.d)({min:"min-width",max:"max-width"},we,we),`(${we}: ${_e})`}).join(" and ")}).join(", ")}var O=f("85a9");let L=!1,U=!1,j=null;function W(J=O,fe){j&&!fe||L||(L=!0,U=!0,j=new A.a({data(){return{matches:[],queries:[]}},methods:{refreshQueries(){var _e=this;window&&window.matchMedia&&(this.queries=Object(i.r)(J,function(we){const ye=window.matchMedia(P(we));return Object(i.k)(ye.addEventListener)?ye.addEventListener("change",_e.refreshMatches):ye.addListener(_e.refreshMatches),ye}),this.refreshMatches())},refreshMatches(){this.matches=Object(i.w)(this.queries).filter(function(_e){return _e[1].matches}).map(function(_e){return _e[0]})}}}),L=!1)}A.a.mixin({beforeCreate(){L||W()},mounted(){U&&j&&(j.refreshQueries(),U=!1)},computed:{$screens(){return function(J,fe){return j.matches.reduce(function(_e,we){return Object(i.e)(J,we)?J[we]:_e},Object(i.o)(fe)?J.default:fe)}}}})},1368:function(m,T,f){var x=f("da03"),A=function(){var P=/[^.]+$/.exec(x&&x.keys&&x.keys.IE_PROTO||"");return P?"Symbol(src)_1."+P:""}();function i(P){return!!A&&A in P}m.exports=i},"13d2":function(m,T,f){var x=f("e330"),A=f("d039"),i=f("1626"),P=f("1a2d"),O=f("83ab"),L=f("5e77").CONFIGURABLE,U=f("8925"),j=f("69f3"),W=j.enforce,J=j.get,fe=String,_e=Object.defineProperty,we=x("".slice),ye=x("".replace),Pe=x([].join),Fe=O&&!A(function(){return _e(function(){},"length",{value:8}).length!==8}),Be=String(String).split("String"),He=m.exports=function(Ce,ve,Te){we(fe(ve),0,7)==="Symbol("&&(ve="["+ye(fe(ve),/^Symbol\(([^)]*)\)/,"$1")+"]"),Te&&Te.getter&&(ve="get "+ve),Te&&Te.setter&&(ve="set "+ve),(!P(Ce,"name")||L&&Ce.name!==ve)&&(O?_e(Ce,"name",{value:ve,configurable:!0}):Ce.name=ve),Fe&&Te&&P(Te,"arity")&&Ce.length!==Te.arity&&_e(Ce,"length",{value:Te.arity});try{Te&&P(Te,"constructor")&&Te.constructor?O&&_e(Ce,"prototype",{writable:!1}):Ce.prototype&&(Ce.prototype=void 0)}catch{}var Ye=W(Ce);return P(Ye,"source")||(Ye.source=Pe(Be,typeof ve=="string"?ve:"")),Ce};Function.prototype.toString=He(function(){return i(this)&&J(this).source||U(this)},"toString")},"13d5":function(m,T,f){var x=f("23e7"),A=f("d58f").left,i=f("a640"),P=f("2d00"),O=f("605d"),L=!O&&P>79&&P<83,U=L||!i("reduce");x({target:"Array",proto:!0,forced:U},{reduce:function(j){var W=arguments.length;return A(this,j,W,W>1?arguments[1]:void 0)}})},"14d9":function(m,T,f){var x=f("23e7"),A=f("7b0b"),i=f("07fa"),P=f("3a34"),O=f("3511"),L=f("d039"),U=L(function(){return[].push.call({length:4294967296},1)!==4294967297}),j=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(J){return J instanceof TypeError}},W=U||!j();x({target:"Array",proto:!0,arity:1,forced:W},{push:function(J){var fe=A(this),_e=i(fe),we=arguments.length;O(_e+we);for(var ye=0;ye<we;ye++)fe[_e]=arguments[ye],_e++;return P(fe,_e),_e}})},"159a":function(m,T,f){var x=f("32b3"),A=f("e2e4"),i=f("c098"),P=f("1a8c"),O=f("f4d6");function L(U,j,W,J){if(!P(U))return U;j=A(j,U);for(var fe=-1,_e=j.length,we=_e-1,ye=U;ye!=null&&++fe<_e;){var Pe=O(j[fe]),Fe=W;if(Pe==="__proto__"||Pe==="constructor"||Pe==="prototype")return U;if(fe!=we){var Be=ye[Pe];Fe=J?J(Be,Pe,ye):void 0,Fe===void 0&&(Fe=P(Be)?Be:i(j[fe+1])?[]:{})}x(ye,Pe,Fe),ye=ye[Pe]}return U}m.exports=L},"15f3":function(m,T,f){var x=f("89d9"),A=f("8604");function i(P,O){return x(P,O,function(L,U){return A(P,U)})}m.exports=i},1626:function(m,T,f){var x=f("8ea1"),A=x.all;m.exports=x.IS_HTMLDDA?function(i){return typeof i=="function"||i===A}:function(i){return typeof i=="function"}},1838:function(m,T,f){var x=f("c05f"),A=f("9b02"),i=f("8604"),P=f("f608"),O=f("08cc"),L=f("20ec"),U=f("f4d6"),j=1,W=2;function J(fe,_e){return P(fe)&&O(_e)?L(U(fe),_e):function(we){var ye=A(we,fe);return ye===void 0&&ye===_e?i(we,fe):x(_e,ye,j|W)}}m.exports=J},"18d8":function(m,T,f){var x=f("234d"),A=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,P=x(function(O){var L=[];return O.charCodeAt(0)===46&&L.push(""),O.replace(A,function(U,j,W,J){L.push(W?J.replace(i,"$1"):j||U)}),L});m.exports=P},"1a2d":function(m,T,f){var x=f("e330"),A=f("7b0b"),i=x({}.hasOwnProperty);m.exports=Object.hasOwn||function(P,O){return i(A(P),O)}},"1a2d0":function(m,T,f){var x=f("42a2"),A=f("1310"),i="[object Map]";function P(O){return A(O)&&x(O)==i}m.exports=P},"1a8c":function(m,T){function f(x){var A=typeof x;return x!=null&&(A=="object"||A=="function")}m.exports=f},"1bac":function(m,T,f){var x=f("7d1f"),A=f("a029"),i=f("9934");function P(O){return x(O,i,A)}m.exports=P},"1c3c":function(m,T,f){var x=f("9e69"),A=f("2474"),i=f("9638"),P=f("a2be"),O=f("edfa"),L=f("ac41"),U=1,j=2,W="[object Boolean]",J="[object Date]",fe="[object Error]",_e="[object Map]",we="[object Number]",ye="[object RegExp]",Pe="[object Set]",Fe="[object String]",Be="[object Symbol]",He="[object ArrayBuffer]",Ce="[object DataView]",ve=x?x.prototype:void 0,Te=ve?ve.valueOf:void 0;function Ye(Oe,lt,Ht,nt,Tt,Rt,vt){switch(Ht){case Ce:if(Oe.byteLength!=lt.byteLength||Oe.byteOffset!=lt.byteOffset)return!1;Oe=Oe.buffer,lt=lt.buffer;case He:return!(Oe.byteLength!=lt.byteLength||!Rt(new A(Oe),new A(lt)));case W:case J:case we:return i(+Oe,+lt);case fe:return Oe.name==lt.name&&Oe.message==lt.message;case ye:case Fe:return Oe==lt+"";case _e:var wr=O;case Pe:var Kr=nt&U;if(wr||(wr=L),Oe.size!=lt.size&&!Kr)return!1;var Gr=vt.get(Oe);if(Gr)return Gr==lt;nt|=j,vt.set(Oe,lt);var Or=P(wr(Oe),wr(lt),nt,Tt,Rt,vt);return vt.delete(Oe),Or;case Be:if(Te)return Te.call(Oe)==Te.call(lt)}return!1}m.exports=Ye},"1c6b":function(m,T,f){f("7d87")},"1cec":function(m,T,f){var x=f("0b07"),A=f("2b3e"),i=x(A,"Promise");m.exports=i},"1d80":function(m,T,f){var x=f("7234"),A=TypeError;m.exports=function(i){if(x(i))throw new A("Can't call method on "+i);return i}},"1efc":function(m,T){function f(x){var A=this.has(x)&&delete this.__data__[x];return this.size-=A?1:0,A}m.exports=f},"1fc8":function(m,T,f){var x=f("4245");function A(i,P){var O=x(this,i),L=O.size;return O.set(i,P),this.size+=O.size==L?0:1,this}m.exports=A},"20ec":function(m,T){function f(x,A){return function(i){return i!=null&&i[x]===A&&(A!==void 0||x in Object(i))}}m.exports=f},2286:function(m,T,f){var x=f("85e3"),A=Math.max;function i(P,O,L){return O=A(O===void 0?P.length-1:O,0),function(){for(var U=arguments,j=-1,W=A(U.length-O,0),J=Array(W);++j<W;)J[j]=U[O+j];j=-1;for(var fe=Array(O+1);++j<O;)fe[j]=U[j];return fe[O]=L(J),x(P,this,fe)}}m.exports=i},"22f3":function(m,T,f){f.d(T,"a",function(){return P}),f("14d9");var x=f("cfe5"),A=f("2fa3"),i=f("9404");class P{constructor({key:L,hashcode:U,highlight:j,content:W,dot:J,bar:fe,popover:_e,dates:we,excludeDates:ye,excludeMode:Pe,customData:Fe,order:Be,pinPage:He},Ce,ve){this.key=Object(i.o)(L)?Object(A.c)():L,this.hashcode=U,this.customData=Fe,this.order=Be||0,this.dateOpts={order:Be,locale:ve},this.pinPage=He,j&&(this.highlight=Ce.normalizeHighlight(j)),W&&(this.content=Ce.normalizeContent(W)),J&&(this.dot=Ce.normalizeDot(J)),fe&&(this.bar=Ce.normalizeBar(fe)),_e&&(this.popover=_e),this.dates=ve.normalizeDates(we,this.dateOpts),this.hasDates=!!Object(A.b)(this.dates),this.excludeDates=ve.normalizeDates(ye,this.dateOpts),this.hasExcludeDates=!!Object(A.b)(this.excludeDates),this.excludeMode=Pe||"intersects",this.hasExcludeDates&&!this.hasDates&&(this.dates.push(new x.a({},this.dateOpts)),this.hasDates=!0),this.isComplex=Object(i.v)(this.dates,function(Te){return Te.isComplex})}intersectsDate(L){return L=L instanceof x.a?L:new x.a(L,this.dateOpts),!this.excludesDate(L)&&(this.dates.find(function(U){return U.intersectsDate(L)})||!1)}includesDate(L){return L=L instanceof x.a?L:new x.a(L,this.dateOpts),!this.excludesDate(L)&&(this.dates.find(function(U){return U.includesDate(L)})||!1)}excludesDate(L){var U=this;return L=L instanceof x.a?L:new x.a(L,this.dateOpts),this.hasExcludeDates&&this.excludeDates.find(function(j){return U.excludeMode==="intersects"&&j.intersectsDate(L)||U.excludeMode==="includes"&&j.includesDate(L)})}intersectsDay(L){return!this.excludesDay(L)&&(this.dates.find(function(U){return U.intersectsDay(L)})||!1)}excludesDay(L){return this.hasExcludeDates&&this.excludeDates.find(function(U){return U.intersectsDay(L)})}}},"234d":function(m,T,f){var x=f("e380"),A=500;function i(P){var O=x(P,function(U){return L.size===A&&L.clear(),U}),L=O.cache;return O}m.exports=i},"23a5":function(m){m.exports=JSON.parse('{"maxSwipeTime":300,"minHorizontalSwipeDistance":60,"maxVerticalSwipeDistance":80}')},"23cb":function(m,T,f){var x=f("5926"),A=Math.max,i=Math.min;m.exports=function(P,O){var L=x(P);return L<0?A(L+O,0):i(L,O)}},"23da":function(m,T,f){var x=f("3963");x.__esModule&&(x=x.default),typeof x=="string"&&(x=[[m.i,x,""]]),x.locals&&(m.exports=x.locals);var A=f("499e").default;A("9371b050",x,!0,{sourceMap:!1,shadowMode:!1})},"23e7":function(m,T,f){var x=f("da84"),A=f("06cf").f,i=f("9112"),P=f("cb2d"),O=f("6374"),L=f("e893"),U=f("94ca");m.exports=function(j,W){var J,fe,_e,we,ye,Pe,Fe=j.target,Be=j.global,He=j.stat;if(fe=Be?x:He?x[Fe]||O(Fe,{}):(x[Fe]||{}).prototype,fe)for(_e in W){if(ye=W[_e],j.dontCallGetSet?(Pe=A(fe,_e),we=Pe&&Pe.value):we=fe[_e],J=U(Be?_e:Fe+(He?".":"#")+_e,j.forced),!J&&we!==void 0){if(typeof ye==typeof we)continue;L(ye,we)}(j.sham||we&&we.sham)&&i(ye,"sham",!0),P(fe,_e,ye,j)}}},2411:function(m,T,f){var x=f("f909"),A=f("2ec1"),i=A(function(P,O,L,U){x(P,O,L,U)});m.exports=i},"241c":function(m,T,f){var x=f("ca84"),A=f("7839"),i=A.concat("length","prototype");T.f=Object.getOwnPropertyNames||function(P){return x(P,i)}},"242e":function(m,T,f){var x=f("72af"),A=f("ec69");function i(P,O){return P&&x(P,O,A)}m.exports=i},2474:function(m,T,f){var x=f("2b3e"),A=x.Uint8Array;m.exports=A},2478:function(m,T,f){var x=f("4245");function A(i){return x(this,i).get(i)}m.exports=A},"24fb":function(m,T,f){function x(i,P){var O=i[1]||"",L=i[3];if(!L)return O;if(P&&typeof btoa=="function"){var U=A(L),j=L.sources.map(function(W){return"/*# sourceURL=".concat(L.sourceRoot||"").concat(W," */")});return[O].concat(j).concat([U]).join(`
`)}return[O].join(`
`)}function A(i){var P=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),O="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(P);return"/*# ".concat(O," */")}m.exports=function(i){var P=[];return P.toString=function(){return this.map(function(O){var L=x(O,i);return O[2]?"@media ".concat(O[2]," {").concat(L,"}"):L}).join("")},P.i=function(O,L,U){typeof O=="string"&&(O=[[null,O,""]]);var j={};if(U)for(var W=0;W<this.length;W++){var J=this[W][0];J!=null&&(j[J]=!0)}for(var fe=0;fe<O.length;fe++){var _e=[].concat(O[fe]);U&&j[_e[0]]||(L&&(_e[2]?_e[2]="".concat(L," and ").concat(_e[2]):_e[2]=L),P.push(_e))}},P}},2524:function(m,T,f){var x=f("6044"),A="__lodash_hash_undefined__";function i(P,O){var L=this.__data__;return this.size+=this.has(P)?0:1,L[P]=x&&O===void 0?A:O,this}m.exports=i},"253c":function(m,T,f){var x=f("3729"),A=f("1310"),i="[object Arguments]";function P(O){return A(O)&&x(O)==i}m.exports=P},2593:function(m,T,f){var x=f("15f3"),A=f("c6cf"),i=A(function(P,O){return P==null?{}:x(P,O)});m.exports=i},"26e8":function(m,T){function f(x,A){return x!=null&&A in Object(x)}m.exports=f},2745:function(m,T,f){f("5332")},"28c9":function(m,T){function f(){this.__data__=[],this.size=0}m.exports=f},"29ae":function(m,T,f){f.d(T,"a",function(){return Ut}),f.d(T,"b",function(){return mt}),f("14d9"),f("d9e2"),f("13d5");var x=f("2cfd"),A=f.n(x),i=f("5465"),P=f.n(i);function O(ce,ee){var me=J(ee);return me.formatToParts?U(me,ce):j(me,ce)}var L={year:0,month:1,day:2,hour:3,minute:4,second:5};function U(ce,ee){try{for(var me=ce.formatToParts(ee),xe=[],Ve=0;Ve<me.length;Ve++){var Ue=L[me[Ve].type];Ue>=0&&(xe[Ue]=parseInt(me[Ve].value,10))}return xe}catch(Xe){if(Xe instanceof RangeError)return[NaN];throw Xe}}function j(ce,ee){var me=ce.format(ee).replace(/\u200E/g,""),xe=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(me);return[xe[3],xe[1],xe[2],xe[4],xe[5],xe[6]]}var W={};function J(ce){if(!W[ce]){var ee=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:"America/New_York",year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),me=ee==="06/25/2014, 00:00:00"||ee==="06/25/2014 00:00:00";W[ce]=me?new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:ce,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:ce,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}return W[ce]}function fe(ce,ee,me,xe,Ve,Ue,Xe){var yt=new Date(0);return yt.setUTCFullYear(ce,ee,me),yt.setUTCHours(xe,Ve,Ue,Xe),yt}var _e=36e5,we=6e4,ye={timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-]\d{2}):?(\d{2})$/};function Pe(ce,ee,me){var xe,Ve,Ue;if(!ce||(xe=ye.timezoneZ.exec(ce),xe))return 0;if(xe=ye.timezoneHH.exec(ce),xe)return Ue=parseInt(xe[1],10),Ce(Ue)?-Ue*_e:NaN;if(xe=ye.timezoneHHMM.exec(ce),xe){Ue=parseInt(xe[1],10);var Xe=parseInt(xe[2],10);return Ce(Ue,Xe)?(Ve=Math.abs(Ue)*_e+Xe*we,Ue>0?-Ve:Ve):NaN}if(Te(ce)){ee=new Date(ee||Date.now());var yt=me?ee:Fe(ee),rt=Be(yt,ce),Zt=me?rt:He(ee,rt,ce);return-Zt}return NaN}function Fe(ce){return fe(ce.getFullYear(),ce.getMonth(),ce.getDate(),ce.getHours(),ce.getMinutes(),ce.getSeconds(),ce.getMilliseconds())}function Be(ce,ee){var me=O(ce,ee),xe=fe(me[0],me[1]-1,me[2],me[3]%24,me[4],me[5],0).getTime(),Ve=ce.getTime(),Ue=Ve%1e3;return Ve-=Ue>=0?Ue:1e3+Ue,xe-Ve}function He(ce,ee,me){var xe=ce.getTime(),Ve=xe-ee,Ue=Be(new Date(Ve),me);if(ee===Ue)return ee;Ve-=Ue-ee;var Xe=Be(new Date(Ve),me);return Ue===Xe?Ue:Math.max(Ue,Xe)}function Ce(ce,ee){return-23<=ce&&ce<=23&&(ee==null||0<=ee&&ee<=59)}var ve={};function Te(ce){if(ve[ce])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:ce}),ve[ce]=!0,!0}catch{return!1}}var Ye=/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/,Oe=Ye,lt=36e5,Ht=6e4,nt=2,Tt={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:Oe};function Rt(ce,ee){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(ce===null)return new Date(NaN);var me=ee||{},xe=me.additionalDigits==null?nt:A()(me.additionalDigits);if(xe!==2&&xe!==1&&xe!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(ce instanceof Date||typeof ce=="object"&&Object.prototype.toString.call(ce)==="[object Date]")return new Date(ce.getTime());if(typeof ce=="number"||Object.prototype.toString.call(ce)==="[object Number]")return new Date(ce);if(typeof ce!="string"&&Object.prototype.toString.call(ce)!=="[object String]")return new Date(NaN);var Ve=vt(ce),Ue=wr(Ve.date,xe),Xe=Ue.year,yt=Ue.restDateString,rt=Kr(yt,Xe);if(isNaN(rt))return new Date(NaN);if(rt){var Zt,fn=rt.getTime(),zt=0;if(Ve.time&&(zt=Gr(Ve.time),isNaN(zt)))return new Date(NaN);if(Ve.timeZone||me.timeZone){if(Zt=Pe(Ve.timeZone||me.timeZone,new Date(fn+zt)),isNaN(Zt))return new Date(NaN)}else Zt=P()(new Date(fn+zt)),Zt=P()(new Date(fn+zt+Zt));return new Date(fn+zt+Zt)}return new Date(NaN)}function vt(ce){var ee,me={},xe=Tt.dateTimePattern.exec(ce);if(xe?(me.date=xe[1],ee=xe[3]):(xe=Tt.datePattern.exec(ce),xe?(me.date=xe[1],ee=xe[2]):(me.date=null,ee=ce)),ee){var Ve=Tt.timeZone.exec(ee);Ve?(me.time=ee.replace(Ve[1],""),me.timeZone=Ve[1].trim()):me.time=ee}return me}function wr(ce,ee){var me,xe=Tt.YYY[ee],Ve=Tt.YYYYY[ee];if(me=Tt.YYYY.exec(ce)||Ve.exec(ce),me){var Ue=me[1];return{year:parseInt(Ue,10),restDateString:ce.slice(Ue.length)}}if(me=Tt.YY.exec(ce)||xe.exec(ce),me){var Xe=me[1];return{year:100*parseInt(Xe,10),restDateString:ce.slice(Xe.length)}}return{year:null}}function Kr(ce,ee){if(ee===null)return null;var me,xe,Ve,Ue;if(ce.length===0)return xe=new Date(0),xe.setUTCFullYear(ee),xe;if(me=Tt.MM.exec(ce),me)return xe=new Date(0),Ve=parseInt(me[1],10)-1,zr(ee,Ve)?(xe.setUTCFullYear(ee,Ve),xe):new Date(NaN);if(me=Tt.DDD.exec(ce),me){xe=new Date(0);var Xe=parseInt(me[1],10);return It(ee,Xe)?(xe.setUTCFullYear(ee,0,Xe),xe):new Date(NaN)}if(me=Tt.MMDD.exec(ce),me){xe=new Date(0),Ve=parseInt(me[1],10)-1;var yt=parseInt(me[2],10);return zr(ee,Ve,yt)?(xe.setUTCFullYear(ee,Ve,yt),xe):new Date(NaN)}if(me=Tt.Www.exec(ce),me)return Ue=parseInt(me[1],10)-1,mn(ee,Ue)?Or(ee,Ue):new Date(NaN);if(me=Tt.WwwD.exec(ce),me){Ue=parseInt(me[1],10)-1;var rt=parseInt(me[2],10)-1;return mn(ee,Ue,rt)?Or(ee,Ue,rt):new Date(NaN)}return null}function Gr(ce){var ee,me,xe;if(ee=Tt.HH.exec(ce),ee)return me=parseFloat(ee[1].replace(",",".")),on(me)?me%24*lt:NaN;if(ee=Tt.HHMM.exec(ce),ee)return me=parseInt(ee[1],10),xe=parseFloat(ee[2].replace(",",".")),on(me,xe)?me%24*lt+xe*Ht:NaN;if(ee=Tt.HHMMSS.exec(ce),ee){me=parseInt(ee[1],10),xe=parseInt(ee[2],10);var Ve=parseFloat(ee[3].replace(",","."));return on(me,xe,Ve)?me%24*lt+xe*Ht+1e3*Ve:NaN}return null}function Or(ce,ee,me){ee=ee||0,me=me||0;var xe=new Date(0);xe.setUTCFullYear(ce,0,4);var Ve=xe.getUTCDay()||7,Ue=7*ee+me+1-Ve;return xe.setUTCDate(xe.getUTCDate()+Ue),xe}var yi=[31,28,31,30,31,30,31,31,30,31,30,31],Hr=[31,29,31,30,31,30,31,31,30,31,30,31];function oi(ce){return ce%400===0||ce%4===0&&ce%100!==0}function zr(ce,ee,me){if(ee<0||ee>11)return!1;if(me!=null){if(me<1)return!1;var xe=oi(ce);if(xe&&me>Hr[ee]||!xe&&me>yi[ee])return!1}return!0}function It(ce,ee){if(ee<1)return!1;var me=oi(ce);return!(me&&ee>366)&&!(!me&&ee>365)}function mn(ce,ee,me){return!(ee<0||ee>52)&&(me==null||!(me<0||me>6))}function on(ce,ee,me){return(ce==null||!(ce<0||ce>=25))&&(ee==null||!(ee<0||ee>=60))&&(me==null||!(me<0||me>=60))}var an=f("fd3a"),$n=f("fe1f"),Gn=f("8c86"),De={};function Re(){return De}function ft(ce,ee){var me,xe,Ve,Ue,Xe,yt,rt,Zt;Object(Gn.a)(1,arguments);var fn=Re(),zt=Object($n.a)((me=(xe=(Ve=(Ue=ee==null?void 0:ee.weekStartsOn)!==null&&Ue!==void 0?Ue:ee==null||(Xe=ee.locale)===null||Xe===void 0||(yt=Xe.options)===null||yt===void 0?void 0:yt.weekStartsOn)!==null&&Ve!==void 0?Ve:fn.weekStartsOn)!==null&&xe!==void 0?xe:(rt=fn.locale)===null||rt===void 0||(Zt=rt.options)===null||Zt===void 0?void 0:Zt.weekStartsOn)!==null&&me!==void 0?me:0);if(!(zt>=0&&zt<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var Rn=Object(an.a)(ce),zn=Rn.getDay(),Hn=(zn<zt?7:0)+zn-zt;return Rn.setDate(Rn.getDate()-Hn),Rn.setHours(0,0,0,0),Rn}function Lt(ce){return Object(Gn.a)(1,arguments),ft(ce,{weekStartsOn:1})}function Ot(ce){Object(Gn.a)(1,arguments);var ee=Object(an.a)(ce),me=ee.getFullYear(),xe=new Date(0);xe.setFullYear(me+1,0,4),xe.setHours(0,0,0,0);var Ve=Lt(xe),Ue=new Date(0);Ue.setFullYear(me,0,4),Ue.setHours(0,0,0,0);var Xe=Lt(Ue);return ee.getTime()>=Ve.getTime()?me+1:ee.getTime()>=Xe.getTime()?me:me-1}function Kt(ce){Object(Gn.a)(1,arguments);var ee=Ot(ce),me=new Date(0);me.setFullYear(ee,0,4),me.setHours(0,0,0,0);var xe=Lt(me);return xe}var dn=6048e5;function Vt(ce){Object(Gn.a)(1,arguments);var ee=Object(an.a)(ce),me=Lt(ee).getTime()-Kt(ee).getTime();return Math.round(me/dn)+1}function Gt(ce,ee){var me,xe,Ve,Ue,Xe,yt,rt,Zt;Object(Gn.a)(1,arguments);var fn=Object(an.a)(ce),zt=fn.getFullYear(),Rn=Re(),zn=Object($n.a)((me=(xe=(Ve=(Ue=ee==null?void 0:ee.firstWeekContainsDate)!==null&&Ue!==void 0?Ue:ee==null||(Xe=ee.locale)===null||Xe===void 0||(yt=Xe.options)===null||yt===void 0?void 0:yt.firstWeekContainsDate)!==null&&Ve!==void 0?Ve:Rn.firstWeekContainsDate)!==null&&xe!==void 0?xe:(rt=Rn.locale)===null||rt===void 0||(Zt=rt.options)===null||Zt===void 0?void 0:Zt.firstWeekContainsDate)!==null&&me!==void 0?me:1);if(!(zn>=1&&zn<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var Hn=new Date(0);Hn.setFullYear(zt+1,0,zn),Hn.setHours(0,0,0,0);var ni=ft(Hn,ee),ar=new Date(0);ar.setFullYear(zt,0,zn),ar.setHours(0,0,0,0);var Qn=ft(ar,ee);return fn.getTime()>=ni.getTime()?zt+1:fn.getTime()>=Qn.getTime()?zt:zt-1}function Yt(ce,ee){var me,xe,Ve,Ue,Xe,yt,rt,Zt;Object(Gn.a)(1,arguments);var fn=Re(),zt=Object($n.a)((me=(xe=(Ve=(Ue=ee==null?void 0:ee.firstWeekContainsDate)!==null&&Ue!==void 0?Ue:ee==null||(Xe=ee.locale)===null||Xe===void 0||(yt=Xe.options)===null||yt===void 0?void 0:yt.firstWeekContainsDate)!==null&&Ve!==void 0?Ve:fn.firstWeekContainsDate)!==null&&xe!==void 0?xe:(rt=fn.locale)===null||rt===void 0||(Zt=rt.options)===null||Zt===void 0?void 0:Zt.firstWeekContainsDate)!==null&&me!==void 0?me:1),Rn=Gt(ce,ee),zn=new Date(0);zn.setFullYear(Rn,0,zt),zn.setHours(0,0,0,0);var Hn=ft(zn,ee);return Hn}var qt=6048e5;function Mn(ce,ee){Object(Gn.a)(1,arguments);var me=Object(an.a)(ce),xe=ft(me,ee).getTime()-Yt(me,ee).getTime();return Math.round(xe/qt)+1}function En(ce){var ee=new Date(Date.UTC(ce.getFullYear(),ce.getMonth(),ce.getDate(),ce.getHours(),ce.getMinutes(),ce.getSeconds(),ce.getMilliseconds()));return ee.setUTCFullYear(ce.getFullYear()),ce.getTime()-ee.getTime()}var Qe=6048e5;function re(ce,ee,me){Object(Gn.a)(2,arguments);var xe=ft(ce,me),Ve=ft(ee,me),Ue=xe.getTime()-En(xe),Xe=Ve.getTime()-En(Ve);return Math.round((Ue-Xe)/Qe)}function ue(ce){Object(Gn.a)(1,arguments);var ee=Object(an.a)(ce),me=ee.getMonth();return ee.setFullYear(ee.getFullYear(),me+1,0),ee.setHours(0,0,0,0),ee}function Ee(ce){Object(Gn.a)(1,arguments);var ee=Object(an.a)(ce);return ee.setDate(1),ee.setHours(0,0,0,0),ee}function it(ce,ee){return Object(Gn.a)(1,arguments),re(ue(ce),Ee(ce),ee)+1}var pt=f("f7f1"),Mt=f("cfe5"),nn=f("f15d"),Ke=f("2fa3"),jt=f("9404");const Ut={DATE_TIME:1,DATE:2,TIME:3},tn={1:["year","month","day","hours","minutes","seconds","milliseconds"],2:["year","month","day"],3:["hours","minutes","seconds","milliseconds"]},Sn=/d{1,2}|W{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|Z{1,4}|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,Ln=/\d\d?/,Dr=/\d{3}/,Nr=/\d{4}/,hr=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Tr=/\[([^]*?)\]/gm,Rr=function(){},$r=function(ce){return function(ee,me,xe){const Ve=xe[ce].indexOf(me.charAt(0).toUpperCase()+me.substr(1).toLowerCase());~Ve&&(ee.month=Ve)}},Di=["L","iso"],dr=7,io=[31,28,31,30,31,30,31,31,30,31,30,31],Ji=[{value:0,label:"00"},{value:1,label:"01"},{value:2,label:"02"},{value:3,label:"03"},{value:4,label:"04"},{value:5,label:"05"},{value:6,label:"06"},{value:7,label:"07"},{value:8,label:"08"},{value:9,label:"09"},{value:10,label:"10"},{value:11,label:"11"},{value:12,label:"12"},{value:13,label:"13"},{value:14,label:"14"},{value:15,label:"15"},{value:16,label:"16"},{value:17,label:"17"},{value:18,label:"18"},{value:19,label:"19"},{value:20,label:"20"},{value:21,label:"21"},{value:22,label:"22"},{value:23,label:"23"}],oo={D(ce){return ce.day},DD(ce){return Object(Ke.m)(ce.day)},Do(ce,ee){return ee.DoFn(ce.day)},d(ce){return ce.weekday-1},dd(ce){return Object(Ke.m)(ce.weekday-1)},W(ce,ee){return ee.dayNamesNarrow[ce.weekday-1]},WW(ce,ee){return ee.dayNamesShorter[ce.weekday-1]},WWW(ce,ee){return ee.dayNamesShort[ce.weekday-1]},WWWW(ce,ee){return ee.dayNames[ce.weekday-1]},M(ce){return ce.month},MM(ce){return Object(Ke.m)(ce.month)},MMM(ce,ee){return ee.monthNamesShort[ce.month-1]},MMMM(ce,ee){return ee.monthNames[ce.month-1]},YY(ce){return String(ce.year).substr(2)},YYYY(ce){return Object(Ke.m)(ce.year,4)},h(ce){return ce.hours%12||12},hh(ce){return Object(Ke.m)(ce.hours%12||12)},H(ce){return ce.hours},HH(ce){return Object(Ke.m)(ce.hours)},m(ce){return ce.minutes},mm(ce){return Object(Ke.m)(ce.minutes)},s(ce){return ce.seconds},ss(ce){return Object(Ke.m)(ce.seconds)},S(ce){return Math.round(ce.milliseconds/100)},SS(ce){return Object(Ke.m)(Math.round(ce.milliseconds/10),2)},SSS(ce){return Object(Ke.m)(ce.milliseconds,3)},a(ce,ee){return ce.hours<12?ee.amPm[0]:ee.amPm[1]},A(ce,ee){return ce.hours<12?ee.amPm[0].toUpperCase():ee.amPm[1].toUpperCase()},Z(){return"Z"},ZZ(ce){const ee=ce.timezoneOffset;return`${ee>0?"-":"+"}${Object(Ke.m)(Math.floor(Math.abs(ee)/60),2)}`},ZZZ(ce){const ee=ce.timezoneOffset;return`${ee>0?"-":"+"}${Object(Ke.m)(100*Math.floor(Math.abs(ee)/60)+Math.abs(ee)%60,4)}`},ZZZZ(ce){const ee=ce.timezoneOffset;return`${ee>0?"-":"+"}${Object(Ke.m)(Math.floor(Math.abs(ee)/60),2)}:${Object(Ke.m)(Math.abs(ee)%60,2)}`}},rr={D:[Ln,function(ce,ee){ce.day=ee}],Do:[new RegExp(Ln.source+hr.source),function(ce,ee){ce.day=parseInt(ee,10)}],d:[Ln,Rr],W:[hr,Rr],M:[Ln,function(ce,ee){ce.month=ee-1}],MMM:[hr,$r("monthNamesShort")],MMMM:[hr,$r("monthNames")],YY:[Ln,function(ce,ee){const me=new Date,xe=+me.getFullYear().toString().substr(0,2);ce.year=`${ee>68?xe-1:xe}${ee}`}],YYYY:[Nr,function(ce,ee){ce.year=ee}],S:[/\d/,function(ce,ee){ce.millisecond=100*ee}],SS:[/\d{2}/,function(ce,ee){ce.millisecond=10*ee}],SSS:[Dr,function(ce,ee){ce.millisecond=ee}],h:[Ln,function(ce,ee){ce.hour=ee}],m:[Ln,function(ce,ee){ce.minute=ee}],s:[Ln,function(ce,ee){ce.second=ee}],a:[hr,function(ce,ee,me){const xe=ee.toLowerCase();xe===me.amPm[0]?ce.isPm=!1:xe===me.amPm[1]&&(ce.isPm=!0)}],Z:[/[^\s]*?[+-]\d\d:?\d\d|[^\s]*?Z?/,function(ce,ee){ee==="Z"&&(ee="+00:00");const me=(""+ee).match(/([+-]|\d\d)/gi);if(me){const xe=60*me[1]+parseInt(me[2],10);ce.timezoneOffset=me[0]==="+"?xe:-xe}}]};function vi(ce,ee){const me=new Intl.DateTimeFormat().resolvedOptions().locale;let xe;Object(jt.n)(ce)?xe=ce:Object(jt.e)(ce,"id")&&(xe=ce.id),xe=(xe||me).toLowerCase();const Ve=Object.keys(ee),Ue=function(yt){return Ve.find(function(rt){return rt.toLowerCase()===yt})};xe=Ue(xe)||Ue(xe.substring(0,2))||me;const Xe={...ee["en-IE"],...ee[xe],id:xe};return ce=Object(jt.m)(ce)?Object(jt.c)(ce,Xe):Xe,ce}rr.DD=rr.D,rr.dd=rr.d,rr.WWWW=rr.WWW=rr.WW=rr.W,rr.MM=rr.M,rr.mm=rr.m,rr.hh=rr.H=rr.HH=rr.h,rr.ss=rr.s,rr.A=rr.a,rr.ZZZZ=rr.ZZZ=rr.ZZ=rr.Z;class mt{constructor(ee,{locales:me=nn.a,timezone:xe}={}){const{id:Ve,firstDayOfWeek:Ue,masks:Xe}=vi(ee,me);this.id=Ve,this.daysInWeek=dr,this.firstDayOfWeek=Object(jt.a)(Ue,1,dr),this.masks=Xe,this.timezone=xe||void 0,this.dayNames=this.getDayNames("long"),this.dayNamesShort=this.getDayNames("short"),this.dayNamesShorter=this.dayNamesShort.map(function(yt){return yt.substring(0,2)}),this.dayNamesNarrow=this.getDayNames("narrow"),this.monthNames=this.getMonthNames("long"),this.monthNamesShort=this.getMonthNames("short"),this.amPm=["am","pm"],this.monthData={},this.getMonthComps=this.getMonthComps.bind(this),this.parse=this.parse.bind(this),this.format=this.format.bind(this),this.toPage=this.toPage.bind(this)}format(ee,me){var xe=this;if(ee=this.normalizeDate(ee),!ee)return"";me=this.normalizeMasks(me)[0];const Ve=[];me=me.replace(Tr,function(yt,rt){return Ve.push(rt),"??"});const Ue=/Z$/.test(me)?"utc":this.timezone,Xe=this.getDateParts(ee,Ue);return me=me.replace(Sn,function(yt){return yt in oo?oo[yt](Xe,xe):yt.slice(1,yt.length-1)}),me.replace(/\?\?/g,function(){return Ve.shift()})}parse(ee,me){var xe=this;return this.normalizeMasks(me).map(function(Ue){if(typeof Ue!="string")throw new Error("Invalid mask in fecha.parse");let Xe=ee;if(Xe.length>1e3)return!1;let yt=!0;const rt={};if(Ue.replace(Sn,function(zt){if(rr[zt]){const Rn=rr[zt],zn=Xe.search(Rn[0]);~zn?Xe.replace(Rn[0],function(Hn){return Rn[1](rt,Hn,xe),Xe=Xe.substr(zn+Hn.length),Hn}):yt=!1}return rr[zt]?"":zt.slice(1,zt.length-1)}),!yt)return!1;const Zt=new Date;let fn;return rt.isPm===!0&&rt.hour!=null&&+rt.hour!=12?rt.hour=+rt.hour+12:rt.isPm===!1&&+rt.hour==12&&(rt.hour=0),rt.timezoneOffset!=null?(rt.minute=+(rt.minute||0)-+rt.timezoneOffset,fn=new Date(Date.UTC(rt.year||Zt.getFullYear(),rt.month||0,rt.day||1,rt.hour||0,rt.minute||0,rt.second||0,rt.millisecond||0))):fn=xe.getDateFromParts({year:rt.year||Zt.getFullYear(),month:(rt.month||0)+1,day:rt.day||1,hours:rt.hour||0,minutes:rt.minute||0,seconds:rt.second||0,milliseconds:rt.millisecond||0}),fn}).find(function(Ue){return Ue})||new Date(ee)}normalizeMasks(ee){var me=this;return(Object(Ke.b)(ee)&&ee||[Object(jt.n)(ee)&&ee||"YYYY-MM-DD"]).map(function(xe){return Di.reduce(function(Ve,Ue){return Ve.replace(Ue,me.masks[Ue]||"")},xe)})}normalizeDate(ee,me={}){let xe=null,{type:Ve,fillDate:Ue}=me;const{mask:Xe,patch:yt,time:rt}=me,Zt=Ve==="auto"||!Ve;if(Object(jt.l)(ee)?(Ve="number",xe=new Date(+ee)):Object(jt.n)(ee)?(Ve="string",xe=ee?this.parse(ee,Xe||"iso"):null):Object(jt.m)(ee)?(Ve="object",xe=this.getDateFromParts(ee)):(Ve="date",xe=Object(jt.j)(ee)?new Date(ee.getTime()):null),xe&&yt){Ue=Ue==null?new Date:this.normalizeDate(Ue);const fn={...this.getDateParts(Ue),...Object(jt.t)(this.getDateParts(xe),tn[yt])};xe=this.getDateFromParts(fn)}return Zt&&(me.type=Ve),xe&&!isNaN(xe.getTime())?(rt&&(xe=this.adjustTimeForDate(xe,{timeAdjust:rt})),xe):null}denormalizeDate(ee,{type:me,mask:xe}={}){switch(me){case"number":return ee?ee.getTime():NaN;case"string":return ee?this.format(ee,xe||"iso"):"";default:return ee?new Date(ee):null}}hourIsValid(ee,me,xe){if(!me)return!0;if(Object(jt.h)(me))return me.includes(ee);if(Object(jt.m)(me)){const Ve=me.min||0,Ue=me.max||24;return Ve<=ee&&Ue>=ee}return me(ee,xe)}getHourOptions(ee,me){var xe=this;return Ji.filter(function(Ve){return xe.hourIsValid(Ve.value,ee,me)})}getMinuteOptions(ee){const me=[];ee=ee>0?ee:1;for(let xe=0;xe<=59;xe+=ee)me.push({value:xe,label:Object(Ke.m)(xe,2)});return me}nearestOptionValue(ee,me){if(ee==null)return ee;const xe=me.reduce(function(Ve,Ue){if(Ue.disabled)return Ve;if(isNaN(Ve))return Ue.value;const Xe=Math.abs(Ve-ee);return Math.abs(Ue.value-ee)<Xe?Ue.value:Ve},NaN);return isNaN(xe)?ee:xe}adjustTimeForDate(ee,{timeAdjust:me,validHours:xe,minuteIncrement:Ve}){if(!me&&!xe&&!Ve)return ee;const Ue=this.getDateParts(ee);if(me)if(me==="now"){const Xe=this.getDateParts(new Date);Ue.hours=Xe.hours,Ue.minutes=Xe.minutes,Ue.seconds=Xe.seconds,Ue.milliseconds=Xe.milliseconds}else{const Xe=new Date(`2000-01-01T${me}Z`);Ue.hours=Xe.getUTCHours(),Ue.minutes=Xe.getUTCMinutes(),Ue.seconds=Xe.getUTCSeconds(),Ue.milliseconds=Xe.getUTCMilliseconds()}if(xe){const Xe=this.getHourOptions(xe,Ue);Ue.hours=this.nearestOptionValue(Ue.hours,Xe)}if(Ve){const Xe=this.getMinuteOptions(Ve);Ue.minutes=this.nearestOptionValue(Ue.minutes,Xe)}return ee=this.getDateFromParts(Ue),ee}normalizeDates(ee,me){return me=me||{},me.locale=this,(Object(jt.h)(ee)?ee:[ee]).map(function(xe){return xe&&(xe instanceof Mt.a?xe:new Mt.a(xe,me))}).filter(function(xe){return xe})}getDateParts(ee,me=this.timezone){if(!ee)return null;let xe=ee;if(me){const Gi=new Date(ee.toLocaleString("en-US",{timeZone:me}));Gi.setMilliseconds(ee.getMilliseconds());const di=Gi.getTime()-ee.getTime();xe=new Date(ee.getTime()+di)}const Ve=xe.getMilliseconds(),Ue=xe.getSeconds(),Xe=xe.getMinutes(),yt=xe.getHours(),rt=xe.getMonth()+1,Zt=xe.getFullYear(),fn=this.getMonthComps(rt,Zt),zt=xe.getDate(),Rn=fn.days-zt+1,zn=xe.getDay()+1,Hn=Math.floor((zt-1)/7+1),ni=Math.floor((fn.days-zt)/7+1),ar=Math.ceil((zt+Math.abs(fn.firstWeekday-fn.firstDayOfWeek))/7),Qn=fn.weeks-ar+1,ki={milliseconds:Ve,seconds:Ue,minutes:Xe,hours:yt,day:zt,dayFromEnd:Rn,weekday:zn,weekdayOrdinal:Hn,weekdayOrdinalFromEnd:ni,week:ar,weekFromEnd:Qn,month:rt,year:Zt,date:ee,isValid:!0};return ki.timezoneOffset=this.getTimezoneOffset(ki),ki}getDateFromParts(ee){if(!ee)return null;const me=new Date,{year:xe=me.getFullYear(),month:Ve=me.getMonth()+1,day:Ue=me.getDate(),hours:Xe=0,minutes:yt=0,seconds:rt=0,milliseconds:Zt=0}=ee;if(this.timezone){const fn=`${Object(Ke.m)(xe,4)}-${Object(Ke.m)(Ve,2)}-${Object(Ke.m)(Ue,2)}T${Object(Ke.m)(Xe,2)}:${Object(Ke.m)(yt,2)}:${Object(Ke.m)(rt,2)}.${Object(Ke.m)(Zt,3)}`;return Rt(fn,{timeZone:this.timezone})}return new Date(xe,Ve-1,Ue,Xe,yt,rt,Zt)}getTimezoneOffset(ee){const{year:me,month:xe,day:Ve,hours:Ue=0,minutes:Xe=0,seconds:yt=0,milliseconds:rt=0}=ee;let Zt;const fn=new Date(Date.UTC(me,xe-1,Ve,Ue,Xe,yt,rt));if(this.timezone){const zt=`${Object(Ke.m)(me,4)}-${Object(Ke.m)(xe,2)}-${Object(Ke.m)(Ve,2)}T${Object(Ke.m)(Ue,2)}:${Object(Ke.m)(Xe,2)}:${Object(Ke.m)(yt,2)}.${Object(Ke.m)(rt,3)}`;Zt=Rt(zt,{timeZone:this.timezone})}else Zt=new Date(me,xe-1,Ve,Ue,Xe,yt,rt);return(Zt-fn)/6e4}toPage(ee,me){return Object(jt.l)(ee)?Object(Ke.a)(me,ee):Object(jt.n)(ee)?this.getDateParts(this.normalizeDate(ee)):Object(jt.j)(ee)?this.getDateParts(ee):Object(jt.m)(ee)?ee:null}getMonthDates(ee=2e3){const me=[];for(let xe=0;xe<12;xe++)me.push(new Date(ee,xe,15));return me}getMonthNames(ee){const me=new Intl.DateTimeFormat(this.id,{month:ee,timezome:"UTC"});return this.getMonthDates().map(function(xe){return me.format(xe)})}getWeekdayDates(ee=this.firstDayOfWeek){const me=[],Ue=5+ee-1;for(let Xe=0;Xe<dr;Xe++)me.push(this.getDateFromParts({year:2020,month:1,day:Ue+Xe,hours:12}));return me}getDayNames(ee){const me=new Intl.DateTimeFormat(this.id,{weekday:ee,timeZone:this.timezone});return this.getWeekdayDates(1).map(function(xe){return me.format(xe)})}getMonthComps(ee,me){const xe=`${ee}-${me}`;let Ve=this.monthData[xe];if(!Ve){const Ue=me%4===0&&me%100!==0||me%400===0,Xe=new Date(me,ee-1,1),yt=Xe.getDay()+1,rt=ee===2&&Ue?29:io[ee-1],Zt=this.firstDayOfWeek-1,fn=it(Xe,{weekStartsOn:Zt}),zt=[],Rn=[];for(let zn=0;zn<fn;zn++){const Hn=Object(pt.a)(Xe,7*zn);zt.push(Mn(Hn,{weekStartsOn:Zt})),Rn.push(Vt(Hn))}Ve={firstDayOfWeek:this.firstDayOfWeek,inLeapYear:Ue,firstWeekday:yt,days:rt,weeks:fn,month:ee,year:me,weeknumbers:zt,isoWeeknumbers:Rn},this.monthData[xe]=Ve}return Ve}getThisMonthComps(){const{month:ee,year:me}=this.getDateParts(new Date);return this.getMonthComps(ee,me)}getPrevMonthComps(ee,me){return ee===1?this.getMonthComps(12,me-1):this.getMonthComps(ee-1,me)}getNextMonthComps(ee,me){return ee===12?this.getMonthComps(1,me+1):this.getMonthComps(ee+1,me)}getDayId(ee){return this.format(ee,"YYYY-MM-DD")}getCalendarDays({weeks:ee,monthComps:me,prevMonthComps:xe,nextMonthComps:Ve}){var Ue=this;const Xe=[],{firstDayOfWeek:yt,firstWeekday:rt,isoWeeknumbers:Zt,weeknumbers:fn}=me,zt=rt+(rt<yt?dr:0)-yt;let Rn=!0,zn=!1,Hn=!1;const ni=new Intl.DateTimeFormat(this.id,{weekday:"long",year:"numeric",month:"long",day:"numeric"});let ar=xe.days-zt+1,Qn=xe.days-ar+1,ki=Math.floor((ar-1)/dr+1),Gi=1,di=xe.weeks,Qo=1,Hi=xe.month,To=xe.year;const ha=new Date,bs=ha.getDate(),ml=ha.getMonth()+1,qs=ha.getFullYear(),Ql=function(Io,Co,Po){return function(ws,Yi,li,Zn){return Ue.normalizeDate({year:Io,month:Co,day:Po,hours:ws,minutes:Yi,seconds:li,milliseconds:Zn})}};for(let Io=1;Io<=ee;Io++){for(let Co=1,Po=yt;Co<=dr;Co++,Po+=Po===dr?1-dr:1){Rn&&Po===rt&&(ar=1,Qn=me.days,ki=Math.floor((ar-1)/dr+1),Gi=Math.floor((me.days-ar)/dr+1),di=1,Qo=me.weeks,Hi=me.month,To=me.year,Rn=!1,zn=!0);const ws=Ql(To,Hi,ar),Yi={start:ws(0,0,0),end:ws(23,59,59,999)},li=Yi.start,Zn=`${Object(Ke.m)(To,4)}-${Object(Ke.m)(Hi,2)}-${Object(Ke.m)(ar,2)}`,_l=Co,Ba=dr-Co,yn=fn[Io-1],yr=Zt[Io-1],Do=ar===bs&&Hi===ml&&To===qs,Na=zn&&ar===1,xo=zn&&ar===me.days,Ts=Io===1,en=Io===ee,vr=Co===1,xr=Co===dr;Xe.push({id:Zn,label:ar.toString(),ariaLabel:ni.format(new Date(To,Hi-1,ar)),day:ar,dayFromEnd:Qn,weekday:Po,weekdayPosition:_l,weekdayPositionFromEnd:Ba,weekdayOrdinal:ki,weekdayOrdinalFromEnd:Gi,week:di,weekFromEnd:Qo,weeknumber:yn,isoWeeknumber:yr,month:Hi,year:To,dateFromTime:ws,date:li,range:Yi,isToday:Do,isFirstDay:Na,isLastDay:xo,inMonth:zn,inPrevMonth:Rn,inNextMonth:Hn,onTop:Ts,onBottom:en,onLeft:vr,onRight:xr,classes:["id-"+Zn,"day-"+ar,"day-from-end-"+Qn,"weekday-"+Po,"weekday-position-"+_l,"weekday-ordinal-"+ki,"weekday-ordinal-from-end-"+Gi,"week-"+di,"week-from-end-"+Qo,{"is-today":Do,"is-first-day":Na,"is-last-day":xo,"in-month":zn,"in-prev-month":Rn,"in-next-month":Hn,"on-top":Ts,"on-bottom":en,"on-left":vr,"on-right":xr}]}),zn&&xo?(zn=!1,Hn=!0,ar=1,Qn=Ve.days,ki=1,Gi=Math.floor((Ve.days-ar)/dr+1),di=1,Qo=Ve.weeks,Hi=Ve.month,To=Ve.year):(ar++,Qn--,ki=Math.floor((ar-1)/dr+1),Gi=Math.floor((me.days-ar)/dr+1))}di++,Qo--}return Xe}}},"29f3":function(m,T){var f=Object.prototype,x=f.toString;function A(i){return x.call(i)}m.exports=A},"2af9":function(m,T,f){f.r(T),f.d(T,"Calendar",function(){return Jt}),f.d(T,"CalendarNav",function(){return Qc}),f.d(T,"DatePicker",function(){return ac}),f.d(T,"Popover",function(){return en}),f("d9e2"),f("14d9"),f("13d5");var x=f("f7f1"),A=f("fe1f"),i=f("fd3a"),P=f("8c86");function O(R,G){Object(P.a)(2,arguments);var te=Object(i.a)(R),Me=Object(A.a)(G);if(isNaN(Me))return new Date(NaN);if(!Me)return te;var ze=te.getDate(),We=new Date(te.getTime());We.setMonth(te.getMonth()+Me+1,0);var ut=We.getDate();return ze>=ut?We:(te.setFullYear(We.getFullYear(),We.getMonth(),ze),te)}function L(R,G){Object(P.a)(2,arguments);var te=Object(A.a)(G);return O(R,12*te)}function U(R){if(R==null)return window;if(R.toString()!=="[object Window]"){var G=R.ownerDocument;return G&&G.defaultView||window}return R}function j(R){var G=U(R).Element;return R instanceof G||R instanceof Element}function W(R){var G=U(R).HTMLElement;return R instanceof G||R instanceof HTMLElement}function J(R){if(typeof ShadowRoot>"u")return!1;var G=U(R).ShadowRoot;return R instanceof G||R instanceof ShadowRoot}var fe=Math.max,_e=Math.min,we=Math.round;function ye(){var R=navigator.userAgentData;return R!=null&&R.brands&&Array.isArray(R.brands)?R.brands.map(function(G){return G.brand+"/"+G.version}).join(" "):navigator.userAgent}function Pe(){return!/^((?!chrome|android).)*safari/i.test(ye())}function Fe(R,G,te){G===void 0&&(G=!1),te===void 0&&(te=!1);var Me=R.getBoundingClientRect(),ze=1,We=1;G&&W(R)&&(ze=R.offsetWidth>0&&we(Me.width)/R.offsetWidth||1,We=R.offsetHeight>0&&we(Me.height)/R.offsetHeight||1);var ut=j(R)?U(R):window,ht=ut.visualViewport,gt=!Pe()&&te,xt=(Me.left+(gt&&ht?ht.offsetLeft:0))/ze,Qt=(Me.top+(gt&&ht?ht.offsetTop:0))/We,Cn=Me.width/ze,Pn=Me.height/We;return{width:Cn,height:Pn,top:Qt,right:xt+Cn,bottom:Qt+Pn,left:xt,x:xt,y:Qt}}function Be(R){var G=U(R),te=G.pageXOffset,Me=G.pageYOffset;return{scrollLeft:te,scrollTop:Me}}function He(R){return{scrollLeft:R.scrollLeft,scrollTop:R.scrollTop}}function Ce(R){return R!==U(R)&&W(R)?He(R):Be(R)}function ve(R){return R?(R.nodeName||"").toLowerCase():null}function Te(R){return((j(R)?R.ownerDocument:R.document)||window.document).documentElement}function Ye(R){return Fe(Te(R)).left+Be(R).scrollLeft}function Oe(R){return U(R).getComputedStyle(R)}function lt(R){var G=Oe(R),te=G.overflow,Me=G.overflowX,ze=G.overflowY;return/auto|scroll|overlay|hidden/.test(te+ze+Me)}function Ht(R){var G=R.getBoundingClientRect(),te=we(G.width)/R.offsetWidth||1,Me=we(G.height)/R.offsetHeight||1;return te!==1||Me!==1}function nt(R,G,te){te===void 0&&(te=!1);var Me=W(G),ze=W(G)&&Ht(G),We=Te(G),ut=Fe(R,ze,te),ht={scrollLeft:0,scrollTop:0},gt={x:0,y:0};return(Me||!Me&&!te)&&((ve(G)!=="body"||lt(We))&&(ht=Ce(G)),W(G)?(gt=Fe(G,!0),gt.x+=G.clientLeft,gt.y+=G.clientTop):We&&(gt.x=Ye(We))),{x:ut.left+ht.scrollLeft-gt.x,y:ut.top+ht.scrollTop-gt.y,width:ut.width,height:ut.height}}function Tt(R){var G=Fe(R),te=R.offsetWidth,Me=R.offsetHeight;return Math.abs(G.width-te)<=1&&(te=G.width),Math.abs(G.height-Me)<=1&&(Me=G.height),{x:R.offsetLeft,y:R.offsetTop,width:te,height:Me}}function Rt(R){return ve(R)==="html"?R:R.assignedSlot||R.parentNode||(J(R)?R.host:null)||Te(R)}function vt(R){return["html","body","#document"].indexOf(ve(R))>=0?R.ownerDocument.body:W(R)&&lt(R)?R:vt(Rt(R))}function wr(R,G){var te;G===void 0&&(G=[]);var Me=vt(R),ze=Me===((te=R.ownerDocument)==null?void 0:te.body),We=U(Me),ut=ze?[We].concat(We.visualViewport||[],lt(Me)?Me:[]):Me,ht=G.concat(ut);return ze?ht:ht.concat(wr(Rt(ut)))}function Kr(R){return["table","td","th"].indexOf(ve(R))>=0}function Gr(R){return W(R)&&Oe(R).position!=="fixed"?R.offsetParent:null}function Or(R){var G=/firefox/i.test(ye()),te=/Trident/i.test(ye());if(te&&W(R)){var Me=Oe(R);if(Me.position==="fixed")return null}var ze=Rt(R);for(J(ze)&&(ze=ze.host);W(ze)&&["html","body"].indexOf(ve(ze))<0;){var We=Oe(ze);if(We.transform!=="none"||We.perspective!=="none"||We.contain==="paint"||["transform","perspective"].indexOf(We.willChange)!==-1||G&&We.willChange==="filter"||G&&We.filter&&We.filter!=="none")return ze;ze=ze.parentNode}return null}function yi(R){for(var G=U(R),te=Gr(R);te&&Kr(te)&&Oe(te).position==="static";)te=Gr(te);return te&&(ve(te)==="html"||ve(te)==="body"&&Oe(te).position==="static")?G:te||Or(R)||G}var Hr="top",oi="bottom",zr="right",It="left",mn="auto",on=[Hr,oi,zr,It],an="start",$n="end",Gn="clippingParents",De="viewport",Re="popper",ft="reference",Lt=on.reduce(function(R,G){return R.concat([G+"-"+an,G+"-"+$n])},[]),Ot=[].concat(on,[mn]).reduce(function(R,G){return R.concat([G,G+"-"+an,G+"-"+$n])},[]),Kt="beforeRead",dn="read",Vt="afterRead",Gt="beforeMain",Yt="main",qt="afterMain",Mn="beforeWrite",En="write",Qe="afterWrite",re=[Kt,dn,Vt,Gt,Yt,qt,Mn,En,Qe];function ue(R){var G=new Map,te=new Set,Me=[];function ze(We){te.add(We.name);var ut=[].concat(We.requires||[],We.requiresIfExists||[]);ut.forEach(function(ht){if(!te.has(ht)){var gt=G.get(ht);gt&&ze(gt)}}),Me.push(We)}return R.forEach(function(We){G.set(We.name,We)}),R.forEach(function(We){te.has(We.name)||ze(We)}),Me}function Ee(R){var G=ue(R);return re.reduce(function(te,Me){return te.concat(G.filter(function(ze){return ze.phase===Me}))},[])}function it(R){var G;return function(){return G||(G=new Promise(function(te){Promise.resolve().then(function(){G=void 0,te(R())})})),G}}function pt(R){var G=R.reduce(function(te,Me){var ze=te[Me.name];return te[Me.name]=ze?Object.assign({},ze,Me,{options:Object.assign({},ze.options,Me.options),data:Object.assign({},ze.data,Me.data)}):Me,te},{});return Object.keys(G).map(function(te){return G[te]})}var Mt={placement:"bottom",modifiers:[],strategy:"absolute"};function nn(){for(var R=arguments.length,G=new Array(R),te=0;te<R;te++)G[te]=arguments[te];return!G.some(function(Me){return!(Me&&typeof Me.getBoundingClientRect=="function")})}function Ke(R){R===void 0&&(R={});var G=R,te=G.defaultModifiers,Me=te===void 0?[]:te,ze=G.defaultOptions,We=ze===void 0?Mt:ze;return function(ut,ht,gt){gt===void 0&&(gt=We);var xt={placement:"bottom",orderedModifiers:[],options:Object.assign({},Mt,We),modifiersData:{},elements:{reference:ut,popper:ht},attributes:{},styles:{}},Qt=[],Cn=!1,Pn={state:xt,setOptions:function(tr){var Fr=typeof tr=="function"?tr(xt.options):tr;Er(),xt.options=Object.assign({},We,xt.options,Fr),xt.scrollParents={reference:j(ut)?wr(ut):ut.contextElement?wr(ut.contextElement):[],popper:wr(ht)};var ci=Ee(pt([].concat(Me,xt.options.modifiers)));return xt.orderedModifiers=ci.filter(function(Ri){return Ri.enabled}),er(),Pn.update()},forceUpdate:function(){if(!Cn){var tr=xt.elements,Fr=tr.reference,ci=tr.popper;if(nn(Fr,ci)){xt.rects={reference:nt(Fr,yi(ci),xt.options.strategy==="fixed"),popper:Tt(ci)},xt.reset=!1,xt.placement=xt.options.placement,xt.orderedModifiers.forEach(function(bi){return xt.modifiersData[bi.name]=Object.assign({},bi.data)});for(var Ri=0;Ri<xt.orderedModifiers.length;Ri++)if(xt.reset!==!0){var Bi=xt.orderedModifiers[Ri],Vr=Bi.fn,Jr=Bi.options,ri=Jr===void 0?{}:Jr,Ni=Bi.name;typeof Vr=="function"&&(xt=Vr({state:xt,options:ri,name:Ni,instance:Pn})||xt)}else xt.reset=!1,Ri=-1}}},update:it(function(){return new Promise(function(tr){Pn.forceUpdate(),tr(xt)})}),destroy:function(){Er(),Cn=!0}};if(!nn(ut,ht))return Pn;function er(){xt.orderedModifiers.forEach(function(tr){var Fr=tr.name,ci=tr.options,Ri=ci===void 0?{}:ci,Bi=tr.effect;if(typeof Bi=="function"){var Vr=Bi({state:xt,name:Fr,instance:Pn,options:Ri}),Jr=function(){};Qt.push(Vr||Jr)}})}function Er(){Qt.forEach(function(tr){return tr()}),Qt=[]}return Pn.setOptions(gt).then(function(tr){!Cn&&gt.onFirstUpdate&&gt.onFirstUpdate(tr)}),Pn}}var jt={passive:!0};function Ut(R){var G=R.state,te=R.instance,Me=R.options,ze=Me.scroll,We=ze===void 0||ze,ut=Me.resize,ht=ut===void 0||ut,gt=U(G.elements.popper),xt=[].concat(G.scrollParents.reference,G.scrollParents.popper);return We&&xt.forEach(function(Qt){Qt.addEventListener("scroll",te.update,jt)}),ht&&gt.addEventListener("resize",te.update,jt),function(){We&&xt.forEach(function(Qt){Qt.removeEventListener("scroll",te.update,jt)}),ht&&gt.removeEventListener("resize",te.update,jt)}}var tn={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Ut,data:{}};function Sn(R){return R.split("-")[0]}function Ln(R){return R.split("-")[1]}function Dr(R){return["top","bottom"].indexOf(R)>=0?"x":"y"}function Nr(R){var G,te=R.reference,Me=R.element,ze=R.placement,We=ze?Sn(ze):null,ut=ze?Ln(ze):null,ht=te.x+te.width/2-Me.width/2,gt=te.y+te.height/2-Me.height/2;switch(We){case Hr:G={x:ht,y:te.y-Me.height};break;case oi:G={x:ht,y:te.y+te.height};break;case zr:G={x:te.x+te.width,y:gt};break;case It:G={x:te.x-Me.width,y:gt};break;default:G={x:te.x,y:te.y}}var xt=We?Dr(We):null;if(xt!=null){var Qt=xt==="y"?"height":"width";switch(ut){case an:G[xt]=G[xt]-(te[Qt]/2-Me[Qt]/2);break;case $n:G[xt]=G[xt]+(te[Qt]/2-Me[Qt]/2);break}}return G}function hr(R){var G=R.state,te=R.name;G.modifiersData[te]=Nr({reference:G.rects.reference,element:G.rects.popper,strategy:"absolute",placement:G.placement})}var Tr={name:"popperOffsets",enabled:!0,phase:"read",fn:hr,data:{}},Rr={top:"auto",right:"auto",bottom:"auto",left:"auto"};function $r(R,G){var te=R.x,Me=R.y,ze=G.devicePixelRatio||1;return{x:we(te*ze)/ze||0,y:we(Me*ze)/ze||0}}function Di(R){var G,te=R.popper,Me=R.popperRect,ze=R.placement,We=R.variation,ut=R.offsets,ht=R.position,gt=R.gpuAcceleration,xt=R.adaptive,Qt=R.roundOffsets,Cn=R.isFixed,Pn=ut.x,er=Pn===void 0?0:Pn,Er=ut.y,tr=Er===void 0?0:Er,Fr=typeof Qt=="function"?Qt({x:er,y:tr}):{x:er,y:tr};er=Fr.x,tr=Fr.y;var ci=ut.hasOwnProperty("x"),Ri=ut.hasOwnProperty("y"),Bi=It,Vr=Hr,Jr=window;if(xt){var ri=yi(te),Ni="clientHeight",bi="clientWidth";if(ri===U(te)&&(ri=Te(te),Oe(ri).position!=="static"&&ht==="absolute"&&(Ni="scrollHeight",bi="scrollWidth")),ri=ri,ze===Hr||(ze===It||ze===zr)&&We===$n){Vr=oi;var so=Cn&&ri===Jr&&Jr.visualViewport?Jr.visualViewport.height:ri[Ni];tr-=so-Me.height,tr*=gt?1:-1}if(ze===It||(ze===Hr||ze===oi)&&We===$n){Bi=zr;var ji=Cn&&ri===Jr&&Jr.visualViewport?Jr.visualViewport.width:ri[bi];er-=ji-Me.width,er*=gt?1:-1}}var Vi,$o=Object.assign({position:ht},xt&&Rr),Go=Qt===!0?$r({x:er,y:tr},U(te)):{x:er,y:tr};return er=Go.x,tr=Go.y,gt?Object.assign({},$o,(Vi={},Vi[Vr]=Ri?"0":"",Vi[Bi]=ci?"0":"",Vi.transform=(Jr.devicePixelRatio||1)<=1?"translate("+er+"px, "+tr+"px)":"translate3d("+er+"px, "+tr+"px, 0)",Vi)):Object.assign({},$o,(G={},G[Vr]=Ri?tr+"px":"",G[Bi]=ci?er+"px":"",G.transform="",G))}function dr(R){var G=R.state,te=R.options,Me=te.gpuAcceleration,ze=Me===void 0||Me,We=te.adaptive,ut=We===void 0||We,ht=te.roundOffsets,gt=ht===void 0||ht,xt={placement:Sn(G.placement),variation:Ln(G.placement),popper:G.elements.popper,popperRect:G.rects.popper,gpuAcceleration:ze,isFixed:G.options.strategy==="fixed"};G.modifiersData.popperOffsets!=null&&(G.styles.popper=Object.assign({},G.styles.popper,Di(Object.assign({},xt,{offsets:G.modifiersData.popperOffsets,position:G.options.strategy,adaptive:ut,roundOffsets:gt})))),G.modifiersData.arrow!=null&&(G.styles.arrow=Object.assign({},G.styles.arrow,Di(Object.assign({},xt,{offsets:G.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:gt})))),G.attributes.popper=Object.assign({},G.attributes.popper,{"data-popper-placement":G.placement})}var io={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:dr,data:{}};function Ji(R){var G=R.state;Object.keys(G.elements).forEach(function(te){var Me=G.styles[te]||{},ze=G.attributes[te]||{},We=G.elements[te];W(We)&&ve(We)&&(Object.assign(We.style,Me),Object.keys(ze).forEach(function(ut){var ht=ze[ut];ht===!1?We.removeAttribute(ut):We.setAttribute(ut,ht===!0?"":ht)}))})}function oo(R){var G=R.state,te={popper:{position:G.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(G.elements.popper.style,te.popper),G.styles=te,G.elements.arrow&&Object.assign(G.elements.arrow.style,te.arrow),function(){Object.keys(G.elements).forEach(function(Me){var ze=G.elements[Me],We=G.attributes[Me]||{},ut=Object.keys(G.styles.hasOwnProperty(Me)?G.styles[Me]:te[Me]),ht=ut.reduce(function(gt,xt){return gt[xt]="",gt},{});W(ze)&&ve(ze)&&(Object.assign(ze.style,ht),Object.keys(We).forEach(function(gt){ze.removeAttribute(gt)}))})}}var rr={name:"applyStyles",enabled:!0,phase:"write",fn:Ji,effect:oo,requires:["computeStyles"]};function vi(R,G,te){var Me=Sn(R),ze=[It,Hr].indexOf(Me)>=0?-1:1,We=typeof te=="function"?te(Object.assign({},G,{placement:R})):te,ut=We[0],ht=We[1];return ut=ut||0,ht=(ht||0)*ze,[It,zr].indexOf(Me)>=0?{x:ht,y:ut}:{x:ut,y:ht}}function mt(R){var G=R.state,te=R.options,Me=R.name,ze=te.offset,We=ze===void 0?[0,0]:ze,ut=Ot.reduce(function(Qt,Cn){return Qt[Cn]=vi(Cn,G.rects,We),Qt},{}),ht=ut[G.placement],gt=ht.x,xt=ht.y;G.modifiersData.popperOffsets!=null&&(G.modifiersData.popperOffsets.x+=gt,G.modifiersData.popperOffsets.y+=xt),G.modifiersData[Me]=ut}var ce={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:mt},ee={left:"right",right:"left",bottom:"top",top:"bottom"};function me(R){return R.replace(/left|right|bottom|top/g,function(G){return ee[G]})}var xe={start:"end",end:"start"};function Ve(R){return R.replace(/start|end/g,function(G){return xe[G]})}function Ue(R,G){var te=U(R),Me=Te(R),ze=te.visualViewport,We=Me.clientWidth,ut=Me.clientHeight,ht=0,gt=0;if(ze){We=ze.width,ut=ze.height;var xt=Pe();(xt||!xt&&G==="fixed")&&(ht=ze.offsetLeft,gt=ze.offsetTop)}return{width:We,height:ut,x:ht+Ye(R),y:gt}}function Xe(R){var G,te=Te(R),Me=Be(R),ze=(G=R.ownerDocument)==null?void 0:G.body,We=fe(te.scrollWidth,te.clientWidth,ze?ze.scrollWidth:0,ze?ze.clientWidth:0),ut=fe(te.scrollHeight,te.clientHeight,ze?ze.scrollHeight:0,ze?ze.clientHeight:0),ht=-Me.scrollLeft+Ye(R),gt=-Me.scrollTop;return Oe(ze||te).direction==="rtl"&&(ht+=fe(te.clientWidth,ze?ze.clientWidth:0)-We),{width:We,height:ut,x:ht,y:gt}}function yt(R,G){var te=G.getRootNode&&G.getRootNode();if(R.contains(G))return!0;if(te&&J(te)){var Me=G;do{if(Me&&R.isSameNode(Me))return!0;Me=Me.parentNode||Me.host}while(Me)}return!1}function rt(R){return Object.assign({},R,{left:R.x,top:R.y,right:R.x+R.width,bottom:R.y+R.height})}function Zt(R,G){var te=Fe(R,!1,G==="fixed");return te.top=te.top+R.clientTop,te.left=te.left+R.clientLeft,te.bottom=te.top+R.clientHeight,te.right=te.left+R.clientWidth,te.width=R.clientWidth,te.height=R.clientHeight,te.x=te.left,te.y=te.top,te}function fn(R,G,te){return G===De?rt(Ue(R,te)):j(G)?Zt(G,te):rt(Xe(Te(R)))}function zt(R){var G=wr(Rt(R)),te=["absolute","fixed"].indexOf(Oe(R).position)>=0,Me=te&&W(R)?yi(R):R;return j(Me)?G.filter(function(ze){return j(ze)&&yt(ze,Me)&&ve(ze)!=="body"}):[]}function Rn(R,G,te,Me){var ze=G==="clippingParents"?zt(R):[].concat(G),We=[].concat(ze,[te]),ut=We[0],ht=We.reduce(function(gt,xt){var Qt=fn(R,xt,Me);return gt.top=fe(Qt.top,gt.top),gt.right=_e(Qt.right,gt.right),gt.bottom=_e(Qt.bottom,gt.bottom),gt.left=fe(Qt.left,gt.left),gt},fn(R,ut,Me));return ht.width=ht.right-ht.left,ht.height=ht.bottom-ht.top,ht.x=ht.left,ht.y=ht.top,ht}function zn(){return{top:0,right:0,bottom:0,left:0}}function Hn(R){return Object.assign({},zn(),R)}function ni(R,G){return G.reduce(function(te,Me){return te[Me]=R,te},{})}function ar(R,G){G===void 0&&(G={});var te=G,Me=te.placement,ze=Me===void 0?R.placement:Me,We=te.strategy,ut=We===void 0?R.strategy:We,ht=te.boundary,gt=ht===void 0?Gn:ht,xt=te.rootBoundary,Qt=xt===void 0?De:xt,Cn=te.elementContext,Pn=Cn===void 0?Re:Cn,er=te.altBoundary,Er=er!==void 0&&er,tr=te.padding,Fr=tr===void 0?0:tr,ci=Hn(typeof Fr!="number"?Fr:ni(Fr,on)),Ri=Pn===Re?ft:Re,Bi=R.rects.popper,Vr=R.elements[Er?Ri:Pn],Jr=Rn(j(Vr)?Vr:Vr.contextElement||Te(R.elements.popper),gt,Qt,ut),ri=Fe(R.elements.reference),Ni=Nr({reference:ri,element:Bi,strategy:"absolute",placement:ze}),bi=rt(Object.assign({},Bi,Ni)),so=Pn===Re?bi:ri,ji={top:Jr.top-so.top+ci.top,bottom:so.bottom-Jr.bottom+ci.bottom,left:Jr.left-so.left+ci.left,right:so.right-Jr.right+ci.right},Vi=R.modifiersData.offset;if(Pn===Re&&Vi){var $o=Vi[ze];Object.keys(ji).forEach(function(Go){var ao=[zr,oi].indexOf(Go)>=0?1:-1,cs=[Hr,oi].indexOf(Go)>=0?"y":"x";ji[Go]+=$o[cs]*ao})}return ji}function Qn(R,G){G===void 0&&(G={});var te=G,Me=te.placement,ze=te.boundary,We=te.rootBoundary,ut=te.padding,ht=te.flipVariations,gt=te.allowedAutoPlacements,xt=gt===void 0?Ot:gt,Qt=Ln(Me),Cn=Qt?ht?Lt:Lt.filter(function(Er){return Ln(Er)===Qt}):on,Pn=Cn.filter(function(Er){return xt.indexOf(Er)>=0});Pn.length===0&&(Pn=Cn);var er=Pn.reduce(function(Er,tr){return Er[tr]=ar(R,{placement:tr,boundary:ze,rootBoundary:We,padding:ut})[Sn(tr)],Er},{});return Object.keys(er).sort(function(Er,tr){return er[Er]-er[tr]})}function ki(R){if(Sn(R)===mn)return[];var G=me(R);return[Ve(R),G,Ve(G)]}function Gi(R){var G=R.state,te=R.options,Me=R.name;if(!G.modifiersData[Me]._skip){for(var ze=te.mainAxis,We=ze===void 0||ze,ut=te.altAxis,ht=ut===void 0||ut,gt=te.fallbackPlacements,xt=te.padding,Qt=te.boundary,Cn=te.rootBoundary,Pn=te.altBoundary,er=te.flipVariations,Er=er===void 0||er,tr=te.allowedAutoPlacements,Fr=G.options.placement,ci=Sn(Fr),Ri=ci===Fr,Bi=gt||(Ri||!Er?[me(Fr)]:ki(Fr)),Vr=[Fr].concat(Bi).reduce(function(Ds,Lo){return Ds.concat(Sn(Lo)===mn?Qn(G,{placement:Lo,boundary:Qt,rootBoundary:Cn,padding:xt,flipVariations:Er,allowedAutoPlacements:tr}):Lo)},[]),Jr=G.rects.reference,ri=G.rects.popper,Ni=new Map,bi=!0,so=Vr[0],ji=0;ji<Vr.length;ji++){var Vi=Vr[ji],$o=Sn(Vi),Go=Ln(Vi)===an,ao=[Hr,oi].indexOf($o)>=0,cs=ao?"width":"height",_o=ar(G,{placement:Vi,boundary:Qt,rootBoundary:Cn,altBoundary:Pn,padding:xt}),Eo=ao?Go?zr:It:Go?oi:Hr;Jr[cs]>ri[cs]&&(Eo=me(Eo));var ya=me(Eo),Cs=[];if(We&&Cs.push(_o[$o]<=0),ht&&Cs.push(_o[Eo]<=0,_o[ya]<=0),Cs.every(function(Ds){return Ds})){so=Vi,bi=!1;break}Ni.set(Vi,Cs)}if(bi)for(var Ya=Er?3:1,lc=function(Ds){var Lo=Vr.find(function(ks){var lo=Ni.get(ks);if(lo)return lo.slice(0,Ds).every(function(ns){return ns})});if(Lo)return so=Lo,"break"},us=Ya;us>0;us--){var Ps=lc(us);if(Ps==="break")break}G.placement!==so&&(G.modifiersData[Me]._skip=!0,G.placement=so,G.reset=!0)}}var di={name:"flip",enabled:!0,phase:"main",fn:Gi,requiresIfExists:["offset"],data:{_skip:!1}};function Qo(R){return R==="x"?"y":"x"}function Hi(R,G,te){return fe(R,_e(G,te))}function To(R,G,te){var Me=Hi(R,G,te);return Me>te?te:Me}function ha(R){var G=R.state,te=R.options,Me=R.name,ze=te.mainAxis,We=ze===void 0||ze,ut=te.altAxis,ht=ut!==void 0&&ut,gt=te.boundary,xt=te.rootBoundary,Qt=te.altBoundary,Cn=te.padding,Pn=te.tether,er=Pn===void 0||Pn,Er=te.tetherOffset,tr=Er===void 0?0:Er,Fr=ar(G,{boundary:gt,rootBoundary:xt,padding:Cn,altBoundary:Qt}),ci=Sn(G.placement),Ri=Ln(G.placement),Bi=!Ri,Vr=Dr(ci),Jr=Qo(Vr),ri=G.modifiersData.popperOffsets,Ni=G.rects.reference,bi=G.rects.popper,so=typeof tr=="function"?tr(Object.assign({},G.rects,{placement:G.placement})):tr,ji=typeof so=="number"?{mainAxis:so,altAxis:so}:Object.assign({mainAxis:0,altAxis:0},so),Vi=G.modifiersData.offset?G.modifiersData.offset[G.placement]:null,$o={x:0,y:0};if(ri){if(We){var Go,ao=Vr==="y"?Hr:It,cs=Vr==="y"?oi:zr,_o=Vr==="y"?"height":"width",Eo=ri[Vr],ya=Eo+Fr[ao],Cs=Eo-Fr[cs],Ya=er?-bi[_o]/2:0,lc=Ri===an?Ni[_o]:bi[_o],us=Ri===an?-bi[_o]:-Ni[_o],Ps=G.elements.arrow,Ds=er&&Ps?Tt(Ps):{width:0,height:0},Lo=G.modifiersData["arrow#persistent"]?G.modifiersData["arrow#persistent"].padding:zn(),ks=Lo[ao],lo=Lo[cs],ns=Hi(0,Ni[_o],Ds[_o]),pu=Bi?Ni[_o]/2-Ya-ns-ks-ji.mainAxis:lc-ns-ks-ji.mainAxis,cc=Bi?-Ni[_o]/2+Ya+ns+lo+ji.mainAxis:us+ns+lo+ji.mainAxis,Tl=G.elements.arrow&&yi(G.elements.arrow),ea=Tl?Vr==="y"?Tl.clientTop||0:Tl.clientLeft||0:0,fr=(Go=Vi==null?void 0:Vi[Vr])!=null?Go:0,mu=Eo+pu-fr-ea,Bd=Eo+cc-fr,El=Hi(er?_e(ya,mu):ya,Eo,er?fe(Cs,Bd):Cs);ri[Vr]=El,$o[Vr]=El-Eo}if(ht){var _u,gu=Vr==="x"?Hr:It,Th=Vr==="x"?oi:zr,hs=ri[Jr],Sl=Jr==="y"?"height":"width",Xa=hs+Fr[gu],va=hs-Fr[Th],Ml=[Hr,It].indexOf(ci)!==-1,uc=(_u=Vi==null?void 0:Vi[Jr])!=null?_u:0,xa=Ml?Xa:hs-Ni[Sl]-bi[Sl]-uc+ji.altAxis,hc=Ml?hs+Ni[Sl]+bi[Sl]-uc-ji.altAxis:va,dc=er&&Ml?To(xa,hs,hc):Hi(er?xa:Xa,hs,er?hc:va);ri[Jr]=dc,$o[Jr]=dc-hs}G.modifiersData[Me]=$o}}var bs={name:"preventOverflow",enabled:!0,phase:"main",fn:ha,requiresIfExists:["offset"]},ml=function(R,G){return R=typeof R=="function"?R(Object.assign({},G.rects,{placement:G.placement})):R,Hn(typeof R!="number"?R:ni(R,on))};function qs(R){var G,te=R.state,Me=R.name,ze=R.options,We=te.elements.arrow,ut=te.modifiersData.popperOffsets,ht=Sn(te.placement),gt=Dr(ht),xt=[It,zr].indexOf(ht)>=0,Qt=xt?"height":"width";if(We&&ut){var Cn=ml(ze.padding,te),Pn=Tt(We),er=gt==="y"?Hr:It,Er=gt==="y"?oi:zr,tr=te.rects.reference[Qt]+te.rects.reference[gt]-ut[gt]-te.rects.popper[Qt],Fr=ut[gt]-te.rects.reference[gt],ci=yi(We),Ri=ci?gt==="y"?ci.clientHeight||0:ci.clientWidth||0:0,Bi=tr/2-Fr/2,Vr=Cn[er],Jr=Ri-Pn[Qt]-Cn[Er],ri=Ri/2-Pn[Qt]/2+Bi,Ni=Hi(Vr,ri,Jr),bi=gt;te.modifiersData[Me]=(G={},G[bi]=Ni,G.centerOffset=Ni-ri,G)}}function Ql(R){var G=R.state,te=R.options,Me=te.element,ze=Me===void 0?"[data-popper-arrow]":Me;ze!=null&&(typeof ze!="string"||(ze=G.elements.popper.querySelector(ze),ze))&&yt(G.elements.popper,ze)&&(G.elements.arrow=ze)}var Io={name:"arrow",enabled:!0,phase:"main",fn:qs,effect:Ql,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Co(R,G,te){return te===void 0&&(te={x:0,y:0}),{top:R.top-G.height-te.y,right:R.right-G.width+te.x,bottom:R.bottom-G.height+te.y,left:R.left-G.width-te.x}}function Po(R){return[Hr,zr,oi,It].some(function(G){return R[G]>=0})}function ws(R){var G=R.state,te=R.name,Me=G.rects.reference,ze=G.rects.popper,We=G.modifiersData.preventOverflow,ut=ar(G,{elementContext:"reference"}),ht=ar(G,{altBoundary:!0}),gt=Co(ut,Me),xt=Co(ht,ze,We),Qt=Po(gt),Cn=Po(xt);G.modifiersData[te]={referenceClippingOffsets:gt,popperEscapeOffsets:xt,isReferenceHidden:Qt,hasPopperEscaped:Cn},G.attributes.popper=Object.assign({},G.attributes.popper,{"data-popper-reference-hidden":Qt,"data-popper-escaped":Cn})}var Yi,li,Zn={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:ws},_l=[tn,Tr,io,rr,ce,di,bs,Io,Zn],Ba=Ke({defaultModifiers:_l}),yn=f("2fa3"),yr=f("9404"),Do={name:"Popover",render(R){return R("div",{class:["vc-popover-content-wrapper",{"is-interactive":this.isInteractive}],ref:"popover"},[R("transition",{props:{name:this.transition,appear:!0},on:{beforeEnter:this.beforeEnter,afterEnter:this.afterEnter,beforeLeave:this.beforeLeave,afterLeave:this.afterLeave}},[this.isVisible&&R("div",{attrs:{tabindex:-1},class:["vc-popover-content","direction-"+this.direction,this.contentClass]},[this.content,R("span",{class:["vc-popover-caret","direction-"+this.direction,"align-"+this.alignment]})])])])},props:{id:{type:String,required:!0},contentClass:String},data(){return{ref:null,opts:null,data:null,transition:"slide-fade",placement:"bottom",positionFixed:!1,modifiers:[],isInteractive:!1,isHovered:!1,isFocused:!1,showDelay:0,hideDelay:110,autoHide:!1,popperEl:null}},computed:{content(){var R=this;return Object(yr.k)(this.$scopedSlots.default)&&this.$scopedSlots.default({direction:this.direction,alignment:this.alignment,data:this.data,updateLayout:this.setupPopper,hide:function(G){return R.hide(G)}})||this.$slots.default},popperOptions(){return{placement:this.placement,strategy:this.positionFixed?"fixed":"absolute",modifiers:[{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:this.onPopperUpdate},...this.modifiers||[]],onFirstUpdate:this.onPopperUpdate}},isVisible(){return!(!this.ref||!this.content)},direction(){return this.placement&&this.placement.split("-")[0]||"bottom"},alignment(){const R=this.direction==="left"||this.direction==="right";let G=this.placement.split("-");return G=G.length>1?G[1]:"",["start","top","left"].includes(G)?R?"top":"left":["end","bottom","right"].includes(G)?R?"bottom":"right":R?"middle":"center"},state(){return this.$popovers[this.id]}},watch:{opts(R,G){G&&G.callback&&G.callback({...G,completed:!R,reason:R?"Overridden by action":null})}},mounted(){this.popoverEl=this.$refs.popover,this.addEvents()},beforeDestroy(){this.destroyPopper(),this.removeEvents(),this.popoverEl=null},methods:{addEvents(){Object(yn.k)(this.popoverEl,"click",this.onClick),Object(yn.k)(this.popoverEl,"mouseover",this.onMouseOver),Object(yn.k)(this.popoverEl,"mouseleave",this.onMouseLeave),Object(yn.k)(this.popoverEl,"focusin",this.onFocusIn),Object(yn.k)(this.popoverEl,"focusout",this.onFocusOut),Object(yn.k)(document,"keydown",this.onDocumentKeydown),Object(yn.k)(document,"click",this.onDocumentClick),Object(yn.k)(document,"show-popover",this.onDocumentShowPopover),Object(yn.k)(document,"hide-popover",this.onDocumentHidePopover),Object(yn.k)(document,"toggle-popover",this.onDocumentTogglePopover),Object(yn.k)(document,"update-popover",this.onDocumentUpdatePopover)},removeEvents(){Object(yn.j)(this.popoverEl,"click",this.onClick),Object(yn.j)(this.popoverEl,"mouseover",this.onMouseOver),Object(yn.j)(this.popoverEl,"mouseleave",this.onMouseLeave),Object(yn.j)(this.popoverEl,"focusin",this.onFocusIn),Object(yn.j)(this.popoverEl,"focusout",this.onFocusOut),Object(yn.j)(document,"keydown",this.onDocumentKeydown),Object(yn.j)(document,"click",this.onDocumentClick),Object(yn.j)(document,"show-popover",this.onDocumentShowPopover),Object(yn.j)(document,"hide-popover",this.onDocumentHidePopover),Object(yn.j)(document,"toggle-popover",this.onDocumentTogglePopover),Object(yn.j)(document,"update-popover",this.onDocumentUpdatePopover)},onClick(R){R.stopPropagation()},onMouseOver(){this.isHovered=!0,this.isInteractive&&this.show()},onMouseLeave(){this.isHovered=!1,!this.autoHide||this.isFocused||this.ref&&this.ref===document.activeElement||this.hide()},onFocusIn(){this.isFocused=!0,this.isInteractive&&this.show()},onFocusOut(R){R.relatedTarget&&Object(yn.e)(this.popoverEl,R.relatedTarget)||(this.isFocused=!1,!this.isHovered&&this.autoHide&&this.hide())},onDocumentClick(R){this.$refs.popover&&this.ref&&(Object(yn.e)(this.popoverEl,R.target)||Object(yn.e)(this.ref,R.target)||this.hide())},onDocumentKeydown(R){R.key!=="Esc"&&R.key!=="Escape"||this.hide()},onDocumentShowPopover({detail:R}){R.id&&R.id===this.id&&this.show(R)},onDocumentHidePopover({detail:R}){R.id&&R.id===this.id&&this.hide(R)},onDocumentTogglePopover({detail:R}){R.id&&R.id===this.id&&this.toggle(R)},onDocumentUpdatePopover({detail:R}){R.id&&R.id===this.id&&this.update(R)},show(R={}){var G=this;R.action="show";const te=R.ref||this.ref,Me=R.showDelay>=0?R.showDelay:this.showDelay;if(!te)return void(R.callback&&R.callback({completed:!1,reason:"Invalid reference element provided"}));clearTimeout(this.timeout),this.opts=R;const ze=function(){Object.assign(G,R),G.setupPopper(),G.opts=null};Me>0?this.timeout=setTimeout(function(){return ze()},Me):ze()},hide(R={}){var G=this;R.action="hide";const te=R.ref||this.ref,Me=R.hideDelay>=0?R.hideDelay:this.hideDelay;if(!this.ref||te!==this.ref)return void(R.callback&&R.callback({...R,completed:!1,reason:this.ref?"Invalid reference element provided":"Popover already hidden"}));const ze=function(){G.ref=null,G.opts=null};clearTimeout(this.timeout),this.opts=R,Me>0?this.timeout=setTimeout(ze,Me):ze()},toggle(R={}){this.isVisible&&R.ref===this.ref?this.hide(R):this.show(R)},update(R={}){Object.assign(this,R),this.setupPopper()},setupPopper(){var R=this;this.$nextTick(function(){R.ref&&R.$refs.popover&&(R.popper&&R.popper.reference!==R.ref&&R.destroyPopper(),R.popper?R.popper.update():R.popper=Ba(R.ref,R.popoverEl,R.popperOptions))})},onPopperUpdate(R){R.placement?this.placement=R.placement:R.state&&(this.placement=R.state.placement)},beforeEnter(R){this.$emit("beforeShow",R)},afterEnter(R){this.$emit("afterShow",R)},beforeLeave(R){this.$emit("beforeHide",R)},afterLeave(R){this.destroyPopper(),this.$emit("afterHide",R)},destroyPopper(){this.popper&&(this.popper.destroy(),this.popper=null)}}},Na=Do;f("2745");function xo(R,G,te,Me,ze,We,ut,ht){var gt,xt=typeof R=="function"?R.options:R;if(G&&(xt.render=G,xt.staticRenderFns=te,xt._compiled=!0),Me&&(xt.functional=!0),We&&(xt._scopeId="data-v-"+We),ut?(gt=function(Pn){Pn=Pn||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,Pn||typeof __VUE_SSR_CONTEXT__>"u"||(Pn=__VUE_SSR_CONTEXT__),ze&&ze.call(this,Pn),Pn&&Pn._registeredComponents&&Pn._registeredComponents.add(ut)},xt._ssrRegister=gt):ze&&(gt=ht?function(){ze.call(this,(xt.functional?this.parent:this).$root.$options.shadowRoot)}:ze),gt)if(xt.functional){xt._injectStyles=gt;var Qt=xt.render;xt.render=function(Pn,er){return gt.call(er),Qt(Pn,er)}}else{var Cn=xt.beforeCreate;xt.beforeCreate=Cn?[].concat(Cn,gt):[gt]}return{exports:R,options:xt}}var Ts=xo(Na,Yi,li,!1,null,"03f17c2c",null),en=Ts.exports,vr=function(){var R=this,G=R._self._c;return G("div",{staticClass:"vc-day-popover-row"},[R.indicator?G("div",{staticClass:"vc-day-popover-row-indicator"},[G("span",{class:R.indicator.class,style:R.indicator.style})]):R._e(),G("div",{staticClass:"vc-day-popover-row-content"},[R._t("default",function(){return[R._v(R._s(R.attribute.popover?R.attribute.popover.label:"No content provided"))]})],2)])},xr=[],ko=f("51ec");const ja={inject:["sharedState"],mixins:[ko.a],computed:{masks(){return this.sharedState.masks},theme(){return this.sharedState.theme},locale(){return this.sharedState.locale},dayPopoverId(){return this.sharedState.dayPopoverId}},methods:{format(R,G){return this.locale.format(R,G)},pageForDate(R){return this.locale.getDateParts(this.locale.normalizeDate(R))}}},mr=["base","start","end","startEnd"],ec=["class","contentClass","style","contentStyle","color","fillMode"],Va={color:"blue",isDark:!1,highlight:{base:{fillMode:"light"},start:{fillMode:"solid"},end:{fillMode:"solid"}},dot:{base:{fillMode:"solid"},start:{fillMode:"solid"},end:{fillMode:"solid"}},bar:{base:{fillMode:"solid"},start:{fillMode:"solid"},end:{fillMode:"solid"}},content:{base:{},start:{},end:{}}};class Ua{constructor(G){Object.assign(this,Va,G)}normalizeAttr({config:G,type:te}){let Me=this.color,ze={};const We=this[te];if(G===!0||Object(yr.n)(G))Me=Object(yr.n)(G)?G:Me,ze={...We};else{if(!Object(yr.m)(G))return null;ze=Object(yr.f)(G,mr)?{...G}:{base:{...G},start:{...G},end:{...G}}}return Object(yr.b)(ze,{start:ze.startEnd,end:ze.startEnd},We),Object(yr.w)(ze).forEach(function([ut,ht]){let gt=Me;ht===!0||Object(yr.n)(ht)?(gt=Object(yr.n)(ht)?ht:gt,ze[ut]={color:gt}):Object(yr.m)(ht)&&(Object(yr.f)(ht,ec)?ze[ut]={...ht}:ze[ut]={}),Object(yr.e)(ze,ut+".color")||Object(yr.u)(ze,ut+".color",gt)}),ze}normalizeHighlight(G){var te=this;const Me=this.normalizeAttr({config:G,type:"highlight"});return Object(yr.w)(Me).forEach(function([ze,We]){const ut=Object(yr.b)(We,{isDark:te.isDark,color:te.color});We.style={...te.getHighlightBgStyle(ut),...We.style},We.contentStyle={...te.getHighlightContentStyle(ut),...We.contentStyle}}),Me}getHighlightBgStyle({fillMode:G,color:te,isDark:Me}){switch(G){case"outline":case"none":return{backgroundColor:Me?"var(--gray-900)":"var(--white)",border:"2px solid",borderColor:Me?`var(--${te}-200)`:`var(--${te}-700)`,borderRadius:"var(--rounded-full)"};case"light":return{backgroundColor:Me?`var(--${te}-800)`:`var(--${te}-200)`,opacity:Me?.75:1,borderRadius:"var(--rounded-full)"};case"solid":return{backgroundColor:Me?`var(--${te}-500)`:`var(--${te}-600)`,borderRadius:"var(--rounded-full)"};default:return{borderRadius:"var(--rounded-full)"}}}getHighlightContentStyle({fillMode:G,color:te,isDark:Me}){switch(G){case"outline":case"none":return{fontWeight:"var(--font-bold)",color:Me?`var(--${te}-100)`:`var(--${te}-900)`};case"light":return{fontWeight:"var(--font-bold)",color:Me?`var(--${te}-100)`:`var(--${te}-900)`};case"solid":return{fontWeight:"var(--font-bold)",color:"var(--white)"};default:return""}}bgAccentHigh({color:G,isDark:te}){return{backgroundColor:te?`var(--${G}-500)`:`var(--${G}-600)`}}contentAccent({color:G,isDark:te}){return G?{fontWeight:"var(--font-bold)",color:te?`var(--${G}-100)`:`var(--${G}-900)`}:null}normalizeDot(G){return this.normalizeNonHighlight("dot",G,this.bgAccentHigh)}normalizeBar(G){return this.normalizeNonHighlight("bar",G,this.bgAccentHigh)}normalizeContent(G){return this.normalizeNonHighlight("content",G,this.contentAccent)}normalizeNonHighlight(G,te,Me){var ze=this;const We=this.normalizeAttr({type:G,config:te});return Object(yr.w)(We).forEach(function([ut,ht]){Object(yr.b)(ht,{isDark:ze.isDark,color:ze.color}),ht.style={...Me(ht),...ht.style}}),We}}var Oi=f("29ae"),Ai=f("1315"),xn=f("22f3");const da={mixins:[ko.a],props:{color:String,isDark:Boolean,firstDayOfWeek:Number,masks:Object,locale:[String,Object],timezone:String,minDate:null,maxDate:null,minDateExact:null,maxDateExact:null,disabledDates:null,availableDates:null,theme:null},computed:{$theme(){return this.theme instanceof Ua?this.theme:new Ua({color:this.passedProp("color","blue"),isDark:this.passedProp("isDark",!1)})},$locale(){if(this.locale instanceof Oi.b)return this.locale;const R=Object(yr.m)(this.locale)?this.locale:{id:this.locale,firstDayOfWeek:this.firstDayOfWeek,masks:this.masks};return new Oi.b(R,{locales:this.$locales,timezone:this.timezone})},disabledDates_(){const R=this.normalizeDates(this.disabledDates),{minDate:G,minDateExact:te,maxDate:Me,maxDateExact:ze}=this;if(te||G){const We=te?this.normalizeDate(te):this.normalizeDate(G,{time:"00:00:00"});R.push({start:null,end:new Date(We.getTime()-1e3)})}if(ze||Me){const We=ze?this.normalizeDate(ze):this.normalizeDate(Me,{time:"23:59:59"});R.push({start:new Date(We.getTime()+1e3),end:null})}return R},availableDates_(){return this.normalizeDates(this.availableDates)},disabledAttribute(){return new xn.a({key:"disabled",dates:this.disabledDates_,excludeDates:this.availableDates_,excludeMode:"includes",order:100},this.$theme,this.$locale)}},created(){Object(Ai.a)(this.$defaults.screens)},methods:{formatDate(R,G){return this.$locale?this.$locale.format(R,G):""},parseDate(R,G){if(!this.$locale)return null;const te=this.$locale.parse(R,G);return Object(yr.j)(te)?te:null},normalizeDate(R,G){return this.$locale?this.$locale.normalizeDate(R,G):R},normalizeDates(R){return this.$locale.normalizeDates(R,{isFullDay:!0})},pageForDate(R){return this.$locale.getDateParts(this.normalizeDate(R))},pageForThisMonth(){return this.pageForDate(new Date)}}},Dn={methods:{safeScopedSlot(R,G,te=null){return Object(yr.k)(this.$scopedSlots[R])?this.$scopedSlots[R](G):te}}},es=ja,Yn=da,Ws=Dn;var Qi={name:"PopoverRow",mixins:[es],props:{attribute:Object},computed:{indicator(){const{highlight:R,dot:G,bar:te,popover:Me}=this.attribute;if(Me&&Me.hideIndicator)return null;if(R){const{color:ze,isDark:We}=R.start;return{style:{...this.theme.bgAccentHigh({color:ze,isDark:!We}),width:"10px",height:"5px",borderRadius:"3px"}}}if(G){const{color:ze,isDark:We}=G.start;return{style:{...this.theme.bgAccentHigh({color:ze,isDark:!We}),width:"5px",height:"5px",borderRadius:"50%"}}}if(te){const{color:ze,isDark:We}=te.start;return{style:{...this.theme.bgAccentHigh({color:ze,isDark:!We}),width:"10px",height:"3px"}}}return null}}},bn=Qi,vh=(f("ca17"),xo(bn,vr,xr,!1,null,"eb5afd1a",null)),fa=vh.exports,Fi=function(){var R=this,G=R._self._c;return G("div",{staticClass:"vc-nav-container"},[G("div",{staticClass:"vc-nav-header"},[G("span",{staticClass:"vc-nav-arrow is-left",class:{"is-disabled":!R.prevItemsEnabled},attrs:{role:"button",tabindex:R.prevItemsEnabled?0:void 0},on:{click:R.movePrev,keydown:function(te){return R.onSpaceOrEnter(te,R.movePrev)}}},[R._t("nav-left-button",function(){return[G("svg-icon",{attrs:{name:"left-arrow",width:"20px",height:"24px"}})]})],2),G("span",{staticClass:"vc-nav-title vc-grid-focus",style:{whiteSpace:"nowrap"},attrs:{role:"button",tabindex:"0"},on:{click:R.toggleMode,keydown:function(te){return R.onSpaceOrEnter(te,R.toggleMode)}}},[R._v(" "+R._s(R.title)+" ")]),G("span",{staticClass:"vc-nav-arrow is-right",class:{"is-disabled":!R.nextItemsEnabled},attrs:{role:"button",tabindex:R.nextItemsEnabled?0:void 0},on:{click:R.moveNext,keydown:function(te){return R.onSpaceOrEnter(te,R.moveNext)}}},[R._t("nav-right-button",function(){return[G("svg-icon",{attrs:{name:"right-arrow",width:"20px",height:"24px"}})]})],2)]),G("div",{staticClass:"vc-nav-items"},R._l(R.activeItems,function(te){return G("span",{key:te.label,class:R.getItemClasses(te),attrs:{role:"button","data-id":te.id,"aria-label":te.ariaLabel,tabindex:te.isDisabled?void 0:0},on:{click:te.click,keydown:function(Me){return R.onSpaceOrEnter(Me,te.click)}}},[R._v(" "+R._s(te.label)+" ")])}),0)])},jo=[],Zs=function(){var R=this,G=R._self._c;return G("svg",R._g({staticClass:"vc-svg-icon",attrs:{width:R.width,height:R.height,viewBox:R.viewBox}},R.$listeners),[G("path",{attrs:{d:R.path}})])},Es=[];const xi="26px",Kc="0 0 32 32",Jc={"left-arrow":{viewBox:"0 -1 16 34",path:"M11.196 10c0 0.143-0.071 0.304-0.179 0.411l-7.018 7.018 7.018 7.018c0.107 0.107 0.179 0.268 0.179 0.411s-0.071 0.304-0.179 0.411l-0.893 0.893c-0.107 0.107-0.268 0.179-0.411 0.179s-0.304-0.071-0.411-0.179l-8.321-8.321c-0.107-0.107-0.179-0.268-0.179-0.411s0.071-0.304 0.179-0.411l8.321-8.321c0.107-0.107 0.268-0.179 0.411-0.179s0.304 0.071 0.411 0.179l0.893 0.893c0.107 0.107 0.179 0.25 0.179 0.411z"},"right-arrow":{viewBox:"-5 -1 16 34",path:"M10.625 17.429c0 0.143-0.071 0.304-0.179 0.411l-8.321 8.321c-0.107 0.107-0.268 0.179-0.411 0.179s-0.304-0.071-0.411-0.179l-0.893-0.893c-0.107-0.107-0.179-0.25-0.179-0.411 0-0.143 0.071-0.304 0.179-0.411l7.018-7.018-7.018-7.018c-0.107-0.107-0.179-0.268-0.179-0.411s0.071-0.304 0.179-0.411l0.893-0.893c0.107-0.107 0.268-0.179 0.411-0.179s0.304 0.071 0.411 0.179l8.321 8.321c0.107 0.107 0.179 0.268 0.179 0.411z"}};var Ss={props:["name"],data(){return{width:xi,height:xi,viewBox:Kc,path:"",isBaseline:!1}},mounted(){this.updateIcon()},watch:{name(){this.updateIcon()}},methods:{updateIcon(){const R=Jc[this.name];R&&(this.width=R.width||xi,this.height=R.height||xi,this.viewBox=R.viewBox,this.path=R.path)}}},$a=Ss,pa=(f("52ca"),xo($a,Zs,Es,!1,null,"63f7b5ec",null)),ma=pa.exports;const Oo=12;var tc={name:"CalendarNav",components:{SvgIcon:ma},mixins:[es],props:{value:{type:Object,default:function(){return{month:0,year:0}}},validator:{type:Function,default:function(){return function(){return!0}}}},data(){return{monthMode:!0,yearIndex:0,yearGroupIndex:0,onSpaceOrEnter:yn.l}},computed:{month(){return this.value&&this.value.month||0},year(){return this.value&&this.value.year||0},title(){return this.monthMode?this.yearIndex:`${this.firstYear} - ${this.lastYear}`},monthItems(){return this.getMonthItems(this.yearIndex)},yearItems(){return this.getYearItems(this.yearGroupIndex)},prevItemsEnabled(){return this.monthMode?this.prevMonthItemsEnabled:this.prevYearItemsEnabled},nextItemsEnabled(){return this.monthMode?this.nextMonthItemsEnabled:this.nextYearItemsEnabled},prevMonthItemsEnabled(){return this.getMonthItems(this.yearIndex-1).some(function(R){return!R.isDisabled})},nextMonthItemsEnabled(){return this.getMonthItems(this.yearIndex+1).some(function(R){return!R.isDisabled})},prevYearItemsEnabled(){return this.getYearItems(this.yearGroupIndex-1).some(function(R){return!R.isDisabled})},nextYearItemsEnabled(){return this.getYearItems(this.yearGroupIndex+1).some(function(R){return!R.isDisabled})},activeItems(){return this.monthMode?this.monthItems:this.yearItems},firstYear(){return Object(yr.g)(this.yearItems.map(function(R){return R.year}))},lastYear(){return Object(yr.p)(this.yearItems.map(function(R){return R.year}))}},watch:{year(){this.yearIndex=this.year},yearIndex(R){this.yearGroupIndex=this.getYearGroupIndex(R)},value(){this.focusFirstItem()}},created(){this.yearIndex=this.year},mounted(){this.focusFirstItem()},methods:{focusFirstItem(){var R=this;this.$nextTick(function(){const G=R.$el.querySelector(".vc-nav-item:not(.is-disabled)");G&&G.focus()})},getItemClasses({isActive:R,isCurrent:G,isDisabled:te}){const Me=["vc-nav-item"];return R?Me.push("is-active"):G&&Me.push("is-current"),te&&Me.push("is-disabled"),Me},getYearGroupIndex(R){return Math.floor(R/Oo)},getMonthItems(R){var G=this;const{month:te,year:Me}=this.pageForDate(new Date);return this.locale.getMonthDates().map(function(ze,We){const ut=We+1;return{month:ut,year:R,id:`${R}.${Object(yn.m)(ut,2)}`,label:G.locale.format(ze,G.masks.navMonths),ariaLabel:G.locale.format(ze,"MMMM YYYY"),isActive:ut===G.month&&R===G.year,isCurrent:ut===te&&R===Me,isDisabled:!G.validator({month:ut,year:R}),click:function(){return G.monthClick(ut,R)}}})},getYearItems(R){var G=this;const{_:te,year:Me}=this.pageForDate(new Date),ze=R*Oo,We=ze+Oo,ut=[];for(let ht=ze;ht<We;ht+=1){let gt=!1;for(let xt=1;xt<12&&(gt=this.validator({month:xt,year:ht}),!gt);xt++);ut.push({year:ht,id:ht,label:ht,ariaLabel:ht,isActive:ht===this.year,isCurrent:ht===Me,isDisabled:!gt,click:function(){return G.yearClick(ht)}})}return ut},monthClick(R,G){this.validator({month:R,year:G})&&this.$emit("input",{month:R,year:G})},yearClick(R){this.yearIndex=R,this.monthMode=!0,this.focusFirstItem()},toggleMode(){this.monthMode=!this.monthMode},movePrev(){this.prevItemsEnabled&&(this.monthMode&&this.movePrevYear(),this.movePrevYearGroup())},moveNext(){this.nextItemsEnabled&&(this.monthMode&&this.moveNextYear(),this.moveNextYearGroup())},movePrevYear(){this.yearIndex--},moveNextYear(){this.yearIndex++},movePrevYearGroup(){this.yearGroupIndex--},moveNextYearGroup(){this.yearGroupIndex++}}},Ms=tc,gl=(f("dc9e"),xo(Ms,Fi,jo,!1,null,null,null)),Qc=gl.exports;f("3c65");function As(R){document&&document.dispatchEvent(new CustomEvent("show-popover",{detail:R}))}function nc(R){document&&document.dispatchEvent(new CustomEvent("hide-popover",{detail:R}))}function lr(R){document&&document.dispatchEvent(new CustomEvent("toggle-popover",{detail:R}))}function yl(R){document&&document.dispatchEvent(new CustomEvent("update-popover",{detail:R}))}function Ga(R){const{visibility:G}=R,te=G==="click",Me=G==="hover",ze=G==="hover-focus",We=G==="focus";R.autoHide=!te;let ut=!1,ht=!1;return{click(gt){te&&(R.ref=gt.target,lr(R),gt.stopPropagation())},mousemove(gt){R.ref=gt.currentTarget,ut||(ut=!0,(Me||ze)&&As(R))},mouseleave(gt){R.ref=gt.target,ut&&(ut=!1,(Me||ze&&!ht)&&nc(R))},focusin(gt){R.ref=gt.currentTarget,ht||(ht=!0,(We||ze)&&As(R))},focusout(gt){R.ref=gt.currentTarget,ht&&!Object(yn.e)(R.ref,gt.relatedTarget)&&(ht=!1,(We||ze&&!ut)&&nc(R))}}}var Dd,kd,Ys,Xs,rc,Ha,eu,Is,Ks={name:"CalendarDay",mixins:[es,Ws],render(R){var G=this;const te=function(){return G.hasBackgrounds&&R("div",{class:"vc-highlights vc-day-layer"},G.backgrounds.map(function({key:ut,wrapperClass:ht,class:gt,style:xt}){return R("div",{key:ut,class:ht},[R("div",{class:gt,style:xt})])}))},Me=function(){return G.safeScopedSlot("day-content",{day:G.day,attributes:G.day.attributes,attributesMap:G.day.attributesMap,dayProps:G.dayContentProps,dayEvents:G.dayContentEvents})||R("span",{class:G.dayContentClass,style:G.dayContentStyle,attrs:{...G.dayContentProps},on:G.dayContentEvents,ref:"content"},[G.day.label])},ze=function(){return G.hasDots&&R("div",{class:"vc-day-layer vc-day-box-center-bottom"},[R("div",{class:"vc-dots"},G.dots.map(function({key:ut,class:ht,style:gt}){return R("span",{key:ut,class:ht,style:gt})}))])},We=function(){return G.hasBars&&R("div",{class:"vc-day-layer vc-day-box-center-bottom"},[R("div",{class:"vc-bars"},G.bars.map(function({key:ut,class:ht,style:gt}){return R("span",{key:ut,class:ht,style:gt})}))])};return R("div",{class:["vc-day",...this.day.classes,{"vc-day-box-center-center":!this.$scopedSlots["day-content"]},{"is-not-in-month":!this.inMonth}]},[te(),Me(),ze(),We()])},inject:["sharedState"],props:{day:{type:Object,required:!0}},data(){return{glyphs:{},dayContentEvents:{}}},computed:{label(){return this.day.label},startTime(){return this.day.range.start.getTime()},endTime(){return this.day.range.end.getTime()},inMonth(){return this.day.inMonth},isDisabled(){return this.day.isDisabled},backgrounds(){return this.glyphs.backgrounds},hasBackgrounds(){return!!Object(yn.b)(this.backgrounds)},content(){return this.glyphs.content},dots(){return this.glyphs.dots},hasDots(){return!!Object(yn.b)(this.dots)},bars(){return this.glyphs.bars},hasBars(){return!!Object(yn.b)(this.bars)},popovers(){return this.glyphs.popovers},hasPopovers(){return!!Object(yn.b)(this.popovers)},dayContentClass(){return["vc-day-content vc-focusable",{"is-disabled":this.isDisabled},Object(yr.d)(Object(yr.p)(this.content),"class")||""]},dayContentStyle(){return Object(yr.d)(Object(yr.p)(this.content),"style")},dayContentProps(){let R;return this.day.isFocusable?R="0":this.day.inMonth&&(R="-1"),{tabindex:R,"aria-label":this.day.ariaLabel,"aria-disabled":this.day.isDisabled?"true":"false",role:"button"}},dayEvent(){return{...this.day,el:this.$refs.content,popovers:this.popovers}}},watch:{theme(){this.refresh()},popovers(){this.refreshPopovers()}},mounted(){this.refreshPopovers()},methods:{getDayEvent(R){return{...this.dayEvent,event:R}},click(R){this.$emit("dayclick",this.getDayEvent(R))},mouseenter(R){this.$emit("daymouseenter",this.getDayEvent(R))},mouseleave(R){this.$emit("daymouseleave",this.getDayEvent(R))},focusin(R){this.$emit("dayfocusin",this.getDayEvent(R))},focusout(R){this.$emit("dayfocusout",this.getDayEvent(R))},keydown(R){this.$emit("daykeydown",this.getDayEvent(R))},refresh(){var R=this;if(!this.day.refresh)return;this.day.refresh=!1;const G={backgrounds:[],dots:[],bars:[],popovers:[],content:[]};this.$set(this.day,"attributes",Object.values(this.day.attributesMap||{}).sort(function(te,Me){return te.order-Me.order})),this.day.attributes.forEach(function(te){const{targetDate:Me}=te,{isDate:ze,isComplex:We,startTime:ut,endTime:ht}=Me,gt=R.startTime<=ut,xt=R.endTime>=ht,Qt=gt&&xt,Cn=gt||xt,Pn={isDate:ze,isComplex:We,onStart:gt,onEnd:xt,onStartAndEnd:Qt,onStartOrEnd:Cn};R.processHighlight(te,Pn,G),R.processNonHighlight(te,"content",Pn,G.content),R.processNonHighlight(te,"dot",Pn,G.dots),R.processNonHighlight(te,"bar",Pn,G.bars),R.processPopover(te,G)}),this.glyphs=G},processHighlight({key:R,highlight:G},{isDate:te,isComplex:Me,onStart:ze,onEnd:We,onStartAndEnd:ut},{backgrounds:ht,content:gt}){if(!G)return;const{base:xt,start:Qt,end:Cn}=G;te||Me||ut?(ht.push({key:R,wrapperClass:"vc-day-layer vc-day-box-center-center",class:["vc-highlight",Qt.class],style:Qt.style}),gt.push({key:R+"-content",class:Qt.contentClass,style:Qt.contentStyle})):ze?(ht.push({key:R+"-base",wrapperClass:"vc-day-layer vc-day-box-right-center",class:["vc-highlight vc-highlight-base-start",xt.class],style:xt.style}),ht.push({key:R,wrapperClass:"vc-day-layer vc-day-box-center-center",class:["vc-highlight",Qt.class],style:Qt.style}),gt.push({key:R+"-content",class:Qt.contentClass,style:Qt.contentStyle})):We?(ht.push({key:R+"-base",wrapperClass:"vc-day-layer vc-day-box-left-center",class:["vc-highlight vc-highlight-base-end",xt.class],style:xt.style}),ht.push({key:R,wrapperClass:"vc-day-layer vc-day-box-center-center",class:["vc-highlight",Cn.class],style:Cn.style}),gt.push({key:R+"-content",class:Cn.contentClass,style:Cn.contentStyle})):(ht.push({key:R+"-middle",wrapperClass:"vc-day-layer vc-day-box-center-center",class:["vc-highlight vc-highlight-base-middle",xt.class],style:xt.style}),gt.push({key:R+"-content",class:xt.contentClass,style:xt.contentStyle}))},processNonHighlight(R,G,{isDate:te,onStart:Me,onEnd:ze},We){if(!R[G])return;const{key:ut}=R,ht="vc-"+G,{base:gt,start:xt,end:Qt}=R[G];te||Me?We.push({key:ut,class:[ht,xt.class],style:xt.style}):ze?We.push({key:ut,class:[ht,Qt.class],style:Qt.style}):We.push({key:ut,class:[ht,gt.class],style:gt.style})},processPopover(R,{popovers:G}){const{key:te,customData:Me,popover:ze}=R;if(!ze)return;const We=Object(yr.b)({key:te,customData:Me,attribute:R},{...ze},{visibility:ze.label?"hover":"click",placement:"bottom",isInteractive:!ze.label});G.splice(0,0,We)},refreshPopovers(){let R={};Object(yn.b)(this.popovers)&&(R=Ga(Object(yr.b)({id:this.dayPopoverId,data:this.day},...this.popovers))),this.dayContentEvents=Object(yn.h)({click:this.click,mouseenter:this.mouseenter,mouseleave:this.mouseleave,focusin:this.focusin,focusout:this.focusout,keydown:this.keydown},R),yl({id:this.dayPopoverId,data:this.day})}}},vl=Ks,tu=(f("8ab2"),xo(vl,Dd,kd,!1,null,"4420d078",null)),nu=tu.exports,Vo={name:"CalendarPane",mixins:[es,Ws],render(R){var G=this;const te=this.safeScopedSlot("header",this.page)||R("div",{class:"vc-header align-"+this.titlePosition},[R("div",{class:"vc-title",on:this.navPopoverEvents},[this.safeScopedSlot("header-title",this.page,this.page.title)])]),Me=this.weekdayLabels.map(function(Qt,Cn){return R("div",{key:Cn+1,class:"vc-weekday"},[Qt])}),ze=this.showWeeknumbers_.startsWith("left"),We=this.showWeeknumbers_.startsWith("right");ze?Me.unshift(R("div",{class:"vc-weekday"})):We&&Me.push(R("div",{class:"vc-weekday"}));const ut=function(Qt){return R("div",{class:["vc-weeknumber"]},[R("span",{class:["vc-weeknumber-content","is-"+G.showWeeknumbers_],on:{click:function(Cn){G.$emit("weeknumberclick",{weeknumber:Qt,days:G.page.days.filter(function(Pn){return Pn[G.weeknumberKey]===Qt}),event:Cn})}}},[Qt])])},ht=[],{daysInWeek:gt}=this.locale;this.page.days.forEach(function(Qt,Cn){const Pn=Cn%gt;(ze&&Pn===0||We&&Pn===gt)&&ht.push(ut(Qt[G.weeknumberKey])),ht.push(R(nu,{attrs:{day:Qt},on:{...G.$listeners},scopedSlots:G.$scopedSlots,key:Qt.id,ref:"days",refInFor:!0})),We&&Pn===gt-1&&ht.push(ut(Qt[G.weeknumberKey]))});const xt=R("div",{class:{"vc-weeks":!0,"vc-show-weeknumbers":this.showWeeknumbers_,"is-left":ze,"is-right":We}},[Me,ht]);return R("div",{class:["vc-pane","row-from-end-"+this.rowFromEnd,"column-from-end-"+this.columnFromEnd],ref:"pane"},[te,xt])},inheritAttrs:!1,props:{page:Object,position:Number,row:Number,rowFromEnd:Number,column:Number,columnFromEnd:Number,titlePosition:String,navVisibility:String,showWeeknumbers:[Boolean,String],showIsoWeeknumbers:[Boolean,String]},computed:{weeknumberKey(){return this.showWeeknumbers?"weeknumber":"isoWeeknumber"},showWeeknumbers_(){const R=this.showWeeknumbers||this.showIsoWeeknumbers;return R==null?"":Object(yr.i)(R)?R?"left":"":R.startsWith("right")?this.columnFromEnd>1?"right":R:this.column>1?"left":R},navVisibility_(){return this.propOrDefault("navVisibility","navVisibility")},navPlacement(){switch(this.titlePosition){case"left":return"bottom-start";case"right":return"bottom-end";default:return"bottom"}},navPopoverEvents(){const{sharedState:R,navVisibility_:G,navPlacement:te,page:Me,position:ze}=this;return Ga({id:R.navPopoverId,visibility:G,placement:te,modifiers:[{name:"flip",options:{fallbackPlacements:["bottom"]}}],data:{page:Me,position:ze},isInteractive:!0})},weekdayLabels(){var R=this;return this.locale.getWeekdayDates().map(function(G){return R.format(G,R.masks.weekdays)})}},methods:{refresh(){this.$refs.days.forEach(function(R){return R.refresh()})}}},xh=Vo,ru=(f("f954"),f("4638"),xo(xh,Ys,Xs,!1,null,"74ad501d",null)),iu=ru.exports,ou={name:"CustomTransition",render(R){return R("transition",{props:{name:this.name_,appear:this.appear},on:{beforeEnter:this.beforeEnter,afterEnter:this.afterEnter}},[this.$slots.default])},props:{name:String,appear:Boolean},computed:{name_(){return this.name||"none"}},methods:{beforeEnter(R){this.$emit("beforeEnter",R),this.$emit("beforeTransition",R)},afterEnter(R){this.$emit("afterEnter",R),this.$emit("afterTransition",R)}}},su=ou,au=(f("0459"),xo(su,rc,Ha,!1,null,"5be4b00c",null)),qa=au.exports,ic=f("9349"),xl=f("0733"),Js=(f("3ee2"),{name:"Calendar",render(R){var G=this;const te=this.pages.map(function(ut,ht){const gt=ht+1,xt=Math.ceil((ht+1)/G.columns),Qt=G.rows-xt+1,Cn=gt%G.columns||G.columns,Pn=G.columns-Cn+1;return R(iu,{attrs:{...G.$attrs,attributes:G.store},props:{page:ut,position:gt,row:xt,rowFromEnd:Qt,column:Cn,columnFromEnd:Pn,titlePosition:G.titlePosition_},on:{...G.$listeners,dayfocusin:function(er){G.lastFocusedDay=er,G.$emit("dayfocusin",er)},dayfocusout:function(er){G.lastFocusedDay=null,G.$emit("dayfocusout",er)}},scopedSlots:G.$scopedSlots,key:ut.key,ref:"pages",refInFor:!0})}),Me=function(ut){const ht=function(){return G.move(ut?-G.step_:G.step_)},gt=function(Qt){return Object(yn.l)(Qt,ht)},xt=ut?!G.canMovePrev:!G.canMoveNext;return R("div",{class:["vc-arrow","is-"+(ut?"left":"right"),{"is-disabled":xt}],attrs:{role:"button"},on:{click:ht,keydown:gt}},[(ut?G.safeScopedSlot("header-left-button",{click:ht}):G.safeScopedSlot("header-right-button",{click:ht}))||R(ma,{props:{name:ut?"left-arrow":"right-arrow"}})])},ze=function(){return R(en,{props:{id:G.sharedState.navPopoverId,contentClass:"vc-nav-popover-container"},ref:"navPopover",scopedSlots:{default:function({data:ut}){const{position:ht,page:gt}=ut;return R(Qc,{props:{value:gt,position:ht,validator:function(xt){return G.canMove(xt,{position:ht})}},on:{input:function(xt){return G.move(xt,{position:ht})}},scopedSlots:G.$scopedSlots})}}})},We=function(){return R(en,{props:{id:G.sharedState.dayPopoverId,contentClass:"vc-day-popover-container"},scopedSlots:{default:function({data:ut,updateLayout:ht,hide:gt}){const xt=ut.attributes?Object.values(ut.attributes).filter(function(er){return er.popover}):[],Qt=G.$locale.masks,Cn=G.formatDate,Pn=Cn(ut.date,Qt.dayPopover);return G.safeScopedSlot("day-popover",{day:ut,attributes:xt,masks:Qt,format:Cn,dayTitle:Pn,updateLayout:ht,hide:gt})||R("div",[Qt.dayPopover&&R("div",{class:["vc-day-popover-header"]},[Pn]),xt.map(function(er){return R(fa,{key:er.key,props:{attribute:er}})})])}}})};return R("div",{attrs:{"data-helptext":"Press the arrow keys to navigate by day, Home and End to navigate to week ends, PageUp and PageDown to navigate by month, Alt+PageUp and Alt+PageDown to navigate by year"},class:["vc-container","vc-"+this.$theme.color,{"vc-is-expanded":this.isExpanded,"vc-is-dark":this.$theme.isDark}],on:{keydown:this.handleKeydown,mouseup:function(ut){return ut.preventDefault()}},ref:"container"},[ze(),R("div",{class:["vc-pane-container",{"in-transition":this.inTransition}]},[R(qa,{props:{name:this.transitionName},on:{beforeEnter:function(){G.inTransition=!0},afterEnter:function(){G.inTransition=!1}}},[R("div",{class:"vc-pane-layout",style:{gridTemplateColumns:`repeat(${this.columns}, 1fr)`},attrs:{...this.$attrs},key:Object(yn.b)(this.pages)?this.pages[0].key:""},te)]),R("div",{class:["vc-arrows-container title-"+this.titlePosition_]},[Me(!0),Me(!1)]),this.$scopedSlots.footer&&this.$scopedSlots.footer()]),We()])},mixins:[Yn,Ws],provide(){return{sharedState:this.sharedState}},props:{rows:{type:Number,default:1},columns:{type:Number,default:1},step:Number,titlePosition:String,isExpanded:Boolean,fromDate:Date,toDate:Date,fromPage:Object,toPage:Object,minPage:Object,maxPage:Object,transition:String,attributes:[Object,Array],trimWeeks:Boolean,disablePageSwipe:Boolean},data(){return{pages:[],store:null,lastFocusedDay:null,focusableDay:new Date().getDate(),transitionName:"",inTransition:!1,sharedState:{navPopoverId:Object(yn.c)(),dayPopoverId:Object(yn.c)(),theme:{},masks:{},locale:{}}}},computed:{titlePosition_(){return this.propOrDefault("titlePosition","titlePosition")},firstPage(){return Object(yr.g)(this.pages)},lastPage(){return Object(yr.p)(this.pages)},minPage_(){return this.minPage||this.pageForDate(this.minDate)},maxPage_(){return this.maxPage||this.pageForDate(this.maxDate)},count(){return this.rows*this.columns},step_(){return this.step||this.count},canMovePrev(){return this.canMove(-this.step_)},canMoveNext(){return this.canMove(this.step_)}},watch:{$locale(){this.refreshLocale(),this.refreshPages({page:this.firstPage,ignoreCache:!0}),this.initStore()},$theme(){this.refreshTheme(),this.initStore()},fromDate(){this.refreshPages()},fromPage(R){const G=this.pages&&this.pages[0];Object(yn.q)(R,G)||this.refreshPages()},toPage(R){const G=this.pages&&this.pages[this.pages.length-1];Object(yn.q)(R,G)||this.refreshPages()},count(){this.refreshPages()},attributes:{handler(R){const{adds:G,deletes:te}=this.store.refresh(R);this.refreshAttrs(this.pages,G,te)},deep:!0},pages(R){this.refreshAttrs(R,this.store.list,null,!0)},disabledAttribute(){this.refreshDisabledDays()},lastFocusedDay(R){R&&(this.focusableDay=R.day,this.refreshFocusableDays())},inTransition(R){R?this.$emit("transition-start"):(this.$emit("transition-end"),this.transitionPromise&&(this.transitionPromise.resolve(!0),this.transitionPromise=null))}},created(){this.refreshLocale(),this.refreshTheme(),this.initStore(),this.refreshPages()},mounted(){var R=this;this.disablePageSwipe||(this.removeHandlers=Object(xl.a)(this.$refs.container,function({toLeft:G,toRight:te}){G?R.moveNext():te&&R.movePrev()},this.$defaults.touch))},destroyed(){this.pages=[],this.store.destroy(),this.store=null,this.sharedState=null,this.removeHandlers&&this.removeHandlers()},methods:{refreshLocale(){this.sharedState.locale=this.$locale,this.sharedState.masks=this.$locale.masks},refreshTheme(){this.sharedState.theme=this.$theme},canMove(R,G={}){var te=this;const Me=this.$locale.toPage(R,this.firstPage);let{position:ze}=G;if(Object(yr.l)(R)&&(ze=1),!Me)return Promise.reject(new Error("Invalid argument provided: "+R));if(!ze)if(Object(yn.o)(Me,this.firstPage))ze=-1;else{if(!Object(yn.n)(Me,this.lastPage))return Promise.resolve(!0);ze=1}return Object.assign(G,this.getTargetPageRange(Me,{position:ze,force:!0})),Object(yn.s)(G.fromPage,G.toPage).some(function(We){return Object(yn.p)(We,te.minPage_,te.maxPage_)})},movePrev(R){return this.move(-this.step_,R)},moveNext(R){return this.move(this.step_,R)},move(R,G={}){const te=this.canMove(R,G);return G.force||te?(this.$refs.navPopover.hide({hideDelay:0}),G.fromPage&&!Object(yn.q)(G.fromPage,this.firstPage)?this.refreshPages({...G,page:G.fromPage,position:1,force:!0}):Promise.resolve(!0)):Promise.reject(new Error("Move target is disabled: "+JSON.stringify(G)))},focusDate(R,G={}){var te=this;return this.move(R,G).then(function(){const Me=te.$el.querySelector(`.id-${te.$locale.getDayId(R)}.in-month .vc-focusable`);return Me?(Me.focus(),Promise.resolve(!0)):Promise.resolve(!1)})},showPageRange(R,G){let te,Me;if(Object(yr.j)(R))te=this.pageForDate(R);else{if(!Object(yr.m)(R))return Promise.reject(new Error("Invalid page range provided."));{const{month:ut,year:ht}=R,{from:gt,to:xt}=R;Object(yr.l)(ut)&&Object(yr.l)(ht)?te=R:(gt||xt)&&(te=Object(yr.j)(gt)?this.pageForDate(gt):gt,Me=Object(yr.j)(xt)?this.pageForDate(xt):xt)}}const ze=this.lastPage;let We=te;return Object(yn.n)(Me,ze)&&(We=Object(yn.a)(Me,-(this.pages.length-1))),Object(yn.o)(We,te)&&(We=te),this.refreshPages({...G,page:We})},getTargetPageRange(R,{position:G,force:te}={}){let Me=null,ze=null;if(Object(yn.r)(R)){let We=0;G=+G,isNaN(G)||(We=G>0?1-G:-(this.count+G)),Me=Object(yn.a)(R,We)}else Me=this.getDefaultInitialPage();return ze=Object(yn.a)(Me,this.count-1),te||(Object(yn.o)(Me,this.minPage_)?Me=this.minPage_:Object(yn.n)(ze,this.maxPage_)&&(Me=Object(yn.a)(this.maxPage_,1-this.count)),ze=Object(yn.a)(Me,this.count-1)),{fromPage:Me,toPage:ze}},getDefaultInitialPage(){let R=this.fromPage||this.pageForDate(this.fromDate);if(!Object(yn.r)(R)){const G=this.toPage||this.pageForDate(this.toPage);Object(yn.r)(G)&&(R=Object(yn.a)(G,1-this.count))}return Object(yn.r)(R)||(R=this.getPageForAttributes()),Object(yn.r)(R)||(R=this.pageForThisMonth()),R},refreshPages({page:R,position:G=1,force:te,transition:Me,ignoreCache:ze}={}){var We=this;return new Promise(function(ut,ht){const{fromPage:gt,toPage:xt}=We.getTargetPageRange(R,{position:G,force:te}),Qt=[];for(let Cn=0;Cn<We.count;Cn++)Qt.push(We.buildPage(Object(yn.a)(gt,Cn),ze));We.refreshDisabledDays(Qt),We.refreshFocusableDays(Qt),We.transitionName=We.getPageTransition(We.pages[0],Qt[0],Me),We.pages=Qt,We.$emit("update:from-page",gt),We.$emit("update:to-page",xt),We.transitionName&&We.transitionName!=="none"?We.transitionPromise={resolve:ut,reject:ht}:ut(!0)})},refreshDisabledDays(R){var G=this;this.getPageDays(R).forEach(function(te){te.isDisabled=!!G.disabledAttribute&&G.disabledAttribute.intersectsDay(te)})},refreshFocusableDays(R){var G=this;this.getPageDays(R).forEach(function(te){te.isFocusable=te.inMonth&&te.day===G.focusableDay})},getPageDays(R=this.pages){return R.reduce(function(G,te){return G.concat(te.days)},[])},getPageTransition(R,G,te=this.transition){if(te==="none")return te;if(te==="fade"||!te&&this.count>1||!Object(yn.r)(R)||!Object(yn.r)(G))return"fade";const Me=Object(yn.o)(G,R);return te==="slide-v"?Me?"slide-down":"slide-up":Me?"slide-right":"slide-left"},getPageForAttributes(){let R=null;const G=this.store.pinAttr;if(G&&G.hasDates){let[te]=G.dates;te=te.start||te.date,R=this.pageForDate(te)}return R},buildPage({month:R,year:G},te){var Me=this;const ze=`${G.toString()}-${R.toString()}`;let We=this.pages.find(function(ut){return ut.key===ze});if(!We||te){const ut=new Date(G,R-1,15),ht=this.$locale.getMonthComps(R,G),gt=this.$locale.getPrevMonthComps(R,G),xt=this.$locale.getNextMonthComps(R,G);We={key:ze,month:R,year:G,weeks:this.trimWeeks?ht.weeks:6,title:this.$locale.format(ut,this.$locale.masks.title),shortMonthLabel:this.$locale.format(ut,"MMM"),monthLabel:this.$locale.format(ut,"MMMM"),shortYearLabel:G.toString().substring(2),yearLabel:G.toString(),monthComps:ht,prevMonthComps:gt,nextMonthComps:xt,canMove:function(Qt){return Me.canMove(Qt)},move:function(Qt){return Me.move(Qt)},moveThisMonth:function(){return Me.moveThisMonth()},movePrevMonth:function(){return Me.move(gt)},moveNextMonth:function(){return Me.move(xt)},refresh:!0},We.days=this.$locale.getCalendarDays(We)}return We},initStore(){this.store=new ic.a(this.$theme,this.$locale,this.attributes),this.refreshAttrs(this.pages,this.store.list,[],!0)},refreshAttrs(R=[],G=[],te=[],Me){var ze=this;Object(yn.b)(R)&&(R.forEach(function(We){We.days.forEach(function(ut){let ht={};Me?ut.refresh=!0:Object(yr.f)(ut.attributesMap,te)?(ht=Object(yr.s)(ut.attributesMap,te),ut.refresh=!0):ht=ut.attributesMap||{},G.forEach(function(gt){const xt=gt.intersectsDay(ut);if(xt){const Qt={...gt,targetDate:xt};ht[gt.key]=Qt,ut.refresh=!0}}),ut.refresh&&(ut.attributesMap=ht)})}),this.$nextTick(function(){ze.$refs.pages.forEach(function(We){return We.refresh()})}))},handleKeydown(R){const G=this.lastFocusedDay;G!=null&&(G.event=R,this.handleDayKeydown(G))},handleDayKeydown(R){const{dateFromTime:G,event:te}=R,Me=G(12);let ze=null;switch(te.key){case"ArrowLeft":ze=Object(x.a)(Me,-1);break;case"ArrowRight":ze=Object(x.a)(Me,1);break;case"ArrowUp":ze=Object(x.a)(Me,-7);break;case"ArrowDown":ze=Object(x.a)(Me,7);break;case"Home":ze=Object(x.a)(Me,1-R.weekdayPosition);break;case"End":ze=Object(x.a)(Me,R.weekdayPositionFromEnd);break;case"PageUp":ze=te.altKey?L(Me,-1):O(Me,-1);break;case"PageDown":ze=te.altKey?L(Me,1):O(Me,1);break}ze&&(te.preventDefault(),this.focusDate(ze).catch(function(){}))}}}),lu=Js,Uo=(f("1c6b"),xo(lu,eu,Is,!1,null,null,null)),Jt=Uo.exports,oc=function(){var R=this,G=R._self._c;return G("div",{staticClass:"vc-time-picker",class:[{"vc-disabled":R.isDisabled,"vc-bordered":R.showBorder}]},[G("div",[G("svg",{staticClass:"vc-time-icon",attrs:{fill:"none","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",stroke:"currentColor"}},[G("path",{attrs:{d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"}})])]),G("div",{staticClass:"vc-date-time"},[R.date?G("div",{staticClass:"vc-date"},[G("span",{staticClass:"vc-weekday"},[R._v(" "+R._s(R.locale.format(R.date,"WWW"))+" ")]),G("span",{staticClass:"vc-month"},[R._v(" "+R._s(R.locale.format(R.date,"MMM"))+" ")]),G("span",{staticClass:"vc-day"},[R._v(" "+R._s(R.locale.format(R.date,"D"))+" ")]),G("span",{staticClass:"vc-year"},[R._v(" "+R._s(R.locale.format(R.date,"YYYY"))+" ")])]):R._e(),G("div",{staticClass:"vc-time"},[G("time-select",{attrs:{options:R.hourOptions_},model:{value:R.hours,callback:function(te){R.hours=R._n(te)},expression:"hours"}}),G("span",{staticStyle:{margin:"0 4px"}},[R._v(":")]),G("time-select",{attrs:{options:R.minuteOptions},model:{value:R.minutes,callback:function(te){R.minutes=R._n(te)},expression:"minutes"}}),R.is24hr?R._e():G("div",{staticClass:"vc-am-pm",class:{"vc-disabled":!(R.hours>=0)}},[G("button",{class:{active:R.isAM,"vc-disabled":R.amDisabled},attrs:{type:"button"},on:{click:function(te){te.preventDefault(),R.isAM=!0}}},[R._v(" AM ")]),G("button",{class:{active:!R.isAM,"vc-disabled":R.pmDisabled},attrs:{type:"button"},on:{click:function(te){te.preventDefault(),R.isAM=!1}}},[R._v(" PM ")])])],1)])])},cu=[],bl=function(){var R=this,G=R._self._c;return G("div",{staticClass:"vc-select"},[G("select",R._b({directives:[{name:"model",rawName:"v-model",value:R.model,expression:"model"}],on:{change:function(te){var Me=Array.prototype.filter.call(te.target.options,function(ze){return ze.selected}).map(function(ze){var We="_value"in ze?ze._value:ze.value;return We});R.model=te.target.multiple?Me:Me[0]}}},"select",R.$attrs,!1),R._l(R.options,function(te){return G("option",{key:te.value,attrs:{disabled:te.disabled},domProps:{value:te.value}},[R._v(" "+R._s(te.label)+" ")])}),0),G("div",{staticClass:"vc-select-arrow"},[G("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"}},[G("path",{attrs:{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"}})])])])},uu=[],Qs={inheritAttrs:!1,props:{options:Array,value:Number},computed:{model:{get(){return this.value},set(R){this.$emit("input",R)}}}},ts=Qs,hu=(f("47c6"),xo(ts,bl,uu,!1,null,"7b2eaf0a",null)),_a=hu.exports;const sc=[{value:0,label:"12"},{value:1,label:"1"},{value:2,label:"2"},{value:3,label:"3"},{value:4,label:"4"},{value:5,label:"5"},{value:6,label:"6"},{value:7,label:"7"},{value:8,label:"8"},{value:9,label:"9"},{value:10,label:"10"},{value:11,label:"11"}],ga=[{value:12,label:"12"},{value:13,label:"1"},{value:14,label:"2"},{value:15,label:"3"},{value:16,label:"4"},{value:17,label:"5"},{value:18,label:"6"},{value:19,label:"7"},{value:20,label:"8"},{value:21,label:"9"},{value:22,label:"10"},{value:23,label:"11"}];var du={name:"TimePicker",components:{TimeSelect:_a},props:{value:{type:Object,required:!0},locale:{type:Object,required:!0},theme:{type:Object,required:!0},is24hr:{type:Boolean,default:!0},showBorder:Boolean,isDisabled:Boolean,hourOptions:Array,minuteOptions:Array},computed:{date(){let R=this.locale.normalizeDate(this.value);return this.value.hours===24&&(R=new Date(R.getTime()-1)),R},hours:{get(){return this.value.hours},set(R){this.updateValue(R,this.minutes)}},minutes:{get(){return this.value.minutes},set(R){this.updateValue(this.hours,R)}},isAM:{get(){return this.value.hours<12},set(R){let G=this.hours;R&&G>=12?G-=12:!R&&G<12&&(G+=12),this.updateValue(G,this.minutes)}},amHourOptions(){var R=this;return sc.filter(function(G){return R.hourOptions.some(function(te){return te.value===G.value})})},pmHourOptions(){var R=this;return ga.filter(function(G){return R.hourOptions.some(function(te){return te.value===G.value})})},hourOptions_(){return this.is24hr?this.hourOptions:this.isAM?this.amHourOptions:this.pmHourOptions},amDisabled(){return!Object(yn.b)(this.amHourOptions)},pmDisabled(){return!Object(yn.b)(this.pmHourOptions)}},methods:{updateValue(R,G){R===this.hours&&G===this.minutes||this.$emit("input",{...this.value,hours:R,minutes:G,seconds:0,milliseconds:0})}}},Od=du,Wa=(f("e177"),xo(Od,oc,cu,!1,null,"f4e11af8",null)),Rd=Wa.exports;const fu={type:"auto",mask:"iso",timeAdjust:""},bh=[fu,fu],Za={DATE:"date",DATE_TIME:"datetime",TIME:"time"},Ro={NONE:0,START:1,END:2,BOTH:3};var Ld,zd,wh={name:"DatePicker",render(R){var G=this;const te=function(){if(!G.dateParts)return null;const We=G.isRange?G.dateParts:[G.dateParts[0]];return R("div",[...We.map(function(ut,ht){const gt=G.$locale.getHourOptions(G.modelConfig_[ht].validHours,ut),xt=G.$locale.getMinuteOptions(G.modelConfig_[ht].minuteIncrement,ut);return R(Rd,{props:{value:ut,locale:G.$locale,theme:G.$theme,is24hr:G.is24hr,minuteIncrement:G.minuteIncrement,showBorder:!G.isTime,isDisabled:G.isDateTime&&!ut.isValid||G.isDragging,hourOptions:gt,minuteOptions:xt},on:{input:function(Qt){return G.onTimeInput(Qt,ht===0)}}})}),G.$scopedSlots.footer&&G.$scopedSlots.footer()])},Me=function(){return R(Jt,{attrs:{...G.$attrs,attributes:G.attributes_,theme:G.$theme,locale:G.$locale},props:{minDate:G.minDateExact||G.minDate,maxDate:G.maxDateExact||G.maxDate,disabledDates:G.disabledDates,availableDates:G.availableDates},on:{...G.$listeners,dayclick:G.onDayClick,daykeydown:G.onDayKeydown,daymouseenter:G.onDayMouseEnter},scopedSlots:{...G.$scopedSlots,footer:G.isDateTime?te:G.$scopedSlots.footer},ref:"calendar"})},ze=function(){return G.isTime?R("div",{class:["vc-container","vc-"+G.$theme.color,{"vc-is-dark":G.$theme.isDark}]},[te()]):Me()};return this.$scopedSlots.default&&R("span",[this.$scopedSlots.default(this.slotArgs),R(en,{props:{id:this.datePickerPopoverId,placement:"bottom-start",contentClass:"vc-container"+(this.isDark?" vc-is-dark":"")},on:{beforeShow:function(We){return G.$emit("popoverWillShow",We)},afterShow:function(We){return G.$emit("popoverDidShow",We)},beforeHide:function(We){return G.$emit("popoverWillHide",We)},afterHide:function(We){return G.$emit("popoverDidHide",We)}},scopedSlots:{default(){return ze()}},ref:"popover"})])||ze()},mixins:[Yn],props:{mode:{type:String,default:Za.DATE},value:{type:null,required:!0},modelConfig:{type:Object,default:function(){return{}}},is24hr:Boolean,minuteIncrement:Number,isRequired:Boolean,isRange:Boolean,updateOnInput:Boolean,inputDebounce:Number,popover:{type:Object,default:function(){return{}}},dragAttribute:Object,selectAttribute:Object,attributes:Array,validHours:[Object,Array,Function]},data(){return{value_:null,dateParts:null,activeDate:"",dragValue:null,inputValues:["",""],updateTimeout:null,watchValue:!0,datePickerPopoverId:Object(yn.c)()}},computed:{updateOnInput_(){return this.propOrDefault("updateOnInput","datePicker.updateOnInput")},inputDebounce_(){return this.propOrDefault("inputDebounce","datePicker.inputDebounce")},isDate(){return this.mode.toLowerCase()===Za.DATE},isDateTime(){return this.mode.toLowerCase()===Za.DATE_TIME},isTime(){return this.mode.toLowerCase()===Za.TIME},isDragging(){return!!this.dragValue&&this.isRange},modelConfig_(){return this.normalizeConfig(this.modelConfig,bh)},inputMask(){const R=this.$locale.masks;return this.isTime?this.is24hr?R.inputTime24hr:R.inputTime:this.isDateTime?this.is24hr?R.inputDateTime24hr:R.inputDateTime:this.$locale.masks.input},inputMaskHasTime(){return/[Hh]/g.test(this.inputMask)},inputMaskHasDate(){return/[dD]{1,2}|Do|W{1,4}|M{1,4}|YY(?:YY)?/g.test(this.inputMask)},inputMaskPatch(){return this.inputMaskHasTime&&this.inputMaskHasDate?Oi.a.DATE_TIME:this.inputMaskHasDate?Oi.a.DATE:this.inputMaskHasTime?Oi.a.TIME:void 0},slotArgs(){var R=this;const{isRange:G,isDragging:te,updateValue:Me,showPopover:ze,hidePopover:We,togglePopover:ut}=this,ht=G?{start:this.inputValues[0],end:this.inputValues[1]}:this.inputValues[0],gt=[!0,!1].map(function(Qt){return{input:R.onInputInput(Qt),change:R.onInputChange(Qt),keyup:R.onInputKeyup,...Ga({...R.popover_,id:R.datePickerPopoverId,callback:function(Cn){Cn.action==="show"&&Cn.completed&&R.onInputShow(Qt)}})}}),xt=G?{start:gt[0],end:gt[1]}:gt[0];return{inputValue:ht,inputEvents:xt,isDragging:te,updateValue:Me,showPopover:ze,hidePopover:We,togglePopover:ut,getPopoverTriggerEvents:Ga}},popover_(){return this.propOrDefault("popover","datePicker.popover","merge")},selectAttribute_(){if(!this.hasValue(this.value_))return null;const R={key:"select-drag",...this.selectAttribute,dates:this.value_,pinPage:!0},{dot:G,bar:te,highlight:Me,content:ze}=R;return G||te||Me||ze||(R.highlight=!0),R},dragAttribute_(){if(!this.isRange||!this.hasValue(this.dragValue))return null;const R={key:"select-drag",...this.dragAttribute,dates:this.dragValue},{dot:G,bar:te,highlight:Me,content:ze}=R;return G||te||Me||ze||(R.highlight={startEnd:{fillMode:"outline"}}),R},attributes_(){const R=Object(yr.h)(this.attributes)?[...this.attributes]:[];return this.dragAttribute_?R.push(this.dragAttribute_):this.selectAttribute_&&R.push(this.selectAttribute_),R}},watch:{inputMask(){this.formatInput()},value(R){this.watchValue&&this.forceUpdateValue(R,{config:this.modelConfig_,notify:!1,formatInput:!0,hidePopover:!1})},value_(){this.refreshDateParts()},dragValue(){this.refreshDateParts()},timezone(){this.refreshDateParts(),this.forceUpdateValue(this.value_,{formatInput:!0})}},created(){this.value_=this.normalizeValue(this.value,this.modelConfig_,Oi.a.DATE_TIME,Ro.BOTH),this.forceUpdateValue(this.value,{config:this.modelConfig_,formatInput:!0,hidePopover:!1}),this.refreshDateParts()},mounted(){Object(yn.k)(document,"keydown",this.onDocumentKeyDown),Object(yn.k)(document,"click",this.onDocumentClick)},destroyed(){Object(yn.j)(document,"keydown",this.onDocumentKeyDown),Object(yn.j)(document,"click",this.onDocumentClick)},methods:{getDateParts(R){return this.$locale.getDateParts(R)},getDateFromParts(R){return this.$locale.getDateFromParts(R)},refreshDateParts(){var R=this;const G=this.dragValue||this.value_,te=[];this.isRange?(G&&G.start?te.push(this.getDateParts(G.start)):te.push({}),G&&G.end?te.push(this.getDateParts(G.end)):te.push({})):G?G&&G.start?te.push(this.getDateParts(G.start)):te.push(this.getDateParts(G)):te.push({}),this.$nextTick(function(){return R.dateParts=te})},onDocumentKeyDown(R){this.dragValue&&R.key==="Escape"&&(this.dragValue=null)},onDocumentClick(R){document.body.contains(R.target)&&!Object(yn.e)(this.$el,R.target)&&(this.dragValue=null,this.formatInput())},onDayClick(R){this.handleDayClick(R),this.$emit("dayclick",R)},onDayKeydown(R){switch(R.event.key){case" ":case"Enter":this.handleDayClick(R),R.event.preventDefault();break;case"Escape":this.hidePopover()}this.$emit("daykeydown",R)},handleDayClick(R){const{keepVisibleOnInput:G,visibility:te}=this.popover_,Me={patch:Oi.a.DATE,adjustTime:!0,formatInput:!0,hidePopover:this.isDate&&!G&&te!=="visible"};this.isRange?(this.isDragging?this.dragTrackingValue.end=R.date:this.dragTrackingValue={...R.range},Me.isDragging=!this.isDragging,Me.rangePriority=Me.isDragging?Ro.NONE:Ro.BOTH,Me.hidePopover=Me.hidePopover&&!Me.isDragging,this.updateValue(this.dragTrackingValue,Me)):(Me.clearIfEqual=!this.isRequired,this.updateValue(R.date,Me))},onDayMouseEnter(R){this.isDragging&&(this.dragTrackingValue.end=R.date,this.updateValue(this.dragTrackingValue,{patch:Oi.a.DATE,adjustTime:!0,formatInput:!0,hidePopover:!1,rangePriority:Ro.NONE}))},onTimeInput(R,G){var te=this;let Me=null;if(this.isRange){const ze=G?R:this.dateParts[0],We=G?this.dateParts[1]:R;Me={start:ze,end:We}}else Me=R;this.updateValue(Me,{patch:Oi.a.TIME,rangePriority:G?Ro.START:Ro.END}).then(function(){return te.adjustPageRange(G)})},onInputInput(R){var G=this;return function(te){G.updateOnInput_&&G.onInputUpdate(te.target.value,R,{formatInput:!1,hidePopover:!1,debounce:G.inputDebounce_})}},onInputChange(R){var G=this;return function(te){G.onInputUpdate(te.target.value,R,{formatInput:!0,hidePopover:!1})}},onInputUpdate(R,G,te){var Me=this;this.inputValues.splice(G?0:1,1,R);const ze=this.isRange?{start:this.inputValues[0],end:this.inputValues[1]||this.inputValues[0]}:R,We={type:"string",mask:this.inputMask};this.updateValue(ze,{...te,config:We,patch:this.inputMaskPatch,rangePriority:G?Ro.START:Ro.END}).then(function(){return Me.adjustPageRange(G)})},onInputShow(R){this.adjustPageRange(R)},onInputKeyup(R){R.key==="Escape"&&this.updateValue(this.value_,{formatInput:!0,hidePopover:!0})},normalizeConfig(R,G=this.modelConfig_){var te=this;return R=Object(yr.h)(R)?R:[R.start||R,R.end||R],G.map(function(Me,ze){return{validHours:te.validHours,minuteIncrement:te.minuteIncrement,...Me,...R[ze]}})},updateValue(R,G={}){var te=this;return clearTimeout(this.updateTimeout),new Promise(function(Me){const{debounce:ze,...We}=G;ze>0?te.updateTimeout=setTimeout(function(){te.forceUpdateValue(R,We),Me(te.value_)},ze):(te.forceUpdateValue(R,We),Me(te.value_))})},forceUpdateValue(R,{config:G=this.modelConfig_,patch:te=Oi.a.DATE_TIME,clearIfEqual:Me=!1,formatInput:ze=!0,hidePopover:We=!1,isDragging:ut=this.isDragging,rangePriority:ht=Ro.BOTH}={}){var gt=this;G=this.normalizeConfig(G);let xt=this.normalizeValue(R,G,te,ht);!xt&&this.isRequired&&(xt=this.value_),xt=this.adjustTimeForValue(xt,G);const Qt=this.valueIsDisabled(xt);if(Qt){if(ut)return;xt=this.value_,We=!1}const Cn=ut?"dragValue":"value_";let Pn=!this.valuesAreEqual(this[Cn],xt);if(Qt||Pn||!Me||(xt=null,Pn=!0),Pn){this.$set(this,Cn,xt),ut||(this.dragValue=null);const er=this.denormalizeValue(xt),Er=this.isDragging?"drag":"input";this.watchValue=!1,this.$emit(Er,er),this.$nextTick(function(){return gt.watchValue=!0})}We&&this.hidePopover(),ze&&this.formatInput()},hasValue(R){return this.isRange?Object(yr.m)(R)&&!!R.start&&!!R.end:!!R},normalizeValue(R,G,te,Me){if(!this.hasValue(R))return null;if(this.isRange){const ze={},We=R.start>R.end?R.end:R.start;ze.start=this.normalizeDate(We,{...G[0],fillDate:this.value_&&this.value_.start||G[0].fillDate,patch:te});const ut=R.start>R.end?R.start:R.end;return ze.end=this.normalizeDate(ut,{...G[1],fillDate:this.value_&&this.value_.end||G[1].fillDate,patch:te}),this.sortRange(ze,Me)}return this.normalizeDate(R,{...G[0],fillDate:this.value_||G[0].fillDate,patch:te})},adjustTimeForValue(R,G){return this.hasValue(R)?this.isRange?{start:this.$locale.adjustTimeForDate(R.start,G[0]),end:this.$locale.adjustTimeForDate(R.end,G[1])}:this.$locale.adjustTimeForDate(R,G[0]):null},sortRange(R,G=Ro.NONE){const{start:te,end:Me}=R;if(te>Me)switch(G){case Ro.START:return{start:te,end:te};case Ro.END:return{start:Me,end:Me};case Ro.BOTH:return{start:Me,end:te}}return{start:te,end:Me}},denormalizeValue(R,G=this.modelConfig_){return this.isRange?this.hasValue(R)?{start:this.$locale.denormalizeDate(R.start,G[0]),end:this.$locale.denormalizeDate(R.end,G[1])}:null:this.$locale.denormalizeDate(R,G[0])},valuesAreEqual(R,G){if(this.isRange){const te=this.hasValue(R),Me=this.hasValue(G);return!te&&!Me||te===Me&&Object(yn.d)(R.start,G.start)&&Object(yn.d)(R.end,G.end)}return Object(yn.d)(R,G)},valueIsDisabled(R){return this.hasValue(R)&&this.disabledAttribute&&this.disabledAttribute.intersectsDate(R)},formatInput(){var R=this;this.$nextTick(function(){const G=R.normalizeConfig({type:"string",mask:R.inputMask}),te=R.denormalizeValue(R.dragValue||R.value_,G);R.isRange?R.inputValues=[te&&te.start,te&&te.end]:R.inputValues=[te,""]})},showPopover(R={}){As({ref:this.$el,...this.popover_,...R,isInteractive:!0,id:this.datePickerPopoverId})},hidePopover(R={}){nc({hideDelay:10,...this.popover_,...R,id:this.datePickerPopoverId})},togglePopover(R){lr({ref:this.$el,...this.popover_,...R,isInteractive:!0,id:this.datePickerPopoverId})},adjustPageRange(R){var G=this;this.$nextTick(function(){const te=G.$refs.calendar,Me=G.getPageForValue(R),ze=R?1:-1;Me&&te&&!Object(yn.p)(Me,te.firstPage,te.lastPage)&&te.move(Me,{position:ze,transition:"fade"})})},getPageForValue(R){return this.hasValue(this.value_)?this.pageForDate(this.isRange?this.value_[R?"start":"end"]:this.value_):null},move(R,G){return this.$refs.calendar?this.$refs.calendar.move(R,G):Promise.reject(new Error("Navigation disabled while calendar is not yet displayed"))},focusDate(R,G){return this.$refs.calendar?this.$refs.calendar.focusDate(R,G):Promise.reject(new Error("Navigation disabled while calendar is not yet displayed"))}}},wl=wh,Fd=xo(wl,Ld,zd,!1,null,null,null),ac=Fd.exports},"2b10":function(m,T){function f(x,A,i){var P=-1,O=x.length;A<0&&(A=-A>O?0:O+A),i=i>O?O:i,i<0&&(i+=O),O=A>i?0:i-A>>>0,A>>>=0;for(var L=Array(O);++P<O;)L[P]=x[P+A];return L}m.exports=f},"2b3e":function(m,T,f){var x=f("585a"),A=typeof self=="object"&&self&&self.Object===Object&&self,i=x||A||Function("return this")();m.exports=i},"2ba4":function(m,T,f){var x=f("40d5"),A=Function.prototype,i=A.apply,P=A.call;m.exports=typeof Reflect=="object"&&Reflect.apply||(x?P.bind(i):function(){return P.apply(i,arguments)})},"2cfd":function(m,T,f){function x(A){if(A===null||A===!0||A===!1)return NaN;var i=Number(A);return isNaN(i)?i:i<0?Math.ceil(i):Math.floor(i)}Object.defineProperty(T,"__esModule",{value:!0}),T.default=x,m.exports=T.default},"2d00":function(m,T,f){var x,A,i=f("da84"),P=f("342f"),O=i.process,L=i.Deno,U=O&&O.versions||L&&L.version,j=U&&U.v8;j&&(x=j.split("."),A=x[0]>0&&x[0]<4?1:+(x[0]+x[1])),!A&&P&&(x=P.match(/Edge\/(\d+)/),(!x||x[1]>=74)&&(x=P.match(/Chrome\/(\d+)/),x&&(A=+x[1]))),m.exports=A},"2d7c":function(m,T){function f(x,A){for(var i=-1,P=x==null?0:x.length,O=0,L=[];++i<P;){var U=x[i];A(U,i,x)&&(L[O++]=U)}return L}m.exports=f},"2dcb":function(m,T,f){var x=f("91e9"),A=x(Object.getPrototypeOf,Object);m.exports=A},"2ec1":function(m,T,f){var x=f("100e"),A=f("9aff");function i(P){return x(function(O,L){var U=-1,j=L.length,W=j>1?L[j-1]:void 0,J=j>2?L[2]:void 0;for(W=P.length>3&&typeof W=="function"?(j--,W):void 0,J&&A(L[0],L[1],J)&&(W=j<3?void 0:W,j=1),O=Object(O);++U<j;){var fe=L[U];fe&&P(O,fe,U,W)}return O})}m.exports=i},"2fa3":function(m,T,f){f.d(T,"m",function(){return A}),f.d(T,"f",function(){return i}),f.d(T,"h",function(){return P}),f.d(T,"r",function(){return O}),f.d(T,"o",function(){return L}),f.d(T,"n",function(){return U}),f.d(T,"p",function(){return j}),f.d(T,"q",function(){return W}),f.d(T,"a",function(){return J}),f.d(T,"s",function(){return fe}),f.d(T,"d",function(){return _e}),f.d(T,"b",function(){return we}),f.d(T,"i",function(){return ye}),f.d(T,"k",function(){return Pe}),f.d(T,"j",function(){return Fe}),f.d(T,"e",function(){return Be}),f.d(T,"l",function(){return He}),f.d(T,"c",function(){return Ce}),f.d(T,"g",function(){return ve}),f("14d9");var x=f("9404");const A=function(Te,Ye,Oe="0"){for(Te=Te!=null?String(Te):"",Ye=Ye||2;Te.length<Ye;)Te=`${Oe}${Te}`;return Te},i=function(Te,Ye){return Object(x.k)(Te)?Te(Ye):Te},P=function(...Te){const Ye={};return Te.forEach(function(Oe){return Object.entries(Oe).forEach(function([lt,Ht]){Ye[lt]?Object(x.h)(Ye[lt])?Ye[lt].push(Ht):Ye[lt]=[Ye[lt],Ht]:Ye[lt]=Ht})}),Ye},O=function(Te){return!!(Te&&Te.month&&Te.year)},L=function(Te,Ye){return!(!O(Te)||!O(Ye))&&(Te.year===Ye.year?Te.month<Ye.month:Te.year<Ye.year)},U=function(Te,Ye){return!(!O(Te)||!O(Ye))&&(Te.year===Ye.year?Te.month>Ye.month:Te.year>Ye.year)},j=function(Te,Ye,Oe){return!!Te&&!L(Te,Ye)&&!U(Te,Oe)},W=function(Te,Ye){return!(!Te&&Ye)&&!(Te&&!Ye)&&(!Te&&!Ye||Te.month===Ye.month&&Te.year===Ye.year)},J=function({month:Te,year:Ye},Oe){const lt=Oe>0?1:-1;for(let Ht=0;Ht<Math.abs(Oe);Ht++)Te+=lt,Te>12?(Te=1,Ye++):Te<1&&(Te=12,Ye--);return{month:Te,year:Ye}},fe=function(Te,Ye){if(!O(Te)||!O(Ye))return[];const Oe=[];for(;!U(Te,Ye);)Oe.push(Te),Te=J(Te,1);return Oe};function _e(Te,Ye){const Oe=Object(x.j)(Te),lt=Object(x.j)(Ye);return!Oe&&!lt||Oe===lt&&Te.getTime()===Ye.getTime()}const we=function(Te){return Object(x.h)(Te)&&Te.length},ye=function(Te,Ye,Oe){const lt=[];return Oe.forEach(function(Ht){const nt=Ht.name||Ht.toString(),Tt=Ht.mixin,Rt=Ht.validate;if(Object.prototype.hasOwnProperty.call(Te,nt)){const vt=Rt?Rt(Te[nt]):Te[nt];Ye[nt]=Tt&&Object(x.m)(vt)?{...Tt,...vt}:vt,lt.push(nt)}}),{target:Ye,assigned:lt.length?lt:null}},Pe=function(Te,Ye,Oe,lt){Te&&Ye&&Oe&&Te.addEventListener(Ye,Oe,lt)},Fe=function(Te,Ye,Oe,lt){Te&&Ye&&Te.removeEventListener(Ye,Oe,lt)},Be=function(Te,Ye){return!!Te&&!!Ye&&(Te===Ye||Te.contains(Ye))},He=function(Te,Ye){Te.key!==" "&&Te.key!=="Enter"||(Ye(Te),Te.preventDefault())},Ce=function(){function Te(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return`${Te()+Te()}-${Te()}-${Te()}-${Te()}-${Te()}${Te()}${Te()}`};function ve(Te){let Ye,Oe=0,lt=0;if(Te.length===0)return Oe;for(lt=0;lt<Te.length;lt++)Ye=Te.charCodeAt(lt),Oe=(Oe<<5)-Oe+Ye,Oe|=0;return Oe}},"2fcc":function(m,T){function f(x){var A=this.__data__,i=A.delete(x);return this.size=A.size,i}m.exports=f},"2feb":function(m,T,f){var x=f("d798");x.__esModule&&(x=x.default),typeof x=="string"&&(x=[[m.i,x,""]]),x.locals&&(m.exports=x.locals);var A=f("499e").default;A("010e9ae0",x,!0,{sourceMap:!1,shadowMode:!1})},3092:function(m,T,f){var x=f("4284"),A=f("badf"),i=f("361d"),P=f("6747"),O=f("9aff");function L(U,j,W){var J=P(U)?x:i;return W&&O(U,j,W)&&(j=void 0),J(U,A(j,3))}m.exports=L},"30c9":function(m,T,f){var x=f("9520"),A=f("b218");function i(P){return P!=null&&A(P.length)&&!x(P)}m.exports=i},"32b3":function(m,T,f){var x=f("872a"),A=f("9638"),i=Object.prototype,P=i.hasOwnProperty;function O(L,U,j){var W=L[U];P.call(L,U)&&A(W,j)&&(j!==void 0||U in L)||x(L,U,j)}m.exports=O},"32f4":function(m,T,f){var x=f("2d7c"),A=f("d327"),i=Object.prototype,P=i.propertyIsEnumerable,O=Object.getOwnPropertySymbols,L=O?function(U){return U==null?[]:(U=Object(U),x(O(U),function(j){return P.call(U,j)}))}:A;m.exports=L},"342f":function(m,T,f){m.exports=typeof navigator<"u"&&String(navigator.userAgent)||""},"34ac":function(m,T,f){var x=f("9520"),A=f("1368"),i=f("1a8c"),P=f("dc57"),O=/[\\^$.*+?()[\]{}|]/g,L=/^\[object .+?Constructor\]$/,U=Function.prototype,j=Object.prototype,W=U.toString,J=j.hasOwnProperty,fe=RegExp("^"+W.call(J).replace(O,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function _e(we){if(!i(we)||A(we))return!1;var ye=x(we)?fe:L;return ye.test(P(we))}m.exports=_e},"34e9":function(m,T,f){(function(x){var A=f("2af9"),i=f("ed08");function P(U,j){if(P.installed)return;P.installed=!0;const W=i.setupCalendar(j);Object.entries(A).forEach(function([J,fe]){U.component(`${W.componentPrefix}${J}`,fe)})}f.d(T,"c",function(){return A.Calendar}),f.d(T,"d",function(){return A.CalendarNav}),f.d(T,"f",function(){return A.DatePicker}),f.d(T,"h",function(){return A.Popover}),f.d(T,"a",function(){return i.Attribute}),f.d(T,"b",function(){return i.AttributeStore}),f.d(T,"e",function(){return i.DateInfo}),f.d(T,"g",function(){return i.Locale}),f.d(T,"i",function(){return i.addHorizontalSwipeHandler}),f.d(T,"j",function(){return i.addPages}),f.d(T,"k",function(){return i.arrayHasItems}),f.d(T,"l",function(){return i.createGuid}),f.d(T,"m",function(){return i.datesAreEqual}),f.d(T,"o",function(){return i.elementContains}),f.d(T,"p",function(){return i.evalFn}),f.d(T,"q",function(){return i.hash}),f.d(T,"r",function(){return i.mergeEvents}),f.d(T,"s",function(){return i.mixinOptionalProps}),f.d(T,"t",function(){return i.off}),f.d(T,"u",function(){return i.on}),f.d(T,"v",function(){return i.onSpaceOrEnter}),f.d(T,"w",function(){return i.pad}),f.d(T,"x",function(){return i.pageIsAfterPage}),f.d(T,"y",function(){return i.pageIsBeforePage}),f.d(T,"z",function(){return i.pageIsBetweenPages}),f.d(T,"A",function(){return i.pageIsEqualToPage}),f.d(T,"B",function(){return i.pageIsValid}),f.d(T,"C",function(){return i.pageRangeToArray}),f.d(T,"D",function(){return i.setupCalendar});const O={install:P,...A,...i};let L=null;typeof window<"u"?L=window.Vue:typeof x<"u"&&(L=x.Vue),L&&L.use(O),T.n=O}).call(this,f("c8ba"))},3511:function(m,T,f){var x=TypeError,A=9007199254740991;m.exports=function(i){if(i>A)throw x("Maximum allowed index exceeded");return i}},"361d":function(m,T,f){var x=f("48a0");function A(i,P){var O;return x(i,function(L,U,j){return O=P(L,U,j),!O}),!!O}m.exports=A},3698:function(m,T){function f(x,A){return x==null?void 0:x[A]}m.exports=f},3729:function(m,T,f){var x=f("9e69"),A=f("00fd"),i=f("29f3"),P="[object Null]",O="[object Undefined]",L=x?x.toStringTag:void 0;function U(j){return j==null?j===void 0?O:P:L&&L in Object(j)?A(j):i(j)}m.exports=U},3818:function(m,T,f){var x=f("7e64"),A=f("8057"),i=f("32b3"),P=f("5b01"),O=f("0f0f"),L=f("e538"),U=f("4359"),j=f("54eb"),W=f("1041"),J=f("a994"),fe=f("1bac"),_e=f("42a2"),we=f("c87c"),ye=f("c2b6"),Pe=f("fa21"),Fe=f("6747"),Be=f("0d24"),He=f("cc45"),Ce=f("1a8c"),ve=f("d7ee"),Te=f("ec69"),Ye=f("9934"),Oe=1,lt=2,Ht=4,nt="[object Arguments]",Tt="[object Array]",Rt="[object Boolean]",vt="[object Date]",wr="[object Error]",Kr="[object Function]",Gr="[object GeneratorFunction]",Or="[object Map]",yi="[object Number]",Hr="[object Object]",oi="[object RegExp]",zr="[object Set]",It="[object String]",mn="[object Symbol]",on="[object WeakMap]",an="[object ArrayBuffer]",$n="[object DataView]",Gn="[object Float32Array]",De="[object Float64Array]",Re="[object Int8Array]",ft="[object Int16Array]",Lt="[object Int32Array]",Ot="[object Uint8Array]",Kt="[object Uint8ClampedArray]",dn="[object Uint16Array]",Vt="[object Uint32Array]",Gt={};function Yt(qt,Mn,En,Qe,re,ue){var Ee,it=Mn&Oe,pt=Mn&lt,Mt=Mn&Ht;if(En&&(Ee=re?En(qt,Qe,re,ue):En(qt)),Ee!==void 0)return Ee;if(!Ce(qt))return qt;var nn=Fe(qt);if(nn){if(Ee=we(qt),!it)return U(qt,Ee)}else{var Ke=_e(qt),jt=Ke==Kr||Ke==Gr;if(Be(qt))return L(qt,it);if(Ke==Hr||Ke==nt||jt&&!re){if(Ee=pt||jt?{}:Pe(qt),!it)return pt?W(qt,O(Ee,qt)):j(qt,P(Ee,qt))}else{if(!Gt[Ke])return re?qt:{};Ee=ye(qt,Ke,it)}}ue||(ue=new x);var Ut=ue.get(qt);if(Ut)return Ut;ue.set(qt,Ee),ve(qt)?qt.forEach(function(Ln){Ee.add(Yt(Ln,Mn,En,Ln,qt,ue))}):He(qt)&&qt.forEach(function(Ln,Dr){Ee.set(Dr,Yt(Ln,Mn,En,Dr,qt,ue))});var tn=Mt?pt?fe:J:pt?Ye:Te,Sn=nn?void 0:tn(qt);return A(Sn||qt,function(Ln,Dr){Sn&&(Dr=Ln,Ln=qt[Dr]),i(Ee,Dr,Yt(Ln,Mn,En,Dr,qt,ue))}),Ee}Gt[nt]=Gt[Tt]=Gt[an]=Gt[$n]=Gt[Rt]=Gt[vt]=Gt[Gn]=Gt[De]=Gt[Re]=Gt[ft]=Gt[Lt]=Gt[Or]=Gt[yi]=Gt[Hr]=Gt[oi]=Gt[zr]=Gt[It]=Gt[mn]=Gt[Ot]=Gt[Kt]=Gt[dn]=Gt[Vt]=!0,Gt[wr]=Gt[Kr]=Gt[on]=!1,m.exports=Yt},3852:function(m,T,f){var x=f("96f3"),A=f("e2c0");function i(P,O){return P!=null&&A(P,O,x)}m.exports=i},"386f":function(m,T,f){var x=f("24fb");T=x(!1),T.push([m.i,".vc-time-picker[data-v-f4e11af8]{display:flex;align-items:center;padding:8px}.vc-time-picker.vc-invalid[data-v-f4e11af8]{pointer-events:none;opacity:.5}.vc-time-picker.vc-bordered[data-v-f4e11af8]{border-top:1px solid var(--gray-400)}.vc-date-time[data-v-f4e11af8]{margin-left:8px}.vc-disabled[data-v-f4e11af8]{pointer-events:none;opacity:.5}.vc-time-icon[data-v-f4e11af8]{width:16px;height:16px;color:var(--gray-600)}.vc-date[data-v-f4e11af8]{display:flex;align-items:center;font-size:var(--text-sm);font-weight:var(--font-semibold);text-transform:uppercase;padding:0 0 4px 4px;margin-top:-4px}.vc-date .vc-weekday[data-v-f4e11af8]{color:var(--gray-700);letter-spacing:var(--tracking-wide)}.vc-date .vc-month[data-v-f4e11af8]{color:var(--accent-600);margin-left:8px}.vc-date .vc-day[data-v-f4e11af8]{color:var(--accent-600);margin-left:4px}.vc-date .vc-year[data-v-f4e11af8]{color:var(--gray-500);margin-left:8px}.vc-am-pm[data-v-f4e11af8],.vc-time[data-v-f4e11af8]{display:flex;align-items:center}.vc-am-pm[data-v-f4e11af8]{background:var(--gray-200);margin-left:8px;padding:4px;border-radius:var(--rounded);height:30px}.vc-am-pm button[data-v-f4e11af8]{color:var(--gray-900);font-size:var(--text-sm);font-weight:var(--font-medium);padding:0 4px;background:transparent;border:2px solid transparent;border-radius:var(--rounded);line-height:var(--leading-snug)}.vc-am-pm button[data-v-f4e11af8]:hover{color:var(--gray-600)}.vc-am-pm button[data-v-f4e11af8]:focus{border-color:var(--accent-400)}.vc-am-pm button.active[data-v-f4e11af8]{background:var(--accent-600);color:var(--white)}.vc-am-pm button.active[data-v-f4e11af8]:hover{background:var(--accent-500)}.vc-am-pm button.active[data-v-f4e11af8]:focus{border-color:var(--accent-400)}.vc-is-dark .vc-time-picker[data-v-f4e11af8]{border-color:var(--gray-700)}.vc-is-dark .vc-time-icon[data-v-f4e11af8],.vc-is-dark .vc-weekday[data-v-f4e11af8]{color:var(--gray-400)}.vc-is-dark .vc-day[data-v-f4e11af8],.vc-is-dark .vc-month[data-v-f4e11af8]{color:var(--accent-400)}.vc-is-dark .vc-year[data-v-f4e11af8]{color:var(--gray-500)}.vc-is-dark .vc-am-pm[data-v-f4e11af8]{background:var(--gray-700)}.vc-is-dark .vc-am-pm[data-v-f4e11af8]:focus{border-color:var(--accent-500)}.vc-is-dark .vc-am-pm button[data-v-f4e11af8]{color:var(--gray-100)}.vc-is-dark .vc-am-pm button[data-v-f4e11af8]:hover{color:var(--gray-400)}.vc-is-dark .vc-am-pm button[data-v-f4e11af8]:focus{border-color:var(--accent-500)}.vc-is-dark .vc-am-pm button.active[data-v-f4e11af8]{background:var(--accent-500);color:var(--white)}.vc-is-dark .vc-am-pm button.active[data-v-f4e11af8]:hover{background:var(--accent-600)}.vc-is-dark .vc-am-pm button.active[data-v-f4e11af8]:focus{border-color:var(--accent-500)}",""]),m.exports=T},3963:function(m,T,f){var x=f("24fb");T=x(!1),T.push([m.i,".vc-day[data-v-4420d078]{position:relative;min-height:32px;z-index:1}.vc-day.is-not-in-month *[data-v-4420d078]{opacity:0;pointer-events:none}.vc-day-layer[data-v-4420d078]{position:absolute;left:0;right:0;top:0;bottom:0;pointer-events:none}.vc-day-box-center-center[data-v-4420d078]{display:flex;justify-content:center;align-items:center;transform-origin:50% 50%}.vc-day-box-left-center[data-v-4420d078]{display:flex;justify-content:flex-start;align-items:center;transform-origin:0 50%}.vc-day-box-right-center[data-v-4420d078]{display:flex;justify-content:flex-end;align-items:center;transform-origin:100% 50%}.vc-day-box-center-bottom[data-v-4420d078]{display:flex;justify-content:center;align-items:flex-end}.vc-day-content[data-v-4420d078]{display:flex;justify-content:center;align-items:center;font-size:var(--text-sm);font-weight:var(--font-medium);width:28px;height:28px;line-height:28px;border-radius:var(--rounded-full);-webkit-user-select:none;user-select:none;cursor:pointer}.vc-day-content[data-v-4420d078]:hover{background-color:rgba(204,214,224,.3)}.vc-day-content[data-v-4420d078]:focus{font-weight:var(--font-bold);background-color:rgba(204,214,224,.4)}.vc-day-content.is-disabled[data-v-4420d078]{color:var(--gray-400)}.vc-is-dark .vc-day-content[data-v-4420d078]:hover{background-color:rgba(114,129,151,.3)}.vc-is-dark .vc-day-content[data-v-4420d078]:focus{background-color:rgba(114,129,151,.4)}.vc-is-dark .vc-day-content.is-disabled[data-v-4420d078]{color:var(--gray-600)}.vc-highlights[data-v-4420d078]{overflow:hidden;pointer-events:none;z-index:-1}.vc-highlight[data-v-4420d078]{width:28px;height:28px}.vc-highlight.vc-highlight-base-start[data-v-4420d078]{width:50%!important;border-radius:0!important;border-right-width:0!important}.vc-highlight.vc-highlight-base-end[data-v-4420d078]{width:50%!important;border-radius:0!important;border-left-width:0!important}.vc-highlight.vc-highlight-base-middle[data-v-4420d078]{width:100%;border-radius:0!important;border-left-width:0!important;border-right-width:0!important;margin:0 -1px}.vc-dots[data-v-4420d078]{display:flex;justify-content:center;align-items:center}.vc-dot[data-v-4420d078]{width:5px;height:5px;border-radius:50%;transition:all var(--day-content-transition-time)}.vc-dot[data-v-4420d078]:not(:last-child){margin-right:3px}.vc-bars[data-v-4420d078]{display:flex;justify-content:flex-start;align-items:center;width:75%}.vc-bar[data-v-4420d078]{flex-grow:1;height:3px;transition:all var(--day-content-transition-time)}",""]),m.exports=T},"39ff":function(m,T,f){var x=f("0b07"),A=f("2b3e"),i=x(A,"WeakMap");m.exports=i},"3a34":function(m,T,f){var x=f("83ab"),A=f("e8b5"),i=TypeError,P=Object.getOwnPropertyDescriptor,O=x&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(L){return L instanceof TypeError}}();m.exports=O?function(L,U){if(A(L)&&!P(L,"length").writable)throw new i("Cannot set read only .length");return L.length=U}:function(L,U){return L.length=U}},"3a9b":function(m,T,f){var x=f("e330");m.exports=x({}.isPrototypeOf)},"3b4a":function(m,T,f){var x=f("0b07"),A=function(){try{var i=x(Object,"defineProperty");return i({},"",{}),i}catch{}}();m.exports=A},"3bb4":function(m,T,f){var x=f("08cc"),A=f("ec69");function i(P){for(var O=A(P),L=O.length;L--;){var U=O[L],j=P[U];O[L]=[U,j,x(j)]}return O}m.exports=i},"3bbe":function(m,T,f){var x=f("1626"),A=String,i=TypeError;m.exports=function(P){if(typeof P=="object"||x(P))return P;throw new i("Can't set "+A(P)+" as a prototype")}},"3c65":function(m,T,f){var x=f("23e7"),A=f("7b0b"),i=f("07fa"),P=f("3a34"),O=f("083a"),L=f("3511"),U=[].unshift(0)!==1,j=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(J){return J instanceof TypeError}},W=U||!j();x({target:"Array",proto:!0,arity:1,forced:W},{unshift:function(J){var fe=A(this),_e=i(fe),we=arguments.length;if(we){L(_e+we);for(var ye=_e;ye--;){var Pe=ye+we;ye in fe?fe[Pe]=fe[ye]:O(fe,Pe)}for(var Fe=0;Fe<we;Fe++)fe[Fe]=arguments[Fe]}return P(fe,_e+we)}})},"3ee2":function(m,T,f){var x=f("dc8c");x.__esModule&&(x=x.default),typeof x=="string"&&(x=[[m.i,x,""]]),x.locals&&(m.exports=x.locals);var A=f("499e").default;A("72fef618",x,!0,{sourceMap:!1,shadowMode:!1})},"3eea":function(m,T,f){var x=f("7948"),A=f("3818"),i=f("4bb5"),P=f("e2e4"),O=f("8eeb"),L=f("e0e7"),U=f("c6cf"),j=f("1bac"),W=1,J=2,fe=4,_e=U(function(we,ye){var Pe={};if(we==null)return Pe;var Fe=!1;ye=x(ye,function(He){return He=P(He,we),Fe||(Fe=He.length>1),He}),O(we,j(we),Pe),Fe&&(Pe=A(Pe,W|J|fe,L));for(var Be=ye.length;Be--;)i(Pe,ye[Be]);return Pe});m.exports=_e},"3f84":function(m,T,f){var x=f("85e3"),A=f("100e"),i=f("e031"),P=f("2411"),O=A(function(L){return L.push(void 0,i),x(P,void 0,L)});m.exports=O},"40d5":function(m,T,f){var x=f("d039");m.exports=!x(function(){var A=(function(){}).bind();return typeof A!="function"||A.hasOwnProperty("prototype")})},"41c3":function(m,T,f){var x=f("1a8c"),A=f("eac5"),i=f("ec8c"),P=Object.prototype,O=P.hasOwnProperty;function L(U){if(!x(U))return i(U);var j=A(U),W=[];for(var J in U)(J!="constructor"||!j&&O.call(U,J))&&W.push(J);return W}m.exports=L},4245:function(m,T,f){var x=f("1290");function A(i,P){var O=i.__data__;return x(P)?O[typeof P=="string"?"string":"hash"]:O.map}m.exports=A},4284:function(m,T){function f(x,A){for(var i=-1,P=x==null?0:x.length;++i<P;)if(A(x[i],i,x))return!0;return!1}m.exports=f},"42a2":function(m,T,f){var x=f("b5a7"),A=f("79bc"),i=f("1cec"),P=f("c869"),O=f("39ff"),L=f("3729"),U=f("dc57"),j="[object Map]",W="[object Object]",J="[object Promise]",fe="[object Set]",_e="[object WeakMap]",we="[object DataView]",ye=U(x),Pe=U(A),Fe=U(i),Be=U(P),He=U(O),Ce=L;(x&&Ce(new x(new ArrayBuffer(1)))!=we||A&&Ce(new A)!=j||i&&Ce(i.resolve())!=J||P&&Ce(new P)!=fe||O&&Ce(new O)!=_e)&&(Ce=function(ve){var Te=L(ve),Ye=Te==W?ve.constructor:void 0,Oe=Ye?U(Ye):"";if(Oe)switch(Oe){case ye:return we;case Pe:return j;case Fe:return J;case Be:return fe;case He:return _e}return Te}),m.exports=Ce},4359:function(m,T){function f(x,A){var i=-1,P=x.length;for(A||(A=Array(P));++i<P;)A[i]=x[i];return A}m.exports=f},4416:function(m,T){function f(x){var A=x==null?0:x.length;return A?x[A-1]:void 0}m.exports=f},"44ad":function(m,T,f){var x=f("e330"),A=f("d039"),i=f("c6b6"),P=Object,O=x("".split);m.exports=A(function(){return!P("z").propertyIsEnumerable(0)})?function(L){return i(L)==="String"?O(L,""):P(L)}:P},4638:function(m,T,f){f("6562")},"47c6":function(m,T,f){f("1205")},"485a":function(m,T,f){var x=f("c65b"),A=f("1626"),i=f("861d"),P=TypeError;m.exports=function(O,L){var U,j;if(L==="string"&&A(U=O.toString)&&!i(j=x(U,O))||A(U=O.valueOf)&&!i(j=x(U,O))||L!=="string"&&A(U=O.toString)&&!i(j=x(U,O)))return j;throw new P("Can't convert object to primitive value")}},"48a0":function(m,T,f){var x=f("242e"),A=f("950a"),i=A(x);m.exports=i},"499e":function(m,T,f){function x(Ce,ve){for(var Te=[],Ye={},Oe=0;Oe<ve.length;Oe++){var lt=ve[Oe],Ht=lt[0],nt=lt[1],Tt=lt[2],Rt=lt[3],vt={id:Ce+":"+Oe,css:nt,media:Tt,sourceMap:Rt};Ye[Ht]?Ye[Ht].parts.push(vt):Te.push(Ye[Ht]={id:Ht,parts:[vt]})}return Te}f.r(T),f.d(T,"default",function(){return _e});var A=typeof document<"u";if(typeof DEBUG<"u"&&DEBUG&&!A)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i={},P=A&&(document.head||document.getElementsByTagName("head")[0]),O=null,L=0,U=!1,j=function(){},W=null,J="data-vue-ssr-id",fe=typeof navigator<"u"&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function _e(Ce,ve,Te,Ye){U=Te,W=Ye||{};var Oe=x(Ce,ve);return we(Oe),function(lt){for(var Ht=[],nt=0;nt<Oe.length;nt++){var Tt=Oe[nt],Rt=i[Tt.id];Rt.refs--,Ht.push(Rt)}for(lt?(Oe=x(Ce,lt),we(Oe)):Oe=[],nt=0;nt<Ht.length;nt++)if(Rt=Ht[nt],Rt.refs===0){for(var vt=0;vt<Rt.parts.length;vt++)Rt.parts[vt]();delete i[Rt.id]}}}function we(Ce){for(var ve=0;ve<Ce.length;ve++){var Te=Ce[ve],Ye=i[Te.id];if(Ye){Ye.refs++;for(var Oe=0;Oe<Ye.parts.length;Oe++)Ye.parts[Oe](Te.parts[Oe]);for(;Oe<Te.parts.length;Oe++)Ye.parts.push(Pe(Te.parts[Oe]));Ye.parts.length>Te.parts.length&&(Ye.parts.length=Te.parts.length)}else{var lt=[];for(Oe=0;Oe<Te.parts.length;Oe++)lt.push(Pe(Te.parts[Oe]));i[Te.id]={id:Te.id,refs:1,parts:lt}}}}function ye(){var Ce=document.createElement("style");return Ce.type="text/css",P.appendChild(Ce),Ce}function Pe(Ce){var ve,Te,Ye=document.querySelector("style["+J+'~="'+Ce.id+'"]');if(Ye){if(U)return j;Ye.parentNode.removeChild(Ye)}if(fe){var Oe=L++;Ye=O||(O=ye()),ve=Be.bind(null,Ye,Oe,!1),Te=Be.bind(null,Ye,Oe,!0)}else Ye=ye(),ve=He.bind(null,Ye),Te=function(){Ye.parentNode.removeChild(Ye)};return ve(Ce),function(lt){if(lt){if(lt.css===Ce.css&&lt.media===Ce.media&&lt.sourceMap===Ce.sourceMap)return;ve(Ce=lt)}else Te()}}var Fe=function(){var Ce=[];return function(ve,Te){return Ce[ve]=Te,Ce.filter(Boolean).join(`
`)}}();function Be(Ce,ve,Te,Ye){var Oe=Te?"":Ye.css;if(Ce.styleSheet)Ce.styleSheet.cssText=Fe(ve,Oe);else{var lt=document.createTextNode(Oe),Ht=Ce.childNodes;Ht[ve]&&Ce.removeChild(Ht[ve]),Ht.length?Ce.insertBefore(lt,Ht[ve]):Ce.appendChild(lt)}}function He(Ce,ve){var Te=ve.css,Ye=ve.media,Oe=ve.sourceMap;if(Ye&&Ce.setAttribute("media",Ye),W.ssrId&&Ce.setAttribute(J,ve.id),Oe&&(Te+=`
/*# sourceURL=`+Oe.sources[0]+" */",Te+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(Oe))))+" */"),Ce.styleSheet)Ce.styleSheet.cssText=Te;else{for(;Ce.firstChild;)Ce.removeChild(Ce.firstChild);Ce.appendChild(document.createTextNode(Te))}}},"49f4":function(m,T,f){var x=f("6044");function A(){this.__data__=x?x(null):{},this.size=0}m.exports=A},"4bb5":function(m,T,f){var x=f("e2e4"),A=f("4416"),i=f("8296"),P=f("f4d6");function O(L,U){return U=x(U,L),L=i(L,U),L==null||delete L[P(A(U))]}m.exports=O},"4cef":function(m,T){var f=/\s/;function x(A){for(var i=A.length;i--&&f.test(A.charAt(i)););return i}m.exports=x},"4cfe":function(m,T){function f(x){return x===void 0}m.exports=f},"4d64":function(m,T,f){var x=f("fc6a"),A=f("23cb"),i=f("07fa"),P=function(O){return function(L,U,j){var W,J=x(L),fe=i(J),_e=A(j,fe);if(O&&U!==U){for(;fe>_e;)if(W=J[_e++],W!==W)return!0}else for(;fe>_e;_e++)if((O||_e in J)&&J[_e]===U)return O||_e||0;return!O&&-1}};m.exports={includes:P(!0),indexOf:P(!1)}},"4d8c":function(m,T,f){var x=f("5c69");function A(i){var P=i==null?0:i.length;return P?x(i,1):[]}m.exports=A},"4f50":function(m,T,f){var x=f("b760"),A=f("e538"),i=f("c8fe"),P=f("4359"),O=f("fa21"),L=f("d370"),U=f("6747"),j=f("dcbe"),W=f("0d24"),J=f("9520"),fe=f("1a8c"),_e=f("60ed"),we=f("73ac"),ye=f("8adb"),Pe=f("8de2");function Fe(Be,He,Ce,ve,Te,Ye,Oe){var lt=ye(Be,Ce),Ht=ye(He,Ce),nt=Oe.get(Ht);if(nt)x(Be,Ce,nt);else{var Tt=Ye?Ye(lt,Ht,Ce+"",Be,He,Oe):void 0,Rt=Tt===void 0;if(Rt){var vt=U(Ht),wr=!vt&&W(Ht),Kr=!vt&&!wr&&we(Ht);Tt=Ht,vt||wr||Kr?U(lt)?Tt=lt:j(lt)?Tt=P(lt):wr?(Rt=!1,Tt=A(Ht,!0)):Kr?(Rt=!1,Tt=i(Ht,!0)):Tt=[]:_e(Ht)||L(Ht)?(Tt=lt,L(lt)?Tt=Pe(lt):fe(lt)&&!J(lt)||(Tt=O(Ht))):Rt=!1}Rt&&(Oe.set(Ht,Tt),Te(Tt,Ht,ve,Ye,Oe),Oe.delete(Ht)),x(Be,Ce,Tt)}}m.exports=Fe},"501e":function(m,T,f){var x=f("3729"),A=f("1310"),i="[object Number]";function P(O){return typeof O=="number"||A(O)&&x(O)==i}m.exports=P},"50c4":function(m,T,f){var x=f("5926"),A=Math.min;m.exports=function(i){return i>0?A(x(i),9007199254740991):0}},"50d8":function(m,T){function f(x,A){for(var i=-1,P=Array(x);++i<x;)P[i]=A(i);return P}m.exports=f},"51ec":function(m,T,f){f.d(T,"b",function(){return J}),f.d(T,"a",function(){return fe});var x=f("8bbf"),A=f.n(x),i=f("9404"),P=f("23a5"),O=f("7efe"),L=f("85a9"),U=f("f15d");const j={componentPrefix:"v",navVisibility:"click",titlePosition:"center",transition:"slide-h",touch:P,masks:O,screens:L,locales:U.a,datePicker:{updateOnInput:!0,inputDebounce:1e3,popover:{visibility:"hover-focus",placement:"bottom-start",keepVisibleOnInput:!1,isInteractive:!0}}};let W=null;const J=function(_e){return W||(W=new A.a({data(){return{defaults:Object(i.c)(_e,j)}},computed:{locales(){var we=this;return Object(i.r)(this.defaults.locales,function(ye){return ye.masks=Object(i.c)(ye.masks,we.defaults.masks),ye})}}})),W.defaults},fe={beforeCreate(){J()},computed:{$defaults(){return W.defaults},$locales(){return W.locales}},methods:{propOrDefault(_e,we,ye){return this.passedProp(_e,Object(i.d)(this.$defaults,we),ye)},passedProp(_e,we,ye){if(Object(i.e)(this.$options.propsData,_e)){const Pe=this[_e];return Object(i.m)(Pe)&&ye==="merge"?Object(i.c)(Pe,we):Pe}return we}}}},"52ca":function(m,T,f){f("bfb3")},5332:function(m,T,f){var x=f("d8e2");x.__esModule&&(x=x.default),typeof x=="string"&&(x=[[m.i,x,""]]),x.locals&&(m.exports=x.locals);var A=f("499e").default;A("ecf39550",x,!0,{sourceMap:!1,shadowMode:!1})},"53ca":function(m,T,f){function x(A){return x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},x(A)}f.d(T,"a",function(){return x})},5465:function(m,T,f){function x(A){var i=new Date(Date.UTC(A.getFullYear(),A.getMonth(),A.getDate(),A.getHours(),A.getMinutes(),A.getSeconds(),A.getMilliseconds()));return i.setUTCFullYear(A.getFullYear()),A.getTime()-i.getTime()}Object.defineProperty(T,"__esModule",{value:!0}),T.default=x,m.exports=T.default},"54eb":function(m,T,f){var x=f("8eeb"),A=f("32f4");function i(P,O){return x(P,A(P),O)}m.exports=i},"55a3":function(m,T){function f(x){return this.__data__.has(x)}m.exports=f},"55ed":function(m,T,f){var x=f("386f");x.__esModule&&(x=x.default),typeof x=="string"&&(x=[[m.i,x,""]]),x.locals&&(m.exports=x.locals);var A=f("499e").default;A("557943a7",x,!0,{sourceMap:!1,shadowMode:!1})},5692:function(m,T,f){var x=f("c430"),A=f("c6cd");(m.exports=function(i,P){return A[i]||(A[i]=P!==void 0?P:{})})("versions",[]).push({version:"3.33.0",mode:x?"pure":"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.0/LICENSE",source:"https://github.com/zloirock/core-js"})},"56ef":function(m,T,f){var x=f("d066"),A=f("e330"),i=f("241c"),P=f("7418"),O=f("825a"),L=A([].concat);m.exports=x("Reflect","ownKeys")||function(U){var j=i.f(O(U)),W=P.f;return W?L(j,W(U)):j}},"577e":function(m,T,f){var x=f("f5df"),A=String;m.exports=function(i){if(x(i)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return A(i)}},"57a5":function(m,T,f){var x=f("91e9"),A=x(Object.keys,Object);m.exports=A},"585a":function(m,T,f){(function(x){var A=typeof x=="object"&&x&&x.Object===Object&&x;m.exports=A}).call(this,f("c8ba"))},5926:function(m,T,f){var x=f("b42e");m.exports=function(A){var i=+A;return i!==i||i===0?0:x(i)}},"59ed":function(m,T,f){var x=f("1626"),A=f("0d51"),i=TypeError;m.exports=function(P){if(x(P))return P;throw new i(A(P)+" is not a function")}},"5b01":function(m,T,f){var x=f("8eeb"),A=f("ec69");function i(P,O){return P&&x(O,A(O),P)}m.exports=i},"5c69":function(m,T,f){var x=f("087d"),A=f("0621");function i(P,O,L,U,j){var W=-1,J=P.length;for(L||(L=A),j||(j=[]);++W<J;){var fe=P[W];O>0&&L(fe)?O>1?i(fe,O-1,L,U,j):x(j,fe):U||(j[j.length]=fe)}return j}m.exports=i},"5c6c":function(m,T,f){m.exports=function(x,A){return{enumerable:!(1&x),configurable:!(2&x),writable:!(4&x),value:A}}},"5d89":function(m,T,f){var x=f("f8af");function A(i,P){var O=P?x(i.buffer):i.buffer;return new i.constructor(O,i.byteOffset,i.byteLength)}m.exports=A},"5e2e":function(m,T,f){var x=f("28c9"),A=f("69d5"),i=f("b4c0"),P=f("fba5"),O=f("67ca");function L(U){var j=-1,W=U==null?0:U.length;for(this.clear();++j<W;){var J=U[j];this.set(J[0],J[1])}}L.prototype.clear=x,L.prototype.delete=A,L.prototype.get=i,L.prototype.has=P,L.prototype.set=O,m.exports=L},"5e77":function(m,T,f){var x=f("83ab"),A=f("1a2d"),i=Function.prototype,P=x&&Object.getOwnPropertyDescriptor,O=A(i,"name"),L=O&&(function(){}).name==="something",U=O&&(!x||x&&P(i,"name").configurable);m.exports={EXISTS:O,PROPER:L,CONFIGURABLE:U}},6044:function(m,T,f){var x=f("0b07"),A=x(Object,"create");m.exports=A},"605d":function(m,T,f){var x=f("da84"),A=f("c6b6");m.exports=A(x.process)==="process"},"60ed":function(m,T,f){var x=f("3729"),A=f("2dcb"),i=f("1310"),P="[object Object]",O=Function.prototype,L=Object.prototype,U=O.toString,j=L.hasOwnProperty,W=U.call(Object);function J(fe){if(!i(fe)||x(fe)!=P)return!1;var _e=A(fe);if(_e===null)return!0;var we=j.call(_e,"constructor")&&_e.constructor;return typeof we=="function"&&we instanceof we&&U.call(we)==W}m.exports=J},6220:function(m,T,f){var x=f("b1d2"),A=f("b047"),i=f("99d3"),P=i&&i.isDate,O=P?A(P):x;m.exports=O},"62e4":function(m,T){m.exports=function(f){return f.webpackPolyfill||(f.deprecate=function(){},f.paths=[],f.children||(f.children=[]),Object.defineProperty(f,"loaded",{enumerable:!0,get:function(){return f.l}}),Object.defineProperty(f,"id",{enumerable:!0,get:function(){return f.i}}),f.webpackPolyfill=1),f}},6374:function(m,T,f){var x=f("da84"),A=Object.defineProperty;m.exports=function(i,P){try{A(x,i,{value:P,configurable:!0,writable:!0})}catch{x[i]=P}return P}},"642a":function(m,T,f){var x=f("966f"),A=f("3bb4"),i=f("20ec");function P(O){var L=A(O);return L.length==1&&L[0][2]?i(L[0][0],L[0][1]):function(U){return U===O||x(U,O,L)}}m.exports=P},"643d":function(m,T,f){var x=f("116a");x.__esModule&&(x=x.default),typeof x=="string"&&(x=[[m.i,x,""]]),x.locals&&(m.exports=x.locals);var A=f("499e").default;A("d4127e08",x,!0,{sourceMap:!1,shadowMode:!1})},6562:function(m,T,f){var x=f("9419");x.__esModule&&(x=x.default),typeof x=="string"&&(x=[[m.i,x,""]]),x.locals&&(m.exports=x.locals);var A=f("499e").default;A("0ba08e60",x,!0,{sourceMap:!1,shadowMode:!1})},"656b":function(m,T,f){var x=f("e2e4"),A=f("f4d6");function i(P,O){O=x(O,P);for(var L=0,U=O.length;P!=null&&L<U;)P=P[A(O[L++])];return L&&L==U?P:void 0}m.exports=i},6679:function(m,T,f){var x=f("3729"),A=f("1310"),i="[object Boolean]";function P(O){return O===!0||O===!1||A(O)&&x(O)==i}m.exports=P},6747:function(m,T){var f=Array.isArray;m.exports=f},"67ca":function(m,T,f){var x=f("cb5a");function A(i,P){var O=this.__data__,L=x(O,i);return L<0?(++this.size,O.push([i,P])):O[L][1]=P,this}m.exports=A},"69d5":function(m,T,f){var x=f("cb5a"),A=Array.prototype,i=A.splice;function P(O){var L=this.__data__,U=x(L,O);if(U<0)return!1;var j=L.length-1;return U==j?L.pop():i.call(L,U,1),--this.size,!0}m.exports=P},"69f3":function(m,T,f){var x,A,i,P=f("cdce"),O=f("da84"),L=f("861d"),U=f("9112"),j=f("1a2d"),W=f("c6cd"),J=f("f772"),fe=f("d012"),_e="Object already initialized",we=O.TypeError,ye=O.WeakMap,Pe=function(Ce){return i(Ce)?A(Ce):x(Ce,{})},Fe=function(Ce){return function(ve){var Te;if(!L(ve)||(Te=A(ve)).type!==Ce)throw new we("Incompatible receiver, "+Ce+" required");return Te}};if(P||W.state){var Be=W.state||(W.state=new ye);Be.get=Be.get,Be.has=Be.has,Be.set=Be.set,x=function(Ce,ve){if(Be.has(Ce))throw new we(_e);return ve.facade=Ce,Be.set(Ce,ve),ve},A=function(Ce){return Be.get(Ce)||{}},i=function(Ce){return Be.has(Ce)}}else{var He=J("state");fe[He]=!0,x=function(Ce,ve){if(j(Ce,He))throw new we(_e);return ve.facade=Ce,U(Ce,He,ve),ve},A=function(Ce){return j(Ce,He)?Ce[He]:{}},i=function(Ce){return j(Ce,He)}}m.exports={set:x,get:A,has:i,enforce:Pe,getterFor:Fe}},"6f19":function(m,T,f){var x=f("9112"),A=f("0d26"),i=f("b980"),P=Error.captureStackTrace;m.exports=function(O,L,U,j){i&&(P?P(O,L):x(O,"stack",A(U,j)))}},"6f6c":function(m,T){var f=/\w*$/;function x(A){var i=new A.constructor(A.source,f.exec(A));return i.lastIndex=A.lastIndex,i}m.exports=x},"6fcd":function(m,T,f){var x=f("50d8"),A=f("d370"),i=f("6747"),P=f("0d24"),O=f("c098"),L=f("73ac"),U=Object.prototype,j=U.hasOwnProperty;function W(J,fe){var _e=i(J),we=!_e&&A(J),ye=!_e&&!we&&P(J),Pe=!_e&&!we&&!ye&&L(J),Fe=_e||we||ye||Pe,Be=Fe?x(J.length,String):[],He=Be.length;for(var Ce in J)!fe&&!j.call(J,Ce)||Fe&&(Ce=="length"||ye&&(Ce=="offset"||Ce=="parent")||Pe&&(Ce=="buffer"||Ce=="byteLength"||Ce=="byteOffset")||O(Ce,He))||Be.push(Ce);return Be}m.exports=W},7156:function(m,T,f){var x=f("1626"),A=f("861d"),i=f("d2bb");m.exports=function(P,O,L){var U,j;return i&&x(U=O.constructor)&&U!==L&&A(j=U.prototype)&&j!==L.prototype&&i(P,j),P}},7234:function(m,T,f){m.exports=function(x){return x==null}},7282:function(m,T,f){var x=f("e330"),A=f("59ed");m.exports=function(i,P,O){try{return x(A(Object.getOwnPropertyDescriptor(i,P)[O]))}catch{}}},"72af":function(m,T,f){var x=f("99cd"),A=x();m.exports=A},"72f0":function(m,T){function f(x){return function(){return x}}m.exports=f},"73ac":function(m,T,f){var x=f("743f"),A=f("b047"),i=f("99d3"),P=i&&i.isTypedArray,O=P?A(P):x;m.exports=O},7418:function(m,T,f){T.f=Object.getOwnPropertySymbols},"743f":function(m,T,f){var x=f("3729"),A=f("b218"),i=f("1310"),P="[object Arguments]",O="[object Array]",L="[object Boolean]",U="[object Date]",j="[object Error]",W="[object Function]",J="[object Map]",fe="[object Number]",_e="[object Object]",we="[object RegExp]",ye="[object Set]",Pe="[object String]",Fe="[object WeakMap]",Be="[object ArrayBuffer]",He="[object DataView]",Ce="[object Float32Array]",ve="[object Float64Array]",Te="[object Int8Array]",Ye="[object Int16Array]",Oe="[object Int32Array]",lt="[object Uint8Array]",Ht="[object Uint8ClampedArray]",nt="[object Uint16Array]",Tt="[object Uint32Array]",Rt={};function vt(wr){return i(wr)&&A(wr.length)&&!!Rt[x(wr)]}Rt[Ce]=Rt[ve]=Rt[Te]=Rt[Ye]=Rt[Oe]=Rt[lt]=Rt[Ht]=Rt[nt]=Rt[Tt]=!0,Rt[P]=Rt[O]=Rt[Be]=Rt[L]=Rt[He]=Rt[U]=Rt[j]=Rt[W]=Rt[J]=Rt[fe]=Rt[_e]=Rt[we]=Rt[ye]=Rt[Pe]=Rt[Fe]=!1,m.exports=vt},7530:function(m,T,f){var x=f("1a8c"),A=Object.create,i=function(){function P(){}return function(O){if(!x(O))return{};if(A)return A(O);P.prototype=O;var L=new P;return P.prototype=void 0,L}}();m.exports=i},"76dd":function(m,T,f){var x=f("ce86");function A(i){return i==null?"":x(i)}m.exports=A},7839:function(m,T,f){m.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},7948:function(m,T){function f(x,A){for(var i=-1,P=x==null?0:x.length,O=Array(P);++i<P;)O[i]=A(x[i],i,x);return O}m.exports=f},"79bc":function(m,T,f){var x=f("0b07"),A=f("2b3e"),i=x(A,"Map");m.exports=i},"7a48":function(m,T,f){var x=f("6044"),A=Object.prototype,i=A.hasOwnProperty;function P(O){var L=this.__data__;return x?L[O]!==void 0:i.call(L,O)}m.exports=P},"7b0b":function(m,T,f){var x=f("1d80"),A=Object;m.exports=function(i){return A(x(i))}},"7b83":function(m,T,f){var x=f("7c64"),A=f("93ed"),i=f("2478"),P=f("a524"),O=f("1fc8");function L(U){var j=-1,W=U==null?0:U.length;for(this.clear();++j<W;){var J=U[j];this.set(J[0],J[1])}}L.prototype.clear=x,L.prototype.delete=A,L.prototype.get=i,L.prototype.has=P,L.prototype.set=O,m.exports=L},"7b97":function(m,T,f){var x=f("7e64"),A=f("a2be"),i=f("1c3c"),P=f("b1e5"),O=f("42a2"),L=f("6747"),U=f("0d24"),j=f("73ac"),W=1,J="[object Arguments]",fe="[object Array]",_e="[object Object]",we=Object.prototype,ye=we.hasOwnProperty;function Pe(Fe,Be,He,Ce,ve,Te){var Ye=L(Fe),Oe=L(Be),lt=Ye?fe:O(Fe),Ht=Oe?fe:O(Be);lt=lt==J?_e:lt,Ht=Ht==J?_e:Ht;var nt=lt==_e,Tt=Ht==_e,Rt=lt==Ht;if(Rt&&U(Fe)){if(!U(Be))return!1;Ye=!0,nt=!1}if(Rt&&!nt)return Te||(Te=new x),Ye||j(Fe)?A(Fe,Be,He,Ce,ve,Te):i(Fe,Be,lt,He,Ce,ve,Te);if(!(He&W)){var vt=nt&&ye.call(Fe,"__wrapped__"),wr=Tt&&ye.call(Be,"__wrapped__");if(vt||wr){var Kr=vt?Fe.value():Fe,Gr=wr?Be.value():Be;return Te||(Te=new x),ve(Kr,Gr,He,Ce,Te)}}return!!Rt&&(Te||(Te=new x),P(Fe,Be,He,Ce,ve,Te))}m.exports=Pe},"7c64":function(m,T,f){var x=f("e24b"),A=f("5e2e"),i=f("79bc");function P(){this.size=0,this.__data__={hash:new x,map:new(i||A),string:new x}}m.exports=P},"7d1f":function(m,T,f){var x=f("087d"),A=f("6747");function i(P,O,L){var U=O(P);return A(P)?U:x(U,L(P))}m.exports=i},"7d87":function(m,T,f){var x=f("0f62");x.__esModule&&(x=x.default),typeof x=="string"&&(x=[[m.i,x,""]]),x.locals&&(m.exports=x.locals);var A=f("499e").default;A("d0e2b3b8",x,!0,{sourceMap:!1,shadowMode:!1})},"7e64":function(m,T,f){var x=f("5e2e"),A=f("efb6"),i=f("2fcc"),P=f("802a"),O=f("55a3"),L=f("d02c");function U(j){var W=this.__data__=new x(j);this.size=W.size}U.prototype.clear=A,U.prototype.delete=i,U.prototype.get=P,U.prototype.has=O,U.prototype.set=L,m.exports=U},"7ed2":function(m,T){var f="__lodash_hash_undefined__";function x(A){return this.__data__.set(A,f),this}m.exports=x},"7efe":function(m){m.exports=JSON.parse('{"title":"MMMM YYYY","weekdays":"W","navMonths":"MMM","input":["L","YYYY-MM-DD","YYYY/MM/DD"],"inputDateTime":["L h:mm A","YYYY-MM-DD h:mm A","YYYY/MM/DD h:mm A"],"inputDateTime24hr":["L HH:mm","YYYY-MM-DD HH:mm","YYYY/MM/DD HH:mm"],"inputTime":["h:mm A"],"inputTime24hr":["HH:mm"],"dayPopover":"WWW, MMM D, YYYY","data":["L","YYYY-MM-DD","YYYY/MM/DD"],"iso":"YYYY-MM-DDTHH:mm:ss.SSSZ"}')},"802a":function(m,T){function f(x){return this.__data__.get(x)}m.exports=f},8057:function(m,T){function f(x,A){for(var i=-1,P=x==null?0:x.length;++i<P&&A(x[i],i,x)!==!1;);return x}m.exports=f},"825a":function(m,T,f){var x=f("861d"),A=String,i=TypeError;m.exports=function(P){if(x(P))return P;throw new i(A(P)+" is not an object")}},8296:function(m,T,f){var x=f("656b"),A=f("2b10");function i(P,O){return O.length<2?P:x(P,A(O,0,-1))}m.exports=i},8384:function(m,T){function f(x,A,i){return x===x&&(i!==void 0&&(x=x<=i?x:i),A!==void 0&&(x=x>=A?x:A)),x}m.exports=f},"83ab":function(m,T,f){var x=f("d039");m.exports=!x(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},8518:function(m,T,f){var x=f("b3ff");x.__esModule&&(x=x.default),typeof x=="string"&&(x=[[m.i,x,""]]),x.locals&&(m.exports=x.locals);var A=f("499e").default;A("22adb7aa",x,!0,{sourceMap:!1,shadowMode:!1})},"85a9":function(m){m.exports=JSON.parse('{"sm":"640px","md":"768px","lg":"1024px","xl":"1280px"}')},"85e3":function(m,T){function f(x,A,i){switch(i.length){case 0:return x.call(A);case 1:return x.call(A,i[0]);case 2:return x.call(A,i[0],i[1]);case 3:return x.call(A,i[0],i[1],i[2])}return x.apply(A,i)}m.exports=f},8604:function(m,T,f){var x=f("26e8"),A=f("e2c0");function i(P,O){return P!=null&&A(P,O,x)}m.exports=i},"861d":function(m,T,f){var x=f("1626"),A=f("8ea1"),i=A.all;m.exports=A.IS_HTMLDDA?function(P){return typeof P=="object"?P!==null:x(P)||P===i}:function(P){return typeof P=="object"?P!==null:x(P)}},"872a":function(m,T,f){var x=f("3b4a");function A(i,P,O){P=="__proto__"&&x?x(i,P,{configurable:!0,enumerable:!0,value:O,writable:!0}):i[P]=O}m.exports=A},8925:function(m,T,f){var x=f("e330"),A=f("1626"),i=f("c6cd"),P=x(Function.toString);A(i.inspectSource)||(i.inspectSource=function(O){return P(O)}),m.exports=i.inspectSource},"89d9":function(m,T,f){var x=f("656b"),A=f("159a"),i=f("e2e4");function P(O,L,U){for(var j=-1,W=L.length,J={};++j<W;){var fe=L[j],_e=x(O,fe);U(_e,fe)&&A(J,i(fe,O),_e)}return J}m.exports=P},"8ab2":function(m,T,f){f("23da")},"8adb":function(m,T){function f(x,A){if((A!=="constructor"||typeof x[A]!="function")&&A!="__proto__")return x[A]}m.exports=f},"8bbf":function(m,T){m.exports=E},"8c86":function(m,T,f){function x(A,i){if(i.length<A)throw new TypeError(A+" argument"+(A>1?"s":"")+" required, but only "+i.length+" present")}f.d(T,"a",function(){return x})},"8d74":function(m,T,f){var x=f("4cef"),A=/^\s+/;function i(P){return P&&P.slice(0,x(P)+1).replace(A,"")}m.exports=i},"8de2":function(m,T,f){var x=f("8eeb"),A=f("9934");function i(P){return x(P,A(P))}m.exports=i},"8ea1":function(m,T,f){var x=typeof document=="object"&&document.all,A=typeof x>"u"&&x!==void 0;m.exports={all:x,IS_HTMLDDA:A}},"8eeb":function(m,T,f){var x=f("32b3"),A=f("872a");function i(P,O,L,U){var j=!L;L||(L={});for(var W=-1,J=O.length;++W<J;){var fe=O[W],_e=U?U(L[fe],P[fe],fe,L,P):void 0;_e===void 0&&(_e=P[fe]),j?A(L,fe,_e):x(L,fe,_e)}return L}m.exports=i},"90e3":function(m,T,f){var x=f("e330"),A=0,i=Math.random(),P=x(1 .toString);m.exports=function(O){return"Symbol("+(O===void 0?"":O)+")_"+P(++A+i,36)}},9112:function(m,T,f){var x=f("83ab"),A=f("9bf2"),i=f("5c6c");m.exports=x?function(P,O,L){return A.f(P,O,i(1,L))}:function(P,O,L){return P[O]=L,P}},"91e9":function(m,T){function f(x,A){return function(i){return x(A(i))}}m.exports=f},9349:function(m,T,f){f.d(T,"a",function(){return i}),f("14d9");var x=f("22f3"),A=f("2fa3");class i{constructor(O,L,U){this.theme=O,this.locale=L,this.map={},this.refresh(U,!0)}destroy(){this.theme=null,this.locale=null,this.map={},this.list=[],this.pinAttr=null}refresh(O,L){var U=this;const j={},W=[];let J=null;const fe=[],_e=L?new Set:new Set(Object.keys(this.map));return Object(A.b)(O)&&O.forEach(function(we,ye){if(!we||!we.dates)return;const Pe=we.key?we.key.toString():ye.toString(),Fe=we.order||0,Be=Object(A.g)(JSON.stringify(we));let He=U.map[Pe];!L&&He&&He.hashcode===Be?_e.delete(Pe):(He=new x.a({key:Pe,order:Fe,hashcode:Be,...we},U.theme,U.locale),fe.push(He)),He&&He.pinPage&&(J=He),j[Pe]=He,W.push(He)}),this.map=j,this.list=W,this.pinAttr=J,{adds:fe,deletes:Array.from(_e)}}}},"93ed":function(m,T,f){var x=f("4245");function A(i){var P=x(this,i).delete(i);return this.size-=P?1:0,P}m.exports=A},9404:function(m,T,f){f.d(T,"j",function(){return De}),f.d(T,"m",function(){return Re}),f.d(T,"e",function(){return ft}),f.d(T,"f",function(){return Lt}),f.d(T,"v",function(){return Ot});var x=f("6679"),A=f.n(x);f.d(T,"i",function(){return A.a});var i=f("501e"),P=f.n(i);f.d(T,"l",function(){return P.a});var O=f("e2a0"),L=f.n(O);f.d(T,"n",function(){return L.a});var U=f("dcbe"),j=f.n(U);f.d(T,"h",function(){return j.a});var W=f("9520"),J=f.n(W);f.d(T,"k",function(){return J.a});var fe=f("4cfe"),_e=f.n(fe);f.d(T,"o",function(){return _e.a});var we=f("6220"),ye=f.n(we),Pe=f("f678"),Fe=f.n(Pe);f.d(T,"a",function(){return Fe.a});var Be=f("9b02"),He=f.n(Be);f.d(T,"d",function(){return He.a});var Ce=f("0f5c"),ve=f.n(Ce);f.d(T,"u",function(){return ve.a});var Te=f("9e86"),Ye=f.n(Te);f.d(T,"r",function(){return Ye.a});var Oe=f("f542"),lt=f.n(Oe);f.d(T,"w",function(){return lt.a});var Ht=f("95ae"),nt=f.n(Ht);f.d(T,"b",function(){return nt.a});var Tt=f("3f84"),Rt=f.n(Tt);f.d(T,"c",function(){return Rt.a});var vt=f("2593"),wr=f.n(vt);f.d(T,"t",function(){return wr.a});var Kr=f("3eea"),Gr=f.n(Kr);f.d(T,"s",function(){return Gr.a});var Or=f("3852"),yi=f.n(Or),Hr=f("dd61"),oi=f.n(Hr);f.d(T,"q",function(){return oi.a});var zr=f("a59b"),It=f.n(zr);f.d(T,"g",function(){return It.a});var mn=f("4416"),on=f.n(mn);f.d(T,"p",function(){return on.a});var an=f("3092"),$n=f.n(an);const Gn=function(Kt){return Object.prototype.toString.call(Kt).slice(8,-1)},De=function(Kt){return ye()(Kt)&&!isNaN(Kt.getTime())},Re=function(Kt){return Gn(Kt)==="Object"},ft=yi.a,Lt=function(Kt,dn){return $n()(dn,function(Vt){return yi()(Kt,Vt)})},Ot=$n.a},9419:function(m,T,f){var x=f("24fb");T=x(!1),T.push([m.i,".vc-nav-popover-container{color:var(--white);font-size:var(--text-sm);font-weight:var(--font-semibold);background-color:var(--gray-800);border:1px solid;border-color:var(--gray-700);border-radius:var(--rounded-lg);padding:4px;box-shadow:var(--shadow)}.vc-is-dark .vc-nav-popover-container{color:var(--gray-800);background-color:var(--white);border-color:var(--gray-100)}",""]),m.exports=T},"94ca":function(m,T,f){var x=f("d039"),A=f("1626"),i=/#|\.prototype\./,P=function(W,J){var fe=L[O(W)];return fe===j||fe!==U&&(A(J)?x(J):!!J)},O=P.normalize=function(W){return String(W).replace(i,".").toLowerCase()},L=P.data={},U=P.NATIVE="N",j=P.POLYFILL="P";m.exports=P},"950a":function(m,T,f){var x=f("30c9");function A(i,P){return function(O,L){if(O==null)return O;if(!x(O))return i(O,L);for(var U=O.length,j=P?U:-1,W=Object(O);(P?j--:++j<U)&&L(W[j],j,W)!==!1;);return O}}m.exports=A},9520:function(m,T,f){var x=f("3729"),A=f("1a8c"),i="[object AsyncFunction]",P="[object Function]",O="[object GeneratorFunction]",L="[object Proxy]";function U(j){if(!A(j))return!1;var W=x(j);return W==P||W==O||W==i||W==L}m.exports=U},"95ae":function(m,T,f){var x=f("100e"),A=f("9638"),i=f("9aff"),P=f("9934"),O=Object.prototype,L=O.hasOwnProperty,U=x(function(j,W){j=Object(j);var J=-1,fe=W.length,_e=fe>2?W[2]:void 0;for(_e&&i(W[0],W[1],_e)&&(fe=1);++J<fe;)for(var we=W[J],ye=P(we),Pe=-1,Fe=ye.length;++Pe<Fe;){var Be=ye[Pe],He=j[Be];(He===void 0||A(He,O[Be])&&!L.call(j,Be))&&(j[Be]=we[Be])}return j});m.exports=U},9638:function(m,T){function f(x,A){return x===A||x!==x&&A!==A}m.exports=f},"966f":function(m,T,f){var x=f("7e64"),A=f("c05f"),i=1,P=2;function O(L,U,j,W){var J=j.length,fe=J,_e=!W;if(L==null)return!fe;for(L=Object(L);J--;){var we=j[J];if(_e&&we[2]?we[1]!==L[we[0]]:!(we[0]in L))return!1}for(;++J<fe;){we=j[J];var ye=we[0],Pe=L[ye],Fe=we[1];if(_e&&we[2]){if(Pe===void 0&&!(ye in L))return!1}else{var Be=new x;if(W)var He=W(Pe,Fe,ye,L,U,Be);if(!(He===void 0?A(Fe,Pe,i|P,W,Be):He))return!1}}return!0}m.exports=O},"96f3":function(m,T){var f=Object.prototype,x=f.hasOwnProperty;function A(i,P){return i!=null&&x.call(i,P)}m.exports=A},"97d3":function(m,T,f){var x=f("48a0"),A=f("30c9");function i(P,O){var L=-1,U=A(P)?Array(P.length):[];return x(P,function(j,W,J){U[++L]=O(j,W,J)}),U}m.exports=i},9934:function(m,T,f){var x=f("6fcd"),A=f("41c3"),i=f("30c9");function P(O){return i(O)?x(O,!0):A(O)}m.exports=P},"99cd":function(m,T){function f(x){return function(A,i,P){for(var O=-1,L=Object(A),U=P(A),j=U.length;j--;){var W=U[x?j:++O];if(i(L[W],W,L)===!1)break}return A}}m.exports=f},"99d3":function(m,T,f){(function(x){var A=f("585a"),i=T&&!T.nodeType&&T,P=i&&typeof x=="object"&&x&&!x.nodeType&&x,O=P&&P.exports===i,L=O&&A.process,U=function(){try{var j=P&&P.require&&P.require("util").types;return j||L&&L.binding&&L.binding("util")}catch{}}();x.exports=U}).call(this,f("62e4")(m))},"9aff":function(m,T,f){var x=f("9638"),A=f("30c9"),i=f("c098"),P=f("1a8c");function O(L,U,j){if(!P(j))return!1;var W=typeof U;return!!(W=="number"?A(j)&&i(U,j.length):W=="string"&&U in j)&&x(j[U],L)}m.exports=O},"9b02":function(m,T,f){var x=f("656b");function A(i,P,O){var L=i==null?void 0:x(i,P);return L===void 0?O:L}m.exports=A},"9bf2":function(m,T,f){var x=f("83ab"),A=f("0cfb"),i=f("aed9"),P=f("825a"),O=f("a04b"),L=TypeError,U=Object.defineProperty,j=Object.getOwnPropertyDescriptor,W="enumerable",J="configurable",fe="writable";T.f=x?i?function(_e,we,ye){if(P(_e),we=O(we),P(ye),typeof _e=="function"&&we==="prototype"&&"value"in ye&&fe in ye&&!ye[fe]){var Pe=j(_e,we);Pe&&Pe[fe]&&(_e[we]=ye.value,ye={configurable:J in ye?ye[J]:Pe[J],enumerable:W in ye?ye[W]:Pe[W],writable:!1})}return U(_e,we,ye)}:U:function(_e,we,ye){if(P(_e),we=O(we),P(ye),A)try{return U(_e,we,ye)}catch{}if("get"in ye||"set"in ye)throw new L("Accessors not supported");return"value"in ye&&(_e[we]=ye.value),_e}},"9e69":function(m,T,f){var x=f("2b3e"),A=x.Symbol;m.exports=A},"9e86":function(m,T,f){var x=f("872a"),A=f("242e"),i=f("badf");function P(O,L){var U={};return L=i(L,3),A(O,function(j,W,J){x(U,W,L(j,W,J))}),U}m.exports=P},a029:function(m,T,f){var x=f("087d"),A=f("2dcb"),i=f("32f4"),P=f("d327"),O=Object.getOwnPropertySymbols,L=O?function(U){for(var j=[];U;)x(j,i(U)),U=A(U);return j}:P;m.exports=L},a04b:function(m,T,f){var x=f("c04e"),A=f("d9b5");m.exports=function(i){var P=x(i,"string");return A(P)?P:P+""}},a2be:function(m,T,f){var x=f("d612"),A=f("4284"),i=f("c584"),P=1,O=2;function L(U,j,W,J,fe,_e){var we=W&P,ye=U.length,Pe=j.length;if(ye!=Pe&&!(we&&Pe>ye))return!1;var Fe=_e.get(U),Be=_e.get(j);if(Fe&&Be)return Fe==j&&Be==U;var He=-1,Ce=!0,ve=W&O?new x:void 0;for(_e.set(U,j),_e.set(j,U);++He<ye;){var Te=U[He],Ye=j[He];if(J)var Oe=we?J(Ye,Te,He,j,U,_e):J(Te,Ye,He,U,j,_e);if(Oe!==void 0){if(Oe)continue;Ce=!1;break}if(ve){if(!A(j,function(lt,Ht){if(!i(ve,Ht)&&(Te===lt||fe(Te,lt,W,J,_e)))return ve.push(Ht)})){Ce=!1;break}}else if(Te!==Ye&&!fe(Te,Ye,W,J,_e)){Ce=!1;break}}return _e.delete(U),_e.delete(j),Ce}m.exports=L},a2db:function(m,T,f){var x=f("9e69"),A=x?x.prototype:void 0,i=A?A.valueOf:void 0;function P(O){return i?Object(i.call(O)):{}}m.exports=P},a3fd:function(m,T,f){var x=f("7948");function A(i,P){return x(P,function(O){return[O,i[O]]})}m.exports=A},a454:function(m,T,f){var x=f("72f0"),A=f("3b4a"),i=f("cd9d"),P=A?function(O,L){return A(O,"toString",{configurable:!0,enumerable:!1,value:x(L),writable:!0})}:i;m.exports=P},a524:function(m,T,f){var x=f("4245");function A(i){return x(this,i).has(i)}m.exports=A},a59b:function(m,T){function f(x){return x&&x.length?x[0]:void 0}m.exports=f},a640:function(m,T,f){var x=f("d039");m.exports=function(A,i){var P=[][A];return!!P&&x(function(){P.call(null,i||function(){return 1},1)})}},a994:function(m,T,f){var x=f("7d1f"),A=f("32f4"),i=f("ec69");function P(O){return x(O,i,A)}m.exports=P},ab36:function(m,T,f){var x=f("861d"),A=f("9112");m.exports=function(i,P){x(P)&&"cause"in P&&A(i,"cause",P.cause)}},ac41:function(m,T){function f(x){var A=-1,i=Array(x.size);return x.forEach(function(P){i[++A]=P}),i}m.exports=f},aeb0:function(m,T,f){var x=f("9bf2").f;m.exports=function(A,i,P){P in A||x(A,P,{configurable:!0,get:function(){return i[P]},set:function(O){i[P]=O}})}},aed9:function(m,T,f){var x=f("83ab"),A=f("d039");m.exports=x&&A(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},b047:function(m,T){function f(x){return function(A){return x(A)}}m.exports=f},b0b5:function(m,T,f){var x=f("24fb");T=x(!1),T.push([m.i,".vc-nav-header{display:flex;justify-content:space-between}.vc-nav-arrow{display:flex;justify-content:center;align-items:center;cursor:pointer;-webkit-user-select:none;user-select:none;line-height:var(--leading-snug);border-width:2px;border-style:solid;border-color:transparent;border-radius:var(--rounded)}.vc-nav-arrow.is-left{margin-right:auto}.vc-nav-arrow.is-right{margin-left:auto}.vc-nav-arrow.is-disabled{opacity:.25;pointer-events:none;cursor:not-allowed}.vc-nav-arrow:hover{background-color:var(--gray-900)}.vc-nav-arrow:focus{border-color:var(--accent-600)}.vc-nav-title{color:var(--accent-100);font-weight:var(--font-bold);line-height:var(--leading-snug);padding:4px 8px;border-radius:var(--rounded);border-width:2px;border-style:solid;border-color:transparent;-webkit-user-select:none;user-select:none}.vc-nav-title:hover{background-color:var(--gray-900)}.vc-nav-title:focus{border-color:var(--accent-600)}.vc-nav-items{display:grid;grid-template-columns:repeat(3,1fr);grid-row-gap:2px;grid-column-gap:5px}.vc-nav-item{width:48px;text-align:center;line-height:var(--leading-snug);font-weight:var(--font-semibold);padding:4px 0;cursor:pointer;border-color:transparent;border-width:2px;border-style:solid;border-radius:var(--rounded);-webkit-user-select:none;user-select:none}.vc-nav-item:hover{color:var(--white);background-color:var(--gray-900);box-shadow:var(--shadow-inner)}.vc-nav-item.is-active{color:var(--accent-900);background:var(--accent-100);font-weight:var(--font-bold);box-shadow:var(--shadow)}.vc-nav-item.is-current{color:var(--accent-100);font-weight:var(--bold);border-color:var(--accent-100)}.vc-nav-item:focus{border-color:var(--accent-600)}.vc-nav-item.is-disabled{opacity:.25;pointer-events:none}.vc-is-dark .vc-nav-title{color:var(--gray-900)}.vc-is-dark .vc-nav-title:hover{background-color:var(--gray-200)}.vc-is-dark .vc-nav-title:focus{border-color:var(--accent-400)}.vc-is-dark .vc-nav-arrow:hover{background-color:var(--gray-200)}.vc-is-dark .vc-nav-arrow:focus{border-color:var(--accent-400)}.vc-is-dark .vc-nav-item:hover{color:var(--gray-900);background-color:var(--gray-200);box-shadow:none}.vc-is-dark .vc-nav-item.is-active{color:var(--white);background:var(--accent-500)}.vc-is-dark .vc-nav-item.is-current{color:var(--accent-600);border-color:var(--accent-500)}.vc-is-dark .vc-nav-item:focus{border-color:var(--accent-400)}",""]),m.exports=T},b1d2:function(m,T,f){var x=f("3729"),A=f("1310"),i="[object Date]";function P(O){return A(O)&&x(O)==i}m.exports=P},b1e5:function(m,T,f){var x=f("a994"),A=1,i=Object.prototype,P=i.hasOwnProperty;function O(L,U,j,W,J,fe){var _e=j&A,we=x(L),ye=we.length,Pe=x(U),Fe=Pe.length;if(ye!=Fe&&!_e)return!1;for(var Be=ye;Be--;){var He=we[Be];if(!(_e?He in U:P.call(U,He)))return!1}var Ce=fe.get(L),ve=fe.get(U);if(Ce&&ve)return Ce==U&&ve==L;var Te=!0;fe.set(L,U),fe.set(U,L);for(var Ye=_e;++Be<ye;){He=we[Be];var Oe=L[He],lt=U[He];if(W)var Ht=_e?W(lt,Oe,He,U,L,fe):W(Oe,lt,He,L,U,fe);if(!(Ht===void 0?Oe===lt||J(Oe,lt,j,W,fe):Ht)){Te=!1;break}Ye||(Ye=He=="constructor")}if(Te&&!Ye){var nt=L.constructor,Tt=U.constructor;nt==Tt||!("constructor"in L)||!("constructor"in U)||typeof nt=="function"&&nt instanceof nt&&typeof Tt=="function"&&Tt instanceof Tt||(Te=!1)}return fe.delete(L),fe.delete(U),Te}m.exports=O},b218:function(m,T){var f=9007199254740991;function x(A){return typeof A=="number"&&A>-1&&A%1==0&&A<=f}m.exports=x},b3ff:function(m,T,f){var x=f("24fb");T=x(!1),T.push([m.i,".vc-pane[data-v-74ad501d]{min-width:250px}.vc-header[data-v-74ad501d]{display:flex;justify-content:center;align-items:center;padding:10px 18px 0 18px}.vc-header.align-left[data-v-74ad501d]{justify-content:flex-start}.vc-header.align-right[data-v-74ad501d]{justify-content:flex-end}.vc-title[data-v-74ad501d]{font-size:var(--text-lg);color:var(--gray-800);font-weight:var(--font-semibold);line-height:28px;cursor:pointer;-webkit-user-select:none;user-select:none;white-space:nowrap}.vc-title[data-v-74ad501d]:hover{opacity:.75}.vc-weeknumber[data-v-74ad501d]{position:relative}.vc-weeknumber[data-v-74ad501d],.vc-weeknumber-content[data-v-74ad501d]{display:flex;justify-content:center;align-items:center}.vc-weeknumber-content[data-v-74ad501d]{font-size:var(--text-xs);font-weight:var(--font-medium);font-style:italic;width:28px;height:28px;margin-top:2px;color:var(--gray-500);-webkit-user-select:none;user-select:none}.vc-weeknumber-content.is-left-outside[data-v-74ad501d]{position:absolute;left:var(--weeknumber-offset)}.vc-weeknumber-content.is-right-outside[data-v-74ad501d]{position:absolute;right:var(--weeknumber-offset)}.vc-weeks[data-v-74ad501d]{display:grid;grid-template-columns:repeat(7,1fr);position:relative;-webkit-overflow-scrolling:touch;padding:5px;min-width:250px}.vc-weeks.vc-show-weeknumbers[data-v-74ad501d]{grid-template-columns:auto repeat(7,1fr)}.vc-weeks.vc-show-weeknumbers.is-right[data-v-74ad501d]{grid-template-columns:repeat(7,1fr) auto}.vc-weekday[data-v-74ad501d]{text-align:center;color:var(--gray-500);font-size:var(--text-sm);font-weight:var(--font-bold);line-height:14px;padding-top:4px;padding-bottom:8px;cursor:default;-webkit-user-select:none;user-select:none}.vc-is-dark .vc-header[data-v-74ad501d]{color:var(--gray-200)}.vc-is-dark .vc-title[data-v-74ad501d]{color:var(--gray-100)}.vc-is-dark .vc-weekday[data-v-74ad501d]{color:var(--accent-200)}",""]),m.exports=T},b42e:function(m,T,f){var x=Math.ceil,A=Math.floor;m.exports=Math.trunc||function(i){var P=+i;return(P>0?A:x)(P)}},b4b0:function(m,T,f){var x=f("8d74"),A=f("1a8c"),i=f("ffd6"),P=NaN,O=/^[-+]0x[0-9a-f]+$/i,L=/^0b[01]+$/i,U=/^0o[0-7]+$/i,j=parseInt;function W(J){if(typeof J=="number")return J;if(i(J))return P;if(A(J)){var fe=typeof J.valueOf=="function"?J.valueOf():J;J=A(fe)?fe+"":fe}if(typeof J!="string")return J===0?J:+J;J=x(J);var _e=L.test(J);return _e||U.test(J)?j(J.slice(2),_e?2:8):O.test(J)?P:+J}m.exports=W},b4c0:function(m,T,f){var x=f("cb5a");function A(i){var P=this.__data__,O=x(P,i);return O<0?void 0:P[O][1]}m.exports=A},b5a7:function(m,T,f){var x=f("0b07"),A=f("2b3e"),i=x(A,"DataView");m.exports=i},b622:function(m,T,f){var x=f("da84"),A=f("5692"),i=f("1a2d"),P=f("90e3"),O=f("04f8"),L=f("fdbf"),U=x.Symbol,j=A("wks"),W=L?U.for||U:U&&U.withoutSetter||P;m.exports=function(J){return i(j,J)||(j[J]=O&&i(U,J)?U[J]:W("Symbol."+J)),j[J]}},b760:function(m,T,f){var x=f("872a"),A=f("9638");function i(P,O,L){(L!==void 0&&!A(P[O],L)||L===void 0&&!(O in P))&&x(P,O,L)}m.exports=i},b7f0:function(m,T,f){var x=f("24fb");T=x(!1),T.push([m.i,".vc-select[data-v-7b2eaf0a]{position:relative}.vc-select select[data-v-7b2eaf0a]{flex-grow:1;display:block;-webkit-appearance:none;appearance:none;width:52px;height:30px;font-size:var(--text-base);font-weight:var(--font-medium);text-align:left;background-color:var(--gray-200);border:2px solid;border-color:var(--gray-200);color:var(--gray-900);padding:0 20px 0 8px;border-radius:var(--rounded);line-height:var(--leading-tight);text-indent:0;cursor:pointer;-moz-padding-start:3px;background-image:none}.vc-select select[data-v-7b2eaf0a]:hover{color:var(--gray-600)}.vc-select select[data-v-7b2eaf0a]:focus{outline:0;border-color:var(--accent-400);background-color:var(--white)}.vc-select-arrow[data-v-7b2eaf0a]{display:flex;align-items:center;pointer-events:none;position:absolute;top:0;bottom:0;right:0;padding:0 4px 0 0;color:var(--gray-500)}.vc-select-arrow svg[data-v-7b2eaf0a]{width:16px;height:16px;fill:currentColor}.vc-is-dark select[data-v-7b2eaf0a]{background:var(--gray-700);color:var(--gray-100);border-color:var(--gray-700)}.vc-is-dark select[data-v-7b2eaf0a]:hover{color:var(--gray-400)}.vc-is-dark select[data-v-7b2eaf0a]:focus{border-color:var(--accent-500);background-color:var(--gray-800)}",""]),m.exports=T},b980:function(m,T,f){var x=f("d039"),A=f("5c6c");m.exports=!x(function(){var i=new Error("a");return!("stack"in i)||(Object.defineProperty(i,"stack",A(1,7)),i.stack!==7)})},badf:function(m,T,f){var x=f("642a"),A=f("1838"),i=f("cd9d"),P=f("6747"),O=f("f9ce");function L(U){return typeof U=="function"?U:U==null?i:typeof U=="object"?P(U)?A(U[0],U[1]):x(U):O(U)}m.exports=L},bbc0:function(m,T,f){var x=f("6044"),A="__lodash_hash_undefined__",i=Object.prototype,P=i.hasOwnProperty;function O(L){var U=this.__data__;if(x){var j=U[L];return j===A?void 0:j}return P.call(U,L)?U[L]:void 0}m.exports=O},bfb3:function(m,T,f){var x=f("0840");x.__esModule&&(x=x.default),typeof x=="string"&&(x=[[m.i,x,""]]),x.locals&&(m.exports=x.locals);var A=f("499e").default;A("1d8413e8",x,!0,{sourceMap:!1,shadowMode:!1})},c04e:function(m,T,f){var x=f("c65b"),A=f("861d"),i=f("d9b5"),P=f("dc4a"),O=f("485a"),L=f("b622"),U=TypeError,j=L("toPrimitive");m.exports=function(W,J){if(!A(W)||i(W))return W;var fe,_e=P(W,j);if(_e){if(J===void 0&&(J="default"),fe=x(_e,W,J),!A(fe)||i(fe))return fe;throw new U("Can't convert object to primitive value")}return J===void 0&&(J="number"),O(W,J)}},c05f:function(m,T,f){var x=f("7b97"),A=f("1310");function i(P,O,L,U,j){return P===O||(P==null||O==null||!A(P)&&!A(O)?P!==P&&O!==O:x(P,O,L,U,i,j))}m.exports=i},c098:function(m,T){var f=9007199254740991,x=/^(?:0|[1-9]\d*)$/;function A(i,P){var O=typeof i;return P=P??f,!!P&&(O=="number"||O!="symbol"&&x.test(i))&&i>-1&&i%1==0&&i<P}m.exports=A},c1c9:function(m,T,f){var x=f("a454"),A=f("f3c1"),i=A(x);m.exports=i},c2b6:function(m,T,f){var x=f("f8af"),A=f("5d89"),i=f("6f6c"),P=f("a2db"),O=f("c8fe"),L="[object Boolean]",U="[object Date]",j="[object Map]",W="[object Number]",J="[object RegExp]",fe="[object Set]",_e="[object String]",we="[object Symbol]",ye="[object ArrayBuffer]",Pe="[object DataView]",Fe="[object Float32Array]",Be="[object Float64Array]",He="[object Int8Array]",Ce="[object Int16Array]",ve="[object Int32Array]",Te="[object Uint8Array]",Ye="[object Uint8ClampedArray]",Oe="[object Uint16Array]",lt="[object Uint32Array]";function Ht(nt,Tt,Rt){var vt=nt.constructor;switch(Tt){case ye:return x(nt);case L:case U:return new vt(+nt);case Pe:return A(nt,Rt);case Fe:case Be:case He:case Ce:case ve:case Te:case Ye:case Oe:case lt:return O(nt,Rt);case j:return new vt;case W:case _e:return new vt(nt);case J:return i(nt);case fe:return new vt;case we:return P(nt)}}m.exports=Ht},c3fc:function(m,T,f){var x=f("42a2"),A=f("1310"),i="[object Set]";function P(O){return A(O)&&x(O)==i}m.exports=P},c430:function(m,T,f){m.exports=!1},c584:function(m,T){function f(x,A){return x.has(A)}m.exports=f},c65b:function(m,T,f){var x=f("40d5"),A=Function.prototype.call;m.exports=x?A.bind(A):function(){return A.apply(A,arguments)}},c6b6:function(m,T,f){var x=f("e330"),A=x({}.toString),i=x("".slice);m.exports=function(P){return i(A(P),8,-1)}},c6cd:function(m,T,f){var x=f("da84"),A=f("6374"),i="__core-js_shared__",P=x[i]||A(i,{});m.exports=P},c6cf:function(m,T,f){var x=f("4d8c"),A=f("2286"),i=f("c1c9");function P(O){return i(A(O,void 0,x),O+"")}m.exports=P},c869:function(m,T,f){var x=f("0b07"),A=f("2b3e"),i=x(A,"Set");m.exports=i},c87c:function(m,T){var f=Object.prototype,x=f.hasOwnProperty;function A(i){var P=i.length,O=new i.constructor(P);return P&&typeof i[0]=="string"&&x.call(i,"index")&&(O.index=i.index,O.input=i.input),O}m.exports=A},c8ba:function(m,T){var f;f=function(){return this}();try{f=f||new Function("return this")()}catch{typeof window=="object"&&(f=window)}m.exports=f},c8fe:function(m,T,f){var x=f("f8af");function A(i,P){var O=P?x(i.buffer):i.buffer;return new i.constructor(O,i.byteOffset,i.length)}m.exports=A},ca17:function(m,T,f){f("2feb")},ca84:function(m,T,f){var x=f("e330"),A=f("1a2d"),i=f("fc6a"),P=f("4d64").indexOf,O=f("d012"),L=x([].push);m.exports=function(U,j){var W,J=i(U),fe=0,_e=[];for(W in J)!A(O,W)&&A(J,W)&&L(_e,W);for(;j.length>fe;)A(J,W=j[fe++])&&(~P(_e,W)||L(_e,W));return _e}},cb2d:function(m,T,f){var x=f("1626"),A=f("9bf2"),i=f("13d2"),P=f("6374");m.exports=function(O,L,U,j){j||(j={});var W=j.enumerable,J=j.name!==void 0?j.name:L;if(x(U)&&i(U,J,j),j.global)W?O[L]=U:P(L,U);else{try{j.unsafe?O[L]&&(W=!0):delete O[L]}catch{}W?O[L]=U:A.f(O,L,{value:U,enumerable:!1,configurable:!j.nonConfigurable,writable:!j.nonWritable})}return O}},cb5a:function(m,T,f){var x=f("9638");function A(i,P){for(var O=i.length;O--;)if(x(i[O][0],P))return O;return-1}m.exports=A},cc12:function(m,T,f){var x=f("da84"),A=f("861d"),i=x.document,P=A(i)&&A(i.createElement);m.exports=function(O){return P?i.createElement(O):{}}},cc45:function(m,T,f){var x=f("1a2d0"),A=f("b047"),i=f("99d3"),P=i&&i.isMap,O=P?A(P):x;m.exports=O},cd9d:function(m,T){function f(x){return x}m.exports=f},cdce:function(m,T,f){var x=f("da84"),A=f("1626"),i=x.WeakMap;m.exports=A(i)&&/native code/.test(String(i))},ce86:function(m,T,f){var x=f("9e69"),A=f("7948"),i=f("6747"),P=f("ffd6"),O=1/0,L=x?x.prototype:void 0,U=L?L.toString:void 0;function j(W){if(typeof W=="string")return W;if(i(W))return A(W,j)+"";if(P(W))return U?U.call(W):"";var J=W+"";return J=="0"&&1/W==-O?"-0":J}m.exports=j},cebd:function(m,T){function f(x){var A=-1,i=Array(x.size);return x.forEach(function(P){i[++A]=[P,P]}),i}m.exports=f},cfe5:function(m,T,f){f.d(T,"a",function(){return L}),f("13d5");var x=f("f7f1"),A=f("2fa3"),i=f("9404"),P=f("29ae");const O=864e5;class L{constructor(j,{order:W=0,locale:J,isFullDay:fe}={}){if(this.isDateInfo=!0,this.order=W,this.locale=J instanceof P.b?J:new P.b(J),this.firstDayOfWeek=this.locale.firstDayOfWeek,!Object(i.m)(j)){const Pe=this.locale.normalizeDate(j);j=fe?{start:Pe,end:Pe}:{startOn:Pe,endOn:Pe}}let _e=null,we=null;if(j.start?_e=this.locale.normalizeDate(j.start,{...this.opts,time:"00:00:00"}):j.startOn&&(_e=this.locale.normalizeDate(j.startOn,this.opts)),j.end?we=this.locale.normalizeDate(j.end,{...this.opts,time:"23:59:59"}):j.endOn&&(we=this.locale.normalizeDate(j.endOn,this.opts)),_e&&we&&_e>we){const Pe=_e;_e=we,we=Pe}else _e&&j.span>=1&&(we=Object(x.a)(_e,j.span-1));this.start=_e,this.startTime=_e?_e.getTime():NaN,this.end=we,this.endTime=we?we.getTime():NaN,this.isDate=this.startTime&&this.startTime===this.endTime,this.isRange=!this.isDate;const ye=Object(A.i)(j,{},L.patternProps);if(ye.assigned&&(this.on={and:ye.target}),j.on){const Pe=(Object(i.h)(j.on)?j.on:[j.on]).map(function(Fe){if(Object(i.k)(Fe))return Fe;const Be=Object(A.i)(Fe,{},L.patternProps);return Be.assigned?Be.target:null}).filter(function(Fe){return Fe});Pe.length&&(this.on={...this.on,or:Pe})}this.isComplex=!!this.on}get opts(){return{order:this.order,locale:this.locale}}toDateInfo(j){return j.isDateInfo?j:new L(j,this.opts)}startOfWeek(j){const W=j.getDay()+1,J=W>=this.firstDayOfWeek?this.firstDayOfWeek-W:-(7-(this.firstDayOfWeek-W));return Object(x.a)(j,J)}diffInDays(j,W){return Math.round((W-j)/O)}diffInWeeks(j,W){return this.diffInDays(this.startOfWeek(j),this.startOfWeek(W))}diffInYears(j,W){return W.getUTCFullYear()-j.getUTCFullYear()}diffInMonths(j,W){return 12*this.diffInYears(j,W)+(W.getMonth()-j.getMonth())}static get patterns(){return{dailyInterval:{test:function(j,W,J){return J.diffInDays(J.start||new Date,j.date)%W===0}},weeklyInterval:{test:function(j,W,J){return J.diffInWeeks(J.start||new Date,j.date)%W===0}},monthlyInterval:{test:function(j,W,J){return J.diffInMonths(J.start||new Date,j.date)%W===0}},yearlyInterval:{test:function(){return function(j,W,J){return J.diffInYears(J.start||new Date,j.date)%W===0}}},days:{validate:function(j){return Object(i.h)(j)?j:[parseInt(j,10)]},test:function(j,W){return W.includes(j.day)||W.includes(-j.dayFromEnd)}},weekdays:{validate:function(j){return Object(i.h)(j)?j:[parseInt(j,10)]},test:function(j,W){return W.includes(j.weekday)}},ordinalWeekdays:{validate:function(j){return Object.keys(j).reduce(function(W,J){const fe=j[J];return fe&&(W[J]=Object(i.h)(fe)?fe:[parseInt(fe,10)]),W},{})},test:function(j,W){return Object.keys(W).map(function(J){return parseInt(J,10)}).find(function(J){return W[J].includes(j.weekday)&&(J===j.weekdayOrdinal||J===-j.weekdayOrdinalFromEnd)})}},weekends:{validate:function(j){return j},test:function(j){return j.weekday===1||j.weekday===7}},workweek:{validate:function(j){return j},test:function(j){return j.weekday>=2&&j.weekday<=6}},weeks:{validate:function(j){return Object(i.h)(j)?j:[parseInt(j,10)]},test:function(j,W){return W.includes(j.week)||W.includes(-j.weekFromEnd)}},months:{validate:function(j){return Object(i.h)(j)?j:[parseInt(j,10)]},test:function(j,W){return W.includes(j.month)}},years:{validate:function(j){return Object(i.h)(j)?j:[parseInt(j,10)]},test:function(j,W){return W.includes(j.year)}}}}static get patternProps(){return Object.keys(L.patterns).map(function(j){return{name:j,validate:L.patterns[j].validate}})}static testConfig(j,W,J){return Object(i.k)(j)?j(W):Object(i.m)(j)?Object.keys(j).every(function(fe){return L.patterns[fe].test(W,j[fe],J)}):null}iterateDatesInRange({start:j,end:W},J){if(!j||!W||!Object(i.k)(J))return null;j=this.locale.normalizeDate(j,{...this.opts,time:"00:00:00"});const fe={i:0,date:j,day:this.locale.getDateParts(j),finished:!1};let _e=null;for(;!fe.finished&&fe.date<=W;fe.i++)_e=J(fe),fe.date=Object(x.a)(fe.date,1),fe.day=this.locale.getDateParts(fe.date);return _e}shallowIntersectingRange(j){return this.rangeShallowIntersectingRange(this,this.toDateInfo(j))}rangeShallowIntersectingRange(j,W){if(!this.dateShallowIntersectsDate(j,W))return null;const J=j.toRange(),fe=W.toRange();let _e=null,we=null;return J.start?_e=fe.start?J.start>fe.start?J.start:fe.start:J.start:fe.start&&(_e=fe.start),J.end?we=fe.end?J.end<fe.end?J.end:fe.end:J.end:fe.end&&(we=fe.end),{start:_e,end:we}}intersectsDate(j){var W=this;const J=this.toDateInfo(j);if(!this.shallowIntersectsDate(J))return null;if(!this.on)return this;const fe=this.rangeShallowIntersectingRange(this,J);let _e=!1;return this.iterateDatesInRange(fe,function(we){W.matchesDay(we.day)&&(_e=_e||J.matchesDay(we.day),we.finished=_e)}),_e}shallowIntersectsDate(j){return this.dateShallowIntersectsDate(this,this.toDateInfo(j))}dateShallowIntersectsDate(j,W){return j.isDate?W.isDate?j.startTime===W.startTime:this.dateShallowIncludesDate(W,j):W.isDate?this.dateShallowIncludesDate(j,W):!(j.start&&W.end&&j.start>W.end)&&!(j.end&&W.start&&j.end<W.start)}includesDate(j){var W=this;const J=this.toDateInfo(j);if(!this.shallowIncludesDate(J))return!1;if(!this.on)return!0;const fe=this.rangeShallowIntersectingRange(this,J);let _e=!0;return this.iterateDatesInRange(fe,function(we){W.matchesDay(we.day)&&(_e=_e&&J.matchesDay(we.day),we.finished=!_e)}),_e}shallowIncludesDate(j){return this.dateShallowIncludesDate(this,j.isDate?j:new L(j,this.opts))}dateShallowIncludesDate(j,W){return j.isDate?W.isDate?j.startTime===W.startTime:!(!W.startTime||!W.endTime)&&j.startTime===W.startTime&&j.startTime===W.endTime:W.isDate?!(j.start&&W.start<j.start)&&!(j.end&&W.start>j.end):!(j.start&&(!W.start||W.start<j.start))&&!(j.end&&(!W.end||W.end>j.end))}intersectsDay(j){return this.shallowIntersectsDate(j.range)&&this.matchesDay(j)?this:null}matchesDay(j){var W=this;return!this.on||!(this.on.and&&!L.testConfig(this.on.and,j,this))&&!(this.on.or&&!this.on.or.some(function(J){return L.testConfig(J,j,W)}))}toRange(){return new L({start:this.start,end:this.end},this.opts)}compare(j){if(this.order!==j.order)return this.order-j.order;if(this.isDate!==j.isDate)return this.isDate?1:-1;if(this.isDate)return 0;const W=this.start-j.start;return W!==0?W:this.end-j.end}}},d012:function(m,T,f){m.exports={}},d02c:function(m,T,f){var x=f("5e2e"),A=f("79bc"),i=f("7b83"),P=200;function O(L,U){var j=this.__data__;if(j instanceof x){var W=j.__data__;if(!A||W.length<P-1)return W.push([L,U]),this.size=++j.size,this;j=this.__data__=new i(W)}return j.set(L,U),this.size=j.size,this}m.exports=O},d039:function(m,T,f){m.exports=function(x){try{return!!x()}catch{return!0}}},d066:function(m,T,f){var x=f("da84"),A=f("1626"),i=function(P){return A(P)?P:void 0};m.exports=function(P,O){return arguments.length<2?i(x[P]):x[P]&&x[P][O]}},d1e7:function(m,T,f){var x={}.propertyIsEnumerable,A=Object.getOwnPropertyDescriptor,i=A&&!x.call({1:2},1);T.f=i?function(P){var O=A(this,P);return!!O&&O.enumerable}:x},d2bb:function(m,T,f){var x=f("7282"),A=f("825a"),i=f("3bbe");m.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var P,O=!1,L={};try{P=x(Object.prototype,"__proto__","set"),P(L,[]),O=L instanceof Array}catch{}return function(U,j){return A(U),i(j),O?P(U,j):U.__proto__=j,U}}():void 0)},d327:function(m,T){function f(){return[]}m.exports=f},d370:function(m,T,f){var x=f("253c"),A=f("1310"),i=Object.prototype,P=i.hasOwnProperty,O=i.propertyIsEnumerable,L=x(function(){return arguments}())?x:function(U){return A(U)&&P.call(U,"callee")&&!O.call(U,"callee")};m.exports=L},d58f:function(m,T,f){var x=f("59ed"),A=f("7b0b"),i=f("44ad"),P=f("07fa"),O=TypeError,L=function(U){return function(j,W,J,fe){x(W);var _e=A(j),we=i(_e),ye=P(_e),Pe=U?ye-1:0,Fe=U?-1:1;if(J<2)for(;;){if(Pe in we){fe=we[Pe],Pe+=Fe;break}if(Pe+=Fe,U?Pe<0:ye<=Pe)throw new O("Reduce of empty array with no initial value")}for(;U?Pe>=0:ye>Pe;Pe+=Fe)Pe in we&&(fe=W(fe,we[Pe],Pe,_e));return fe}};m.exports={left:L(!1),right:L(!0)}},d612:function(m,T,f){var x=f("7b83"),A=f("7ed2"),i=f("dc0f");function P(O){var L=-1,U=O==null?0:O.length;for(this.__data__=new x;++L<U;)this.add(O[L])}P.prototype.add=P.prototype.push=A,P.prototype.has=i,m.exports=P},d798:function(m,T,f){var x=f("24fb");T=x(!1),T.push([m.i,".vc-day-popover-row[data-v-eb5afd1a]{--day-content-transition-time:0.13s ease-in;display:flex;align-items:center;transition:all var(--day-content-transition-time)}.vc-day-popover-row[data-v-eb5afd1a]:not(:first-child){margin-top:3px}.vc-day-popover-row-indicator[data-v-eb5afd1a]{display:flex;justify-content:center;align-items:center;flex-grow:0;width:15px;margin-right:3px}.vc-day-popover-row-indicator span[data-v-eb5afd1a]{transition:all var(--day-content-transition-time)}.vc-day-popover-row-content[data-v-eb5afd1a]{display:flex;align-items:center;flex-wrap:none;flex-grow:1;width:max-content}",""]),m.exports=T},d7ee:function(m,T,f){var x=f("c3fc"),A=f("b047"),i=f("99d3"),P=i&&i.isSet,O=P?A(P):x;m.exports=O},d8e2:function(m,T,f){var x=f("24fb");T=x(!1),T.push([m.i,'.vc-popover-content-wrapper[data-v-03f17c2c]{--popover-horizontal-content-offset:8px;--popover-vertical-content-offset:10px;--popover-slide-translation:15px;--popover-transition-time:0.14s ease-in-out;--popover-caret-horizontal-offset:18px;--popover-caret-vertical-offset:8px;position:absolute;display:block;outline:none;z-index:10}.vc-popover-content-wrapper[data-v-03f17c2c]:not(.is-interactive){pointer-events:none}.vc-popover-content[data-v-03f17c2c]{position:relative;outline:none;z-index:10;box-shadow:var(--shadow-lg)}.vc-popover-content.direction-bottom[data-v-03f17c2c]{margin-top:var(--popover-vertical-content-offset)}.vc-popover-content.direction-top[data-v-03f17c2c]{margin-bottom:var(--popover-vertical-content-offset)}.vc-popover-content.direction-left[data-v-03f17c2c]{margin-right:var(--popover-horizontal-content-offset)}.vc-popover-content.direction-right[data-v-03f17c2c]{margin-left:var(--popover-horizontal-content-offset)}.vc-popover-caret[data-v-03f17c2c]{content:"";position:absolute;display:block;width:12px;height:12px;border-top:inherit;border-left:inherit;background-color:inherit;-webkit-user-select:none;user-select:none;z-index:-1}.vc-popover-caret.direction-bottom[data-v-03f17c2c]{top:0}.vc-popover-caret.direction-bottom.align-left[data-v-03f17c2c]{transform:translateY(-50%) rotate(45deg)}.vc-popover-caret.direction-bottom.align-center[data-v-03f17c2c]{transform:translateX(-50%) translateY(-50%) rotate(45deg)}.vc-popover-caret.direction-bottom.align-right[data-v-03f17c2c]{transform:translateY(-50%) rotate(45deg)}.vc-popover-caret.direction-top[data-v-03f17c2c]{top:100%}.vc-popover-caret.direction-top.align-left[data-v-03f17c2c]{transform:translateY(-50%) rotate(-135deg)}.vc-popover-caret.direction-top.align-center[data-v-03f17c2c]{transform:translateX(-50%) translateY(-50%) rotate(-135deg)}.vc-popover-caret.direction-top.align-right[data-v-03f17c2c]{transform:translateY(-50%) rotate(-135deg)}.vc-popover-caret.direction-left[data-v-03f17c2c]{left:100%}.vc-popover-caret.direction-left.align-top[data-v-03f17c2c]{transform:translateX(-50%) rotate(135deg)}.vc-popover-caret.direction-left.align-middle[data-v-03f17c2c]{transform:translateY(-50%) translateX(-50%) rotate(135deg)}.vc-popover-caret.direction-left.align-bottom[data-v-03f17c2c]{transform:translateX(-50%) rotate(135deg)}.vc-popover-caret.direction-right[data-v-03f17c2c]{left:0}.vc-popover-caret.direction-right.align-top[data-v-03f17c2c]{transform:translateX(-50%) rotate(-45deg)}.vc-popover-caret.direction-right.align-middle[data-v-03f17c2c]{transform:translateY(-50%) translateX(-50%) rotate(-45deg)}.vc-popover-caret.direction-right.align-bottom[data-v-03f17c2c]{transform:translateX(-50%) rotate(-45deg)}.vc-popover-caret.align-left[data-v-03f17c2c]{left:var(--popover-caret-horizontal-offset)}.vc-popover-caret.align-center[data-v-03f17c2c]{left:50%}.vc-popover-caret.align-right[data-v-03f17c2c]{right:var(--popover-caret-horizontal-offset)}.vc-popover-caret.align-top[data-v-03f17c2c]{top:var(--popover-caret-vertical-offset)}.vc-popover-caret.align-middle[data-v-03f17c2c]{top:50%}.vc-popover-caret.align-bottom[data-v-03f17c2c]{bottom:var(--popover-caret-vertical-offset)}.fade-enter-active[data-v-03f17c2c],.fade-leave-active[data-v-03f17c2c],.slide-fade-enter-active[data-v-03f17c2c],.slide-fade-leave-active[data-v-03f17c2c]{transition:all var(--popover-transition-time);pointer-events:none}.fade-enter[data-v-03f17c2c],.fade-leave-to[data-v-03f17c2c],.slide-fade-enter[data-v-03f17c2c],.slide-fade-leave-to[data-v-03f17c2c]{opacity:0}.slide-fade-enter.direction-bottom[data-v-03f17c2c],.slide-fade-leave-to.direction-bottom[data-v-03f17c2c]{transform:translateY(calc(var(--popover-slide-translation)*-1))}.slide-fade-enter.direction-top[data-v-03f17c2c],.slide-fade-leave-to.direction-top[data-v-03f17c2c]{transform:translateY(var(--popover-slide-translation))}.slide-fade-enter.direction-left[data-v-03f17c2c],.slide-fade-leave-to.direction-left[data-v-03f17c2c]{transform:translateX(var(--popover-slide-translation))}.slide-fade-enter.direction-right[data-v-03f17c2c],.slide-fade-leave-to.direction-right[data-v-03f17c2c]{transform:translateX(calc(var(--popover-slide-translation)*-1))}',""]),m.exports=T},d9b5:function(m,T,f){var x=f("d066"),A=f("1626"),i=f("3a9b"),P=f("fdbf"),O=Object;m.exports=P?function(L){return typeof L=="symbol"}:function(L){var U=x("Symbol");return A(U)&&i(U.prototype,O(L))}},d9e2:function(m,T,f){var x=f("23e7"),A=f("da84"),i=f("2ba4"),P=f("e5cb"),O="WebAssembly",L=A[O],U=new Error("e",{cause:7}).cause!==7,j=function(J,fe){var _e={};_e[J]=P(J,fe,U),x({global:!0,constructor:!0,arity:1,forced:U},_e)},W=function(J,fe){if(L&&L[J]){var _e={};_e[J]=P(O+"."+J,fe,U),x({target:O,stat:!0,constructor:!0,arity:1,forced:U},_e)}};j("Error",function(J){return function(fe){return i(J,this,arguments)}}),j("EvalError",function(J){return function(fe){return i(J,this,arguments)}}),j("RangeError",function(J){return function(fe){return i(J,this,arguments)}}),j("ReferenceError",function(J){return function(fe){return i(J,this,arguments)}}),j("SyntaxError",function(J){return function(fe){return i(J,this,arguments)}}),j("TypeError",function(J){return function(fe){return i(J,this,arguments)}}),j("URIError",function(J){return function(fe){return i(J,this,arguments)}}),W("CompileError",function(J){return function(fe){return i(J,this,arguments)}}),W("LinkError",function(J){return function(fe){return i(J,this,arguments)}}),W("RuntimeError",function(J){return function(fe){return i(J,this,arguments)}})},da03:function(m,T,f){var x=f("2b3e"),A=x["__core-js_shared__"];m.exports=A},da84:function(m,T,f){(function(x){var A=function(i){return i&&i.Math===Math&&i};m.exports=A(typeof globalThis=="object"&&globalThis)||A(typeof window=="object"&&window)||A(typeof self=="object"&&self)||A(typeof x=="object"&&x)||function(){return this}()||this||Function("return this")()}).call(this,f("c8ba"))},dc0f:function(m,T){function f(x){return this.__data__.has(x)}m.exports=f},dc4a:function(m,T,f){var x=f("59ed"),A=f("7234");m.exports=function(i,P){var O=i[P];return A(O)?void 0:x(O)}},dc57:function(m,T){var f=Function.prototype,x=f.toString;function A(i){if(i!=null){try{return x.call(i)}catch{}try{return i+""}catch{}}return""}m.exports=A},dc8c:function(m,T,f){var x=f("24fb");T=x(!1),T.push([m.i,".vc-container{--white:#fff;--black:#000;--gray-100:#f7fafc;--gray-200:#edf2f7;--gray-300:#e2e8f0;--gray-400:#cbd5e0;--gray-500:#a0aec0;--gray-600:#718096;--gray-700:#4a5568;--gray-800:#2d3748;--gray-900:#1a202c;--red-100:#fff5f5;--red-200:#fed7d7;--red-300:#feb2b2;--red-400:#fc8181;--red-500:#f56565;--red-600:#e53e3e;--red-700:#c53030;--red-800:#9b2c2c;--red-900:#742a2a;--orange-100:#fffaf0;--orange-200:#feebc8;--orange-300:#fbd38d;--orange-400:#f6ad55;--orange-500:#ed8936;--orange-600:#dd6b20;--orange-700:#c05621;--orange-800:#9c4221;--orange-900:#7b341e;--yellow-100:ivory;--yellow-200:#fefcbf;--yellow-300:#faf089;--yellow-400:#f6e05e;--yellow-500:#ecc94b;--yellow-600:#d69e2e;--yellow-700:#b7791f;--yellow-800:#975a16;--yellow-900:#744210;--green-100:#f0fff4;--green-200:#c6f6d5;--green-300:#9ae6b4;--green-400:#68d391;--green-500:#48bb78;--green-600:#38a169;--green-700:#2f855a;--green-800:#276749;--green-900:#22543d;--teal-100:#e6fffa;--teal-200:#b2f5ea;--teal-300:#81e6d9;--teal-400:#4fd1c5;--teal-500:#38b2ac;--teal-600:#319795;--teal-700:#2c7a7b;--teal-800:#285e61;--teal-900:#234e52;--blue-100:#ebf8ff;--blue-200:#bee3f8;--blue-300:#90cdf4;--blue-400:#63b3ed;--blue-500:#4299e1;--blue-600:#3182ce;--blue-700:#2b6cb0;--blue-800:#2c5282;--blue-900:#2a4365;--indigo-100:#ebf4ff;--indigo-200:#c3dafe;--indigo-300:#a3bffa;--indigo-400:#7f9cf5;--indigo-500:#667eea;--indigo-600:#5a67d8;--indigo-700:#4c51bf;--indigo-800:#434190;--indigo-900:#3c366b;--purple-100:#faf5ff;--purple-200:#e9d8fd;--purple-300:#d6bcfa;--purple-400:#b794f4;--purple-500:#9f7aea;--purple-600:#805ad5;--purple-700:#6b46c1;--purple-800:#553c9a;--purple-900:#44337a;--pink-100:#fff5f7;--pink-200:#fed7e2;--pink-300:#fbb6ce;--pink-400:#f687b3;--pink-500:#ed64a6;--pink-600:#d53f8c;--pink-700:#b83280;--pink-800:#97266d;--pink-900:#702459}.vc-container.vc-red{--accent-100:var(--red-100);--accent-200:var(--red-200);--accent-300:var(--red-300);--accent-400:var(--red-400);--accent-500:var(--red-500);--accent-600:var(--red-600);--accent-700:var(--red-700);--accent-800:var(--red-800);--accent-900:var(--red-900)}.vc-container.vc-orange{--accent-100:var(--orange-100);--accent-200:var(--orange-200);--accent-300:var(--orange-300);--accent-400:var(--orange-400);--accent-500:var(--orange-500);--accent-600:var(--orange-600);--accent-700:var(--orange-700);--accent-800:var(--orange-800);--accent-900:var(--orange-900)}.vc-container.vc-yellow{--accent-100:var(--yellow-100);--accent-200:var(--yellow-200);--accent-300:var(--yellow-300);--accent-400:var(--yellow-400);--accent-500:var(--yellow-500);--accent-600:var(--yellow-600);--accent-700:var(--yellow-700);--accent-800:var(--yellow-800);--accent-900:var(--yellow-900)}.vc-container.vc-green{--accent-100:var(--green-100);--accent-200:var(--green-200);--accent-300:var(--green-300);--accent-400:var(--green-400);--accent-500:var(--green-500);--accent-600:var(--green-600);--accent-700:var(--green-700);--accent-800:var(--green-800);--accent-900:var(--green-900)}.vc-container.vc-teal{--accent-100:var(--teal-100);--accent-200:var(--teal-200);--accent-300:var(--teal-300);--accent-400:var(--teal-400);--accent-500:var(--teal-500);--accent-600:var(--teal-600);--accent-700:var(--teal-700);--accent-800:var(--teal-800);--accent-900:var(--teal-900)}.vc-container.vc-blue{--accent-100:var(--blue-100);--accent-200:var(--blue-200);--accent-300:var(--blue-300);--accent-400:var(--blue-400);--accent-500:var(--blue-500);--accent-600:var(--blue-600);--accent-700:var(--blue-700);--accent-800:var(--blue-800);--accent-900:var(--blue-900)}.vc-container.vc-indigo{--accent-100:var(--indigo-100);--accent-200:var(--indigo-200);--accent-300:var(--indigo-300);--accent-400:var(--indigo-400);--accent-500:var(--indigo-500);--accent-600:var(--indigo-600);--accent-700:var(--indigo-700);--accent-800:var(--indigo-800);--accent-900:var(--indigo-900)}.vc-container.vc-purple{--accent-100:var(--purple-100);--accent-200:var(--purple-200);--accent-300:var(--purple-300);--accent-400:var(--purple-400);--accent-500:var(--purple-500);--accent-600:var(--purple-600);--accent-700:var(--purple-700);--accent-800:var(--purple-800);--accent-900:var(--purple-900)}.vc-container.vc-pink{--accent-100:var(--pink-100);--accent-200:var(--pink-200);--accent-300:var(--pink-300);--accent-400:var(--pink-400);--accent-500:var(--pink-500);--accent-600:var(--pink-600);--accent-700:var(--pink-700);--accent-800:var(--pink-800);--accent-900:var(--pink-900)}.vc-container{--font-normal:400;--font-medium:500;--font-semibold:600;--font-bold:700;--text-xs:12px;--text-sm:14px;--text-base:16px;--text-lg:18px;--leading-snug:1.375;--rounded:0.25rem;--rounded-lg:0.5rem;--rounded-full:9999px;--shadow:0 1px 3px 0 rgba(0,0,0,0.1),0 1px 2px 0 rgba(0,0,0,0.06);--shadow-lg:0 10px 15px -3px rgba(0,0,0,0.1),0 4px 6px -2px rgba(0,0,0,0.05);--shadow-inner:inset 0 2px 4px 0 rgba(0,0,0,0.06);--slide-translate:22px;--slide-duration:0.15s;--slide-timing:ease;--day-content-transition-time:0.13s ease-in;--weeknumber-offset:-34px;position:relative;display:inline-flex;width:max-content;height:max-content;font-family:BlinkMacSystemFont,-apple-system,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,Helvetica,Arial,sans-serif;color:var(--gray-900);background-color:var(--white);border:1px solid;border-color:var(--gray-400);border-radius:var(--rounded-lg);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-tap-highlight-color:transparent}.vc-container,.vc-container *{box-sizing:border-box}.vc-container:focus,.vc-container :focus{outline:none}.vc-container [role=button],.vc-container button{cursor:pointer}.vc-container.vc-is-expanded{min-width:100%}.vc-container .vc-container{border:none}.vc-container.vc-is-dark{color:var(--gray-100);background-color:var(--gray-900);border-color:var(--gray-700)}",""]),m.exports=T},dc9e:function(m,T,f){f("eb68")},dcbe:function(m,T,f){var x=f("30c9"),A=f("1310");function i(P){return A(P)&&x(P)}m.exports=i},dd61:function(m,T,f){var x=f("7948"),A=f("badf"),i=f("97d3"),P=f("6747");function O(L,U){var j=P(L)?x:i;return j(L,A(U,3))}m.exports=O},e031:function(m,T,f){var x=f("f909"),A=f("1a8c");function i(P,O,L,U,j,W){return A(P)&&A(O)&&(W.set(O,P),x(P,O,void 0,i,W),W.delete(O)),P}m.exports=i},e0e7:function(m,T,f){var x=f("60ed");function A(i){return x(i)?void 0:i}m.exports=A},e177:function(m,T,f){f("55ed")},e24b:function(m,T,f){var x=f("49f4"),A=f("1efc"),i=f("bbc0"),P=f("7a48"),O=f("2524");function L(U){var j=-1,W=U==null?0:U.length;for(this.clear();++j<W;){var J=U[j];this.set(J[0],J[1])}}L.prototype.clear=x,L.prototype.delete=A,L.prototype.get=i,L.prototype.has=P,L.prototype.set=O,m.exports=L},e2a0:function(m,T,f){var x=f("3729"),A=f("6747"),i=f("1310"),P="[object String]";function O(L){return typeof L=="string"||!A(L)&&i(L)&&x(L)==P}m.exports=O},e2c0:function(m,T,f){var x=f("e2e4"),A=f("d370"),i=f("6747"),P=f("c098"),O=f("b218"),L=f("f4d6");function U(j,W,J){W=x(W,j);for(var fe=-1,_e=W.length,we=!1;++fe<_e;){var ye=L(W[fe]);if(!(we=j!=null&&J(j,ye)))break;j=j[ye]}return we||++fe!=_e?we:(_e=j==null?0:j.length,!!_e&&O(_e)&&P(ye,_e)&&(i(j)||A(j)))}m.exports=U},e2e4:function(m,T,f){var x=f("6747"),A=f("f608"),i=f("18d8"),P=f("76dd");function O(L,U){return x(L)?L:A(L,U)?[L]:i(P(L))}m.exports=O},e330:function(m,T,f){var x=f("40d5"),A=Function.prototype,i=A.call,P=x&&A.bind.bind(i,i);m.exports=x?P:function(O){return function(){return i.apply(O,arguments)}}},e380:function(m,T,f){var x=f("7b83"),A="Expected a function";function i(P,O){if(typeof P!="function"||O!=null&&typeof O!="function")throw new TypeError(A);var L=function(){var U=arguments,j=O?O.apply(this,U):U[0],W=L.cache;if(W.has(j))return W.get(j);var J=P.apply(this,U);return L.cache=W.set(j,J)||W,J};return L.cache=new(i.Cache||x),L}i.Cache=x,m.exports=i},e391:function(m,T,f){var x=f("577e");m.exports=function(A,i){return A===void 0?arguments.length<2?"":i:x(A)}},e3f8:function(m,T,f){var x=f("656b");function A(i){return function(P){return x(P,i)}}m.exports=A},e538:function(m,T,f){(function(x){var A=f("2b3e"),i=T&&!T.nodeType&&T,P=i&&typeof x=="object"&&x&&!x.nodeType&&x,O=P&&P.exports===i,L=O?A.Buffer:void 0,U=L?L.allocUnsafe:void 0;function j(W,J){if(J)return W.slice();var fe=W.length,_e=U?U(fe):new W.constructor(fe);return W.copy(_e),_e}x.exports=j}).call(this,f("62e4")(m))},e5cb:function(m,T,f){var x=f("d066"),A=f("1a2d"),i=f("9112"),P=f("3a9b"),O=f("d2bb"),L=f("e893"),U=f("aeb0"),j=f("7156"),W=f("e391"),J=f("ab36"),fe=f("6f19"),_e=f("83ab"),we=f("c430");m.exports=function(ye,Pe,Fe,Be){var He="stackTraceLimit",Ce=Be?2:1,ve=ye.split("."),Te=ve[ve.length-1],Ye=x.apply(null,ve);if(Ye){var Oe=Ye.prototype;if(!we&&A(Oe,"cause")&&delete Oe.cause,!Fe)return Ye;var lt=x("Error"),Ht=Pe(function(nt,Tt){var Rt=W(Be?Tt:nt,void 0),vt=Be?new Ye(nt):new Ye;return Rt!==void 0&&i(vt,"message",Rt),fe(vt,Ht,vt.stack,2),this&&P(Oe,this)&&j(vt,this,Ht),arguments.length>Ce&&J(vt,arguments[Ce]),vt});if(Ht.prototype=Oe,Te!=="Error"?O?O(Ht,lt):L(Ht,lt,{name:!0}):_e&&He in Ye&&(U(Ht,Ye,He),U(Ht,Ye,"prepareStackTrace")),L(Ht,Ye),!we)try{Oe.name!==Te&&i(Oe,"name",Te),Oe.constructor=Ht}catch{}return Ht}}},e893:function(m,T,f){var x=f("1a2d"),A=f("56ef"),i=f("06cf"),P=f("9bf2");m.exports=function(O,L,U){for(var j=A(L),W=P.f,J=i.f,fe=0;fe<j.length;fe++){var _e=j[fe];x(O,_e)||U&&x(U,_e)||W(O,_e,J(L,_e))}}},e8b5:function(m,T,f){var x=f("c6b6");m.exports=Array.isArray||function(A){return x(A)==="Array"}},eac5:function(m,T){var f=Object.prototype;function x(A){var i=A&&A.constructor,P=typeof i=="function"&&i.prototype||f;return A===P}m.exports=x},eb68:function(m,T,f){var x=f("b0b5");x.__esModule&&(x=x.default),typeof x=="string"&&(x=[[m.i,x,""]]),x.locals&&(m.exports=x.locals);var A=f("499e").default;A("06cf7692",x,!0,{sourceMap:!1,shadowMode:!1})},ec47:function(m,T,f){var x=f("a3fd"),A=f("42a2"),i=f("edfa"),P=f("cebd"),O="[object Map]",L="[object Set]";function U(j){return function(W){var J=A(W);return J==O?i(W):J==L?P(W):x(W,j(W))}}m.exports=U},ec69:function(m,T,f){var x=f("6fcd"),A=f("03dd"),i=f("30c9");function P(O){return i(O)?x(O):A(O)}m.exports=P},ec8c:function(m,T){function f(x){var A=[];if(x!=null)for(var i in Object(x))A.push(i);return A}m.exports=f},ed08:function(m,T,f){f.r(T),f.d(T,"Locale",function(){return x.b}),f.d(T,"DateInfo",function(){return A.a}),f.d(T,"Attribute",function(){return i.a}),f.d(T,"AttributeStore",function(){return P.a}),f.d(T,"setupCalendar",function(){return U}),f.d(T,"pad",function(){return j.m}),f.d(T,"evalFn",function(){return j.f}),f.d(T,"mergeEvents",function(){return j.h}),f.d(T,"pageIsValid",function(){return j.r}),f.d(T,"pageIsBeforePage",function(){return j.o}),f.d(T,"pageIsAfterPage",function(){return j.n}),f.d(T,"pageIsBetweenPages",function(){return j.p}),f.d(T,"pageIsEqualToPage",function(){return j.q}),f.d(T,"addPages",function(){return j.a}),f.d(T,"pageRangeToArray",function(){return j.s}),f.d(T,"datesAreEqual",function(){return j.d}),f.d(T,"arrayHasItems",function(){return j.b}),f.d(T,"mixinOptionalProps",function(){return j.i}),f.d(T,"on",function(){return j.k}),f.d(T,"off",function(){return j.j}),f.d(T,"elementContains",function(){return j.e}),f.d(T,"onSpaceOrEnter",function(){return j.l}),f.d(T,"createGuid",function(){return j.c}),f.d(T,"hash",function(){return j.g}),f.d(T,"addHorizontalSwipeHandler",function(){return W.a});var x=f("29ae"),A=f("cfe5"),i=f("22f3"),P=f("9349"),O=f("51ec"),L=f("1315"),U=function(J){const fe=Object(O.b)(J);return Object(L.a)(fe.screens,!0),fe},j=f("2fa3"),W=f("0733")},edfa:function(m,T){function f(x){var A=-1,i=Array(x.size);return x.forEach(function(P,O){i[++A]=[O,P]}),i}m.exports=f},ef5d:function(m,T){function f(x){return function(A){return A==null?void 0:A[x]}}m.exports=f},efb6:function(m,T,f){var x=f("5e2e");function A(){this.__data__=new x,this.size=0}m.exports=A},f15d:function(m,T,f){var x=f("9404");const A={ar:{dow:7,L:"D/M/YYYY"},bg:{dow:2,L:"D.MM.YYYY"},ca:{dow:2,L:"DD/MM/YYYY"},"zh-CN":{dow:2,L:"YYYY/MM/DD"},"zh-TW":{dow:1,L:"YYYY/MM/DD"},hr:{dow:2,L:"DD.MM.YYYY"},cs:{dow:2,L:"DD.MM.YYYY"},da:{dow:2,L:"DD.MM.YYYY"},nl:{dow:2,L:"DD-MM-YYYY"},"en-US":{dow:1,L:"MM/DD/YYYY"},"en-AU":{dow:2,L:"DD/MM/YYYY"},"en-CA":{dow:1,L:"YYYY-MM-DD"},"en-GB":{dow:2,L:"DD/MM/YYYY"},"en-IE":{dow:2,L:"DD-MM-YYYY"},"en-NZ":{dow:2,L:"DD/MM/YYYY"},"en-ZA":{dow:1,L:"YYYY/MM/DD"},eo:{dow:2,L:"YYYY-MM-DD"},et:{dow:2,L:"DD.MM.YYYY"},fi:{dow:2,L:"DD.MM.YYYY"},fr:{dow:2,L:"DD/MM/YYYY"},"fr-CA":{dow:1,L:"YYYY-MM-DD"},"fr-CH":{dow:2,L:"DD.MM.YYYY"},de:{dow:2,L:"DD.MM.YYYY"},he:{dow:1,L:"DD.MM.YYYY"},id:{dow:2,L:"DD/MM/YYYY"},it:{dow:2,L:"DD/MM/YYYY"},ja:{dow:1,L:"YYYYMD"},ko:{dow:1,L:"YYYY.MM.DD"},lv:{dow:2,L:"DD.MM.YYYY"},lt:{dow:2,L:"DD.MM.YYYY"},mk:{dow:2,L:"D.MM.YYYY"},nb:{dow:2,L:"D. MMMM YYYY"},nn:{dow:2,L:"D. MMMM YYYY"},pl:{dow:2,L:"DD.MM.YYYY"},pt:{dow:2,L:"DD/MM/YYYY"},ro:{dow:2,L:"DD.MM.YYYY"},ru:{dow:2,L:"DD.MM.YYYY"},sk:{dow:2,L:"DD.MM.YYYY"},"es-ES":{dow:2,L:"DD/MM/YYYY"},"es-MX":{dow:2,L:"DD/MM/YYYY"},sv:{dow:2,L:"YYYY-MM-DD"},th:{dow:1,L:"DD/MM/YYYY"},tr:{dow:2,L:"DD.MM.YYYY"},uk:{dow:2,L:"DD.MM.YYYY"},vi:{dow:2,L:"DD/MM/YYYY"}};A.en=A["en-US"],A.es=A["es-ES"],A.no=A.nb,A.zh=A["zh-CN"],Object(x.w)(A).forEach(function([i,{dow:P,L:O}]){A[i]={id:i,firstDayOfWeek:P,masks:{L:O}}}),T.a=A},f3c1:function(m,T){var f=800,x=16,A=Date.now;function i(P){var O=0,L=0;return function(){var U=A(),j=x-(U-L);if(L=U,j>0){if(++O>=f)return arguments[0]}else O=0;return P.apply(void 0,arguments)}}m.exports=i},f4d6:function(m,T,f){var x=f("ffd6"),A=1/0;function i(P){if(typeof P=="string"||x(P))return P;var O=P+"";return O=="0"&&1/P==-A?"-0":O}m.exports=i},f542:function(m,T,f){var x=f("ec47"),A=f("ec69"),i=x(A);m.exports=i},f5df:function(m,T,f){var x=f("00ee"),A=f("1626"),i=f("c6b6"),P=f("b622"),O=P("toStringTag"),L=Object,U=i(function(){return arguments}())==="Arguments",j=function(W,J){try{return W[J]}catch{}};m.exports=x?i:function(W){var J,fe,_e;return W===void 0?"Undefined":W===null?"Null":typeof(fe=j(J=L(W),O))=="string"?fe:U?i(J):(_e=i(J))==="Object"&&A(J.callee)?"Arguments":_e}},f608:function(m,T,f){var x=f("6747"),A=f("ffd6"),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,P=/^\w*$/;function O(L,U){if(x(L))return!1;var j=typeof L;return!(j!="number"&&j!="symbol"&&j!="boolean"&&L!=null&&!A(L))||P.test(L)||!i.test(L)||U!=null&&L in Object(U)}m.exports=O},f678:function(m,T,f){var x=f("8384"),A=f("b4b0");function i(P,O,L){return L===void 0&&(L=O,O=void 0),L!==void 0&&(L=A(L),L=L===L?L:0),O!==void 0&&(O=A(O),O=O===O?O:0),x(A(P),O,L)}m.exports=i},f772:function(m,T,f){var x=f("5692"),A=f("90e3"),i=x("keys");m.exports=function(P){return i[P]||(i[P]=A(P))}},f7f1:function(m,T,f){f.d(T,"a",function(){return P});var x=f("fe1f"),A=f("fd3a"),i=f("8c86");function P(O,L){Object(i.a)(2,arguments);var U=Object(A.a)(O),j=Object(x.a)(L);return isNaN(j)?new Date(NaN):(j&&U.setDate(U.getDate()+j),U)}},f8af:function(m,T,f){var x=f("2474");function A(i){var P=new i.constructor(i.byteLength);return new x(P).set(new x(i)),P}m.exports=A},f909:function(m,T,f){var x=f("7e64"),A=f("b760"),i=f("72af"),P=f("4f50"),O=f("1a8c"),L=f("9934"),U=f("8adb");function j(W,J,fe,_e,we){W!==J&&i(J,function(ye,Pe){if(we||(we=new x),O(ye))P(W,J,Pe,fe,j,_e,we);else{var Fe=_e?_e(U(W,Pe),ye,Pe+"",W,J,we):void 0;Fe===void 0&&(Fe=ye),A(W,Pe,Fe)}},L)}m.exports=j},f954:function(m,T,f){f("8518")},f9ce:function(m,T,f){var x=f("ef5d"),A=f("e3f8"),i=f("f608"),P=f("f4d6");function O(L){return i(L)?x(P(L)):A(L)}m.exports=O},fa21:function(m,T,f){var x=f("7530"),A=f("2dcb"),i=f("eac5");function P(O){return typeof O.constructor!="function"||i(O)?{}:x(A(O))}m.exports=P},fb15:function(m,T,f){if(f.r(T),f.d(T,"Calendar",function(){return i.c}),f.d(T,"CalendarNav",function(){return i.d}),f.d(T,"DatePicker",function(){return i.f}),f.d(T,"Popover",function(){return i.h}),f.d(T,"Locale",function(){return i.g}),f.d(T,"DateInfo",function(){return i.e}),f.d(T,"Attribute",function(){return i.a}),f.d(T,"AttributeStore",function(){return i.b}),f.d(T,"setupCalendar",function(){return i.D}),f.d(T,"pad",function(){return i.w}),f.d(T,"evalFn",function(){return i.p}),f.d(T,"mergeEvents",function(){return i.r}),f.d(T,"pageIsValid",function(){return i.B}),f.d(T,"pageIsBeforePage",function(){return i.y}),f.d(T,"pageIsAfterPage",function(){return i.x}),f.d(T,"pageIsBetweenPages",function(){return i.z}),f.d(T,"pageIsEqualToPage",function(){return i.A}),f.d(T,"addPages",function(){return i.j}),f.d(T,"pageRangeToArray",function(){return i.C}),f.d(T,"datesAreEqual",function(){return i.m}),f.d(T,"arrayHasItems",function(){return i.k}),f.d(T,"mixinOptionalProps",function(){return i.s}),f.d(T,"on",function(){return i.u}),f.d(T,"off",function(){return i.t}),f.d(T,"elementContains",function(){return i.o}),f.d(T,"onSpaceOrEnter",function(){return i.v}),f.d(T,"createGuid",function(){return i.l}),f.d(T,"hash",function(){return i.q}),f.d(T,"addHorizontalSwipeHandler",function(){return i.i}),typeof window<"u"){var x=window.document.currentScript,A=x&&x.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);A&&(f.p=A[1])}var i=f("34e9");T.default=i.n},fba5:function(m,T,f){var x=f("cb5a");function A(i){return x(this.__data__,i)>-1}m.exports=A},fc6a:function(m,T,f){var x=f("44ad"),A=f("1d80");m.exports=function(i){return x(A(i))}},fd3a:function(m,T,f){f.d(T,"a",function(){return i});var x=f("53ca"),A=f("8c86");function i(P){Object(A.a)(1,arguments);var O=Object.prototype.toString.call(P);return P instanceof Date||Object(x.a)(P)==="object"&&O==="[object Date]"?new Date(P.getTime()):typeof P=="number"||O==="[object Number]"?new Date(P):(typeof P!="string"&&O!=="[object String]"||typeof console>"u"||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}},fdbf:function(m,T,f){var x=f("04f8");m.exports=x&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},fe1f:function(m,T,f){function x(A){if(A===null||A===!0||A===!1)return NaN;var i=Number(A);return isNaN(i)?i:i<0?Math.ceil(i):Math.floor(i)}f.d(T,"a",function(){return x})},ffd6:function(m,T,f){var x=f("3729"),A=f("1310"),i="[object Symbol]";function P(O){return typeof O=="symbol"||A(O)&&x(O)==i}m.exports=P}})})})(ZM);var V4=ZM.exports;Yr(new Date);const Pd=u=>(Zl("data-v-02e01603"),u=u(),Yl(),u),U4=Pd(()=>Ct("div",{class:"title-h2"},[Ct("h2",null,"Plan your next adventure")],-1)),$4={class:"section1"},G4=Pd(()=>Ct("h4",null,"Place & dates",-1)),H4=["placeholder"],q4={class:"text-sm"},W4={class:"flex rounded-lg border border-gray-300 dark:border-gray-600 overflow-hidden calendar whole_calendar",id:"whole_calendar"},Z4=["onClick"],Y4=Pd(()=>Ct("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-calendar w-5 h-5"},[Ct("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),Ct("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),Ct("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),Ct("line",{x1:"3",y1:"10",x2:"21",y2:"10"})],-1)),X4=[Y4],K4=["value"],J4={class:"section2"},Q4=Pd(()=>Ct("h4",null,"Kind of Activities",-1)),eF={class:"box"},tF=["onUpdate:modelValue","id"],nF=["id","for","onClick"],rF=["onUpdate:modelValue","id"],iF=["id","for","onClick"],oF={class:"section3"},sF=Pd(()=>Ct("h4",null,"How many people is going?",-1)),aF={class:"content3"},lF={class:"c-0"},cF=Pd(()=>Ct("p",null,"People",-1)),uF=PS('<section class="section4" data-v-02e01603><div class="box" data-v-02e01603><ul data-v-02e01603><li data-v-02e01603><input type="radio" id="couple" name="relationship" value="couple" checked data-v-02e01603><label class="label" for="couple" data-v-02e01603>Couple</label></li><li data-v-02e01603><input type="radio" id="family" name="relationship" value="family" data-v-02e01603><label class="label" for="family" data-v-02e01603>Family</label></li><li data-v-02e01603><input type="radio" id="friends" name="relationship" value="friends" data-v-02e01603><label class="label" for="friends" data-v-02e01603>Friends</label></li></ul></div></section>',1),hF={class:"submit-btn"},dF=["on-click"],fF={__name:"OptionsMain",setup(u){const _=ua();Mi(()=>ca().get("search",_.language));const E=kv();Yr(new Date);var m=Yr({start:new Date,end:new Date});const T=Yr({dot:!0}),f=Yr(null),x=Yr("orange"),A=Mi(()=>({popover:{visibility:"hover",isInteractive:!1}}));var i=Yr(1);function P(){i.value>1&&i.value--}function O(){i.value<5&&i.value++}const L=[{label:"Kid Friendly",value:"kid_friendly",selected:!1,count:0},{label:"Museums",value:"museums",selected:!1,count:0},{label:"Historical",value:"historical",selected:!1,count:0},{label:"Shopping",value:"shopping",selected:!1,count:0}],U=[{label:"Outdoor Adventures",value:"outdoor_adventures",selected:!1,count:0},{label:"Art & Cultural",value:"art_cultural",selected:!1,count:0},{label:"Amusement Parks",value:"amusement_parks",selected:!1,count:0}];function j(){var Fe=[];for(const Be in L)Be.selected==!0&&(Fe.push=Be.label);console.log(Fe)}function W(Fe,Be){const He=Be==1?L:U;var Ce=He.findIndex(ve=>ve.value===Fe);He[Ce].selected=!He[Ce].selected,console.log(L),console.log(J())}function J(){for(var Fe=document.getElementsByName("relationship"),Be=0;Be<Fe.length;Be++)if(Fe[Be].checked)return Fe[Be].value;return null}const fe=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"];var _e=Yr("Select a range date"),we=document.getElementById("btn_calendar");document.addEventListener("DOMContentLoaded",function(){we.addEventListener("click",()=>{var Fe=fe[m.value.start.getMonth()],Be=fe[m.value.end.getMonth()],He=m.value.start.getDate(),Ce=m.value.end.getDate();_e.value=`${He} ${Fe} ~ ${Ce} ${Be}`,console.log(_e.value)})});function ye(){Pe(),j(),E.changeVar("type",J()),E.changeVar("people",i.value),console.log(E.vars)}function Pe(){var Fe=fe[m.value.start.getMonth()],Be=fe[m.value.end.getMonth()],He=m.value.start.getDate(),Ce=m.value.end.getDate(),ve=document.querySelector(".inputWrong"),Te=new Date;_e.value=="Select a range date"&&Ce==Te.getDate()&&Be==fe[Te.getMonth()]||Ce==He&&Be==Fe?(_e.value="Select a range date",document.addEventListener("DOMContentLoaded",function(){ve.style.color="black"})):Te.getDate()>m.value.start.getDate()&&Te.getMonth()>m.value.start.getMonth()||Te.getDate()>m.value.start.getDate()&&Te.getMonth()==m.value.start.getMonth()?(_e.value="Select a valid range",ve.style.color="red"):(ve.style.color="black",_e.value=`${He} ${Fe} ~ ${Ce} ${Be}`),console.log(_e.value)}return(Fe,Be)=>(gr(),Pr("main",null,[U4,Ct("section",$4,[G4,Ct("div",null,[Ct("input",{type:"",placeholder:$i(E).vars.destiny=="null"?"Select a destiny":$i(E).vars.destiny,class:"destiny"},null,8,H4),Ct("div",null,[cr($i(V4.DatePicker),{color:x.value,modelValue:$i(m),"onUpdate:modelValue":Be[0]||(Be[0]=He=>ro(m)?m.value=He:m=He),modelModifiers:{range:!0},popover:!1,"select-attribute":T.value,"drag-attribute":A.value,onDrag:Be[1]||(Be[1]=He=>f.value=He)},{"day-popover":wp(({format:He})=>[Ct("div",q4,Gc(He(f.value?f.value.start:$i(m).start,"MMM D"))+" - "+Gc(He(f.value?f.value.end:$i(m).end,"MMM D")),1)]),default:wp(({togglePopover:He,inputEvents:Ce})=>[Ct("div",W4,[Ct("button",{class:"flex justify-center items-center px-2 bg-accent-100 hover:bg-accent-200 text-accent-700 border-r border-gray-300 dark:bg-gray-700 dark:text-accent-300 dark:border-gray-600 dark:hover:bg-gray-600 btn-calendar",onClick:()=>He(),id:"btn-calendar"},X4,8,Z4),Ct("input",Sv({value:$i(_e)},cS(Ce,!0),{class:"flex-grow px-2 py-1 bg-white dark:bg-gray-700 inputWrong"}),null,16,K4)])]),_:1},8,["color","modelValue","select-attribute","drag-attribute"])])])]),Ct("section",J4,[Q4,Ct("div",eF,[Ct("ul",null,[(gr(),Pr(zi,null,uh(L,He=>Ct("li",{key:He.value},[lh(Ct("input",{type:"checkbox","onUpdate:modelValue":Ce=>He.selected=Ce,id:He.value},null,8,tF),[[Sp,He.selected]]),Ct("label",{id:He.value,class:"label",for:He.value,onClick:Ce=>W(He.value,1)},Gc(He.label),9,nF)])),64))]),Ct("ul",null,[(gr(),Pr(zi,null,uh(U,He=>Ct("li",{key:He.value},[lh(Ct("input",{type:"checkbox","onUpdate:modelValue":Ce=>He.selected=Ce,id:He.value},null,8,rF),[[Sp,He.selected]]),Ct("label",{id:He.value,class:"label",for:He.value,onClick:Ce=>W(He.value,1)},Gc(He.label),9,iF)])),64))])])]),Ct("section",oF,[sF,Ct("div",aF,[Ct("div",lF,[Ct("p",null,Gc($i(i)),1)]),Ct("div",{class:"c-1"},[cF,Ct("div",{class:"c-2"},[Ct("div",{class:"box-btn"},[Ct("button",{onClick:P},"-")]),Ct("div",{class:"box-btn"},[Ct("button",{onClick:O},"+")])])])])]),uF,Ct("div",hF,[Ct("input",{type:"submit",value:"Create New Trip","on-click":ye()},null,40,dF)])]))}},pF=Ao(fF,[["__scopeId","data-v-02e01603"]]),mF={class:"allComponents"},_F={__name:"OptionsComponent",setup(u){return(_,E)=>(gr(),Pr("section",mF,[cr(fg),cr(pF)]))}},gF=Ao(_F,[["__scopeId","data-v-6a7a6de7"]]),yF={class:"container-fluid"},vF={__name:"OptionsView",setup(u){return(_,E)=>(gr(),Pr("main",yF,[Ct("div",null,[cr(gF)])]))}},xF=WO({history:TO("/"),routes:[{path:"/",name:"home",component:VR},{path:"/about",name:"about",component:g4},{path:"/test",name:"test",component:$R},{path:"/login",name:"login",component:N4},{path:"/options",name:"options",component:vF}]}),wg=nM(YO);wg.use(Vk());wg.use(xF);wg.use(T4,{clientId:"585388550874-da88aogj6sqc6he9o5mnmm9ibagborua.apps.googleusercontent.com"});wg.mount("#app");
